#if STENCIL_ORDER == 2
Max Stencil shock_max_stencil {

          [-1][-1][-1] = 1,
          [-1][-1][0] = 1,
          [-1][-1][1] = 1,
          [-1][0][-1] = 1,
          [-1][0][0] = 1,
          [-1][0][1] = 1,
          [-1][1][-1] = 1,
          [-1][1][0] = 1,
          [-1][1][1] = 1,
          [0][-1][-1] = 1,
          [0][-1][0] = 1,
          [0][-1][1] = 1,
          [0][0][-1] = 1,
          [0][0][0] = 1,
          [0][0][1] = 1,
          [0][1][-1] = 1,
          [0][1][0] = 1,
          [0][1][1] = 1,
          [1][-1][-1] = 1,
          [1][-1][0] = 1,
          [1][-1][1] = 1,
          [1][0][-1] = 1,
          [1][0][0] = 1,
          [1][0][1] = 1,
          [1][1][-1] = 1,
          [1][1][0] = 1,
          [1][1][1] = 1

}
Stencil
shock_smooth_kernel
{
          [-1][-1][-1] = 0.022247314453125,
          [-1][-1][0] = 0.03460693359375,
          [-1][-1][1] = 0.022247314453125,
          [-1][0][-1] = 0.03460693359375,
          [-1][0][0] = 0.0538330078125,
          [-1][0][1] = 0.03460693359375,
          [-1][1][-1] = 0.022247314453125,
          [-1][1][0] = 0.03460693359375,
          [-1][1][1] = 0.022247314453125,
          [0][-1][-1] = 0.03460693359375,
          [0][-1][0] = 0.0538330078125,
          [0][-1][1] = 0.03460693359375,
          [0][0][-1] = 0.0538330078125,
          [0][0][0] = 0.083740234375,
          [0][0][1] = 0.0538330078125,
          [0][1][-1] = 0.03460693359375,
          [0][1][0] = 0.0538330078125,
          [0][1][1] = 0.03460693359375,
          [1][-1][-1] = 0.022247314453125,
          [1][-1][0] = 0.03460693359375,
          [1][-1][1] = 0.022247314453125,
          [1][0][-1] = 0.03460693359375,
          [1][0][0] = 0.0538330078125,
          [1][0][1] = 0.03460693359375,
          [1][1][-1] = 0.022247314453125,
          [1][1][0] = 0.03460693359375,
          [1][1][1] = 0.022247314453125
}
#else
Stencil
shock_smooth_kernel
{
	  [-3][-3][-3] = 1.7146776406035666e-07,
	  [-3][-3][-2] = 1.5432098765432098e-06,
	  [-3][-3][-1] = 7.71604938271605e-06,
	  [-3][-3][0] = 1.2002743484224965e-05,
	  [-3][-3][1] = 7.71604938271605e-06,
	  [-3][-3][2] = 1.5432098765432098e-06,
	  [-3][-3][3] = 1.7146776406035666e-07,
	  [-3][-2][-3] = 1.5432098765432098e-06,
	  [-3][-2][-2] = 1.388888888888889e-05,
	  [-3][-2][-1] = 6.944444444444444e-05,
	  [-3][-2][0] = 0.0001080246913580247,
	  [-3][-2][1] = 6.944444444444444e-05,
	  [-3][-2][2] = 1.388888888888889e-05,
	  [-3][-2][3] = 1.5432098765432098e-06,
	  [-3][-1][-3] = 7.71604938271605e-06,
	  [-3][-1][-2] = 6.944444444444444e-05,
	  [-3][-1][-1] = 0.00034722222222222224,
	  [-3][-1][0] = 0.0005401234567901234,
	  [-3][-1][1] = 0.00034722222222222224,
	  [-3][-1][2] = 6.944444444444444e-05,
	  [-3][-1][3] = 7.71604938271605e-06,
	  [-3][0][-3] = 1.2002743484224965e-05,
	  [-3][0][-2] = 0.0001080246913580247,
	  [-3][0][-1] = 0.0005401234567901234,
	  [-3][0][0] = 0.0008401920438957476,
	  [-3][0][1] = 0.0005401234567901234,
	  [-3][0][2] = 0.0001080246913580247,
	  [-3][0][3] = 1.2002743484224965e-05,
	  [-3][1][-3] = 7.71604938271605e-06,
	  [-3][1][-2] = 6.944444444444444e-05,
	  [-3][1][-1] = 0.00034722222222222224,
	  [-3][1][0] = 0.0005401234567901234,
	  [-3][1][1] = 0.00034722222222222224,
	  [-3][1][2] = 6.944444444444444e-05,
	  [-3][1][3] = 7.71604938271605e-06,
	  [-3][2][-3] = 1.5432098765432098e-06,
	  [-3][2][-2] = 1.388888888888889e-05,
	  [-3][2][-1] = 6.944444444444444e-05,
	  [-3][2][0] = 0.0001080246913580247,
	  [-3][2][1] = 6.944444444444444e-05,
	  [-3][2][2] = 1.388888888888889e-05,
	  [-3][2][3] = 1.5432098765432098e-06,
	  [-3][3][-3] = 1.7146776406035666e-07,
	  [-3][3][-2] = 1.5432098765432098e-06,
	  [-3][3][-1] = 7.71604938271605e-06,
	  [-3][3][0] = 1.2002743484224965e-05,
	  [-3][3][1] = 7.71604938271605e-06,
	  [-3][3][2] = 1.5432098765432098e-06,
	  [-3][3][3] = 1.7146776406035666e-07,
	  [-2][-3][-3] = 1.5432098765432098e-06,
	  [-2][-3][-2] = 1.388888888888889e-05,
	  [-2][-3][-1] = 6.944444444444444e-05,
	  [-2][-3][0] = 0.0001080246913580247,
	  [-2][-3][1] = 6.944444444444444e-05,
	  [-2][-3][2] = 1.388888888888889e-05,
	  [-2][-3][3] = 1.5432098765432098e-06,
	  [-2][-2][-3] = 1.388888888888889e-05,
	  [-2][-2][-2] = 0.000125,
	  [-2][-2][-1] = 0.000625,
	  [-2][-2][0] = 0.0009722222222222222,
	  [-2][-2][1] = 0.000625,
	  [-2][-2][2] = 0.000125,
	  [-2][-2][3] = 1.388888888888889e-05,
	  [-2][-1][-3] = 6.944444444444444e-05,
	  [-2][-1][-2] = 0.000625,
	  [-2][-1][-1] = 0.003125,
	  [-2][-1][0] = 0.004861111111111111,
	  [-2][-1][1] = 0.003125,
	  [-2][-1][2] = 0.000625,
	  [-2][-1][3] = 6.944444444444444e-05,
	  [-2][0][-3] = 0.0001080246913580247,
	  [-2][0][-2] = 0.0009722222222222222,
	  [-2][0][-1] = 0.004861111111111111,
	  [-2][0][0] = 0.007561728395061728,
	  [-2][0][1] = 0.004861111111111111,
	  [-2][0][2] = 0.0009722222222222222,
	  [-2][0][3] = 0.0001080246913580247,
	  [-2][1][-3] = 6.944444444444444e-05,
	  [-2][1][-2] = 0.000625,
	  [-2][1][-1] = 0.003125,
	  [-2][1][0] = 0.004861111111111111,
	  [-2][1][1] = 0.003125,
	  [-2][1][2] = 0.000625,
	  [-2][1][3] = 6.944444444444444e-05,
	  [-2][2][-3] = 1.388888888888889e-05,
	  [-2][2][-2] = 0.000125,
	  [-2][2][-1] = 0.000625,
	  [-2][2][0] = 0.0009722222222222222,
	  [-2][2][1] = 0.000625,
	  [-2][2][2] = 0.000125,
	  [-2][2][3] = 1.388888888888889e-05,
	  [-2][3][-3] = 1.5432098765432098e-06,
	  [-2][3][-2] = 1.388888888888889e-05,
	  [-2][3][-1] = 6.944444444444444e-05,
	  [-2][3][0] = 0.0001080246913580247,
	  [-2][3][1] = 6.944444444444444e-05,
	  [-2][3][2] = 1.388888888888889e-05,
	  [-2][3][3] = 1.5432098765432098e-06,
	  [-1][-3][-3] = 7.71604938271605e-06,
	  [-1][-3][-2] = 6.944444444444444e-05,
	  [-1][-3][-1] = 0.00034722222222222224,
	  [-1][-3][0] = 0.0005401234567901234,
	  [-1][-3][1] = 0.00034722222222222224,
	  [-1][-3][2] = 6.944444444444444e-05,
	  [-1][-3][3] = 7.71604938271605e-06,
	  [-1][-2][-3] = 6.944444444444444e-05,
	  [-1][-2][-2] = 0.000625,
	  [-1][-2][-1] = 0.003125,
	  [-1][-2][0] = 0.004861111111111111,
	  [-1][-2][1] = 0.003125,
	  [-1][-2][2] = 0.000625,
	  [-1][-2][3] = 6.944444444444444e-05,
	  [-1][-1][-3] = 0.00034722222222222224,
	  [-1][-1][-2] = 0.003125,
	  [-1][-1][-1] = 0.015625,
	  [-1][-1][0] = 0.024305555555555556,
	  [-1][-1][1] = 0.015625,
	  [-1][-1][2] = 0.003125,
	  [-1][-1][3] = 0.00034722222222222224,
	  [-1][0][-3] = 0.0005401234567901234,
	  [-1][0][-2] = 0.004861111111111111,
	  [-1][0][-1] = 0.024305555555555556,
	  [-1][0][0] = 0.03780864197530864,
	  [-1][0][1] = 0.024305555555555556,
	  [-1][0][2] = 0.004861111111111111,
	  [-1][0][3] = 0.0005401234567901234,
	  [-1][1][-3] = 0.00034722222222222224,
	  [-1][1][-2] = 0.003125,
	  [-1][1][-1] = 0.015625,
	  [-1][1][0] = 0.024305555555555556,
	  [-1][1][1] = 0.015625,
	  [-1][1][2] = 0.003125,
	  [-1][1][3] = 0.00034722222222222224,
	  [-1][2][-3] = 6.944444444444444e-05,
	  [-1][2][-2] = 0.000625,
	  [-1][2][-1] = 0.003125,
	  [-1][2][0] = 0.004861111111111111,
	  [-1][2][1] = 0.003125,
	  [-1][2][2] = 0.000625,
	  [-1][2][3] = 6.944444444444444e-05,
	  [-1][3][-3] = 7.71604938271605e-06,
	  [-1][3][-2] = 6.944444444444444e-05,
	  [-1][3][-1] = 0.00034722222222222224,
	  [-1][3][0] = 0.0005401234567901234,
	  [-1][3][1] = 0.00034722222222222224,
	  [-1][3][2] = 6.944444444444444e-05,
	  [-1][3][3] = 7.71604938271605e-06,
	  [0][-3][-3] = 1.2002743484224965e-05,
	  [0][-3][-2] = 0.0001080246913580247,
	  [0][-3][-1] = 0.0005401234567901234,
	  [0][-3][0] = 0.0008401920438957476,
	  [0][-3][1] = 0.0005401234567901234,
	  [0][-3][2] = 0.0001080246913580247,
	  [0][-3][3] = 1.2002743484224965e-05,
	  [0][-2][-3] = 0.0001080246913580247,
	  [0][-2][-2] = 0.0009722222222222222,
	  [0][-2][-1] = 0.004861111111111111,
	  [0][-2][0] = 0.007561728395061728,
	  [0][-2][1] = 0.004861111111111111,
	  [0][-2][2] = 0.0009722222222222222,
	  [0][-2][3] = 0.0001080246913580247,
	  [0][-1][-3] = 0.0005401234567901234,
	  [0][-1][-2] = 0.004861111111111111,
	  [0][-1][-1] = 0.024305555555555556,
	  [0][-1][0] = 0.03780864197530864,
	  [0][-1][1] = 0.024305555555555556,
	  [0][-1][2] = 0.004861111111111111,
	  [0][-1][3] = 0.0005401234567901234,
	  [0][0][-3] = 0.0008401920438957476,
	  [0][0][-2] = 0.007561728395061728,
	  [0][0][-1] = 0.03780864197530864,
	  [0][0][0] = 0.05881344307270233,
	  [0][0][1] = 0.03780864197530864,
	  [0][0][2] = 0.007561728395061728,
	  [0][0][3] = 0.0008401920438957476,
	  [0][1][-3] = 0.0005401234567901234,
	  [0][1][-2] = 0.004861111111111111,
	  [0][1][-1] = 0.024305555555555556,
	  [0][1][0] = 0.03780864197530864,
	  [0][1][1] = 0.024305555555555556,
	  [0][1][2] = 0.004861111111111111,
	  [0][1][3] = 0.0005401234567901234,
	  [0][2][-3] = 0.0001080246913580247,
	  [0][2][-2] = 0.0009722222222222222,
	  [0][2][-1] = 0.004861111111111111,
	  [0][2][0] = 0.007561728395061728,
	  [0][2][1] = 0.004861111111111111,
	  [0][2][2] = 0.0009722222222222222,
	  [0][2][3] = 0.0001080246913580247,
	  [0][3][-3] = 1.2002743484224965e-05,
	  [0][3][-2] = 0.0001080246913580247,
	  [0][3][-1] = 0.0005401234567901234,
	  [0][3][0] = 0.0008401920438957476,
	  [0][3][1] = 0.0005401234567901234,
	  [0][3][2] = 0.0001080246913580247,
	  [0][3][3] = 1.2002743484224965e-05,
	  [1][-3][-3] = 7.71604938271605e-06,
	  [1][-3][-2] = 6.944444444444444e-05,
	  [1][-3][-1] = 0.00034722222222222224,
	  [1][-3][0] = 0.0005401234567901234,
	  [1][-3][1] = 0.00034722222222222224,
	  [1][-3][2] = 6.944444444444444e-05,
	  [1][-3][3] = 7.71604938271605e-06,
	  [1][-2][-3] = 6.944444444444444e-05,
	  [1][-2][-2] = 0.000625,
	  [1][-2][-1] = 0.003125,
	  [1][-2][0] = 0.004861111111111111,
	  [1][-2][1] = 0.003125,
	  [1][-2][2] = 0.000625,
	  [1][-2][3] = 6.944444444444444e-05,
	  [1][-1][-3] = 0.00034722222222222224,
	  [1][-1][-2] = 0.003125,
	  [1][-1][-1] = 0.015625,
	  [1][-1][0] = 0.024305555555555556,
	  [1][-1][1] = 0.015625,
	  [1][-1][2] = 0.003125,
	  [1][-1][3] = 0.00034722222222222224,
	  [1][0][-3] = 0.0005401234567901234,
	  [1][0][-2] = 0.004861111111111111,
	  [1][0][-1] = 0.024305555555555556,
	  [1][0][0] = 0.03780864197530864,
	  [1][0][1] = 0.024305555555555556,
	  [1][0][2] = 0.004861111111111111,
	  [1][0][3] = 0.0005401234567901234,
	  [1][1][-3] = 0.00034722222222222224,
	  [1][1][-2] = 0.003125,
	  [1][1][-1] = 0.015625,
	  [1][1][0] = 0.024305555555555556,
	  [1][1][1] = 0.015625,
	  [1][1][2] = 0.003125,
	  [1][1][3] = 0.00034722222222222224,
	  [1][2][-3] = 6.944444444444444e-05,
	  [1][2][-2] = 0.000625,
	  [1][2][-1] = 0.003125,
	  [1][2][0] = 0.004861111111111111,
	  [1][2][1] = 0.003125,
	  [1][2][2] = 0.000625,
	  [1][2][3] = 6.944444444444444e-05,
	  [1][3][-3] = 7.71604938271605e-06,
	  [1][3][-2] = 6.944444444444444e-05,
	  [1][3][-1] = 0.00034722222222222224,
	  [1][3][0] = 0.0005401234567901234,
	  [1][3][1] = 0.00034722222222222224,
	  [1][3][2] = 6.944444444444444e-05,
	  [1][3][3] = 7.71604938271605e-06,
	  [2][-3][-3] = 1.5432098765432098e-06,
	  [2][-3][-2] = 1.388888888888889e-05,
	  [2][-3][-1] = 6.944444444444444e-05,
	  [2][-3][0] = 0.0001080246913580247,
	  [2][-3][1] = 6.944444444444444e-05,
	  [2][-3][2] = 1.388888888888889e-05,
	  [2][-3][3] = 1.5432098765432098e-06,
	  [2][-2][-3] = 1.388888888888889e-05,
	  [2][-2][-2] = 0.000125,
	  [2][-2][-1] = 0.000625,
	  [2][-2][0] = 0.0009722222222222222,
	  [2][-2][1] = 0.000625,
	  [2][-2][2] = 0.000125,
	  [2][-2][3] = 1.388888888888889e-05,
	  [2][-1][-3] = 6.944444444444444e-05,
	  [2][-1][-2] = 0.000625,
	  [2][-1][-1] = 0.003125,
	  [2][-1][0] = 0.004861111111111111,
	  [2][-1][1] = 0.003125,
	  [2][-1][2] = 0.000625,
	  [2][-1][3] = 6.944444444444444e-05,
	  [2][0][-3] = 0.0001080246913580247,
	  [2][0][-2] = 0.0009722222222222222,
	  [2][0][-1] = 0.004861111111111111,
	  [2][0][0] = 0.007561728395061728,
	  [2][0][1] = 0.004861111111111111,
	  [2][0][2] = 0.0009722222222222222,
	  [2][0][3] = 0.0001080246913580247,
	  [2][1][-3] = 6.944444444444444e-05,
	  [2][1][-2] = 0.000625,
	  [2][1][-1] = 0.003125,
	  [2][1][0] = 0.004861111111111111,
	  [2][1][1] = 0.003125,
	  [2][1][2] = 0.000625,
	  [2][1][3] = 6.944444444444444e-05,
	  [2][2][-3] = 1.388888888888889e-05,
	  [2][2][-2] = 0.000125,
	  [2][2][-1] = 0.000625,
	  [2][2][0] = 0.0009722222222222222,
	  [2][2][1] = 0.000625,
	  [2][2][2] = 0.000125,
	  [2][2][3] = 1.388888888888889e-05,
	  [2][3][-3] = 1.5432098765432098e-06,
	  [2][3][-2] = 1.388888888888889e-05,
	  [2][3][-1] = 6.944444444444444e-05,
	  [2][3][0] = 0.0001080246913580247,
	  [2][3][1] = 6.944444444444444e-05,
	  [2][3][2] = 1.388888888888889e-05,
	  [2][3][3] = 1.5432098765432098e-06,
	  [3][-3][-3] = 1.7146776406035666e-07,
	  [3][-3][-2] = 1.5432098765432098e-06,
	  [3][-3][-1] = 7.71604938271605e-06,
	  [3][-3][0] = 1.2002743484224965e-05,
	  [3][-3][1] = 7.71604938271605e-06,
	  [3][-3][2] = 1.5432098765432098e-06,
	  [3][-3][3] = 1.7146776406035666e-07,
	  [3][-2][-3] = 1.5432098765432098e-06,
	  [3][-2][-2] = 1.388888888888889e-05,
	  [3][-2][-1] = 6.944444444444444e-05,
	  [3][-2][0] = 0.0001080246913580247,
	  [3][-2][1] = 6.944444444444444e-05,
	  [3][-2][2] = 1.388888888888889e-05,
	  [3][-2][3] = 1.5432098765432098e-06,
	  [3][-1][-3] = 7.71604938271605e-06,
	  [3][-1][-2] = 6.944444444444444e-05,
	  [3][-1][-1] = 0.00034722222222222224,
	  [3][-1][0] = 0.0005401234567901234,
	  [3][-1][1] = 0.00034722222222222224,
	  [3][-1][2] = 6.944444444444444e-05,
	  [3][-1][3] = 7.71604938271605e-06,
	  [3][0][-3] = 1.2002743484224965e-05,
	  [3][0][-2] = 0.0001080246913580247,
	  [3][0][-1] = 0.0005401234567901234,
	  [3][0][0] = 0.0008401920438957476,
	  [3][0][1] = 0.0005401234567901234,
	  [3][0][2] = 0.0001080246913580247,
	  [3][0][3] = 1.2002743484224965e-05,
	  [3][1][-3] = 7.71604938271605e-06,
	  [3][1][-2] = 6.944444444444444e-05,
	  [3][1][-1] = 0.00034722222222222224,
	  [3][1][0] = 0.0005401234567901234,
	  [3][1][1] = 0.00034722222222222224,
	  [3][1][2] = 6.944444444444444e-05,
	  [3][1][3] = 7.71604938271605e-06,
	  [3][2][-3] = 1.5432098765432098e-06,
	  [3][2][-2] = 1.388888888888889e-05,
	  [3][2][-1] = 6.944444444444444e-05,
	  [3][2][0] = 0.0001080246913580247,
	  [3][2][1] = 6.944444444444444e-05,
	  [3][2][2] = 1.388888888888889e-05,
	  [3][2][3] = 1.5432098765432098e-06,
	  [3][3][-3] = 1.7146776406035666e-07,
	  [3][3][-2] = 1.5432098765432098e-06,
	  [3][3][-1] = 7.71604938271605e-06,
	  [3][3][0] = 1.2002743484224965e-05,
	  [3][3][1] = 7.71604938271605e-06,
	  [3][3][2] = 1.5432098765432098e-06,
	  [3][3][3] = 1.7146776406035666e-07,
}

Max Stencil shock_max_stencil{
[-3][0][0] = 1,
[-2][-2][-1] = 1,
[-2][-2][0] = 1,
[-2][-2][1] = 1,
[-2][-1][-2] = 1,
[-2][-1][-1] = 1,
[-2][-1][0] = 1,
[-2][-1][1] = 1,
[-2][-1][2] = 1,
[-2][0][-2] = 1,
[-2][0][-1] = 1,
[-2][0][0] = 1,
[-2][0][1] = 1,
[-2][0][2] = 1,
[-2][1][-2] = 1,
[-2][1][-1] = 1,
[-2][1][0] = 1,
[-2][1][1] = 1,
[-2][1][2] = 1,
[-2][2][-1] = 1,
[-2][2][0] = 1,
[-2][2][1] = 1,
[-1][-2][-2] = 1,
[-1][-2][-1] = 1,
[-1][-2][0] = 1,
[-1][-2][1] = 1,
[-1][-2][2] = 1,
[-1][-1][-2] = 1,
[-1][-1][-1] = 1,
[-1][-1][0] = 1,
[-1][-1][1] = 1,
[-1][-1][2] = 1,
[-1][0][-2] = 1,
[-1][0][-1] = 1,
[-1][0][0] = 1,
[-1][0][1] = 1,
[-1][0][2] = 1,
[-1][1][-2] = 1,
[-1][1][-1] = 1,
[-1][1][0] = 1,
[-1][1][1] = 1,
[-1][1][2] = 1,
[-1][2][-2] = 1,
[-1][2][-1] = 1,
[-1][2][0] = 1,
[-1][2][1] = 1,
[-1][2][2] = 1,
[0][-3][0] = 1,
[0][-2][-2] = 1,
[0][-2][-1] = 1,
[0][-2][0] = 1,
[0][-2][1] = 1,
[0][-2][2] = 1,
[0][-1][-2] = 1,
[0][-1][-1] = 1,
[0][-1][0] = 1,
[0][-1][1] = 1,
[0][-1][2] = 1,
[0][0][-3] = 1,
[0][0][-2] = 1,
[0][0][-1] = 1,
[0][0][0] = 1,
[0][0][1] = 1,
[0][0][2] = 1,
[0][0][3] = 1,
[0][1][-2] = 1,
[0][1][-1] = 1,
[0][1][0] = 1,
[0][1][1] = 1,
[0][1][2] = 1,
[0][2][-2] = 1,
[0][2][-1] = 1,
[0][2][0] = 1,
[0][2][1] = 1,
[0][2][2] = 1,
[0][3][0] = 1,
[1][-2][-2] = 1,
[1][-2][-1] = 1,
[1][-2][0] = 1,
[1][-2][1] = 1,
[1][-2][2] = 1,
[1][-1][-2] = 1,
[1][-1][-1] = 1,
[1][-1][0] = 1,
[1][-1][1] = 1,
[1][-1][2] = 1,
[1][0][-2] = 1,
[1][0][-1] = 1,
[1][0][0] = 1,
[1][0][1] = 1,
[1][0][2] = 1,
[1][1][-2] = 1,
[1][1][-1] = 1,
[1][1][0] = 1,
[1][1][1] = 1,
[1][1][2] = 1,
[1][2][-2] = 1,
[1][2][-1] = 1,
[1][2][0] = 1,
[1][2][1] = 1,
[1][2][2] = 1,
[2][-2][-1] = 1,
[2][-2][0] = 1,
[2][-2][1] = 1,
[2][-1][-2] = 1,
[2][-1][-1] = 1,
[2][-1][0] = 1,
[2][-1][1] = 1,
[2][-1][2] = 1,
[2][0][-2] = 1,
[2][0][-1] = 1,
[2][0][0] = 1,
[2][0][1] = 1,
[2][0][2] = 1,
[2][1][-2] = 1,
[2][1][-1] = 1,
[2][1][0] = 1,
[2][1][1] = 1,
[2][1][2] = 1,
[2][2][-1] = 1,
[2][2][0] = 1,
[2][2][1] = 1,
[3][0][0] = 1
}
#endif
shock_divu(Field dst, Field3 src)
{
    // Set discard the values which do not contain negative divergence.
    divu = divergence(src)
    if divu < 0.0 {
        divu = -divu
    }
    else {
        divu = 0.0
    }
    write(dst, divu)
}

shock_max(Field shock)
{
    write(shock, shock_max_stencil(shock))
}

shock_smooth(Field shock)
{
    dsmin = AC_dsmin
    cshock = 1.0

    s_shock = shock_smooth_kernel(shock)
    out_shock = cshock*dsmin*dsmin*s_shock //Add scaling constant cshock

    write(shock, out_shock)
}

shock_momentum_update(Field shock, Field3 uu, Field lnrho)
{
  return (shock* (divergence(uu) * gradient(lnrho) +
                                    gradient_of_divergence(uu)) +
                           divergence(uu) * gradient(shock))	

}
