#include "../../stdlib/math"
#include "../../stdlib/derivs.h"
#include "../../stdlib/operators.h"
#include "fieldecs.h"
const int AC_npencils__mod__cparam = 200
//TP: nphis1 and nphis2 don't actually work. simply declared to compile the code
gmem real AC_nphis1__mod__cdata[AC_mx__mod__cparam]
gmem real AC_nphis2__mod__cdata[AC_mx__mod__cparam]
//
#include "var_declares.h"
bool AC_lpencil__mod__cparam[AC_npencils__mod__cparam]
bool AC_cant_know_value
/**
Kernel rhs()
{
	const int3 val = {0,0,0}
	if(val.x == 0)
	{
		print("I AM taken\n")
	}
}
**/
Kernel rhs(){
#include "static_var_declares.h"
#include "df_declares.h"
real ac_transformed_pencil_interdependency
real ac_transformed_pencil_among
real ac_transformed_pencil_by
real ac_transformed_pencil_the
real ac_transformed_pencil_cosmicray
real ac_transformed_pencil_module
real ac_transformed_pencil_pointmasses
real ac_transformed_pencil_acc
real ac_transformed_pencil_ssat
real ac_transformed_pencil_ttc
real ac_transformed_pencil_pscalar
Matrix ac_transformed_pencil_poly
real ac_transformed_pencil_trp
real ac_transformed_pencil_fr
Matrix ac_transformed_pencil_frc
Matrix ac_transformed_pencil_u_dot_gradc
Tensor ac_transformed_pencil_cijk
Matrix ac_transformed_pencil_del2poly
real3 ac_transformed_pencil_div_frc
real3 ac_transformed_pencil_divc
real3 ac_transformed_pencil_grad_fr
real ac_transformed_pencil_shock
real3 ac_transformed_pencil_gshock
real ac_transformed_pencil_shock_perp
real3 ac_transformed_pencil_gshock_perp
real ac_transformed_pencil_this
real ac_transformed_pencil_are
real ac_transformed_pencil_specified
real ac_transformed_pencil_ttp
real ac_transformed_pencil_cc
real ac_transformed_pencil_cc1
real3 ac_transformed_pencil_gcc[AC_0]
real ac_transformed_pencil_lnrhon
real ac_transformed_pencil_rhon
real ac_transformed_pencil_rhon1
real3 ac_transformed_pencil_glnrhon
real3 ac_transformed_pencil_grhon
real ac_transformed_pencil_unglnrhon
real ac_transformed_pencil_ungrhon
real ac_transformed_pencil_del2rhon
real ac_transformed_pencil_glnrhon2
real ac_transformed_pencil_del6lnrhon
real ac_transformed_pencil_del6rhon
real3 ac_transformed_pencil_snglnrhon
real ac_transformed_pencil_alpha
real ac_transformed_pencil_zeta
real ac_transformed_pencil_heat
real ac_transformed_pencil_cool
real ac_transformed_pencil_heatcool
real3 ac_transformed_pencil_uun
real ac_transformed_pencil_divun
Matrix ac_transformed_pencil_snij
real ac_transformed_pencil_neutralvelocity
real3 ac_transformed_pencil_fsgs
real ac_transformed_pencil_sgs_heat
real ac_transformed_pencil_visc_heatn
real ac_transformed_pencil_un2
Matrix ac_transformed_pencil_unij
real ac_transformed_pencil_snij2
real3 ac_transformed_pencil_ungun
real3 ac_transformed_pencil_del2un
real3 ac_transformed_pencil_del6un
real3 ac_transformed_pencil_graddivun
real ac_transformed_pencil_advec_uun
real ac_transformed_pencil_advec_csn2
real3 ac_transformed_pencil_bbf
real ac_transformed_pencil_chiral
real3 ac_transformed_pencil_uud[AC_ndustspec__mod__cparam]
real ac_transformed_pencil_divud[AC_ndustspec__mod__cparam]
real3 ac_transformed_pencil_fcont[AC_n_forcing_cont_max__mod__cparam]
real ac_transformed_pencil_x_mn
real ac_transformed_pencil_y_mn
real ac_transformed_pencil_z_mn
real ac_transformed_pencil_r_mn
real ac_transformed_pencil_r_mn1
real ac_transformed_pencil_phix
real ac_transformed_pencil_phiy
real ac_transformed_pencil_pomx
real ac_transformed_pencil_pomy
real ac_transformed_pencil_rcyl_mn
real ac_transformed_pencil_rcyl_mn1
real ac_transformed_pencil_phi_mn
real3 ac_transformed_pencil_evr
real3 ac_transformed_pencil_rr
real3 ac_transformed_pencil_evth
real ac_transformed_pencil_divu
real3 ac_transformed_pencil_oo
real ac_transformed_pencil_o2
real ac_transformed_pencil_ou
real ac_transformed_pencil_oxu2
real3 ac_transformed_pencil_oxu
real ac_transformed_pencil_u2
Matrix ac_transformed_pencil_uij
real3 ac_transformed_pencil_uu
real3 ac_transformed_pencil_curlo
Matrix ac_transformed_pencil_sij
real ac_transformed_pencil_sij2
Matrix ac_transformed_pencil_uij5
real3 ac_transformed_pencil_ugu
real ac_transformed_pencil_ugu2
Matrix ac_transformed_pencil_oij
Matrix ac_transformed_pencil_d2uidxj
Tensor ac_transformed_pencil_uijk
real3 ac_transformed_pencil_ogu
real ac_transformed_pencil_u3u21
real ac_transformed_pencil_u1u32
real ac_transformed_pencil_u2u13
real3 ac_transformed_pencil_del2u
real3 ac_transformed_pencil_del4u
real3 ac_transformed_pencil_del6u
real ac_transformed_pencil_u2u31
real ac_transformed_pencil_u3u12
real ac_transformed_pencil_u1u23
real3 ac_transformed_pencil_graddivu
real3 ac_transformed_pencil_del6u_bulk
real3 ac_transformed_pencil_grad5divu
real3 ac_transformed_pencil_rhougu
real3 ac_transformed_pencil_der6u
real3 ac_transformed_pencil_transpurho
real ac_transformed_pencil_divu0
Matrix ac_transformed_pencil_u0ij
real3 ac_transformed_pencil_uu0
real3 ac_transformed_pencil_uu_advec
real3 ac_transformed_pencil_uuadvec_guu
real3 ac_transformed_pencil_del6u_strict
real3 ac_transformed_pencil_del4graddivu
real3 ac_transformed_pencil_uu_sph
Matrix ac_transformed_pencil_der6u_res
real ac_transformed_pencil_lorentz
real ac_transformed_pencil_hless
real ac_transformed_pencil_advec_uu
real ac_transformed_pencil_neutraldensity
real3 ac_transformed_pencil_gg
real3 ac_transformed_pencil_gacc
real ac_transformed_pencil_ugacc
real ac_transformed_pencil_del2acc
real3 ac_transformed_pencil_gttc
real ac_transformed_pencil_ugttc
real ac_transformed_pencil_del2ttc
real ac_transformed_pencil_rhod[AC_ndustspec__mod__cparam]
real3 ac_transformed_pencil_udropav
real ac_transformed_pencil_rhodsum
real3 ac_transformed_pencil_glnrhodsum
real3 ac_transformed_pencil_ood[AC_ndustspec__mod__cparam]
real ac_transformed_pencil_od2[AC_ndustspec__mod__cparam]
real ac_transformed_pencil_oud[AC_ndustspec__mod__cparam]
real ac_transformed_pencil_ud2[AC_ndustspec__mod__cparam]
real3 ac_transformed_pencil_udgud[AC_ndustspec__mod__cparam]
real3 ac_transformed_pencil_del2ud[AC_ndustspec__mod__cparam]
real3 ac_transformed_pencil_del6ud[AC_ndustspec__mod__cparam]
real3 ac_transformed_pencil_graddivud[AC_ndustspec__mod__cparam]
real ac_transformed_pencil_advec_uud
real ac_transformed_pencil_dustvelocity
real3 ac_transformed_pencil_sgs_force
real ac_transformed_pencil_ugss
real ac_transformed_pencil_ma2
real3 ac_transformed_pencil_fpres
real ac_transformed_pencil_uglntt
real3 ac_transformed_pencil_sglntt
real ac_transformed_pencil_transprhos
real ac_transformed_pencil_dsdr
real ac_transformed_pencil_initss
real ac_transformed_pencil_initlnrho
real ac_transformed_pencil_uuadvec_gss
real ac_transformed_pencil_advec_cs2
real3 ac_transformed_pencil_glnnd[AC_ndustspec__mod__cparam]
real3 ac_transformed_pencil_gmi[AC_ndustspec__mod__cparam]
real3 ac_transformed_pencil_gmd[AC_ndustspec__mod__cparam]
real3 ac_transformed_pencil_gnd[AC_ndustspec__mod__cparam]
real3 ac_transformed_pencil_grhod[AC_ndustspec__mod__cparam]
real ac_transformed_pencil_ad[AC_ndustspec__mod__cparam]
real ac_transformed_pencil_md[AC_ndustspec__mod__cparam]
real ac_transformed_pencil_mi[AC_ndustspec__mod__cparam]
real ac_transformed_pencil_nd[AC_ndustspec__mod__cparam]
real ac_transformed_pencil_rhod1[AC_ndustspec__mod__cparam]
real ac_transformed_pencil_epsd[AC_ndustspec__mod__cparam]
real ac_transformed_pencil_udgmi[AC_ndustspec__mod__cparam]
real ac_transformed_pencil_udgmd[AC_ndustspec__mod__cparam]
real ac_transformed_pencil_udglnnd[AC_ndustspec__mod__cparam]
real ac_transformed_pencil_udgnd[AC_ndustspec__mod__cparam]
real ac_transformed_pencil_glnnd2[AC_ndustspec__mod__cparam]
real3 ac_transformed_pencil_sdglnnd[AC_ndustspec__mod__cparam]
real ac_transformed_pencil_del2nd[AC_ndustspec__mod__cparam]
real ac_transformed_pencil_del2rhod[AC_ndustspec__mod__cparam]
real ac_transformed_pencil_del6nd[AC_ndustspec__mod__cparam]
real ac_transformed_pencil_del2md[AC_ndustspec__mod__cparam]
real ac_transformed_pencil_del2mi[AC_ndustspec__mod__cparam]
real ac_transformed_pencil_del6lnnd[AC_ndustspec__mod__cparam]
real ac_transformed_pencil_gndglnrho[AC_ndustspec__mod__cparam]
real ac_transformed_pencil_glnndglnrho[AC_ndustspec__mod__cparam]
real3 ac_transformed_pencil_udrop[AC_ndustspec__mod__cparam]
real ac_transformed_pencil_udropgnd[AC_ndustspec__mod__cparam]
real ac_transformed_pencil_fcloud
real ac_transformed_pencil_ccondens
real ac_transformed_pencil_ppwater
real ac_transformed_pencil_ppsat
real ac_transformed_pencil_ppsf[AC_ndustspec__mod__cparam]
real ac_transformed_pencil_mu1
real3 ac_transformed_pencil_glnrhod[AC_ndustspec__mod__cparam]
real ac_transformed_pencil_rhodsum1
real3 ac_transformed_pencil_grhodsum
real ac_transformed_pencil_dustdensity
real ac_transformed_pencil_ss
real3 ac_transformed_pencil_gss
real ac_transformed_pencil_ee
real ac_transformed_pencil_pp
real ac_transformed_pencil_lntt
real ac_transformed_pencil_cs2
real ac_transformed_pencil_cp
real ac_transformed_pencil_cp1
real ac_transformed_pencil_cp1tilde
real3 ac_transformed_pencil_glntt
real ac_transformed_pencil_tt
real ac_transformed_pencil_tt1
real3 ac_transformed_pencil_gtt
real ac_transformed_pencil_yh
Matrix ac_transformed_pencil_hss
Matrix ac_transformed_pencil_hlntt
real ac_transformed_pencil_del2ss
real ac_transformed_pencil_del6ss
real ac_transformed_pencil_del2lntt
real ac_transformed_pencil_cv
real ac_transformed_pencil_cv1
real ac_transformed_pencil_del6lntt
real ac_transformed_pencil_gamma
real ac_transformed_pencil_del2tt
real ac_transformed_pencil_del6tt
real3 ac_transformed_pencil_glnmumol
real ac_transformed_pencil_ppvap
real ac_transformed_pencil_csvap2
real ac_transformed_pencil_ttb
real ac_transformed_pencil_rho_anel
real ac_transformed_pencil_eth
real3 ac_transformed_pencil_geth
real ac_transformed_pencil_del2eth
Matrix ac_transformed_pencil_heth
real ac_transformed_pencil_eths
real3 ac_transformed_pencil_geths
real3 ac_transformed_pencil_rho1gpp
real3 ac_transformed_pencil_glncp
real ac_transformed_pencil_nu
real3 ac_transformed_pencil_gradnu
real ac_transformed_pencil_dydt_reac[AC_nchemspec__mod__cparam]
real ac_transformed_pencil_dydt_diff[AC_nchemspec__mod__cparam]
real ac_transformed_pencil_lambda
real3 ac_transformed_pencil_glambda
real ac_transformed_pencil_diff_penc_add[AC_nchemspec__mod__cparam]
real ac_transformed_pencil_h0_rt[AC_nchemspec__mod__cparam]
real ac_transformed_pencil_hhk_full[AC_nchemspec__mod__cparam]
real3 ac_transformed_pencil_ghhk[AC_nchemspec__mod__cparam]
real ac_transformed_pencil_s0_r[AC_nchemspec__mod__cparam]
real ac_transformed_pencil_ywater
real ac_transformed_pencil_particles_selfgrav
real3 ac_transformed_pencil_aa
real ac_transformed_pencil_a2
Matrix ac_transformed_pencil_aij
real3 ac_transformed_pencil_bb
real3 ac_transformed_pencil_bbb
real ac_transformed_pencil_ab
real ac_transformed_pencil_ua
real3 ac_transformed_pencil_exa
real3 ac_transformed_pencil_exatotal
real ac_transformed_pencil_aps
real ac_transformed_pencil_b2
real ac_transformed_pencil_b21
real ac_transformed_pencil_bf2
Matrix ac_transformed_pencil_bij
real3 ac_transformed_pencil_del2a
real3 ac_transformed_pencil_graddiva
real3 ac_transformed_pencil_jj
real3 ac_transformed_pencil_jj_ohm
real3 ac_transformed_pencil_curlb
real3 ac_transformed_pencil_e3xa
real3 ac_transformed_pencil_el
real ac_transformed_pencil_e2
Matrix ac_transformed_pencil_bijtilde
Matrix ac_transformed_pencil_bij_cov_corr
real ac_transformed_pencil_j2
real ac_transformed_pencil_jb
real ac_transformed_pencil_va2
real3 ac_transformed_pencil_jxb
real3 ac_transformed_pencil_jxbr
real ac_transformed_pencil_jxbr2
real ac_transformed_pencil_ub
real ac_transformed_pencil_uj
real ac_transformed_pencil_ob
real3 ac_transformed_pencil_uxb
real3 ac_transformed_pencil_uxbb
real ac_transformed_pencil_uxb2
real3 ac_transformed_pencil_uxj
real ac_transformed_pencil_chibp
real ac_transformed_pencil_beta
real ac_transformed_pencil_beta1
real3 ac_transformed_pencil_uga
real3 ac_transformed_pencil_uuadvec_gaa
real ac_transformed_pencil_djuidjbi
real ac_transformed_pencil_jo
real ac_transformed_pencil_stokesi
real ac_transformed_pencil_stokesq
real ac_transformed_pencil_stokesu
real ac_transformed_pencil_stokesq1
real ac_transformed_pencil_stokesu1
real ac_transformed_pencil_ujxb
real3 ac_transformed_pencil_oxuxb
real3 ac_transformed_pencil_jxbxb
real3 ac_transformed_pencil_jxbrxb
real3 ac_transformed_pencil_gb22
real3 ac_transformed_pencil_ugb
real ac_transformed_pencil_ugb22
real3 ac_transformed_pencil_bgu
real3 ac_transformed_pencil_bgb
real3 ac_transformed_pencil_bgbp
real ac_transformed_pencil_ubgbp
real3 ac_transformed_pencil_bdivu
real3 ac_transformed_pencil_glnrhoxb
real3 ac_transformed_pencil_del4a
real3 ac_transformed_pencil_del6a
real3 ac_transformed_pencil_oxj
real ac_transformed_pencil_diva
Matrix ac_transformed_pencil_jij
real ac_transformed_pencil_sj
real ac_transformed_pencil_ss12
real ac_transformed_pencil_d6ab
real ac_transformed_pencil_etava
real ac_transformed_pencil_etaj
real ac_transformed_pencil_etaj2
real ac_transformed_pencil_etajrho
real ac_transformed_pencil_cosjb
real ac_transformed_pencil_jparallel
real ac_transformed_pencil_jperp
real ac_transformed_pencil_cosub
real3 ac_transformed_pencil_bunit
real3 ac_transformed_pencil_hjj
real ac_transformed_pencil_hj2
real ac_transformed_pencil_hjb
real ac_transformed_pencil_coshjb
real ac_transformed_pencil_hjparallel
real ac_transformed_pencil_hjperp
real ac_transformed_pencil_nu_ni1
real ac_transformed_pencil_gamma_a2
real ac_transformed_pencil_clight2
real3 ac_transformed_pencil_gva
real3 ac_transformed_pencil_vmagfric
real3 ac_transformed_pencil_bb_sph
real ac_transformed_pencil_advec_va2
real ac_transformed_pencil_lam
real ac_transformed_pencil_lnrho
real ac_transformed_pencil_rho
real ac_transformed_pencil_rho1
real3 ac_transformed_pencil_glnrho
real3 ac_transformed_pencil_grho
real ac_transformed_pencil_uglnrho
real ac_transformed_pencil_ugrho
real ac_transformed_pencil_glnrho2
real ac_transformed_pencil_del2lnrho
real ac_transformed_pencil_del2rho
real ac_transformed_pencil_del6lnrho
real ac_transformed_pencil_del6rho
Matrix ac_transformed_pencil_hlnrho
real3 ac_transformed_pencil_sglnrho
real3 ac_transformed_pencil_uij5glnrho
real ac_transformed_pencil_transprho
real ac_transformed_pencil_ekin
real ac_transformed_pencil_uuadvec_glnrho
real ac_transformed_pencil_uuadvec_grho
real ac_transformed_pencil_rhos1
real3 ac_transformed_pencil_glnrhos
real ac_transformed_pencil_totenergy_rel
real ac_transformed_pencil_divss
real ac_transformed_pencil_rhop
real3 ac_transformed_pencil_grhop
real ac_transformed_pencil_peh
real ac_transformed_pencil_tauascalar
real ac_transformed_pencil_condensationrate
real ac_transformed_pencil_watermixingratio
real ac_transformed_pencil_particles
real ac_transformed_pencil_radiation
real3 ac_transformed_pencil_fvisc
real ac_transformed_pencil_diffus_total
real ac_transformed_pencil_diffus_total2
real ac_transformed_pencil_diffus_total3
real ac_transformed_pencil_visc_heat
real ac_transformed_pencil_nu_smag
real3 ac_transformed_pencil_gnu_smag
real3 ac_transformed_pencil_mf_emf
real ac_transformed_pencil_mf_emfdotb
real3 ac_transformed_pencil_jxb_mf
real3 ac_transformed_pencil_jxbr_mf
real ac_transformed_pencil_chib_mf
real ac_transformed_pencil_mf_qp
real ac_transformed_pencil_mf_beq21
real3 df_iuu_pencil
real tmp_12_13_14_103
real dd_12_13_14_103
real tmp_rho_12_13_14_103
real3 tmp3_12_13_14_103
Matrix tmp33_12_13_14_103
real cs201_12_13_14_103
real outest_12_13_14_103
real bx_4_12_13_14_103
real by_4_12_13_14_103
real bz_4_12_13_14_103
real bx2_4_12_13_14_103
real by2_4_12_13_14_103
real bz2_4_12_13_14_103
real detm1_4_12_13_14_103
real d2_4_12_13_14_103
real d3_4_12_13_14_103
real tmp_19_23_24_103
real tmp_15_19_23_24_103
real tmp_20_22_23_24_103
real tmp_27_28_103
real3 tmp_64_103
real3 tmp2_64_103
real3 gradnu_64_103
real3 sgradnu_64_103
real3 gradnu_shock_64_103
real murho1_64_103
real zetarho1_64_103
real mutt_64_103
real tmp3_64_103
real tmp4_64_103
real pnu_shock_64_103
real lambda_phi_64_103
real prof_64_103
real prof2_64_103
real derprof_64_103
real derprof2_64_103
real gradnu_effective_64_103
real fac_64_103
real advec_hypermesh_uu_64_103
real3 deljskl2_64_103
real3 fvisc_nnewton2_64_103
Matrix d_sld_flux_64_103
real step_vector_return_value_35_37_64_103
real step_vector_return_value_35_37_64_103
real arg_36_37_64_103
real der_step_return_value_36_37_64_103
real step_vector_return_value_38_64_103
real step_vector_return_value_38_64_103
real step_vector_return_value_39_64_103
real step_vector_return_value_39_64_103
real arg_40_64_103
real der_step_return_value_40_64_103
real arg_41_64_103
real der_step_return_value_41_64_103
real step_vector_return_value_43_64_103
real step_vector_return_value_43_64_103
real step_vector_return_value_44_64_103
real step_vector_return_value_44_64_103
real arg_45_64_103
real der_step_return_value_45_64_103
real arg_46_64_103
real der_step_return_value_46_64_103
real step_vector_return_value_48_64_103
real step_vector_return_value_48_64_103
real step_vector_return_value_49_64_103
real step_vector_return_value_49_64_103
real arg_50_64_103
real der_step_return_value_50_64_103
real arg_51_64_103
real der_step_return_value_51_64_103
real step_vector_return_value_52_64_103
real step_vector_return_value_52_64_103
real arg_53_64_103
real der_step_return_value_53_64_103
real step_vector_return_value_55_64_103
real step_vector_return_value_55_64_103
real arg_56_64_103
real der_step_return_value_56_64_103
real step_vector_return_value_58_64_103
real step_vector_return_value_58_64_103
real arg_59_64_103
real der_step_return_value_59_64_103
real tmp_61_64_103
real tmp_62_64_103
real lomega_63_64_103
real dlomega_dr_63_64_103
real dlomega_dtheta_63_64_103
real lver_63_64_103
real lhor_63_64_103
real dlver_dr_63_64_103
real dlhor_dtheta_63_64_103
real3 tmp_80_81_103
real rho1_jxb_80_81_103
real quench_80_81_103
real stokesi_ncr_80_81_103
real tmp1_80_81_103
real bbgb_80_81_103
real va2max_beta_80_81_103
real3 b_ext_80_81_103
real3 j_ext_80_81_103
real c_80_81_103
real s_80_81_103
real c_72_80_81_103
real s_72_80_81_103
real zprof_72_80_81_103
real zder_72_80_81_103
real zpostop_72_80_81_103
real zposbot_72_80_81_103
real step_scalar_return_value_68_72_80_81_103
real step_scalar_return_value_69_72_80_81_103
real arg_70_72_80_81_103
real der_step_return_value_70_72_80_81_103
real arg_71_72_80_81_103
real der_step_return_value_71_72_80_81_103
real c_73_80_81_103
real s_73_80_81_103
real zprof_73_80_81_103
real zder_73_80_81_103
real zpostop_73_80_81_103
real zposbot_73_80_81_103
real step_scalar_return_value_68_73_80_81_103
real step_scalar_return_value_69_73_80_81_103
real arg_70_73_80_81_103
real der_step_return_value_70_73_80_81_103
real arg_71_73_80_81_103
real der_step_return_value_71_73_80_81_103
real get_b0_ext_z_return_value_74_80_81_103
real chi_diamag_77_80_81_103
real3 gchi_diamag_77_80_81_103
real3 bk_bki_77_80_81_103
real3 jj_diamag_77_80_81_103
real3 tmp_77_80_81_103
real uu1_133
real tmp_133
real ftot_133
real ugu_schur_x_133
real ugu_schur_y_133
real ugu_schur_z_133
Matrix puij_schur_133
real c2_108_133
real s2_108_133
real c2_109_133
real s2_109_133
real om2_109_133
real cp2_109_133
real cs2_109_133
real ss2_109_133
real c2_111_133
real s2_111_133
real c2_112_133
real s2_112_133
real c1_113_133
real c2_113_133
real reshock_117_118_133
real fvisc2_117_118_133
real uus_117_118_133
real tmp_117_118_133
real qfvisc_117_118_133
real3 nud2uxb_117_118_133
real3 fluxv_117_118_133
real pdamp_126_133
real fint_work_126_133
real fext_work_126_133
real step_vector_return_value_120_126_133
real step_vector_return_value_120_126_133
real step_vector_return_value_121_126_133
real step_vector_return_value_121_126_133
real step_vector_return_value_122_126_133
real step_vector_return_value_122_126_133
real step_vector_return_value_123_126_133
real step_vector_return_value_123_126_133
real step_vector_return_value_124_126_133
real step_vector_return_value_124_126_133
real step_vector_return_value_125_126_133
real step_vector_return_value_125_126_133
real3 f_target_132_133
real fdiff_146
real tmp_146
real3 tmpv_146
real density_rhs_146
real advec_hypermesh_rho_146
real tmp_138_146
real dlnrhodt_138_146
real pdamp_138_146
real fprofile_138_146
real radius2_138_146
real step_vector_return_value_136_138_146
real step_vector_return_value_136_138_146
real step_vector_return_value_137_138_146
real step_vector_return_value_137_138_146
real f_target_145_146
real ztop_254
real xi_254
real profile_cor_254
real tmp1_254
real cubic_step_pt_return_value_148_149_254
real xi_148_149_254
real relshift_148_149_254
real cubic_step_pt_return_value_148_149_254
real3 glnthcond_159_254
real3 glhc_159_254
real chix_159_254
real thdiff_159_254
real g2_159_254
real del2ss1_159_254
real glnrhoglnt_159_254
real3 gradchit_prof_159_254
Matrix tmp_159_254
real s2_159_254
real c2_159_254
real sc_159_254
real r_mn_157_159_254
real r_mn1_157_159_254
real arg_152_157_159_254
real der_step_return_value_152_157_159_254
real arg_153_157_159_254
real der_step_return_value_153_157_159_254
real step_vector_return_value_154_157_159_254
real step_vector_return_value_154_157_159_254
real step_vector_return_value_155_157_159_254
real step_vector_return_value_155_157_159_254
real r_mn_158_159_254
real r_mn1_158_159_254
real arg_152_158_159_254
real der_step_return_value_152_158_159_254
real arg_153_158_159_254
real der_step_return_value_153_158_159_254
real step_vector_return_value_154_158_159_254
real step_vector_return_value_154_158_159_254
real step_vector_return_value_155_158_159_254
real step_vector_return_value_155_158_159_254
real chix_160_254
real thdiff_160_254
real g2_160_254
real thdiff_161_254
real g2_161_254
real del2ss1_161_254
real thdiff_163_254
real g2_163_254
real3 gradchit_prof_163_254
real r_mn_162_163_254
real r_mn1_162_163_254
real arg_152_162_163_254
real der_step_return_value_152_162_163_254
real arg_153_162_163_254
real der_step_return_value_153_162_163_254
real step_vector_return_value_154_162_163_254
real step_vector_return_value_154_162_163_254
real step_vector_return_value_155_162_163_254
real step_vector_return_value_155_162_163_254
real thdiff_164_254
real g2_164_254
real thchi_164_254
real thdiff_165_254
real g2_165_254
real rhochi_165_254
real thdiff_166_254
real g2_166_254
real gshockglntt_166_254
real gshockgss_166_254
real thdiff_169_254
real g2_169_254
real gshockglntt_169_254
real gchiglntt_169_254
real pchi_shock_169_254
real3 gradchi_shock_169_254
real step_vector_return_value_167_169_254
real step_vector_return_value_167_169_254
real arg_168_169_254
real der_step_return_value_168_169_254
real thdiff_170_254
real3 gvkpara_172_254
real3 gvkperp_172_254
real3 tmpv_172_254
real3 tmpv2_172_254
real bb2_172_254
real thdiff_172_254
real b1_172_254
real tmps_172_254
real vkpara_172_254
real vkperp_172_254
real3 bunit_171_172_254
real3 hhh_171_172_254
real3 gvkperp1_171_172_254
real3 gvkpara1_171_172_254
real3 tmpv_171_172_254
real abs_b_171_172_254
real b1_171_172_254
real del2ecr_171_172_254
real gecr2_171_172_254
real hhh2_171_172_254
real quenchfactor_171_172_254
real tmp_171_172_254
real tmpi_171_172_254
real tmpj_171_172_254
real tmpk_171_172_254
const limiter_tensordiff_171_172_254 = 3.
real tau_173_254
real cooling_173_254
real kappa_173_254
real a1_173_254
real a3_173_254
real a2_173_254
real kappa0_173_254
real kappa0_cgs_173_254
real thdiff_175_254
real chix_175_254
real g2_175_254
real krho1_175_254
real del2ss1_175_254
real3 gradchit_prof_175_254
real r_mn_174_175_254
real r_mn1_174_175_254
real arg_152_174_175_254
real der_step_return_value_152_174_175_254
real arg_153_174_175_254
real der_step_return_value_153_174_175_254
real step_vector_return_value_154_174_175_254
real step_vector_return_value_154_174_175_254
real step_vector_return_value_155_174_175_254
real step_vector_return_value_155_174_175_254
real thdiff_179_254
real thdiff1_179_254
real g2_179_254
real del2ss0_179_254
real del2ss1_179_254
real3 gradchit_prof_179_254
real3 gradchit_prof_fluct_179_254
real r_mn_176_179_254
real r_mn1_176_179_254
real arg_152_176_179_254
real der_step_return_value_152_176_179_254
real arg_153_176_179_254
real der_step_return_value_153_176_179_254
real step_vector_return_value_154_176_179_254
real step_vector_return_value_154_176_179_254
real step_vector_return_value_155_176_179_254
real step_vector_return_value_155_176_179_254
real r_mn_177_179_254
real r_mn1_177_179_254
real arg_152_177_179_254
real der_step_return_value_152_177_179_254
real arg_153_177_179_254
real der_step_return_value_153_177_179_254
real step_vector_return_value_154_177_179_254
real step_vector_return_value_154_177_179_254
real step_vector_return_value_155_177_179_254
real step_vector_return_value_155_177_179_254
real r_mn_178_179_254
real r_mn1_178_179_254
real arg_152_178_179_254
real der_step_return_value_152_178_179_254
real arg_153_178_179_254
real der_step_return_value_153_178_179_254
real step_vector_return_value_154_178_179_254
real step_vector_return_value_154_178_179_254
real step_vector_return_value_155_178_179_254
real step_vector_return_value_155_178_179_254
real thdiff_180_254
real chix_180_254
real g2_180_254
real del2ss1_180_254
real3 gradnu_180_254
real3 gvkpara_181_254
real3 gvkperp_181_254
real3 tmpv_181_254
real3 tmpv2_181_254
real bb2_181_254
real thdiff_181_254
real b1_181_254
real tmps_181_254
real vkpara_181_254
real vkperp_181_254
real3 bunit_171_181_254
real3 hhh_171_181_254
real3 gvkperp1_171_181_254
real3 gvkpara1_171_181_254
real3 tmpv_171_181_254
real abs_b_171_181_254
real b1_171_181_254
real del2ecr_171_181_254
real gecr2_171_181_254
real hhh2_171_181_254
real quenchfactor_171_181_254
real tmp_171_181_254
real tmpi_171_181_254
real tmpj_171_181_254
real tmpk_171_181_254
const limiter_tensordiff_171_181_254 = 3.
real newton_182_254
real lnttor_182_254
real lnq_183_254
real rtv_cool_183_254
real lntt_si_183_254
real lnneni_183_254
real delta_lntt_183_254
real tmp_183_254
real unit_lnq_183_254
const intlnt_1_183_254 = [4.605, 8.959, 9.906, 10.534, 11.283, 12.434, 13.286, 14.541, 17.51, 20.723 ]
const lnh_1_183_254 = [ -542.398,  -228.833, -80.245, -101.314, -78.748, -53.88, -80.452, -70.758, -91.182]
const b_1_183_254 = [     50.,      15.,      0.,      2.0,      0.,    -2.,      0., -AC_twothird__mod__cparam,    0.5 ]
const intlnt_2_183_254 = [ 5.704,7.601 , 8.987 , 11.513 , 17.504 , 20.723, 24.0 ]
const lnh_2_183_254 = [-102.811, -99.01, -111.296, -70.804, -90.934, -80.572 ]
const b_2_183_254 = [    2.0,     1.5,   2.867,  -0.65,   0.5, 0.0 ]
real cosbgt_185_254
real gt2_185_254
real b2_185_254
real rhs_185_254
real vkpara_185_254
real vkperp_185_254
real3 bunit_184_185_254
real3 hhh_184_185_254
real3 gvkperp1_184_185_254
real3 gvkpara1_184_185_254
real3 tmpv_184_185_254
real abs_b_184_185_254
real b1_184_185_254
real del2ecr_184_185_254
real gecr2_184_185_254
real hhh2_184_185_254
real quenchfactor_184_185_254
real tmp_184_185_254
real tmpi_184_185_254
real tmpj_184_185_254
real tmpk_184_185_254
const limiter_tensordiff_184_185_254 = 3.
real thdiff_186_254
real tmp_186_254
real thdiff_187_254
real tmp_187_254
real advec_hypermesh_ss_187_254
real thdiff_188_254
real tmp_236_254
real heat_236_254
real tt_drive_236_254
real prof_236_254
real profile_buffer_236_254
real xi_236_254
real rgas_236_254
real prof_199_236_254
real prof2_199_236_254
real ztop_199_236_254
real zbot_199_236_254
real dumerfc_189_199_236_254
real t_189_199_236_254
real z_189_199_236_254
real erfunc_return_value_189_199_236_254
real dumerfc_190_199_236_254
real t_190_199_236_254
real z_190_199_236_254
real erfunc_return_value_190_199_236_254
real dumerfc_191_199_236_254
real t_191_199_236_254
real z_191_199_236_254
real erfunc_return_value_191_199_236_254
real dumerfc_192_199_236_254
real t_192_199_236_254
real z_192_199_236_254
real erfunc_return_value_192_199_236_254
real dumerfc_193_199_236_254
real t_193_199_236_254
real z_193_199_236_254
real erfunc_return_value_193_199_236_254
real dumerfc_194_199_236_254
real t_194_199_236_254
real z_194_199_236_254
real erfunc_return_value_194_199_236_254
real cubic_step_pt_return_value_195_199_236_254
real xi_195_199_236_254
real relshift_195_199_236_254
real cubic_step_pt_return_value_195_199_236_254
real cubic_step_pt_return_value_196_199_236_254
real xi_196_199_236_254
real relshift_196_199_236_254
real cubic_step_pt_return_value_196_199_236_254
real cubic_step_pt_return_value_197_199_236_254
real xi_197_199_236_254
real relshift_197_199_236_254
real cubic_step_pt_return_value_197_199_236_254
real dumerfc_198_199_236_254
real t_198_199_236_254
real z_198_199_236_254
real erfunc_return_value_198_199_236_254
real prof_203_236_254
real zbot_203_236_254
real ztop_203_236_254
real step_scalar_return_value_200_203_236_254
real step_scalar_return_value_201_203_236_254
real cubic_step_pt_return_value_202_203_236_254
real xi_202_203_236_254
real relshift_202_203_236_254
real cubic_step_pt_return_value_202_203_236_254
real prof_210_236_254
real theta_profile_210_236_254
real div_heat_210_236_254
real div_cool_210_236_254
real step_vector_return_value_204_210_236_254
real step_vector_return_value_204_210_236_254
real step_vector_return_value_205_210_236_254
real step_vector_return_value_205_210_236_254
real step_vector_return_value_206_210_236_254
real step_vector_return_value_206_210_236_254
real step_vector_return_value_207_210_236_254
real step_vector_return_value_207_210_236_254
real step_vector_return_value_208_210_236_254
real step_vector_return_value_208_210_236_254
real step_vector_return_value_209_210_236_254
real step_vector_return_value_209_210_236_254
real prof_227_236_254
real prof2_227_236_254
real cs2_tmp_227_236_254
real fac_tmp_227_236_254
real prof1_227_236_254
real step_vector_return_value_211_227_236_254
real step_vector_return_value_211_227_236_254
real step_vector_return_value_212_227_236_254
real step_vector_return_value_212_227_236_254
real step_vector_return_value_213_227_236_254
real step_vector_return_value_213_227_236_254
real step_vector_return_value_214_227_236_254
real step_vector_return_value_214_227_236_254
real step_vector_return_value_215_227_236_254
real step_vector_return_value_215_227_236_254
real step_vector_return_value_216_227_236_254
real step_vector_return_value_216_227_236_254
real step_vector_return_value_217_227_236_254
real step_vector_return_value_217_227_236_254
real step_vector_return_value_218_227_236_254
real step_vector_return_value_218_227_236_254
real step_vector_return_value_219_227_236_254
real step_vector_return_value_219_227_236_254
real step_vector_return_value_220_227_236_254
real step_vector_return_value_220_227_236_254
real step_vector_return_value_221_227_236_254
real step_vector_return_value_221_227_236_254
real step_vector_return_value_222_227_236_254
real step_vector_return_value_222_227_236_254
real step_vector_return_value_223_227_236_254
real step_vector_return_value_223_227_236_254
real step_vector_return_value_224_227_236_254
real step_vector_return_value_224_227_236_254
real step_vector_return_value_225_227_236_254
real step_vector_return_value_225_227_236_254
real step_vector_return_value_226_227_236_254
real step_vector_return_value_226_227_236_254
real prof_229_236_254
real step_vector_return_value_228_229_236_254
real step_vector_return_value_228_229_236_254
real rr1_234_236_254
real tt_drive_234_236_254
real oo_234_236_254
real pborder_234_236_254
real quintic_step_mn_return_value_232_234_236_254
real xi_232_234_236_254
real relshift_232_234_236_254
real quintic_step_mn_return_value_232_234_236_254
real quintic_step_mn_return_value_233_234_236_254
real xi_233_234_236_254
real relshift_233_234_236_254
real quintic_step_mn_return_value_233_234_236_254
real ztop_235_236_254
real xi_235_236_254
real profile_cor_235_236_254
real newton_237_254
real lnttor_237_254
real lnq_238_254
real rtv_cool_238_254
real lntt_si_238_254
real lnneni_238_254
real delta_lntt_238_254
real tmp_238_254
real unit_lnq_238_254
const intlnt_1_238_254 = [4.605, 8.959, 9.906, 10.534, 11.283, 12.434, 13.286, 14.541, 17.51, 20.723 ]
const lnh_1_238_254 = [ -542.398,  -228.833, -80.245, -101.314, -78.748, -53.88, -80.452, -70.758, -91.182]
const b_1_238_254 = [     50.,      15.,      0.,      2.0,      0.,    -2.,      0., -AC_twothird__mod__cparam,    0.5 ]
const intlnt_2_238_254 = [ 5.704,7.601 , 8.987 , 11.513 , 17.504 , 20.723, 24.0 ]
const lnh_2_238_254 = [-102.811, -99.01, -111.296, -70.804, -90.934, -80.572 ]
const b_2_238_254 = [    2.0,     1.5,   2.867,  -0.65,   0.5, 0.0 ]
real pp_242_254
real lnrho__239_242_254
real ss__239_242_254
real lntt__239_242_254
real ee__239_242_254
real pp__239_242_254
real cs2__239_242_254
real tt__239_242_254
real rho_239_242_254
real eth_239_242_254
real lnrho__240_242_254
real ss__240_242_254
real lntt__240_242_254
real ee__240_242_254
real pp__240_242_254
real cs2__240_242_254
real tt__240_242_254
real rho_240_242_254
real eth_240_242_254
real lnrho__241_242_254
real ss__241_242_254
real lntt__241_242_254
real ee__241_242_254
real pp__241_242_254
real cs2__241_242_254
real tt__241_242_254
real rho_241_242_254
real eth_241_242_254
real scl_244_254
real f_target_253_254
real lnrho_init_253_254
real ss_init_253_254
real rho_init_253_254
real3 ujiaj_304
real3 gua_304
real3 ajiuj_304
real3 aa_xyaver_304
real3 geta_304
real3 uxb_upw_304
real3 tmp2_304
real3 dadt_304
real3 gradeta_shock_304
real3 aa1_304
real3 uu1_304
Matrix d_sld_flux_304
real ftot_304
real datot_304
real peta_shock_304
real sign_jo_304
real tmp1_304
real eta_mn_304
real etass_304
real eta_heat_304
real vdrift_304
real va2max_beta_304
real del2aa_ini_304
real tanhx2_304
real advec_hall_304
real advec_hypermesh_aa_304
real eta_bb_304
real prof_304
real3 b_ext_304
real tmp_304
real eta_out1_304
real cosalp_304
real sinalp_304
real hall_term__304
real tmp_nx_304
const omegass_304 = 1.0
const nxy_304 = AC_nxgrid__mod__cparam*AC_nygrid__mod__cparam
real c_265_304
real s_265_304
real zprof_265_304
real zder_265_304
real zpostop_265_304
real zposbot_265_304
real step_scalar_return_value_68_265_304
real step_scalar_return_value_69_265_304
real arg_70_265_304
real der_step_return_value_70_265_304
real arg_71_265_304
real der_step_return_value_71_265_304
real step_vector_return_value_266_304
real step_vector_return_value_266_304
real tmp1_277_304
real tmp2_277_304
real prof0_277_304
real prof1_277_304
real derprof0_277_304
real derprof1_277_304
real step_vector_return_value_267_277_304
real step_vector_return_value_267_277_304
real arg_268_277_304
real der_step_return_value_268_277_304
real step_vector_return_value_269_277_304
real step_vector_return_value_269_277_304
real step_vector_return_value_270_277_304
real step_vector_return_value_270_277_304
real arg_271_277_304
real der_step_return_value_271_277_304
real arg_272_277_304
real der_step_return_value_272_277_304
real step_vector_return_value_273_277_304
real step_vector_return_value_273_277_304
real step_vector_return_value_274_277_304
real step_vector_return_value_274_277_304
real arg_275_277_304
real der_step_return_value_275_277_304
real arg_276_277_304
real der_step_return_value_276_277_304
real tmp_278_304
real prof_287_304
real eta_r_287_304
real d_int_287_304
real d_ext_287_304
real step_vector_return_value_279_287_304
real step_vector_return_value_279_287_304
real step_vector_return_value_280_287_304
real step_vector_return_value_280_287_304
real arg_281_287_304
real der_step_return_value_281_287_304
real arg_282_287_304
real der_step_return_value_282_287_304
real step_vector_return_value_283_287_304
real step_vector_return_value_283_287_304
real step_vector_return_value_284_287_304
real step_vector_return_value_284_287_304
real arg_285_287_304
real der_step_return_value_285_287_304
real arg_286_287_304
real der_step_return_value_286_287_304
real step_vector_return_value_288_304
real step_vector_return_value_288_304
real arg_289_304
real der_step_return_value_289_304
real step_vector_return_value_290_304
real step_vector_return_value_290_304
real arg_291_304
real der_step_return_value_291_304
real cubic_step_pt_return_value_294_304
real xi_294_304
real relshift_294_304
real cubic_step_pt_return_value_294_304
real del6f_upwind_295_304
real dumerfc_296_304
real t_296_304
real z_296_304
real erfunc_return_value_296_304
real scl_298_304
real3 f_target_302_304
if (AC_lanelastic__mod__cparam) {
df_iuu_pencil = DF_UVEC
DF_UVEC=0.0
}
if (AC_lspherical_coords__mod__cdata) {
dline_1__mod__cdata.x = AC_dx_1__mod__cdata[vertexIdx.x]
dline_1__mod__cdata.y = AC_r1_mn__mod__cdata[vertexIdx.x-NGHOST_VAL] * AC_dy_1__mod__cdata[AC_m__mod__cdata-1]
dline_1__mod__cdata.z = AC_r1_mn__mod__cdata[vertexIdx.x-NGHOST_VAL] * AC_sin1th__mod__cdata[AC_m__mod__cdata-1] * AC_dz_1__mod__cdata[AC_n__mod__cdata-1]
}
else if (AC_lcylindrical_coords__mod__cdata) {
dline_1__mod__cdata.x = AC_dx_1__mod__cdata[vertexIdx.x]
dline_1__mod__cdata.y = AC_rcyl_mn1__mod__cdata[vertexIdx.x-NGHOST_VAL] * AC_dy_1__mod__cdata[AC_m__mod__cdata-1]
dline_1__mod__cdata.z = AC_dz_1__mod__cdata[AC_n__mod__cdata-1]
}
else if (AC_lcartesian_coords__mod__cdata) {
dline_1__mod__cdata.x = AC_dx_1__mod__cdata[vertexIdx.x]
dline_1__mod__cdata.y = AC_dy_1__mod__cdata[AC_m__mod__cdata-1]
dline_1__mod__cdata.z = AC_dz_1__mod__cdata[AC_n__mod__cdata-1]
}
else if (AC_lpipe_coords__mod__cdata) {
dline_1__mod__cdata.x = AC_dx_1__mod__cdata[vertexIdx.x]
dline_1__mod__cdata.y = AC_dy_1__mod__cdata[AC_m__mod__cdata-1]
dline_1__mod__cdata.z = AC_dz_1__mod__cdata[AC_n__mod__cdata-1]
}
dxmax_pencil__mod__cdata = 0.
if (AC_nxgrid__mod__cparam != 1) {
dxmax_pencil__mod__cdata =     1.0 / dline_1__mod__cdata.x
}
if (AC_nygrid__mod__cparam != 1) {
dxmax_pencil__mod__cdata = max(1.0 / dline_1__mod__cdata.y, dxmax_pencil__mod__cdata)
}
if (AC_nzgrid__mod__cparam != 1) {
dxmax_pencil__mod__cdata = max(1.0 / dline_1__mod__cdata.z, dxmax_pencil__mod__cdata)
}
dxmin_pencil__mod__cdata = 0.
if (AC_nxgrid__mod__cparam != 1) {
dxmin_pencil__mod__cdata =     1.0 / dline_1__mod__cdata.x
}
if (AC_nygrid__mod__cparam != 1) {
dxmin_pencil__mod__cdata = min(1.0 / dline_1__mod__cdata.y, dxmin_pencil__mod__cdata)
}
if (AC_nzgrid__mod__cparam != 1) {
dxmin_pencil__mod__cdata = min(1.0 / dline_1__mod__cdata.z, dxmin_pencil__mod__cdata)
}
if (AC_lmaximal_cdtv__mod__cdata) {
dxyz_2__mod__cdata = max(dline_1__mod__cdata.x*dline_1__mod__cdata.x, dline_1__mod__cdata.y*dline_1__mod__cdata.y, dline_1__mod__cdata.z*dline_1__mod__cdata.z)
dxyz_4__mod__cdata = max(dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x, dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y, dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z)
dxyz_6__mod__cdata = max(dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x, dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y, dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z)
}
else {
dxyz_2__mod__cdata = dline_1__mod__cdata.x*dline_1__mod__cdata.x + dline_1__mod__cdata.y*dline_1__mod__cdata.y + dline_1__mod__cdata.z*dline_1__mod__cdata.z
dxyz_4__mod__cdata = dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x + dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y + dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z
dxyz_6__mod__cdata = dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x + dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y + dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z
}
dvol__mod__cdata = AC_dvol_x__mod__cdata[vertexIdx.x]*AC_dvol_y__mod__cdata[AC_m__mod__cdata-1]*AC_dvol_z__mod__cdata[AC_n__mod__cdata-1]
if (AC_lcartesian_coords__mod__cdata) {
if (AC_lpencil__mod__cparam[AC_i_x_mn__mod__cparam-1]) {
ac_transformed_pencil_x_mn    = AC_x__mod__cdata[vertexIdx.x]
}
if (AC_lpencil__mod__cparam[AC_i_y_mn__mod__cparam-1]) {
ac_transformed_pencil_y_mn    = AC_y__mod__cdata[AC_m__mod__cdata-1]
}
if (AC_lpencil__mod__cparam[AC_i_z_mn__mod__cparam-1]) {
ac_transformed_pencil_z_mn    = AC_z__mod__cdata[AC_n__mod__cdata-1]
}
if (AC_lpencil__mod__cparam[AC_i_r_mn__mod__cparam-1]) {
ac_transformed_pencil_r_mn    = sqrt(AC_x__mod__cdata[vertexIdx.x]*AC_x__mod__cdata[vertexIdx.x]+AC_y__mod__cdata[AC_m__mod__cdata-1]*AC_y__mod__cdata[AC_m__mod__cdata-1]+AC_z__mod__cdata[AC_n__mod__cdata-1]*AC_z__mod__cdata[AC_n__mod__cdata-1])
}
if (AC_lpencil__mod__cparam[AC_i_rcyl_mn__mod__cparam-1]) {
ac_transformed_pencil_rcyl_mn = sqrt(AC_x__mod__cdata[vertexIdx.x]*AC_x__mod__cdata[vertexIdx.x]+AC_y__mod__cdata[AC_m__mod__cdata-1]*AC_y__mod__cdata[AC_m__mod__cdata-1])
}
if (AC_lpencil__mod__cparam[AC_i_phi_mn__mod__cparam-1]) {
ac_transformed_pencil_phi_mn  = atan2(AC_y__mod__cdata[AC_m__mod__cdata-1],AC_x__mod__cdata[vertexIdx.x])
}
if (AC_lpencil__mod__cparam[AC_i_rcyl_mn1__mod__cparam-1]) {
ac_transformed_pencil_rcyl_mn1=1./max(ac_transformed_pencil_rcyl_mn,AC_tini__mod__cparam)
}
if (AC_lpencil__mod__cparam[AC_i_r_mn1__mod__cparam-1]) {
ac_transformed_pencil_r_mn1   =1./max(ac_transformed_pencil_r_mn,AC_tini__mod__cparam)
}
if (AC_lpencil__mod__cparam[AC_i_pomx__mod__cparam-1]) {
ac_transformed_pencil_pomx    = AC_x__mod__cdata[vertexIdx.x]*ac_transformed_pencil_rcyl_mn1
}
if (AC_lpencil__mod__cparam[AC_i_pomy__mod__cparam-1]) {
ac_transformed_pencil_pomy    = AC_y__mod__cdata[AC_m__mod__cdata-1]*ac_transformed_pencil_rcyl_mn1
}
if (AC_lpencil__mod__cparam[AC_i_phix__mod__cparam-1]) {
ac_transformed_pencil_phix    =-AC_y__mod__cdata[AC_m__mod__cdata-1]*ac_transformed_pencil_rcyl_mn1
}
if (AC_lpencil__mod__cparam[AC_i_phiy__mod__cparam-1]) {
ac_transformed_pencil_phiy    = AC_x__mod__cdata[vertexIdx.x]*ac_transformed_pencil_rcyl_mn1
}
}
else if (AC_lcylindrical_coords__mod__cdata) {
if (AC_lpencil__mod__cparam[AC_i_x_mn__mod__cparam-1]) {
ac_transformed_pencil_x_mn    = AC_x__mod__cdata[vertexIdx.x]*cos(AC_y__mod__cdata[AC_m__mod__cdata-1])
}
if (AC_lpencil__mod__cparam[AC_i_y_mn__mod__cparam-1]) {
ac_transformed_pencil_y_mn    = AC_x__mod__cdata[vertexIdx.x]*sin(AC_y__mod__cdata[AC_m__mod__cdata-1])
}
if (AC_lpencil__mod__cparam[AC_i_z_mn__mod__cparam-1]) {
ac_transformed_pencil_z_mn    = AC_z__mod__cdata[AC_n__mod__cdata-1]
}
if (AC_lpencil__mod__cparam[AC_i_r_mn__mod__cparam-1]) {
ac_transformed_pencil_r_mn    = sqrt(AC_x__mod__cdata[vertexIdx.x]*AC_x__mod__cdata[vertexIdx.x]+AC_z__mod__cdata[AC_n__mod__cdata-1]*AC_z__mod__cdata[AC_n__mod__cdata-1])
}
if (AC_lpencil__mod__cparam[AC_i_rcyl_mn__mod__cparam-1]) {
ac_transformed_pencil_rcyl_mn = AC_x__mod__cdata[vertexIdx.x]
}
if (AC_lpencil__mod__cparam[AC_i_phi_mn__mod__cparam-1]) {
ac_transformed_pencil_phi_mn  = AC_y__mod__cdata[AC_m__mod__cdata-1]
}
if (AC_lpencil__mod__cparam[AC_i_rcyl_mn1__mod__cparam-1]) {
ac_transformed_pencil_rcyl_mn1=1./max(ac_transformed_pencil_rcyl_mn,AC_tini__mod__cparam)
}
if (AC_lpencil__mod__cparam[AC_i_r_mn1__mod__cparam-1]) {
ac_transformed_pencil_r_mn1   =1./max(ac_transformed_pencil_r_mn,AC_tini__mod__cparam)
}
if (AC_lpencil__mod__cparam[AC_i_pomx__mod__cparam-1]) {
ac_transformed_pencil_pomx    = 1.
}
if (AC_lpencil__mod__cparam[AC_i_pomy__mod__cparam-1]) {
ac_transformed_pencil_pomy    = 0.
}
if (AC_lpencil__mod__cparam[AC_i_phix__mod__cparam-1]) {
ac_transformed_pencil_phix    = 0.
}
if (AC_lpencil__mod__cparam[AC_i_phiy__mod__cparam-1]) {
ac_transformed_pencil_phiy    = 1.
}
}
else if (AC_lspherical_coords__mod__cdata) {
if (AC_lpencil__mod__cparam[AC_i_x_mn__mod__cparam-1]) {
ac_transformed_pencil_x_mn    = AC_x__mod__cdata[vertexIdx.x]*sin(AC_y__mod__cdata[AC_m__mod__cdata-1])*cos(AC_z__mod__cdata[AC_n__mod__cdata-1])
}
if (AC_lpencil__mod__cparam[AC_i_y_mn__mod__cparam-1]) {
ac_transformed_pencil_y_mn    = AC_x__mod__cdata[vertexIdx.x]*sin(AC_y__mod__cdata[AC_m__mod__cdata-1])*sin(AC_z__mod__cdata[AC_n__mod__cdata-1])
}
if (AC_lpencil__mod__cparam[AC_i_z_mn__mod__cparam-1]) {
ac_transformed_pencil_z_mn    = AC_x__mod__cdata[vertexIdx.x]*cos(AC_y__mod__cdata[AC_m__mod__cdata-1])
}
if (AC_lpencil__mod__cparam[AC_i_r_mn__mod__cparam-1]) {
ac_transformed_pencil_r_mn    = AC_x__mod__cdata[vertexIdx.x]
}
if (AC_lpencil__mod__cparam[AC_i_rcyl_mn__mod__cparam-1]) {
ac_transformed_pencil_rcyl_mn = AC_x__mod__cdata[vertexIdx.x]*sin(AC_y__mod__cdata[AC_m__mod__cdata-1])
}
if (AC_lpencil__mod__cparam[AC_i_phi_mn__mod__cparam-1]) {
ac_transformed_pencil_phi_mn  = AC_z__mod__cdata[AC_n__mod__cdata-1]
}
if (AC_lpencil__mod__cparam[AC_i_rcyl_mn1__mod__cparam-1]) {
ac_transformed_pencil_rcyl_mn1=1./max(ac_transformed_pencil_rcyl_mn,AC_tini__mod__cparam)
}
if (AC_lpencil__mod__cparam[AC_i_r_mn1__mod__cparam-1]) {
ac_transformed_pencil_r_mn1   =1./max(ac_transformed_pencil_r_mn,AC_tini__mod__cparam)
}
}
if (AC_lpencil__mod__cparam[AC_i_rr__mod__cparam-1]) {
if (AC_lcartesian_coords__mod__cdata) {
ac_transformed_pencil_rr.x=ac_transformed_pencil_x_mn
ac_transformed_pencil_rr.y=ac_transformed_pencil_y_mn
ac_transformed_pencil_rr.z=ac_transformed_pencil_z_mn
}
else {
}
}
if (AC_lpencil__mod__cparam[AC_i_evr__mod__cparam-1]) {
if (AC_lcartesian_coords__mod__cdata) {
ac_transformed_pencil_evr.x = ac_transformed_pencil_rcyl_mn*ac_transformed_pencil_r_mn1*ac_transformed_pencil_pomx
ac_transformed_pencil_evr.y = ac_transformed_pencil_rcyl_mn*ac_transformed_pencil_r_mn1*ac_transformed_pencil_pomy
ac_transformed_pencil_evr.z = AC_z__mod__cdata[AC_n__mod__cdata-1]*ac_transformed_pencil_r_mn1
}
else {
}
}
if (AC_lpencil__mod__cparam[AC_i_evth__mod__cparam-1]) {
if (AC_lcartesian_coords__mod__cdata) {
ac_transformed_pencil_evth.x = AC_z__mod__cdata[AC_n__mod__cdata-1]*ac_transformed_pencil_r_mn1*ac_transformed_pencil_pomx
ac_transformed_pencil_evth.y = AC_z__mod__cdata[AC_n__mod__cdata-1]*ac_transformed_pencil_r_mn1*ac_transformed_pencil_pomy
ac_transformed_pencil_evth.z = -ac_transformed_pencil_rcyl_mn*ac_transformed_pencil_r_mn1
}
else {
}
}
if (AC_llinearized_hydro__mod__hydro) {
}
else {
if (AC_lpencil__mod__cparam[AC_i_uu__mod__cparam-1]) {
if (AC_lconservative__mod__hydro) {
tmp3_12_13_14_103=value(F_UVEC)
if (AC_lrelativistic__mod__hydro) {
cs201_12_13_14_103=AC_cs20__mod__equationofstate+1.
tmp_rho_12_13_14_103=value(F_RHO)
if (!AC_lhiggsless_old__mod__hydro && AC_lhiggsless__mod__hydro) {
if(AC_t__mod__cdata < value(F_HLESS)) {
tmp_rho_12_13_14_103=tmp_rho_12_13_14_103-AC_eps_hless__mod__hydro
}
}
if (AC_lmagnetic__mod__cparam) {
if (AC_full_3d__mod__hydro) {
dd_12_13_14_103=(value(F_RHO)-0.5*AC_b_ext2__mod__magnetic)/(1.-0.25/value(F_LORENTZ))+AC_b_ext2__mod__magnetic
bx_4_12_13_14_103=ac_transformed_pencil_bb.x
by_4_12_13_14_103=ac_transformed_pencil_bb.y
bz_4_12_13_14_103=ac_transformed_pencil_bb.z
bx2_4_12_13_14_103=bx_4_12_13_14_103*bx_4_12_13_14_103
by2_4_12_13_14_103=by_4_12_13_14_103*by_4_12_13_14_103
bz2_4_12_13_14_103=bz_4_12_13_14_103*bz_4_12_13_14_103
d2_4_12_13_14_103 = dd_12_13_14_103*dd_12_13_14_103
d3_4_12_13_14_103 = d2_4_12_13_14_103*dd_12_13_14_103
detm1_4_12_13_14_103=1./(d3_4_12_13_14_103-d2_4_12_13_14_103*(bx2_4_12_13_14_103+by2_4_12_13_14_103+bz2_4_12_13_14_103)+4.*bx2_4_12_13_14_103*by2_4_12_13_14_103*bz2_4_12_13_14_103)
tmp33_12_13_14_103[1-1][1-1]=detm1_4_12_13_14_103*dd_12_13_14_103*(dd_12_13_14_103-by2_4_12_13_14_103-bz2_4_12_13_14_103)
tmp33_12_13_14_103[2-1][2-1]=detm1_4_12_13_14_103*dd_12_13_14_103*(dd_12_13_14_103-bz2_4_12_13_14_103-bx2_4_12_13_14_103)
tmp33_12_13_14_103[3-1][3-1]=detm1_4_12_13_14_103*dd_12_13_14_103*(dd_12_13_14_103-bx2_4_12_13_14_103-by2_4_12_13_14_103)
tmp33_12_13_14_103[1-1][2-1]=detm1_4_12_13_14_103*bx_4_12_13_14_103*by_4_12_13_14_103*(2.*bz2_4_12_13_14_103-dd_12_13_14_103)
tmp33_12_13_14_103[2-1][3-1]=detm1_4_12_13_14_103*by_4_12_13_14_103*bz_4_12_13_14_103*(2.*bx2_4_12_13_14_103-dd_12_13_14_103)
tmp33_12_13_14_103[3-1][1-1]=detm1_4_12_13_14_103*bz_4_12_13_14_103*bx_4_12_13_14_103*(2.*by2_4_12_13_14_103-dd_12_13_14_103)
tmp33_12_13_14_103[2-1][1-1]=tmp33_12_13_14_103[1-1][2-1]
tmp33_12_13_14_103[3-1][2-1]=tmp33_12_13_14_103[2-1][3-1]
tmp33_12_13_14_103[1-1][3-1]=tmp33_12_13_14_103[3-1][1-1]
ac_transformed_pencil_uu = tmp33_12_13_14_103*tmp3_12_13_14_103
}
else {
tmp_12_13_14_103=1./((value(F_RHO)-0.5*AC_b_ext2__mod__magnetic)/(1.-0.25/value(F_LORENTZ))+AC_b_ext2__mod__magnetic)
ac_transformed_pencil_uu = tmp_12_13_14_103*tmp3_12_13_14_103
}
}
else {
tmp_12_13_14_103=1./(tmp_rho_12_13_14_103/(1.-0.25/value(F_LORENTZ)))
ac_transformed_pencil_uu = tmp_12_13_14_103*tmp3_12_13_14_103
}
}
else {
ac_transformed_pencil_rho1=1./value(F_RHO)
ac_transformed_pencil_uu = ac_transformed_pencil_rho1*tmp3_12_13_14_103
}
}
else {
ac_transformed_pencil_uu=value(F_UVEC)
}
}
if (AC_lpencil__mod__cparam[AC_i_u2__mod__cparam-1]) {
ac_transformed_pencil_u2 = dot(ac_transformed_pencil_uu,ac_transformed_pencil_uu)
}
if (AC_lpencil__mod__cparam[AC_i_uij__mod__cparam-1]) {
if (AC_lvv_as_aux__mod__hydro  ||  AC_lvv_as_comaux__mod__hydro) {
ac_transformed_pencil_uij = gradient(Field3(Field(AC_ivv__mod__cdata), Field(AC_ivv__mod__cdata+1), Field(AC_ivv__mod__cdata+2)))
}
else {
ac_transformed_pencil_uij = gradient(Field3(Field(AC_iuu__mod__cdata), Field(AC_iuu__mod__cdata+1), Field(AC_iuu__mod__cdata+2)))
}
if (AC_lgradu_as_aux__mod__hydro  ||  AC_lparticles_lyapunov__mod__cparam  ||  AC_lparticles_caustics__mod__cparam  ||  AC_lparticles_tetrad__mod__cparam) {
DF_GUIJ11 = ac_transformed_pencil_uij[1-1][1-1]
DF_GUIJ12 = ac_transformed_pencil_uij[1-1][2-1]
DF_GUIJ13 = ac_transformed_pencil_uij[1-1][3-1]
DF_GUIJ21 = ac_transformed_pencil_uij[2-1][1-1]
DF_GUIJ22 = ac_transformed_pencil_uij[2-1][2-1]
DF_GUIJ23 = ac_transformed_pencil_uij[2-1][3-1]
DF_GUIJ31 = ac_transformed_pencil_uij[3-1][1-1]
DF_GUIJ32 = ac_transformed_pencil_uij[3-1][2-1]
DF_GUIJ33 = ac_transformed_pencil_uij[3-1][3-1]
}
}
if (AC_lpencil__mod__cparam[AC_i_divu__mod__cparam-1]) {
ac_transformed_pencil_divu = divergence(ac_transformed_pencil_uij)
}
if (AC_lpencil__mod__cparam[AC_i_sij__mod__cparam-1]) {
ac_transformed_pencil_sij = traceless_strain(ac_transformed_pencil_uij,ac_transformed_pencil_divu)
if (AC_lshear__mod__cparam  &&  AC_lshear_rateofstrain__mod__hydro) {
ac_transformed_pencil_sij[1-1][2-1] = ac_transformed_pencil_sij[1-1][2-1] + AC_sshear__mod__cdata
ac_transformed_pencil_sij[2-1][1-1] = ac_transformed_pencil_sij[2-1][1-1] + AC_sshear__mod__cdata
}
}
if (AC_lpencil__mod__cparam[AC_i_sij2__mod__cparam-1]) {
ac_transformed_pencil_sij2 = multm2_sym(ac_transformed_pencil_sij)
}
if (AC_lpencil__mod__cparam[AC_i_uij5__mod__cparam-1]) {
ac_transformed_pencil_uij5 = gradient5(Field3(Field(AC_iuu__mod__cdata), Field(AC_iuu__mod__cdata+1), Field(AC_iuu__mod__cdata+2)))
}
if (AC_lpencil__mod__cparam[AC_i_oo__mod__cparam-1]) {
if (AC_ioo__mod__cdata != 0) {
ac_transformed_pencil_oo = value(F_OVEC)
}
else {
ac_transformed_pencil_oo=curl(ac_transformed_pencil_uij)
}
}
if (AC_lpencil__mod__cparam[AC_i_o2__mod__cparam-1]) {
ac_transformed_pencil_o2 = dot(ac_transformed_pencil_oo,ac_transformed_pencil_oo)
}
if (AC_lpencil__mod__cparam[AC_i_ou__mod__cparam-1]) {
ac_transformed_pencil_ou = dot(ac_transformed_pencil_oo,ac_transformed_pencil_uu)
}
if (AC_lpencil__mod__cparam[AC_i_oxu__mod__cparam-1]) {
ac_transformed_pencil_oxu = cross(ac_transformed_pencil_oo,ac_transformed_pencil_uu)
}
if (AC_lpencil__mod__cparam[AC_i_oxu2__mod__cparam-1]) {
ac_transformed_pencil_oxu2 = dot(ac_transformed_pencil_oxu,ac_transformed_pencil_oxu)
}
if (AC_lpencil__mod__cparam[AC_i_ugu__mod__cparam-1]) {
ac_transformed_pencil_ugu = ac_transformed_pencil_uij*ac_transformed_pencil_uu
if (AC_lupw_uu__mod__hydro) ac_transformed_pencil_ugu = ac_transformed_pencil_ugu + del6(Field3(Field(AC_iuu__mod__cdata), Field(AC_iuu__mod__cdata+1), Field(AC_iuu__mod__cdata+2)))
if (AC_ldensity__mod__cparam) {
if (AC_lffree__mod__density) {
tmp_12_13_14_103=AC_profx_ffree__mod__density[vertexIdx.x-NGHOST_VAL]*AC_profy_ffree__mod__density[AC_m__mod__cdata-1]*AC_profz_ffree__mod__density[AC_n__mod__cdata-1]
ac_transformed_pencil_ugu.x=ac_transformed_pencil_ugu.x*tmp_12_13_14_103
ac_transformed_pencil_ugu.y=ac_transformed_pencil_ugu.y*tmp_12_13_14_103
ac_transformed_pencil_ugu.z=ac_transformed_pencil_ugu.z*tmp_12_13_14_103
}
}
}
if (AC_lpencil__mod__cparam[AC_i_ugu2__mod__cparam-1]) {
ac_transformed_pencil_ugu2 = dot(ac_transformed_pencil_ugu,ac_transformed_pencil_ugu)
}
if (AC_lpencil__mod__cparam[AC_i_ogu__mod__cparam-1]) {
ac_transformed_pencil_ogu = ac_transformed_pencil_uij*ac_transformed_pencil_oo
if (AC_lupw_uu__mod__hydro) ac_transformed_pencil_ogu = ac_transformed_pencil_ogu + del6(Field3(Field(AC_iuu__mod__cdata), Field(AC_iuu__mod__cdata+1), Field(AC_iuu__mod__cdata+2)))
}
if (AC_lpencil__mod__cparam[AC_i_u3u21__mod__cparam-1]) {
ac_transformed_pencil_u3u21=ac_transformed_pencil_uu.z*ac_transformed_pencil_uij[2-1][1-1]
}
if (AC_lpencil__mod__cparam[AC_i_u1u32__mod__cparam-1]) {
ac_transformed_pencil_u1u32=ac_transformed_pencil_uu.x*ac_transformed_pencil_uij[3-1][2-1]
}
if (AC_lpencil__mod__cparam[AC_i_u2u13__mod__cparam-1]) {
ac_transformed_pencil_u2u13=ac_transformed_pencil_uu.y*ac_transformed_pencil_uij[1-1][3-1]
}
if (AC_lpencil__mod__cparam[AC_i_u2u31__mod__cparam-1]) {
ac_transformed_pencil_u2u31=ac_transformed_pencil_uu.y*ac_transformed_pencil_uij[3-1][1-1]
}
if (AC_lpencil__mod__cparam[AC_i_u3u12__mod__cparam-1]) {
ac_transformed_pencil_u3u12=ac_transformed_pencil_uu.z*ac_transformed_pencil_uij[1-1][2-1]
}
if (AC_lpencil__mod__cparam[AC_i_u1u23__mod__cparam-1]) {
ac_transformed_pencil_u1u23=ac_transformed_pencil_uu.x*ac_transformed_pencil_uij[2-1][3-1]
}
if (AC_lpencil__mod__cparam[AC_i_del4u__mod__cparam-1]) {
ac_transformed_pencil_del4u = del4(Field3(Field(AC_iuu__mod__cdata), Field(AC_iuu__mod__cdata+1), Field(AC_iuu__mod__cdata+2)))
}
if (AC_lpencil__mod__cparam[AC_i_del6u__mod__cparam-1]) {
ac_transformed_pencil_del6u = del6(Field3(Field(AC_iuu__mod__cdata), Field(AC_iuu__mod__cdata+1), Field(AC_iuu__mod__cdata+2)))
}
if (AC_lpencil__mod__cparam[AC_i_del6u_strict__mod__cparam-1]) {
ac_transformed_pencil_del6u_strict = del6_strict(Field3(Field(AC_iuu__mod__cdata), Field(AC_iuu__mod__cdata+1), Field(AC_iuu__mod__cdata+2)))
}
if (AC_lpencil__mod__cparam[AC_i_del4graddivu__mod__cparam-1]) {
not_implemented("del4graddiv")
}
if (AC_lpencil__mod__cparam[AC_i_del6u_bulk__mod__cparam-1]) {
ac_transformed_pencil_del6u_bulk.x = der6x(Field(AC_iux__mod__cdata))
ac_transformed_pencil_del6u_bulk.y = der6y(Field(AC_iuy__mod__cdata))
ac_transformed_pencil_del6u_bulk.z = der6z(Field(AC_iuz__mod__cdata))
}
if (AC_lpencil__mod__cparam[AC_i_der6u_res__mod__cparam-1]) {
ju_12_13_14_103=1+AC_iuu__mod__cdata-1
if (AC_lcylindrical_coords__mod__cdata && ju_12_13_14_103==AC_iuy__mod__cdata && 1==1) {
not_implemented("der6_pencil")
}
else if (AC_lspherical_coords__mod__cdata && ju_12_13_14_103==AC_iuz__mod__cdata && 1==1) {
not_implemented("der6_pencil")
}
else {
ac_transformed_pencil_der6u_res[1-1][1-1] = der6x_ignore_spacing(Field(ju_12_13_14_103))
}
if (AC_lcylindrical_coords__mod__cdata && ju_12_13_14_103==AC_iuy__mod__cdata && 2==1) {
not_implemented("der6_pencil")
}
else if (AC_lspherical_coords__mod__cdata && ju_12_13_14_103==AC_iuz__mod__cdata && 2==1) {
not_implemented("der6_pencil")
}
else {
ac_transformed_pencil_der6u_res[2-1][1-1] = der6y_ignore_spacing(Field(ju_12_13_14_103))
}
if (AC_lcylindrical_coords__mod__cdata && ju_12_13_14_103==AC_iuy__mod__cdata && 3==1) {
not_implemented("der6_pencil")
}
else if (AC_lspherical_coords__mod__cdata && ju_12_13_14_103==AC_iuz__mod__cdata && 3==1) {
not_implemented("der6_pencil")
}
else {
ac_transformed_pencil_der6u_res[3-1][1-1] = der6z_ignore_spacing(Field(ju_12_13_14_103))
}
ju_12_13_14_103=2+AC_iuu__mod__cdata-1
if (AC_lcylindrical_coords__mod__cdata && ju_12_13_14_103==AC_iuy__mod__cdata && 1==1) {
not_implemented("der6_pencil")
}
else if (AC_lspherical_coords__mod__cdata && ju_12_13_14_103==AC_iuz__mod__cdata && 1==1) {
not_implemented("der6_pencil")
}
else {
ac_transformed_pencil_der6u_res[1-1][2-1] = der6x_ignore_spacing(Field(ju_12_13_14_103))
}
if (AC_lcylindrical_coords__mod__cdata && ju_12_13_14_103==AC_iuy__mod__cdata && 2==1) {
not_implemented("der6_pencil")
}
else if (AC_lspherical_coords__mod__cdata && ju_12_13_14_103==AC_iuz__mod__cdata && 2==1) {
not_implemented("der6_pencil")
}
else {
ac_transformed_pencil_der6u_res[2-1][2-1] = der6y_ignore_spacing(Field(ju_12_13_14_103))
}
if (AC_lcylindrical_coords__mod__cdata && ju_12_13_14_103==AC_iuy__mod__cdata && 3==1) {
not_implemented("der6_pencil")
}
else if (AC_lspherical_coords__mod__cdata && ju_12_13_14_103==AC_iuz__mod__cdata && 3==1) {
not_implemented("der6_pencil")
}
else {
ac_transformed_pencil_der6u_res[3-1][2-1] = der6z_ignore_spacing(Field(ju_12_13_14_103))
}
ju_12_13_14_103=3+AC_iuu__mod__cdata-1
if (AC_lcylindrical_coords__mod__cdata && ju_12_13_14_103==AC_iuy__mod__cdata && 1==1) {
not_implemented("der6_pencil")
}
else if (AC_lspherical_coords__mod__cdata && ju_12_13_14_103==AC_iuz__mod__cdata && 1==1) {
not_implemented("der6_pencil")
}
else {
ac_transformed_pencil_der6u_res[1-1][3-1] = der6x_ignore_spacing(Field(ju_12_13_14_103))
}
if (AC_lcylindrical_coords__mod__cdata && ju_12_13_14_103==AC_iuy__mod__cdata && 2==1) {
not_implemented("der6_pencil")
}
else if (AC_lspherical_coords__mod__cdata && ju_12_13_14_103==AC_iuz__mod__cdata && 2==1) {
not_implemented("der6_pencil")
}
else {
ac_transformed_pencil_der6u_res[2-1][3-1] = der6y_ignore_spacing(Field(ju_12_13_14_103))
}
if (AC_lcylindrical_coords__mod__cdata && ju_12_13_14_103==AC_iuy__mod__cdata && 3==1) {
not_implemented("der6_pencil")
}
else if (AC_lspherical_coords__mod__cdata && ju_12_13_14_103==AC_iuz__mod__cdata && 3==1) {
not_implemented("der6_pencil")
}
else {
ac_transformed_pencil_der6u_res[3-1][3-1] = der6z_ignore_spacing(Field(ju_12_13_14_103))
}
}
if (!AC_lcartesian_coords__mod__cdata || AC_lalways_use_gij_etc__mod__hydro) {
if (AC_lpencil__mod__cparam[AC_i_graddivu__mod__cparam-1]) {
ac_transformed_pencil_oij = bij(Field3(Field(AC_iuu__mod__cdata), Field(AC_iuu__mod__cdata+1), Field(AC_iuu__mod__cdata+2)))
ac_transformed_pencil_graddivu = gradient_of_divergence(Field3(Field(AC_iuu__mod__cdata), Field(AC_iuu__mod__cdata+1), Field(AC_iuu__mod__cdata+2)))
}
if (AC_lpencil__mod__cparam[AC_i_del2u__mod__cparam-1]) {
ac_transformed_pencil_curlo=curl(ac_transformed_pencil_oij)
ac_transformed_pencil_del2u=ac_transformed_pencil_graddivu-ac_transformed_pencil_curlo
}
}
else {
if (AC_lpencil__mod__cparam[AC_i_del2u__mod__cparam-1] && AC_lpencil__mod__cparam[AC_i_graddivu__mod__cparam-1] && AC_lpencil__mod__cparam[AC_i_curlo__mod__cparam-1]) {
}
else if (AC_lpencil__mod__cparam[AC_i_del2u__mod__cparam-1] && AC_lpencil__mod__cparam[AC_i_graddivu__mod__cparam-1]) {
}
else if (AC_lpencil__mod__cparam[AC_i_del2u__mod__cparam-1] && AC_lpencil__mod__cparam[AC_i_curlo__mod__cparam-1]) {
}
else if (AC_lpencil__mod__cparam[AC_i_graddivu__mod__cparam-1] && AC_lpencil__mod__cparam[AC_i_curlo__mod__cparam-1]) {
}
else if (AC_lpencil__mod__cparam[AC_i_del2u__mod__cparam-1]) {
}
else if (AC_lpencil__mod__cparam[AC_i_graddivu__mod__cparam-1]) {
}
else if (AC_lpencil__mod__cparam[AC_i_curlo__mod__cparam-1]) {
}
}
if (AC_lpencil__mod__cparam[AC_i_d2uidxj__mod__cparam-1]) {
ac_transformed_pencil_d2uidxj = d2fi_dxj(Field3(Field(AC_iuu__mod__cdata), Field(AC_iuu__mod__cdata+1), Field(AC_iuu__mod__cdata+2)))
}
if (AC_lpencil__mod__cparam[AC_i_uijk__mod__cparam-1]) {
ac_transformed_pencil_uijk = del2fi_dxjk(Field3(Field(AC_iuu__mod__cdata), Field(AC_iuu__mod__cdata+1), Field(AC_iuu__mod__cdata+2)))
}
if (AC_lpencil__mod__cparam[AC_i_grad5divu__mod__cparam-1]) {
ac_transformed_pencil_grad5divu.x = 0.0
ju_12_13_14_103=AC_iuu__mod__cdata+1-1
tmp_12_13_14_103 = der6x(Field(ju_12_13_14_103))
ac_transformed_pencil_grad5divu.x = ac_transformed_pencil_grad5divu.x + tmp_12_13_14_103
ju_12_13_14_103=AC_iuu__mod__cdata+2-1
tmp_12_13_14_103 = der5x1y(Field(ju_12_13_14_103))
ac_transformed_pencil_grad5divu.x = ac_transformed_pencil_grad5divu.x + tmp_12_13_14_103
ju_12_13_14_103=AC_iuu__mod__cdata+3-1
tmp_12_13_14_103 = der5x1z(Field(ju_12_13_14_103))
ac_transformed_pencil_grad5divu.x = ac_transformed_pencil_grad5divu.x + tmp_12_13_14_103
ac_transformed_pencil_grad5divu.y = 0.0
ju_12_13_14_103=AC_iuu__mod__cdata+1-1
tmp_12_13_14_103 = der5y1x(Field(ju_12_13_14_103))
ac_transformed_pencil_grad5divu.y = ac_transformed_pencil_grad5divu.y + tmp_12_13_14_103
ju_12_13_14_103=AC_iuu__mod__cdata+2-1
tmp_12_13_14_103 = der6y(Field(ju_12_13_14_103))
ac_transformed_pencil_grad5divu.y = ac_transformed_pencil_grad5divu.y + tmp_12_13_14_103
ju_12_13_14_103=AC_iuu__mod__cdata+3-1
tmp_12_13_14_103 = der5y1z(Field(ju_12_13_14_103))
ac_transformed_pencil_grad5divu.y = ac_transformed_pencil_grad5divu.y + tmp_12_13_14_103
ac_transformed_pencil_grad5divu.z = 0.0
ju_12_13_14_103=AC_iuu__mod__cdata+1-1
tmp_12_13_14_103 = der5z1x(Field(ju_12_13_14_103))
ac_transformed_pencil_grad5divu.z = ac_transformed_pencil_grad5divu.z + tmp_12_13_14_103
ju_12_13_14_103=AC_iuu__mod__cdata+2-1
tmp_12_13_14_103 = der5z1y(Field(ju_12_13_14_103))
ac_transformed_pencil_grad5divu.z = ac_transformed_pencil_grad5divu.z + tmp_12_13_14_103
ju_12_13_14_103=AC_iuu__mod__cdata+3-1
tmp_12_13_14_103 = der6z(Field(ju_12_13_14_103))
ac_transformed_pencil_grad5divu.z = ac_transformed_pencil_grad5divu.z + tmp_12_13_14_103
}
if (AC_lpencil__mod__cparam[AC_i_transpurho__mod__cparam-1] && AC_ldensity_nolog__mod__cdata) {
if (AC_lreference_state__mod__cdata) {
ac_transformed_pencil_transpurho.x = AC_impossible__mod__cparam
ac_transformed_pencil_transpurho.y = AC_impossible__mod__cparam
ac_transformed_pencil_transpurho.z = AC_impossible__mod__cparam
}
else {
ac_transformed_pencil_transpurho.x = AC_impossible__mod__cparam
ac_transformed_pencil_transpurho.y = AC_impossible__mod__cparam
ac_transformed_pencil_transpurho.z = AC_impossible__mod__cparam
}
}
if (AC_lpencil__mod__cparam[AC_i_uu_advec__mod__cparam-1]) {
ac_transformed_pencil_uu_advec.x=ac_transformed_pencil_uu.x
if (AC_lcylindrical_coords__mod__cdata) {
ac_transformed_pencil_uu_advec.y=ac_transformed_pencil_uu.y-AC_uu_average_cyl__mod__hydro[vertexIdx.x][AC_n__mod__cdata-1]
ac_transformed_pencil_uu_advec.z=ac_transformed_pencil_uu.z
}
else if (AC_lspherical_coords__mod__cdata) {
ac_transformed_pencil_uu_advec.y=ac_transformed_pencil_uu.y
ac_transformed_pencil_uu_advec.z=ac_transformed_pencil_uu.z-AC_uu_average_sph__mod__hydro[vertexIdx.x][AC_m__mod__cdata-1]
}
tmp3_12_13_14_103 = ac_transformed_pencil_uij.row(1-1)
ac_transformed_pencil_uuadvec_guu.x = dot(ac_transformed_pencil_uu_advec,tmp3_12_13_14_103)
tmp3_12_13_14_103 = ac_transformed_pencil_uij.row(2-1)
ac_transformed_pencil_uuadvec_guu.y = dot(ac_transformed_pencil_uu_advec,tmp3_12_13_14_103)
tmp3_12_13_14_103 = ac_transformed_pencil_uij.row(3-1)
ac_transformed_pencil_uuadvec_guu.z = dot(ac_transformed_pencil_uu_advec,tmp3_12_13_14_103)
if (AC_lcylindrical_coords__mod__cdata) {
ac_transformed_pencil_uuadvec_guu.x=ac_transformed_pencil_uuadvec_guu.x-AC_rcyl_mn1__mod__cdata[vertexIdx.x-NGHOST_VAL]*ac_transformed_pencil_uu.y*ac_transformed_pencil_uu.y
ac_transformed_pencil_uuadvec_guu.y=ac_transformed_pencil_uuadvec_guu.y+AC_rcyl_mn1__mod__cdata[vertexIdx.x-NGHOST_VAL]*ac_transformed_pencil_uu.y*ac_transformed_pencil_uu.x
}
else if (AC_lspherical_coords__mod__cdata) {
ac_transformed_pencil_uuadvec_guu.x=ac_transformed_pencil_uuadvec_guu.x-AC_r1_mn__mod__cdata[vertexIdx.x-NGHOST_VAL]*(ac_transformed_pencil_uu.y*ac_transformed_pencil_uu.y+ac_transformed_pencil_uu.z*ac_transformed_pencil_uu.z)
ac_transformed_pencil_uuadvec_guu.y=ac_transformed_pencil_uuadvec_guu.y+AC_r1_mn__mod__cdata[vertexIdx.x-NGHOST_VAL]*(ac_transformed_pencil_uu.y*ac_transformed_pencil_uu.x-ac_transformed_pencil_uu.z*ac_transformed_pencil_uu.z*AC_cotth__mod__cdata[AC_m__mod__cdata-1])
ac_transformed_pencil_uuadvec_guu.z=ac_transformed_pencil_uuadvec_guu.z+AC_r1_mn__mod__cdata[vertexIdx.x-NGHOST_VAL]*(ac_transformed_pencil_uu.z*ac_transformed_pencil_uu.x+ac_transformed_pencil_uu.z*ac_transformed_pencil_uu.y*AC_cotth__mod__cdata[AC_m__mod__cdata-1])
}
}
if (AC_lpencil__mod__cparam[AC_i_uu_sph__mod__cparam-1] && AC_luu_sph_as_aux__mod__hydro) {
ac_transformed_pencil_uu_sph=value(F_UU_SPHVEC)
}
if (AC_lconservative__mod__hydro) {
if (AC_ilorentz__mod__cdata != 0) {
ac_transformed_pencil_lorentz = value(F_LORENTZ)
}
if (!AC_lhiggsless_old__mod__hydro && AC_lhiggsless__mod__hydro) {
ac_transformed_pencil_hless = value(F_HLESS)
}
}
}
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata && AC_ladvection_velocity__mod__hydro) {
if (AC_lmaximal_cdt__mod__cdata) {
ac_transformed_pencil_advec_uu=max(abs(ac_transformed_pencil_uu.x)*dline_1__mod__cdata.x, abs(ac_transformed_pencil_uu.y)*dline_1__mod__cdata.y, abs(ac_transformed_pencil_uu.z)*dline_1__mod__cdata.z)
}
else if (AC_lfargo_advection__mod__cdata) {
ac_transformed_pencil_advec_uu=sum(abs(ac_transformed_pencil_uu_advec)*dline_1__mod__cdata)
}
else {
ac_transformed_pencil_advec_uu=sum(abs(ac_transformed_pencil_uu)*dline_1__mod__cdata)
}
if (AC_lisotropic_advection__mod__cdata) {
if (AC_dimensionality__mod__cparam<3) {
ac_transformed_pencil_advec_uu=sqrt(ac_transformed_pencil_u2*dxyz_2__mod__cdata)
}
}
}
if (AC_ldensity_nolog__mod__cdata) {
ac_transformed_pencil_rho=value(F_RHO)
if (AC_lreference_state__mod__cdata) {
ac_transformed_pencil_rho=ac_transformed_pencil_rho+AC_reference_state__mod__density[vertexIdx.x][AC_iref_rho__mod__cparam-1]
}
if (AC_lpencil__mod__cparam[AC_i_rho1__mod__cparam-1]) {
ac_transformed_pencil_rho1=1.0/ac_transformed_pencil_rho
}
if (AC_lpencil__mod__cparam[AC_i_lnrho__mod__cparam-1]) {
ac_transformed_pencil_lnrho=log(ac_transformed_pencil_rho)
}
if (AC_lpencil__mod__cparam[AC_i_glnrho__mod__cparam-1] || AC_lpencil__mod__cparam[AC_i_grho__mod__cparam-1]) {
ac_transformed_pencil_grho = gradient(Field(AC_irho__mod__cdata))
if (AC_lreference_state__mod__cdata) {
ac_transformed_pencil_grho.x=ac_transformed_pencil_grho.x+AC_reference_state__mod__density[vertexIdx.x][AC_iref_grho__mod__cparam-1]
}
if (AC_lpencil__mod__cparam[AC_i_glnrho__mod__cparam-1]) {
ac_transformed_pencil_glnrho.x=ac_transformed_pencil_rho1*ac_transformed_pencil_grho.x
ac_transformed_pencil_glnrho.y=ac_transformed_pencil_rho1*ac_transformed_pencil_grho.y
ac_transformed_pencil_glnrho.z=ac_transformed_pencil_rho1*ac_transformed_pencil_grho.z
}
}
if (AC_lpencil__mod__cparam[AC_i_ugrho__mod__cparam-1]) {
ac_transformed_pencil_ugrho = dot(ac_transformed_pencil_uu,ac_transformed_pencil_grho)
if (AC_lupw_rho__mod__density) ac_transformed_pencil_ugrho = ac_transformed_pencil_ugrho - del6_upwd(Field(AC_ilnrho__mod__cdata))
}
if (AC_lpencil__mod__cparam[AC_i_glnrho2__mod__cparam-1]) {
ac_transformed_pencil_glnrho2 = dot(ac_transformed_pencil_glnrho,ac_transformed_pencil_glnrho)
}
if (AC_lpencil__mod__cparam[AC_i_del2rho__mod__cparam-1]) {
ac_transformed_pencil_del2rho = laplace(Field(AC_irho__mod__cdata))
if (AC_lreference_state__mod__cdata) {
ac_transformed_pencil_del2rho=ac_transformed_pencil_del2rho+AC_reference_state__mod__density[vertexIdx.x][AC_iref_d2rho__mod__cparam-1]
}
}
if (AC_lpencil__mod__cparam[AC_i_del2lnrho__mod__cparam-1]) {
ac_transformed_pencil_del2lnrho=ac_transformed_pencil_rho1*ac_transformed_pencil_del2rho-ac_transformed_pencil_glnrho2
}
if (AC_lpencil__mod__cparam[AC_i_del6rho__mod__cparam-1]) {
if (AC_ldiff_hyper3__mod__density) {
ac_transformed_pencil_del6rho = del6(Field(AC_irho__mod__cdata))
if (AC_lreference_state__mod__cdata) {
ac_transformed_pencil_del6rho=ac_transformed_pencil_del6rho+AC_reference_state__mod__density[vertexIdx.x][AC_iref_d6rho__mod__cparam-1]
}
}
else if (AC_ldiff_hyper3_strict__mod__density) {
ac_transformed_pencil_del6rho=0.
tmp_15_19_23_24_103 = der6x(Field(AC_irho__mod__cdata))
ac_transformed_pencil_del6rho = ac_transformed_pencil_del6rho + tmp_15_19_23_24_103
if (1!=1) {
tmp_15_19_23_24_103 = der6x(Field(AC_irho__mod__cdata))
ac_transformed_pencil_del6rho = ac_transformed_pencil_del6rho + 3*tmp_15_19_23_24_103
}
if (2!=1) {
tmp_15_19_23_24_103 = der4x2y(Field(AC_irho__mod__cdata))
ac_transformed_pencil_del6rho = ac_transformed_pencil_del6rho + 3*tmp_15_19_23_24_103
}
if (3!=1) {
tmp_15_19_23_24_103 = der4x2z(Field(AC_irho__mod__cdata))
ac_transformed_pencil_del6rho = ac_transformed_pencil_del6rho + 3*tmp_15_19_23_24_103
}
tmp_15_19_23_24_103 = der6y(Field(AC_irho__mod__cdata))
ac_transformed_pencil_del6rho = ac_transformed_pencil_del6rho + tmp_15_19_23_24_103
if (1!=2) {
tmp_15_19_23_24_103 = der4y2x(Field(AC_irho__mod__cdata))
ac_transformed_pencil_del6rho = ac_transformed_pencil_del6rho + 3*tmp_15_19_23_24_103
}
if (2!=2) {
tmp_15_19_23_24_103 = der6y(Field(AC_irho__mod__cdata))
ac_transformed_pencil_del6rho = ac_transformed_pencil_del6rho + 3*tmp_15_19_23_24_103
}
if (3!=2) {
tmp_15_19_23_24_103 = der4y2z(Field(AC_irho__mod__cdata))
ac_transformed_pencil_del6rho = ac_transformed_pencil_del6rho + 3*tmp_15_19_23_24_103
}
tmp_15_19_23_24_103 = der6z(Field(AC_irho__mod__cdata))
ac_transformed_pencil_del6rho = ac_transformed_pencil_del6rho + tmp_15_19_23_24_103
if (1!=3) {
tmp_15_19_23_24_103 = der4z2x(Field(AC_irho__mod__cdata))
ac_transformed_pencil_del6rho = ac_transformed_pencil_del6rho + 3*tmp_15_19_23_24_103
}
if (2!=3) {
tmp_15_19_23_24_103 = der4z2y(Field(AC_irho__mod__cdata))
ac_transformed_pencil_del6rho = ac_transformed_pencil_del6rho + 3*tmp_15_19_23_24_103
}
if (3!=3) {
tmp_15_19_23_24_103 = der6z(Field(AC_irho__mod__cdata))
ac_transformed_pencil_del6rho = ac_transformed_pencil_del6rho + 3*tmp_15_19_23_24_103
}
tmp_15_19_23_24_103 = der2i2j2k(Field(AC_irho__mod__cdata))
ac_transformed_pencil_del6rho = ac_transformed_pencil_del6rho + 6*tmp_15_19_23_24_103
}
}
if (AC_lpencil__mod__cparam[AC_i_del6lnrho__mod__cparam-1]) {
if (AC_ldiff_hyper3lnrho__mod__density) {
}
else if (AC_ldiff_hyper3lnrho_strict__mod__density) {
}
}
if (AC_lpencil__mod__cparam[AC_i_sglnrho__mod__cparam-1]) {
ac_transformed_pencil_sglnrho = ac_transformed_pencil_sij*ac_transformed_pencil_glnrho
}
if (AC_lpencil__mod__cparam[AC_i_uij5glnrho__mod__cparam-1]) {
ac_transformed_pencil_uij5glnrho = ac_transformed_pencil_uij5*ac_transformed_pencil_glnrho
}
if (AC_lpencil__mod__cparam[AC_i_transprho__mod__cparam-1]) {
if (AC_lreference_state__mod__cdata) {
ac_transformed_pencil_transprho = AC_impossible__mod__cparam
}
else {
ac_transformed_pencil_transprho = AC_impossible__mod__cparam
}
}
if (AC_lpencil__mod__cparam[AC_i_uuadvec_grho__mod__cparam-1]) {
ac_transformed_pencil_uuadvec_grho = dot(ac_transformed_pencil_uu_advec,ac_transformed_pencil_grho)
if (AC_lupw_rho__mod__density) {
ac_transformed_pencil_uu_advec = del6(Field(AC_irho__mod__cdata))
ac_transformed_pencil_uuadvec_grho = ac_transformed_pencil_uuadvec_grho - tmp_19_23_24_103
}
}
if (AC_lpencil__mod__cparam[AC_i_divss__mod__cparam-1]) {
ac_transformed_pencil_divss = divergence(Field3(Field(AC_iux__mod__cdata), Field(AC_iux__mod__cdata+1), Field(AC_iux__mod__cdata+2)))
}
if (AC_lconservative__mod__hydro) {
if (AC_lhiggsless__mod__hydro) {
if(ac_transformed_pencil_hless >= AC_t__mod__cdata) {
ac_transformed_pencil_rho=ac_transformed_pencil_rho-AC_eps_hless__mod__hydro
}
ac_transformed_pencil_rho=ac_transformed_pencil_rho/(AC_fourthird__mod__cparam*ac_transformed_pencil_lorentz*(1.-0.25/ac_transformed_pencil_lorentz))
}
else {
ac_transformed_pencil_rho=ac_transformed_pencil_rho/(AC_fourthird__mod__cparam*ac_transformed_pencil_lorentz*(1.-0.25/ac_transformed_pencil_lorentz))
}
}
}
else {
ac_transformed_pencil_lnrho=value(F_LNRHO)
if (AC_lpencil__mod__cparam[AC_i_rho1__mod__cparam-1]) {
ac_transformed_pencil_rho1=exp(-value(F_LNRHO))
}
if (AC_lpencil__mod__cparam[AC_i_rho__mod__cparam-1]) {
ac_transformed_pencil_rho=1.0/ac_transformed_pencil_rho1
}
if (AC_lpencil__mod__cparam[AC_i_glnrho__mod__cparam-1] || AC_lpencil__mod__cparam[AC_i_grho__mod__cparam-1]) {
ac_transformed_pencil_glnrho = gradient(Field(AC_ilnrho__mod__cdata))
if (AC_lpencil__mod__cparam[AC_i_grho__mod__cparam-1]) {
ac_transformed_pencil_grho.x=ac_transformed_pencil_rho*ac_transformed_pencil_glnrho.x
ac_transformed_pencil_grho.y=ac_transformed_pencil_rho*ac_transformed_pencil_glnrho.y
ac_transformed_pencil_grho.z=ac_transformed_pencil_rho*ac_transformed_pencil_glnrho.z
}
}
if (AC_lpencil__mod__cparam[AC_i_uglnrho__mod__cparam-1]) {
if (AC_lupw_lnrho__mod__density) {
ac_transformed_pencil_uglnrho = dot(ac_transformed_pencil_uu,ac_transformed_pencil_glnrho)
if (AC_lupw_lnrho__mod__density) ac_transformed_pencil_uglnrho = ac_transformed_pencil_uglnrho - del6_upwd(Field(AC_ilnrho__mod__cdata))
}
else {
ac_transformed_pencil_uglnrho = dot(ac_transformed_pencil_uu,ac_transformed_pencil_glnrho)
}
}
if (AC_lpencil__mod__cparam[AC_i_glnrho2__mod__cparam-1]) {
ac_transformed_pencil_glnrho2 = dot(ac_transformed_pencil_glnrho,ac_transformed_pencil_glnrho)
}
if (AC_lpencil__mod__cparam[AC_i_del2lnrho__mod__cparam-1]) {
ac_transformed_pencil_del2lnrho = laplace(Field(AC_ilnrho__mod__cdata))
}
if (AC_lpencil__mod__cparam[AC_i_del6lnrho__mod__cparam-1]) {
if (AC_ldiff_hyper3lnrho__mod__density) {
ac_transformed_pencil_del6lnrho = del6(Field(AC_ilnrho__mod__cdata))
}
else if (AC_ldiff_hyper3lnrho_strict__mod__density) {
ac_transformed_pencil_del6lnrho=0.
tmp_20_22_23_24_103 = der6x(Field(AC_ilnrho__mod__cdata))
ac_transformed_pencil_del6lnrho = ac_transformed_pencil_del6lnrho + tmp_20_22_23_24_103
if (1!=1) {
tmp_20_22_23_24_103 = der6x(Field(AC_ilnrho__mod__cdata))
ac_transformed_pencil_del6lnrho = ac_transformed_pencil_del6lnrho + 3*tmp_20_22_23_24_103
}
if (2!=1) {
tmp_20_22_23_24_103 = der4x2y(Field(AC_ilnrho__mod__cdata))
ac_transformed_pencil_del6lnrho = ac_transformed_pencil_del6lnrho + 3*tmp_20_22_23_24_103
}
if (3!=1) {
tmp_20_22_23_24_103 = der4x2z(Field(AC_ilnrho__mod__cdata))
ac_transformed_pencil_del6lnrho = ac_transformed_pencil_del6lnrho + 3*tmp_20_22_23_24_103
}
tmp_20_22_23_24_103 = der6y(Field(AC_ilnrho__mod__cdata))
ac_transformed_pencil_del6lnrho = ac_transformed_pencil_del6lnrho + tmp_20_22_23_24_103
if (1!=2) {
tmp_20_22_23_24_103 = der4y2x(Field(AC_ilnrho__mod__cdata))
ac_transformed_pencil_del6lnrho = ac_transformed_pencil_del6lnrho + 3*tmp_20_22_23_24_103
}
if (2!=2) {
tmp_20_22_23_24_103 = der6y(Field(AC_ilnrho__mod__cdata))
ac_transformed_pencil_del6lnrho = ac_transformed_pencil_del6lnrho + 3*tmp_20_22_23_24_103
}
if (3!=2) {
tmp_20_22_23_24_103 = der4y2z(Field(AC_ilnrho__mod__cdata))
ac_transformed_pencil_del6lnrho = ac_transformed_pencil_del6lnrho + 3*tmp_20_22_23_24_103
}
tmp_20_22_23_24_103 = der6z(Field(AC_ilnrho__mod__cdata))
ac_transformed_pencil_del6lnrho = ac_transformed_pencil_del6lnrho + tmp_20_22_23_24_103
if (1!=3) {
tmp_20_22_23_24_103 = der4z2x(Field(AC_ilnrho__mod__cdata))
ac_transformed_pencil_del6lnrho = ac_transformed_pencil_del6lnrho + 3*tmp_20_22_23_24_103
}
if (2!=3) {
tmp_20_22_23_24_103 = der4z2y(Field(AC_ilnrho__mod__cdata))
ac_transformed_pencil_del6lnrho = ac_transformed_pencil_del6lnrho + 3*tmp_20_22_23_24_103
}
if (3!=3) {
tmp_20_22_23_24_103 = der6z(Field(AC_ilnrho__mod__cdata))
ac_transformed_pencil_del6lnrho = ac_transformed_pencil_del6lnrho + 3*tmp_20_22_23_24_103
}
tmp_20_22_23_24_103 = der2i2j2k(Field(AC_ilnrho__mod__cdata))
ac_transformed_pencil_del6lnrho = ac_transformed_pencil_del6lnrho + 6*tmp_20_22_23_24_103
}
}
if (AC_lpencil__mod__cparam[AC_i_hlnrho__mod__cparam-1]) {
ac_transformed_pencil_hlnrho = hessian(Field(AC_ilnrho__mod__cdata))
}
if (AC_lpencil__mod__cparam[AC_i_sglnrho__mod__cparam-1]) {
ac_transformed_pencil_sglnrho = ac_transformed_pencil_sij*ac_transformed_pencil_glnrho
}
if (AC_lpencil__mod__cparam[AC_i_uij5glnrho__mod__cparam-1]) {
ac_transformed_pencil_uij5glnrho = ac_transformed_pencil_uij5*ac_transformed_pencil_glnrho
}
ac_transformed_pencil_uuadvec_glnrho = dot(ac_transformed_pencil_uu_advec,ac_transformed_pencil_glnrho)
}
if (AC_lpencil__mod__cparam[AC_i_ekin__mod__cparam-1]) {
if (AC_lconservative__mod__hydro) {
ac_transformed_pencil_ekin=AC_fourthird__mod__cparam*ac_transformed_pencil_rho*ac_transformed_pencil_lorentz*ac_transformed_pencil_u2
}
else {
ac_transformed_pencil_ekin=0.5*ac_transformed_pencil_rho*ac_transformed_pencil_u2
}
}
if (AC_lpencil__mod__cparam[AC_i_cc__mod__cparam-1]) {
ac_transformed_pencil_cc=1.0
}
if (AC_lpencil__mod__cparam[AC_i_cc1__mod__cparam-1]) {
ac_transformed_pencil_cc1=1.0
}
if (AC_lpencil__mod__cparam[AC_i_gcc__mod__cparam-1]) {
ac_transformed_pencil_gcc=0.0
}
if (AC_lpencil__mod__cparam[AC_i_cv1__mod__cparam-1]) {
ac_transformed_pencil_cv1=AC_cv1__mod__equationofstate
}
if (AC_lpencil__mod__cparam[AC_i_cp1__mod__cparam-1]) {
ac_transformed_pencil_cp1=AC_cp1__mod__equationofstate
}
if (AC_lpencil__mod__cparam[AC_i_cv__mod__cparam-1]) {
ac_transformed_pencil_cv=1/AC_cv1__mod__equationofstate
}
if (AC_lpencil__mod__cparam[AC_i_cp__mod__cparam-1]) {
ac_transformed_pencil_cp=1/AC_cp1__mod__equationofstate
}
if (AC_lpencil__mod__cparam[AC_i_cp1tilde__mod__cparam-1]) {
ac_transformed_pencil_cp1tilde=AC_cp1__mod__equationofstate
}
if (AC_lpencil__mod__cparam[AC_i_glnmumol__mod__cparam-1]) {
ac_transformed_pencil_glnmumol.x = 0.0
ac_transformed_pencil_glnmumol.y = 0.0
ac_transformed_pencil_glnmumol.z = 0.0
}
if(AC_ieosvars__mod__equationofstate == AC_ilnrho_ss__mod__equationofstate || AC_ieosvars__mod__equationofstate == AC_irho_ss__mod__equationofstate) {
if (AC_leos_isentropic__mod__equationofstate) {
if (AC_lpencil__mod__cparam[AC_i_ss__mod__cparam-1]) {
ac_transformed_pencil_ss=0.0
}
if (AC_lpencil__mod__cparam[AC_i_gss__mod__cparam-1]) {
ac_transformed_pencil_gss.x = 0.0
ac_transformed_pencil_gss.y = 0.0
ac_transformed_pencil_gss.z = 0.0
}
if (AC_lpencil__mod__cparam[AC_i_hss__mod__cparam-1]) {
ac_transformed_pencil_hss=0.0
}
if (AC_lpencil__mod__cparam[AC_i_del2ss__mod__cparam-1]) {
ac_transformed_pencil_del2ss=0.0
}
if (AC_lpencil__mod__cparam[AC_i_del6ss__mod__cparam-1]) {
ac_transformed_pencil_del6ss=0.0
}
if (AC_lpencil__mod__cparam[AC_i_cs2__mod__cparam-1]) {
ac_transformed_pencil_cs2=AC_cs20__mod__equationofstate*exp(AC_gamma_m1__mod__equationofstate*(ac_transformed_pencil_lnrho-AC_lnrho0__mod__equationofstate))
}
}
else if (AC_leos_isothermal__mod__equationofstate) {
if (AC_lpencil__mod__cparam[AC_i_ss__mod__cparam-1]) {
ac_transformed_pencil_ss=-(AC_cp__mod__equationofstate-AC_cv__mod__equationofstate)*(ac_transformed_pencil_lnrho-AC_lnrho0__mod__equationofstate)
}
if (AC_lpencil__mod__cparam[AC_i_gss__mod__cparam-1]) {
ac_transformed_pencil_gss=-(AC_cp__mod__equationofstate-AC_cv__mod__equationofstate)*ac_transformed_pencil_glnrho
}
if (AC_lpencil__mod__cparam[AC_i_hss__mod__cparam-1]) {
ac_transformed_pencil_hss=-(AC_cp__mod__equationofstate-AC_cv__mod__equationofstate)*ac_transformed_pencil_hlnrho
}
if (AC_lpencil__mod__cparam[AC_i_del2ss__mod__cparam-1]) {
ac_transformed_pencil_del2ss=-(AC_cp__mod__equationofstate-AC_cv__mod__equationofstate)*ac_transformed_pencil_del2lnrho
}
if (AC_lpencil__mod__cparam[AC_i_del6ss__mod__cparam-1]) {
ac_transformed_pencil_del6ss=-(AC_cp__mod__equationofstate-AC_cv__mod__equationofstate)*ac_transformed_pencil_del6lnrho
}
if (AC_lpencil__mod__cparam[AC_i_cs2__mod__cparam-1]) {
ac_transformed_pencil_cs2=AC_cs20__mod__equationofstate
}
if (AC_lpencil__mod__cparam[AC_i_rho1gpp__mod__cparam-1]) {
ac_transformed_pencil_rho1gpp.x = ac_transformed_pencil_cs2*ac_transformed_pencil_glnrho.x
ac_transformed_pencil_rho1gpp.y = ac_transformed_pencil_cs2*ac_transformed_pencil_glnrho.y
ac_transformed_pencil_rho1gpp.z = ac_transformed_pencil_cs2*ac_transformed_pencil_glnrho.z
}
}
else if (AC_leos_localisothermal__mod__equationofstate) {
}
else {
if (AC_lpencil__mod__cparam[AC_i_ss__mod__cparam-1]) {
ac_transformed_pencil_ss=value(F_EOSVAR2)
if (AC_lreference_state__mod__cdata) {
ac_transformed_pencil_ss=ac_transformed_pencil_ss+AC_reference_state__mod__density[vertexIdx.x][AC_iref_s__mod__cparam-1]
}
}
if (AC_lpencil__mod__cparam[AC_i_gss__mod__cparam-1]) {
ac_transformed_pencil_gss = gradient(Field(AC_ieosvar2__mod__equationofstate))
if (AC_lreference_state__mod__cdata) {
ac_transformed_pencil_gss.x=ac_transformed_pencil_gss.x+AC_reference_state__mod__density[vertexIdx.x][AC_iref_gs__mod__cparam-1]
}
}
if (AC_lpencil__mod__cparam[AC_i_hss__mod__cparam-1]) {
ac_transformed_pencil_hss = hessian(Field(AC_ieosvar2__mod__equationofstate))
if (AC_lreference_state__mod__cdata) {
ac_transformed_pencil_hss[1-1][1-1]=ac_transformed_pencil_hss[1-1][1-1]+AC_reference_state__mod__density[vertexIdx.x][AC_iref_d2s__mod__cparam-1]
}
}
if (AC_lpencil__mod__cparam[AC_i_del2ss__mod__cparam-1]) {
ac_transformed_pencil_del2ss = laplace(Field(AC_ieosvar2__mod__equationofstate))
if (AC_lreference_state__mod__cdata) {
ac_transformed_pencil_del2ss=ac_transformed_pencil_del2ss+AC_reference_state__mod__density[vertexIdx.x][AC_iref_d2s__mod__cparam-1]
}
}
if (AC_lpencil__mod__cparam[AC_i_del6ss__mod__cparam-1]) {
ac_transformed_pencil_del6ss = del6(Field(AC_ieosvar2__mod__equationofstate))
if (AC_lreference_state__mod__cdata) {
ac_transformed_pencil_del6ss=ac_transformed_pencil_del6ss+AC_reference_state__mod__density[vertexIdx.x][AC_iref_d6s__mod__cparam-1]
}
}
if (AC_lpencil__mod__cparam[AC_i_cs2__mod__cparam-1]) {
ac_transformed_pencil_cs2=AC_cs20__mod__equationofstate*exp(AC_cv1__mod__equationofstate*ac_transformed_pencil_ss+AC_gamma_m1__mod__equationofstate*(ac_transformed_pencil_lnrho-AC_lnrho0__mod__equationofstate))
}
}
if (AC_lpencil__mod__cparam[AC_i_lntt__mod__cparam-1]) {
ac_transformed_pencil_lntt=AC_lntt0__mod__equationofstate+AC_cv1__mod__equationofstate*ac_transformed_pencil_ss+AC_gamma_m1__mod__equationofstate*(ac_transformed_pencil_lnrho-AC_lnrho0__mod__equationofstate)
}
if (AC_lpencil__mod__cparam[AC_i_pp__mod__cparam-1]) {
ac_transformed_pencil_pp=(AC_cp__mod__equationofstate-AC_cv__mod__equationofstate)*exp(ac_transformed_pencil_lntt+ac_transformed_pencil_lnrho)
}
if (AC_lpencil__mod__cparam[AC_i_ee__mod__cparam-1]) {
ac_transformed_pencil_ee=AC_cv__mod__equationofstate*exp(ac_transformed_pencil_lntt)
}
if (AC_lpencil__mod__cparam[AC_i_yh__mod__cparam-1]) {
ac_transformed_pencil_yh=AC_impossible__mod__cparam
}
if (AC_lpencil__mod__cparam[AC_i_tt__mod__cparam-1]) {
ac_transformed_pencil_tt=exp(ac_transformed_pencil_lntt)
}
if (AC_lpencil__mod__cparam[AC_i_tt1__mod__cparam-1]) {
ac_transformed_pencil_tt1=exp(-ac_transformed_pencil_lntt)
}
if (AC_lpencil__mod__cparam[AC_i_glntt__mod__cparam-1]) {
ac_transformed_pencil_glntt=AC_gamma_m1__mod__equationofstate*ac_transformed_pencil_glnrho+AC_cv1__mod__equationofstate*ac_transformed_pencil_gss
}
if (AC_lpencil__mod__cparam[AC_i_gtt__mod__cparam-1]) {
ac_transformed_pencil_gtt.x=ac_transformed_pencil_glntt.x*ac_transformed_pencil_tt
ac_transformed_pencil_gtt.y=ac_transformed_pencil_glntt.y*ac_transformed_pencil_tt
ac_transformed_pencil_gtt.z=ac_transformed_pencil_glntt.z*ac_transformed_pencil_tt
}
if (AC_lpencil__mod__cparam[AC_i_del2lntt__mod__cparam-1]) {
ac_transformed_pencil_del2lntt=AC_gamma_m1__mod__equationofstate*ac_transformed_pencil_del2lnrho+AC_cv1__mod__equationofstate*ac_transformed_pencil_del2ss
}
if (AC_lpencil__mod__cparam[AC_i_hlntt__mod__cparam-1]) {
ac_transformed_pencil_hlntt=AC_gamma_m1__mod__equationofstate*ac_transformed_pencil_hlnrho+AC_cv1__mod__equationofstate*ac_transformed_pencil_hss
}
}
else if(AC_ieosvars__mod__equationofstate == AC_ilnrho_lntt__mod__equationofstate || AC_ieosvars__mod__equationofstate == AC_irho_lntt__mod__equationofstate) {
if (AC_leos_isentropic__mod__equationofstate) {
if (AC_lpencil__mod__cparam[AC_i_lntt__mod__cparam-1]) {
ac_transformed_pencil_lntt=AC_gamma_m1__mod__equationofstate*(ac_transformed_pencil_lnrho-AC_lnrho0__mod__equationofstate)+AC_lntt0__mod__equationofstate
}
if (AC_lpencil__mod__cparam[AC_i_glntt__mod__cparam-1]) {
ac_transformed_pencil_glntt=AC_gamma_m1__mod__equationofstate*ac_transformed_pencil_glnrho
}
if (AC_lpencil__mod__cparam[AC_i_hlntt__mod__cparam-1]) {
ac_transformed_pencil_hlntt=AC_gamma_m1__mod__equationofstate*ac_transformed_pencil_hlnrho
}
if (AC_lpencil__mod__cparam[AC_i_del2lntt__mod__cparam-1]) {
ac_transformed_pencil_del2lntt=AC_gamma_m1__mod__equationofstate*ac_transformed_pencil_del2lnrho
}
if (AC_lpencil__mod__cparam[AC_i_cs2__mod__cparam-1]) {
ac_transformed_pencil_cs2=AC_cs20__mod__equationofstate*exp(AC_gamma_m1__mod__equationofstate*(ac_transformed_pencil_lnrho-AC_lnrho0__mod__equationofstate))
}
}
else if (AC_leos_isothermal__mod__equationofstate) {
if (AC_lpencil__mod__cparam[AC_i_lntt__mod__cparam-1]) {
ac_transformed_pencil_lntt=AC_lntt0__mod__equationofstate
}
if (AC_lpencil__mod__cparam[AC_i_glntt__mod__cparam-1]) {
ac_transformed_pencil_glntt.x = 0.0
ac_transformed_pencil_glntt.y = 0.0
ac_transformed_pencil_glntt.z = 0.0
}
if (AC_lpencil__mod__cparam[AC_i_hlntt__mod__cparam-1]) {
ac_transformed_pencil_hlntt=0.0
}
if (AC_lpencil__mod__cparam[AC_i_del2lntt__mod__cparam-1]) {
ac_transformed_pencil_del2lntt=0.0
}
if (AC_lpencil__mod__cparam[AC_i_cs2__mod__cparam-1]) {
ac_transformed_pencil_cs2=AC_cs20__mod__equationofstate
}
}
else if (AC_leos_localisothermal__mod__equationofstate) {
}
else {
if (AC_lpencil__mod__cparam[AC_i_lntt__mod__cparam-1]) {
ac_transformed_pencil_lntt=value(F_EOSVAR2)
}
if (AC_lpencil__mod__cparam[AC_i_glntt__mod__cparam-1]) {
ac_transformed_pencil_glntt = gradient(Field(AC_ieosvar2__mod__equationofstate))
}
if (AC_lpencil__mod__cparam[AC_i_hlntt__mod__cparam-1]) {
ac_transformed_pencil_hlntt = hessian(Field(AC_ieosvar2__mod__equationofstate))
}
if (AC_lpencil__mod__cparam[AC_i_del2lntt__mod__cparam-1]) {
ac_transformed_pencil_del2lntt = laplace(Field(AC_ieosvar2__mod__equationofstate))
}
if (AC_lpencil__mod__cparam[AC_i_del6lntt__mod__cparam-1]) {
ac_transformed_pencil_del6lntt = del6(Field(AC_ieosvar2__mod__equationofstate))
}
if (AC_lpencil__mod__cparam[AC_i_cs2__mod__cparam-1]) {
ac_transformed_pencil_cs2=AC_cp__mod__equationofstate*exp(ac_transformed_pencil_lntt)*AC_gamma_m1__mod__equationofstate
}
if (AC_lpencil__mod__cparam[AC_i_rho1gpp__mod__cparam-1]) {
ac_transformed_pencil_rho1gpp.x = AC_gamma1__mod__equationofstate*ac_transformed_pencil_cs2*(ac_transformed_pencil_glnrho.x+ac_transformed_pencil_glntt.x)
ac_transformed_pencil_rho1gpp.y = AC_gamma1__mod__equationofstate*ac_transformed_pencil_cs2*(ac_transformed_pencil_glnrho.y+ac_transformed_pencil_glntt.y)
ac_transformed_pencil_rho1gpp.z = AC_gamma1__mod__equationofstate*ac_transformed_pencil_cs2*(ac_transformed_pencil_glnrho.z+ac_transformed_pencil_glntt.z)
}
}
if (AC_lpencil__mod__cparam[AC_i_ss__mod__cparam-1]) {
ac_transformed_pencil_ss=AC_cv__mod__equationofstate*(ac_transformed_pencil_lntt-AC_lntt0__mod__equationofstate-AC_gamma_m1__mod__equationofstate*(ac_transformed_pencil_lnrho-AC_lnrho0__mod__equationofstate))
}
if (AC_lpencil__mod__cparam[AC_i_pp__mod__cparam-1]) {
ac_transformed_pencil_pp=(AC_cp__mod__equationofstate-AC_cv__mod__equationofstate)*exp(ac_transformed_pencil_lntt+ac_transformed_pencil_lnrho)
}
if (AC_lpencil__mod__cparam[AC_i_ee__mod__cparam-1]) {
ac_transformed_pencil_ee=AC_cv__mod__equationofstate*exp(ac_transformed_pencil_lntt)
}
if (AC_lpencil__mod__cparam[AC_i_yh__mod__cparam-1]) {
ac_transformed_pencil_yh=AC_impossible__mod__cparam
}
if (AC_lpencil__mod__cparam[AC_i_tt__mod__cparam-1]) {
ac_transformed_pencil_tt=exp(ac_transformed_pencil_lntt)
}
if (AC_lpencil__mod__cparam[AC_i_tt1__mod__cparam-1]) {
ac_transformed_pencil_tt1=exp(-ac_transformed_pencil_lntt)
}
if (AC_lpencil__mod__cparam[AC_i_gss__mod__cparam-1]) {
ac_transformed_pencil_gss=AC_cv__mod__equationofstate*(ac_transformed_pencil_glntt-AC_gamma_m1__mod__equationofstate*ac_transformed_pencil_glnrho)
}
if (AC_lpencil__mod__cparam[AC_i_del2ss__mod__cparam-1]) {
ac_transformed_pencil_del2ss=AC_cv__mod__equationofstate*(ac_transformed_pencil_del2lntt-AC_gamma_m1__mod__equationofstate*ac_transformed_pencil_del2lnrho)
}
if (AC_lpencil__mod__cparam[AC_i_hss__mod__cparam-1]) {
ac_transformed_pencil_hss=AC_cv__mod__equationofstate*(ac_transformed_pencil_hlntt-AC_gamma_m1__mod__equationofstate*ac_transformed_pencil_hlnrho)
}
if (AC_lpencil__mod__cparam[AC_i_gtt__mod__cparam-1]) {
ac_transformed_pencil_gtt.x=ac_transformed_pencil_tt*ac_transformed_pencil_glntt.x
ac_transformed_pencil_gtt.y=ac_transformed_pencil_tt*ac_transformed_pencil_glntt.y
ac_transformed_pencil_gtt.z=ac_transformed_pencil_tt*ac_transformed_pencil_glntt.z
}
}
else if(AC_ieosvars__mod__equationofstate == AC_ilnrho_tt__mod__equationofstate || AC_ieosvars__mod__equationofstate == AC_irho_tt__mod__equationofstate) {
if (AC_lpencil__mod__cparam[AC_i_tt__mod__cparam-1]) {
ac_transformed_pencil_tt=value(F_EOSVAR2)
}
if (AC_lpencil__mod__cparam[AC_i_tt1__mod__cparam-1] || AC_lpencil__mod__cparam[AC_i_hlntt__mod__cparam-1]) {
ac_transformed_pencil_tt1=1/value(F_EOSVAR2)
}
if (AC_lpencil__mod__cparam[AC_i_lntt__mod__cparam-1] || AC_lpencil__mod__cparam[AC_i_ss__mod__cparam-1] || AC_lpencil__mod__cparam[AC_i_ee__mod__cparam-1]) {
ac_transformed_pencil_lntt=log(value(F_EOSVAR2))
}
if (AC_lpencil__mod__cparam[AC_i_cs2__mod__cparam-1]) {
ac_transformed_pencil_cs2=AC_cp__mod__equationofstate*AC_gamma_m1__mod__equationofstate*value(F_EOSVAR2)
}
if (AC_lpencil__mod__cparam[AC_i_gtt__mod__cparam-1]) {
ac_transformed_pencil_gtt = gradient(Field(AC_ieosvar2__mod__equationofstate))
}
if (AC_lpencil__mod__cparam[AC_i_glntt__mod__cparam-1] || AC_lpencil__mod__cparam[AC_i_hlntt__mod__cparam-1]) {
ac_transformed_pencil_glntt.x=ac_transformed_pencil_gtt.x*ac_transformed_pencil_tt1
ac_transformed_pencil_glntt.y=ac_transformed_pencil_gtt.y*ac_transformed_pencil_tt1
ac_transformed_pencil_glntt.z=ac_transformed_pencil_gtt.z*ac_transformed_pencil_tt1
}
if (AC_lpencil__mod__cparam[AC_i_del2tt__mod__cparam-1] || AC_lpencil__mod__cparam[AC_i_del2lntt__mod__cparam-1]) {
ac_transformed_pencil_del2tt = laplace(Field(AC_ieosvar2__mod__equationofstate))
}
if (AC_lpencil__mod__cparam[AC_i_del2lntt__mod__cparam-1]) {
tmp_27_28_103=0.0
tmp_27_28_103=tmp_27_28_103+ac_transformed_pencil_glntt.x*ac_transformed_pencil_glntt.x
tmp_27_28_103=tmp_27_28_103+ac_transformed_pencil_glntt.y*ac_transformed_pencil_glntt.y
tmp_27_28_103=tmp_27_28_103+ac_transformed_pencil_glntt.z*ac_transformed_pencil_glntt.z
ac_transformed_pencil_del2lntt=ac_transformed_pencil_del2tt*ac_transformed_pencil_tt1-tmp_27_28_103
}
if (AC_lpencil__mod__cparam[AC_i_hlntt__mod__cparam-1]) {
ac_transformed_pencil_hlntt = hessian(Field(AC_itt__mod__cdata))
ac_transformed_pencil_hlntt[1-1][1-1]=ac_transformed_pencil_hlntt[1-1][1-1]*ac_transformed_pencil_tt1-ac_transformed_pencil_glntt.x*ac_transformed_pencil_glntt.x
ac_transformed_pencil_hlntt[1-1][2-1]=ac_transformed_pencil_hlntt[1-1][2-1]*ac_transformed_pencil_tt1-ac_transformed_pencil_glntt.x*ac_transformed_pencil_glntt.y
ac_transformed_pencil_hlntt[1-1][3-1]=ac_transformed_pencil_hlntt[1-1][3-1]*ac_transformed_pencil_tt1-ac_transformed_pencil_glntt.x*ac_transformed_pencil_glntt.z
ac_transformed_pencil_hlntt[2-1][1-1]=ac_transformed_pencil_hlntt[2-1][1-1]*ac_transformed_pencil_tt1-ac_transformed_pencil_glntt.y*ac_transformed_pencil_glntt.x
ac_transformed_pencil_hlntt[2-1][2-1]=ac_transformed_pencil_hlntt[2-1][2-1]*ac_transformed_pencil_tt1-ac_transformed_pencil_glntt.y*ac_transformed_pencil_glntt.y
ac_transformed_pencil_hlntt[2-1][3-1]=ac_transformed_pencil_hlntt[2-1][3-1]*ac_transformed_pencil_tt1-ac_transformed_pencil_glntt.y*ac_transformed_pencil_glntt.z
ac_transformed_pencil_hlntt[3-1][1-1]=ac_transformed_pencil_hlntt[3-1][1-1]*ac_transformed_pencil_tt1-ac_transformed_pencil_glntt.z*ac_transformed_pencil_glntt.x
ac_transformed_pencil_hlntt[3-1][2-1]=ac_transformed_pencil_hlntt[3-1][2-1]*ac_transformed_pencil_tt1-ac_transformed_pencil_glntt.z*ac_transformed_pencil_glntt.y
ac_transformed_pencil_hlntt[3-1][3-1]=ac_transformed_pencil_hlntt[3-1][3-1]*ac_transformed_pencil_tt1-ac_transformed_pencil_glntt.z*ac_transformed_pencil_glntt.z
}
if (AC_lpencil__mod__cparam[AC_i_del6tt__mod__cparam-1]) {
ac_transformed_pencil_del6tt = del6(Field(AC_ieosvar2__mod__equationofstate))
}
if (AC_lpencil__mod__cparam[AC_i_ss__mod__cparam-1]) {
ac_transformed_pencil_ss=AC_cv__mod__equationofstate*(ac_transformed_pencil_lntt-AC_lntt0__mod__equationofstate-AC_gamma_m1__mod__equationofstate*(ac_transformed_pencil_lnrho-AC_lnrho0__mod__equationofstate))
}
if (AC_lpencil__mod__cparam[AC_i_pp__mod__cparam-1]) {
ac_transformed_pencil_pp=AC_cv__mod__equationofstate*AC_gamma_m1__mod__equationofstate*ac_transformed_pencil_rho*ac_transformed_pencil_tt
}
if (AC_lpencil__mod__cparam[AC_i_ee__mod__cparam-1]) {
ac_transformed_pencil_ee=AC_cv__mod__equationofstate*exp(ac_transformed_pencil_lntt)
}
}
else if(AC_ieosvars__mod__equationofstate == AC_ilnrho_cs2__mod__equationofstate || AC_ieosvars__mod__equationofstate == AC_irho_cs2__mod__equationofstate) {
if (AC_leos_isentropic__mod__equationofstate) {
}
else if (AC_leos_isothermal__mod__equationofstate) {
if (AC_lcs_tdep__mod__equationofstate) {
if (AC_lpencil__mod__cparam[AC_i_cs2__mod__cparam-1]) {
ac_transformed_pencil_cs2=AC_cs20__mod__equationofstate*exp(-AC_cs20_tdep_rate__mod__equationofstate*AC_t__mod__cdata)
}
}
else {
if (AC_lpencil__mod__cparam[AC_i_cs2__mod__cparam-1]) {
ac_transformed_pencil_cs2=AC_cs20__mod__equationofstate
}
}
if (AC_lpencil__mod__cparam[AC_i_lntt__mod__cparam-1]) {
ac_transformed_pencil_lntt=AC_lntt0__mod__equationofstate
}
if (AC_lpencil__mod__cparam[AC_i_glntt__mod__cparam-1]) {
ac_transformed_pencil_glntt.x = 0.0
ac_transformed_pencil_glntt.y = 0.0
ac_transformed_pencil_glntt.z = 0.0
}
if (AC_lpencil__mod__cparam[AC_i_hlntt__mod__cparam-1]) {
ac_transformed_pencil_hlntt=0.0
}
if (AC_lpencil__mod__cparam[AC_i_del2lntt__mod__cparam-1]) {
ac_transformed_pencil_del2lntt=0.0
}
if (AC_lpencil__mod__cparam[AC_i_ss__mod__cparam-1]) {
ac_transformed_pencil_ss=-(AC_cp__mod__equationofstate-AC_cv__mod__equationofstate)*(ac_transformed_pencil_lnrho-AC_lnrho0__mod__equationofstate)
}
if (AC_lpencil__mod__cparam[AC_i_del2ss__mod__cparam-1]) {
ac_transformed_pencil_del2ss=-(AC_cp__mod__equationofstate-AC_cv__mod__equationofstate)*ac_transformed_pencil_del2lnrho
}
if (AC_lpencil__mod__cparam[AC_i_gss__mod__cparam-1]) {
ac_transformed_pencil_gss=-(AC_cp__mod__equationofstate-AC_cv__mod__equationofstate)*ac_transformed_pencil_glnrho
}
if (AC_lpencil__mod__cparam[AC_i_hss__mod__cparam-1]) {
ac_transformed_pencil_hss=-(AC_cp__mod__equationofstate-AC_cv__mod__equationofstate)*ac_transformed_pencil_hlnrho
}
if (AC_lpencil__mod__cparam[AC_i_pp__mod__cparam-1]) {
ac_transformed_pencil_pp=AC_gamma1__mod__equationofstate*ac_transformed_pencil_rho*AC_cs20__mod__equationofstate
}
if (AC_lpencil__mod__cparam[AC_i_rho1gpp__mod__cparam-1]) {
ac_transformed_pencil_rho1gpp.x = ac_transformed_pencil_cs2*ac_transformed_pencil_glnrho.x
ac_transformed_pencil_rho1gpp.y = ac_transformed_pencil_cs2*ac_transformed_pencil_glnrho.y
ac_transformed_pencil_rho1gpp.z = ac_transformed_pencil_cs2*ac_transformed_pencil_glnrho.z
}
}
else if (AC_leos_localisothermal__mod__equationofstate) {
if (AC_lpencil__mod__cparam[AC_i_cs2__mod__cparam-1]) {
ac_transformed_pencil_cs2=value(F_GLOBAL_CS2)
}
if (AC_lpencil__mod__cparam[AC_i_glntt__mod__cparam-1]) {
ac_transformed_pencil_glntt=value(F_GLOBAL_GLNTVEC)
}
if (AC_lpencil__mod__cparam[AC_i_pp__mod__cparam-1]) {
ac_transformed_pencil_pp=ac_transformed_pencil_rho*ac_transformed_pencil_cs2
}
}
else {
}
}
else if(AC_ieosvars__mod__equationofstate == AC_ipp_ss__mod__equationofstate) {
if (AC_lanelastic__mod__cparam) {
if (AC_lanelastic_lin__mod__equationofstate) {
ac_transformed_pencil_pp=value(F_PP)
ac_transformed_pencil_ss=value(F_SS)
ac_transformed_pencil_ttb=AC_cs20__mod__equationofstate*AC_cp1__mod__equationofstate*exp(AC_gamma__mod__equationofstate*value(F_SS_B)*AC_cp1__mod__equationofstate+AC_gamma_m1__mod__equationofstate*ac_transformed_pencil_lnrho)/AC_gamma_m1__mod__equationofstate
ac_transformed_pencil_cs2=AC_cp__mod__equationofstate*ac_transformed_pencil_ttb*AC_gamma_m1__mod__equationofstate
ac_transformed_pencil_tt1=1./ac_transformed_pencil_ttb
ac_transformed_pencil_rho_anel=(value(F_PP)/(value(F_RHO_B)*ac_transformed_pencil_cs2) - value(F_SS)*AC_cp1__mod__equationofstate)
}
else {
if (AC_lpencil__mod__cparam[AC_i_pp__mod__cparam-1]) {
ac_transformed_pencil_pp=value(F_PP)
}
if (AC_lpencil__mod__cparam[AC_i_ss__mod__cparam-1]) {
ac_transformed_pencil_ss=value(F_SS)
}
if (AC_lpencil__mod__cparam[AC_i_rho__mod__cparam-1]) {
ac_transformed_pencil_rho=value(F_RHO)
}
if (AC_lpencil__mod__cparam[AC_i_lnrho__mod__cparam-1]) {
ac_transformed_pencil_lnrho=log(ac_transformed_pencil_rho)
}
if (AC_lpencil__mod__cparam[AC_i_cs2__mod__cparam-1]) {
ac_transformed_pencil_cs2=AC_gamma__mod__equationofstate*ac_transformed_pencil_pp/ac_transformed_pencil_rho
}
if (AC_lpencil__mod__cparam[AC_i_lntt__mod__cparam-1]) {
ac_transformed_pencil_lntt=AC_lntt0__mod__equationofstate+AC_cv1__mod__equationofstate*ac_transformed_pencil_ss+AC_gamma_m1__mod__equationofstate*(ac_transformed_pencil_lnrho-AC_lnrho0__mod__equationofstate)
}
if (AC_lpencil__mod__cparam[AC_i_ee__mod__cparam-1]) {
ac_transformed_pencil_ee=AC_cv__mod__equationofstate*exp(ac_transformed_pencil_lntt)
}
if (AC_lpencil__mod__cparam[AC_i_yh__mod__cparam-1]) {
ac_transformed_pencil_yh=AC_impossible__mod__cparam
}
if (AC_lpencil__mod__cparam[AC_i_tt__mod__cparam-1]) {
ac_transformed_pencil_tt=exp(ac_transformed_pencil_lntt)
}
if (AC_lpencil__mod__cparam[AC_i_tt1__mod__cparam-1]) {
ac_transformed_pencil_tt1=exp(-ac_transformed_pencil_lntt)
}
}
}
if (AC_leos_isentropic__mod__equationofstate) {
if (AC_lpencil__mod__cparam[AC_i_ss__mod__cparam-1]) {
ac_transformed_pencil_ss=0.0
}
if (AC_lpencil__mod__cparam[AC_i_lnrho__mod__cparam-1]) {
ac_transformed_pencil_lnrho=log(AC_gamma__mod__equationofstate*ac_transformed_pencil_pp/(AC_rho0__mod__equationofstate*AC_cs20__mod__equationofstate))/AC_gamma__mod__equationofstate
}
if (AC_lpencil__mod__cparam[AC_i_rho__mod__cparam-1]) {
ac_transformed_pencil_rho=exp(log(AC_gamma__mod__equationofstate*ac_transformed_pencil_pp/(AC_rho0__mod__equationofstate*AC_cs20__mod__equationofstate))/AC_gamma__mod__equationofstate)
}
if (AC_lpencil__mod__cparam[AC_i_tt__mod__cparam-1]) {
ac_transformed_pencil_tt=pow((ac_transformed_pencil_pp/AC_pp0__mod__equationofstate),(1.-AC_gamma1__mod__equationofstate))
}
if (AC_lpencil__mod__cparam[AC_i_lntt__mod__cparam-1]) {
ac_transformed_pencil_lntt=(1.-AC_gamma1__mod__equationofstate)*log(AC_gamma__mod__equationofstate*ac_transformed_pencil_pp/(AC_rho0__mod__equationofstate*AC_cs0__mod__equationofstate))
}
if (AC_lpencil__mod__cparam[AC_i_cs2__mod__cparam-1]) {
ac_transformed_pencil_cs2=AC_cs20__mod__equationofstate*pow((ac_transformed_pencil_pp/AC_pp0__mod__equationofstate),(1.-AC_gamma1__mod__equationofstate))
}
}
else if (AC_leos_isothermal__mod__equationofstate) {
if (AC_lpencil__mod__cparam[AC_i_lnrho__mod__cparam-1]) {
ac_transformed_pencil_lnrho=log(AC_gamma__mod__equationofstate*ac_transformed_pencil_pp/(AC_cs20__mod__equationofstate*AC_rho0__mod__equationofstate))-ac_transformed_pencil_lntt
}
if (AC_lpencil__mod__cparam[AC_i_rho__mod__cparam-1]) {
ac_transformed_pencil_rho=exp(ac_transformed_pencil_lnrho)
}
if (AC_lpencil__mod__cparam[AC_i_cs2__mod__cparam-1]) {
ac_transformed_pencil_cs2=AC_cs20__mod__equationofstate
}
if (AC_lpencil__mod__cparam[AC_i_lntt__mod__cparam-1]) {
ac_transformed_pencil_lntt=AC_lntt0__mod__equationofstate
}
if (AC_lpencil__mod__cparam[AC_i_glntt__mod__cparam-1]) {
ac_transformed_pencil_glntt.x = 0.0
ac_transformed_pencil_glntt.y = 0.0
ac_transformed_pencil_glntt.z = 0.0
}
if (AC_lpencil__mod__cparam[AC_i_hlntt__mod__cparam-1]) {
ac_transformed_pencil_hlntt=0.0
}
if (AC_lpencil__mod__cparam[AC_i_del2lntt__mod__cparam-1]) {
ac_transformed_pencil_del2lntt=0.0
}
}
else if (AC_leos_localisothermal__mod__equationofstate) {
}
}
else if(AC_ieosvars__mod__equationofstate == AC_ipp_cs2__mod__equationofstate) {
if (AC_leos_isentropic__mod__equationofstate) {
}
else if (AC_leos_isothermal__mod__equationofstate) {
if (AC_lanelastic__mod__cparam) {
if (AC_lanelastic_lin__mod__equationofstate) {
ac_transformed_pencil_pp=value(F_PP)
ac_transformed_pencil_rho_anel=value(F_PP)/(value(F_RHO_B)*AC_cs20__mod__equationofstate)
}
else {
ac_transformed_pencil_pp=value(F_PP)
}
}
else {
if (AC_lpencil__mod__cparam[AC_i_cs2__mod__cparam-1]) {
ac_transformed_pencil_cs2=AC_cs20__mod__equationofstate
}
if (AC_lpencil__mod__cparam[AC_i_lnrho__mod__cparam-1]) {
ac_transformed_pencil_lnrho=log(ac_transformed_pencil_pp/AC_cs20__mod__equationofstate)
}
if (AC_lpencil__mod__cparam[AC_i_rho__mod__cparam-1]) {
ac_transformed_pencil_rho=(ac_transformed_pencil_pp/AC_cs20__mod__equationofstate)
}
if (AC_lpencil__mod__cparam[AC_i_lntt__mod__cparam-1]) {
ac_transformed_pencil_lntt=AC_lntt0__mod__equationofstate
}
if (AC_lpencil__mod__cparam[AC_i_glntt__mod__cparam-1]) {
ac_transformed_pencil_glntt.x = 0.0
ac_transformed_pencil_glntt.y = 0.0
ac_transformed_pencil_glntt.z = 0.0
}
if (AC_lpencil__mod__cparam[AC_i_hlntt__mod__cparam-1]) {
ac_transformed_pencil_hlntt=0.0
}
if (AC_lpencil__mod__cparam[AC_i_del2lntt__mod__cparam-1]) {
ac_transformed_pencil_del2lntt=0.0
}
}
}
else if (AC_leos_localisothermal__mod__equationofstate) {
}
if (AC_lpencil__mod__cparam[AC_i_ee__mod__cparam-1]) {
if (AC_gamma_m1__mod__equationofstate!=0.0) {
ac_transformed_pencil_ee=(AC_gamma1__mod__equationofstate/AC_gamma_m1__mod__equationofstate)*ac_transformed_pencil_cs2
}
else {
ac_transformed_pencil_ee=ac_transformed_pencil_cs2
}
}
if (AC_lpencil__mod__cparam[AC_i_yh__mod__cparam-1]) {
ac_transformed_pencil_yh=AC_impossible__mod__cparam
}
if (AC_lpencil__mod__cparam[AC_i_tt__mod__cparam-1]) {
ac_transformed_pencil_tt=exp(ac_transformed_pencil_lntt)
}
if (AC_lpencil__mod__cparam[AC_i_tt1__mod__cparam-1]) {
ac_transformed_pencil_tt1=exp(-ac_transformed_pencil_lntt)
}
}
else if(AC_ieosvars__mod__equationofstate == AC_irho_eth__mod__equationofstate || AC_ieosvars__mod__equationofstate == AC_ilnrho_eth__mod__equationofstate) {
if (AC_lstratz__mod__cdata) {
if (AC_lpencil__mod__cparam[AC_i_eths__mod__cparam-1]) {
ac_transformed_pencil_eths = 1.0 + value(F_ETH)
}
if (AC_lpencil__mod__cparam[AC_i_geths__mod__cparam-1]) {
ac_transformed_pencil_geths = gradient(Field(AC_ieth__mod__cdata))
}
if (AC_lpencil__mod__cparam[AC_i_eth__mod__cparam-1]) {
ac_transformed_pencil_eth = AC_eth0z__mod__equationofstate[AC_n__mod__cdata-1] * ac_transformed_pencil_eths
}
}
else {
if (AC_lpencil__mod__cparam[AC_i_eth__mod__cparam-1]) {
ac_transformed_pencil_eth = value(F_ETH)
}
if (AC_lpencil__mod__cparam[AC_i_geth__mod__cparam-1]) {
ac_transformed_pencil_geth = gradient(Field(AC_ieth__mod__cdata))
}
if (AC_lpencil__mod__cparam[AC_i_del2eth__mod__cparam-1]) {
ac_transformed_pencil_del2eth = laplace(Field(AC_ieth__mod__cdata))
}
}
if (AC_lpencil__mod__cparam[AC_i_cs2__mod__cparam-1]) {
ac_transformed_pencil_cs2=AC_gamma__mod__equationofstate*AC_gamma_m1__mod__equationofstate*ac_transformed_pencil_eth*ac_transformed_pencil_rho1
}
if (AC_lpencil__mod__cparam[AC_i_pp__mod__cparam-1]) {
ac_transformed_pencil_pp=AC_gamma_m1__mod__equationofstate*ac_transformed_pencil_eth
}
if (AC_lpencil__mod__cparam[AC_i_ee__mod__cparam-1]) {
ac_transformed_pencil_ee=ac_transformed_pencil_rho1*ac_transformed_pencil_eth
}
if (AC_lpencil__mod__cparam[AC_i_tt__mod__cparam-1]) {
ac_transformed_pencil_tt=ac_transformed_pencil_cv1*ac_transformed_pencil_rho1*ac_transformed_pencil_eth
}
if (AC_lpencil__mod__cparam[AC_i_lntt__mod__cparam-1]) {
ac_transformed_pencil_lntt=log(ac_transformed_pencil_tt)
}
if (AC_lpencil__mod__cparam[AC_i_tt1__mod__cparam-1]) {
ac_transformed_pencil_tt1=1/ac_transformed_pencil_tt
}
if (AC_lpencil__mod__cparam[AC_i_gtt__mod__cparam-1] || AC_lpencil__mod__cparam[AC_i_glntt__mod__cparam-1]) {
ac_transformed_pencil_gtt.x=ac_transformed_pencil_rho1*(ac_transformed_pencil_cv1*ac_transformed_pencil_geth.x-ac_transformed_pencil_tt*ac_transformed_pencil_grho.x)
ac_transformed_pencil_glntt.x=ac_transformed_pencil_tt1*ac_transformed_pencil_gtt.x
ac_transformed_pencil_gtt.y=ac_transformed_pencil_rho1*(ac_transformed_pencil_cv1*ac_transformed_pencil_geth.y-ac_transformed_pencil_tt*ac_transformed_pencil_grho.y)
ac_transformed_pencil_glntt.y=ac_transformed_pencil_tt1*ac_transformed_pencil_gtt.y
ac_transformed_pencil_gtt.z=ac_transformed_pencil_rho1*(ac_transformed_pencil_cv1*ac_transformed_pencil_geth.z-ac_transformed_pencil_tt*ac_transformed_pencil_grho.z)
ac_transformed_pencil_glntt.z=ac_transformed_pencil_tt1*ac_transformed_pencil_gtt.z
}
if (AC_lpencil__mod__cparam[AC_i_del2tt__mod__cparam-1]) {
ac_transformed_pencil_del2tt=ac_transformed_pencil_rho1*(ac_transformed_pencil_cv1*ac_transformed_pencil_del2eth-ac_transformed_pencil_tt*ac_transformed_pencil_del2rho-2*sum(ac_transformed_pencil_grho*ac_transformed_pencil_gtt))
}
}
else {
}
if (AC_lcs_as_aux__mod__equationofstate || AC_lcs_as_comaux__mod__equationofstate) {
DF_CS=sqrt(ac_transformed_pencil_cs2)
}
if (AC_lpencil__mod__cparam[AC_i_shock__mod__cparam-1]) {
ac_transformed_pencil_shock=0.
}
if (AC_lpencil__mod__cparam[AC_i_gshock__mod__cparam-1]) {
ac_transformed_pencil_gshock.x = 0.
ac_transformed_pencil_gshock.y = 0.
ac_transformed_pencil_gshock.z = 0.
}
if (AC_lpencil__mod__cparam[AC_i_ma2__mod__cparam-1]) {
ac_transformed_pencil_ma2=ac_transformed_pencil_u2/ac_transformed_pencil_cs2
}
if (AC_lpencil__mod__cparam[AC_i_ugss__mod__cparam-1]) {
ac_transformed_pencil_ugss = dot(ac_transformed_pencil_uu,ac_transformed_pencil_gss)
if (AC_lupw_ss__mod__energy) ac_transformed_pencil_ugss = ac_transformed_pencil_ugss - del6_upwd(Field(AC_iss__mod__cdata))
if (AC_lreference_state__mod__cdata) {
ac_transformed_pencil_ugss = ac_transformed_pencil_ugss + ac_transformed_pencil_uu.x*AC_reference_state__mod__density[vertexIdx.x][AC_iref_gs__mod__cparam-1]
}
}
if (AC_lpencil__mod__cparam[AC_i_uglntt__mod__cparam-1]) {
ac_transformed_pencil_uglntt = dot(ac_transformed_pencil_uu,ac_transformed_pencil_glntt)
if (AC_lupw_ss__mod__energy) ac_transformed_pencil_uglntt = ac_transformed_pencil_uglntt - del6_upwd(Field(AC_iss__mod__cdata))
}
if (AC_lpencil__mod__cparam[AC_i_sglntt__mod__cparam-1]) {
ac_transformed_pencil_sglntt = ac_transformed_pencil_sij*ac_transformed_pencil_glntt
}
if (AC_lpencil__mod__cparam[AC_i_fpres__mod__cparam-1]) {
if (AC_lfpres_from_pressure__mod__energy) {
ac_transformed_pencil_fpres = gradient(Field(AC_ippaux__mod__energy))
ac_transformed_pencil_fpres.x=-ac_transformed_pencil_rho1*ac_transformed_pencil_fpres.x
ac_transformed_pencil_fpres.y=-ac_transformed_pencil_rho1*ac_transformed_pencil_fpres.y
ac_transformed_pencil_fpres.z=-ac_transformed_pencil_rho1*ac_transformed_pencil_fpres.z
}
else {
if (AC_leos_idealgas__mod__cparam) {
ac_transformed_pencil_fpres.x=-ac_transformed_pencil_cs2*(ac_transformed_pencil_glnrho.x + ac_transformed_pencil_glntt.x)*AC_gamma1__mod__energy
ac_transformed_pencil_fpres.y=-ac_transformed_pencil_cs2*(ac_transformed_pencil_glnrho.y + ac_transformed_pencil_glntt.y)*AC_gamma1__mod__energy
ac_transformed_pencil_fpres.z=-ac_transformed_pencil_cs2*(ac_transformed_pencil_glnrho.z + ac_transformed_pencil_glntt.z)*AC_gamma1__mod__energy
}
else {
ac_transformed_pencil_fpres.x=-ac_transformed_pencil_cs2*(ac_transformed_pencil_glnrho.x + ac_transformed_pencil_cp1tilde*ac_transformed_pencil_gss.x)
ac_transformed_pencil_fpres.y=-ac_transformed_pencil_cs2*(ac_transformed_pencil_glnrho.y + ac_transformed_pencil_cp1tilde*ac_transformed_pencil_gss.y)
ac_transformed_pencil_fpres.z=-ac_transformed_pencil_cs2*(ac_transformed_pencil_glnrho.z + ac_transformed_pencil_cp1tilde*ac_transformed_pencil_gss.z)
}
}
}
if (AC_lpencil__mod__cparam[AC_i_transprhos__mod__cparam-1] && AC_ldensity_nolog__mod__cdata) {
if (AC_lreference_state__mod__cdata) {
ac_transformed_pencil_transprhos = AC_impossible__mod__cparam
}
else {
ac_transformed_pencil_transprhos = AC_impossible__mod__cparam
}
}
if (AC_lpencil__mod__cparam[AC_i_initlnrho__mod__cparam-1] && AC_iglobal_lnrho0__mod__cdata!=0) {
ac_transformed_pencil_initlnrho=value(F_GLOBAL_LNRHO0)
}
if (AC_lpencil__mod__cparam[AC_i_initss__mod__cparam-1] && AC_iglobal_ss0__mod__cdata!=0) {
ac_transformed_pencil_initss=value(F_GLOBAL_SS0)
}
ac_transformed_pencil_uuadvec_gss = dot(ac_transformed_pencil_uu_advec,ac_transformed_pencil_gss)
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
if (AC_lhydro__mod__cparam && AC_ldensity__mod__cparam) {
if (AC_lreduced_sound_speed__mod__density) {
if (AC_lscale_to_cs2top__mod__density) {
ac_transformed_pencil_advec_cs2=AC_reduce_cs2__mod__density*AC_cs2top__mod__equationofstate*dxyz_2__mod__cdata
}
else {
ac_transformed_pencil_advec_cs2=AC_reduce_cs2__mod__density*ac_transformed_pencil_cs2*dxyz_2__mod__cdata
}
}
else {
ac_transformed_pencil_advec_cs2=ac_transformed_pencil_cs2*dxyz_2__mod__cdata
}
}
}
ac_transformed_pencil_fvisc.x = 0.0
ac_transformed_pencil_fvisc.y = 0.0
ac_transformed_pencil_fvisc.z = 0.0
if (AC_lpencil__mod__cparam[AC_i_visc_heat__mod__cparam-1]) {
ac_transformed_pencil_visc_heat=0.0
}
ldiffus_total_64_103 = AC_lfirst__mod__cdata  &&  AC_ldt__mod__cdata  ||  AC_lpencil__mod__cparam[AC_i_diffus_total__mod__cparam-1]
ldiffus_total3_64_103 = AC_lfirst__mod__cdata  &&  AC_ldt__mod__cdata  ||  AC_lpencil__mod__cparam[AC_i_diffus_total3__mod__cparam-1]
if (ldiffus_total_64_103 || ldiffus_total3_64_103) {
ac_transformed_pencil_diffus_total=0.0
ac_transformed_pencil_diffus_total2=0.0
ac_transformed_pencil_diffus_total3=0.0
}
if (! AC_limplicit_viscosity__mod__viscosity  &&  AC_lvisc_simplified__mod__viscosity) {
ac_transformed_pencil_fvisc=ac_transformed_pencil_fvisc+AC_nu__mod__viscosity*ac_transformed_pencil_del2u
if (AC_lpencil__mod__cparam[AC_i_visc_heat__mod__cparam-1]) {
if (AC_lboussinesq__mod__cparam) {
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat+2.*AC_nu__mod__viscosity*ac_transformed_pencil_sij2
}
else {
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat+AC_nu__mod__viscosity*ac_transformed_pencil_o2
}
}
if (ldiffus_total_64_103) {
ac_transformed_pencil_diffus_total=ac_transformed_pencil_diffus_total+AC_nu__mod__viscosity
}
}
if (AC_lvisc_nu_non_newtonian__mod__viscosity) {
deljskl2_64_103.x = 0.
deljskl2_64_103.y = 0.
deljskl2_64_103.z = 0.
gradnu_effective_64_103=0.
deljskl2_64_103 .x = deljskl2_64_103 .x +  ac_transformed_pencil_uijk[1][1][1]*ac_transformed_pencil_sij[1-1][1-1] + ac_transformed_pencil_uijk[1][1][1]*ac_transformed_pencil_sij[1-1][1-1]
deljskl2_64_103 .x = deljskl2_64_103 .x +  ac_transformed_pencil_uijk[1][2][1]*ac_transformed_pencil_sij[2-1][1-1] + ac_transformed_pencil_uijk[2][1][1]*ac_transformed_pencil_sij[1-1][2-1]
deljskl2_64_103 .x = deljskl2_64_103 .x +  ac_transformed_pencil_uijk[1][3][1]*ac_transformed_pencil_sij[3-1][1-1] + ac_transformed_pencil_uijk[3][1][1]*ac_transformed_pencil_sij[1-1][3-1]
deljskl2_64_103 .x = deljskl2_64_103 .x +  ac_transformed_pencil_uijk[2][1][1]*ac_transformed_pencil_sij[1-1][2-1] + ac_transformed_pencil_uijk[1][2][1]*ac_transformed_pencil_sij[2-1][1-1]
deljskl2_64_103 .x = deljskl2_64_103 .x +  ac_transformed_pencil_uijk[2][2][1]*ac_transformed_pencil_sij[2-1][2-1] + ac_transformed_pencil_uijk[2][2][1]*ac_transformed_pencil_sij[2-1][2-1]
deljskl2_64_103 .x = deljskl2_64_103 .x +  ac_transformed_pencil_uijk[2][3][1]*ac_transformed_pencil_sij[3-1][2-1] + ac_transformed_pencil_uijk[3][2][1]*ac_transformed_pencil_sij[2-1][3-1]
deljskl2_64_103 .x = deljskl2_64_103 .x +  ac_transformed_pencil_uijk[3][1][1]*ac_transformed_pencil_sij[1-1][3-1] + ac_transformed_pencil_uijk[1][3][1]*ac_transformed_pencil_sij[3-1][1-1]
deljskl2_64_103 .x = deljskl2_64_103 .x +  ac_transformed_pencil_uijk[3][2][1]*ac_transformed_pencil_sij[2-1][3-1] + ac_transformed_pencil_uijk[2][3][1]*ac_transformed_pencil_sij[3-1][2-1]
deljskl2_64_103 .x = deljskl2_64_103 .x +  ac_transformed_pencil_uijk[3][3][1]*ac_transformed_pencil_sij[3-1][3-1] + ac_transformed_pencil_uijk[3][3][1]*ac_transformed_pencil_sij[3-1][3-1]
deljskl2_64_103 .y = deljskl2_64_103 .y +  ac_transformed_pencil_uijk[1][1][2]*ac_transformed_pencil_sij[1-1][1-1] + ac_transformed_pencil_uijk[1][1][2]*ac_transformed_pencil_sij[1-1][1-1]
deljskl2_64_103 .y = deljskl2_64_103 .y +  ac_transformed_pencil_uijk[1][2][2]*ac_transformed_pencil_sij[2-1][1-1] + ac_transformed_pencil_uijk[2][1][2]*ac_transformed_pencil_sij[1-1][2-1]
deljskl2_64_103 .y = deljskl2_64_103 .y +  ac_transformed_pencil_uijk[1][3][2]*ac_transformed_pencil_sij[3-1][1-1] + ac_transformed_pencil_uijk[3][1][2]*ac_transformed_pencil_sij[1-1][3-1]
deljskl2_64_103 .y = deljskl2_64_103 .y +  ac_transformed_pencil_uijk[2][1][2]*ac_transformed_pencil_sij[1-1][2-1] + ac_transformed_pencil_uijk[1][2][2]*ac_transformed_pencil_sij[2-1][1-1]
deljskl2_64_103 .y = deljskl2_64_103 .y +  ac_transformed_pencil_uijk[2][2][2]*ac_transformed_pencil_sij[2-1][2-1] + ac_transformed_pencil_uijk[2][2][2]*ac_transformed_pencil_sij[2-1][2-1]
deljskl2_64_103 .y = deljskl2_64_103 .y +  ac_transformed_pencil_uijk[2][3][2]*ac_transformed_pencil_sij[3-1][2-1] + ac_transformed_pencil_uijk[3][2][2]*ac_transformed_pencil_sij[2-1][3-1]
deljskl2_64_103 .y = deljskl2_64_103 .y +  ac_transformed_pencil_uijk[3][1][2]*ac_transformed_pencil_sij[1-1][3-1] + ac_transformed_pencil_uijk[1][3][2]*ac_transformed_pencil_sij[3-1][1-1]
deljskl2_64_103 .y = deljskl2_64_103 .y +  ac_transformed_pencil_uijk[3][2][2]*ac_transformed_pencil_sij[2-1][3-1] + ac_transformed_pencil_uijk[2][3][2]*ac_transformed_pencil_sij[3-1][2-1]
deljskl2_64_103 .y = deljskl2_64_103 .y +  ac_transformed_pencil_uijk[3][3][2]*ac_transformed_pencil_sij[3-1][3-1] + ac_transformed_pencil_uijk[3][3][2]*ac_transformed_pencil_sij[3-1][3-1]
deljskl2_64_103 .z = deljskl2_64_103 .z +  ac_transformed_pencil_uijk[1][1][3]*ac_transformed_pencil_sij[1-1][1-1] + ac_transformed_pencil_uijk[1][1][3]*ac_transformed_pencil_sij[1-1][1-1]
deljskl2_64_103 .z = deljskl2_64_103 .z +  ac_transformed_pencil_uijk[1][2][3]*ac_transformed_pencil_sij[2-1][1-1] + ac_transformed_pencil_uijk[2][1][3]*ac_transformed_pencil_sij[1-1][2-1]
deljskl2_64_103 .z = deljskl2_64_103 .z +  ac_transformed_pencil_uijk[1][3][3]*ac_transformed_pencil_sij[3-1][1-1] + ac_transformed_pencil_uijk[3][1][3]*ac_transformed_pencil_sij[1-1][3-1]
deljskl2_64_103 .z = deljskl2_64_103 .z +  ac_transformed_pencil_uijk[2][1][3]*ac_transformed_pencil_sij[1-1][2-1] + ac_transformed_pencil_uijk[1][2][3]*ac_transformed_pencil_sij[2-1][1-1]
deljskl2_64_103 .z = deljskl2_64_103 .z +  ac_transformed_pencil_uijk[2][2][3]*ac_transformed_pencil_sij[2-1][2-1] + ac_transformed_pencil_uijk[2][2][3]*ac_transformed_pencil_sij[2-1][2-1]
deljskl2_64_103 .z = deljskl2_64_103 .z +  ac_transformed_pencil_uijk[2][3][3]*ac_transformed_pencil_sij[3-1][2-1] + ac_transformed_pencil_uijk[3][2][3]*ac_transformed_pencil_sij[2-1][3-1]
deljskl2_64_103 .z = deljskl2_64_103 .z +  ac_transformed_pencil_uijk[3][1][3]*ac_transformed_pencil_sij[1-1][3-1] + ac_transformed_pencil_uijk[1][3][3]*ac_transformed_pencil_sij[3-1][1-1]
deljskl2_64_103 .z = deljskl2_64_103 .z +  ac_transformed_pencil_uijk[3][2][3]*ac_transformed_pencil_sij[2-1][3-1] + ac_transformed_pencil_uijk[2][3][3]*ac_transformed_pencil_sij[3-1][2-1]
deljskl2_64_103 .z = deljskl2_64_103 .z +  ac_transformed_pencil_uijk[3][3][3]*ac_transformed_pencil_sij[3-1][3-1] + ac_transformed_pencil_uijk[3][3][3]*ac_transformed_pencil_sij[3-1][3-1]
fvisc_nnewton2_64_103.x = sum(ac_transformed_pencil_sij.row(1-1)*deljskl2_64_103)
fvisc_nnewton2_64_103.y = sum(ac_transformed_pencil_sij.row(2-1)*deljskl2_64_103)
fvisc_nnewton2_64_103.z = sum(ac_transformed_pencil_sij.row(3-1)*deljskl2_64_103)
if(AC_nnewton_type_int__mod__viscosity == AC_nnewton_type_int_carreu__mod__viscosity) {
ac_transformed_pencil_nu = AC_nu_infinity__mod__viscosity +  (AC_nu0__mod__viscosity-AC_nu_infinity__mod__viscosity)/pow((1+(AC_non_newton_lambda__mod__viscosity*AC_non_newton_lambda__mod__viscosity)*ac_transformed_pencil_sij2),((1.-AC_carreau_exponent__mod__viscosity)/2.))
gradnu_effective_64_103 = (AC_non_newton_lambda__mod__viscosity*AC_non_newton_lambda__mod__viscosity)*0.5*(AC_carreau_exponent__mod__viscosity-1.)*  (AC_nu0__mod__viscosity-AC_nu_infinity__mod__viscosity)/pow((1+(AC_non_newton_lambda__mod__viscosity*AC_non_newton_lambda__mod__viscosity)*ac_transformed_pencil_sij2),(1.5-AC_carreau_exponent__mod__viscosity/2.))
}
else if(AC_nnewton_type_int__mod__viscosity == AC_nnewton_type_int_step__mod__viscosity) {
step_vector_return_value_35_37_64_103 = 0.5*(1+tanh((ac_transformed_pencil_sij2-AC_nnewton_tscale__mod__viscosity*AC_nnewton_tscale__mod__viscosity)/(AC_nnewton_step_width__mod__viscosity+AC_tini__mod__cparam)))
ac_transformed_pencil_nu = AC_nu0__mod__viscosity+(AC_nu_infinity__mod__viscosity-AC_nu0__mod__viscosity)*step_vector_return_value_35_37_64_103
arg_36_37_64_103 = abs((ac_transformed_pencil_sij2-AC_nnewton_tscale__mod__viscosity*AC_nnewton_tscale__mod__viscosity)/(AC_nnewton_step_width__mod__viscosity+AC_tini__mod__cparam))
if (abs(arg_36_37_64_103)>=8.)  {
der_step_return_value_36_37_64_103 = 2./AC_nnewton_step_width__mod__viscosity*exp(-2.*abs(arg_36_37_64_103))
}
else {
der_step_return_value_36_37_64_103 = 0.5/(AC_nnewton_step_width__mod__viscosity*cosh(arg_36_37_64_103)*cosh(arg_36_37_64_103))
}
gradnu_effective_64_103 = (AC_nu_infinity__mod__viscosity-AC_nu0__mod__viscosity)*der_step_return_value_36_37_64_103
}
else {
}
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_nu*ac_transformed_pencil_del2u.x + gradnu_effective_64_103*fvisc_nnewton2_64_103.x
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_nu*ac_transformed_pencil_del2u.y + gradnu_effective_64_103*fvisc_nnewton2_64_103.y
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_nu*ac_transformed_pencil_del2u.z + gradnu_effective_64_103*fvisc_nnewton2_64_103.z
if (ldiffus_total_64_103) {
ac_transformed_pencil_diffus_total=ac_transformed_pencil_diffus_total+AC_nu__mod__viscosity
}
}
if (AC_lvisc_rho_nu_const__mod__viscosity) {
if (AC_lvisc_rho_nu_const_prefact__mod__viscosity) {
murho1_64_103=AC_nu__mod__viscosity
}
else {
murho1_64_103=AC_nu__mod__viscosity*ac_transformed_pencil_rho1
}
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x + murho1_64_103*(ac_transformed_pencil_del2u.x+1.0/3.0*ac_transformed_pencil_graddivu.x)
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y + murho1_64_103*(ac_transformed_pencil_del2u.y+1.0/3.0*ac_transformed_pencil_graddivu.y)
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_fvisc.z + murho1_64_103*(ac_transformed_pencil_del2u.z+1.0/3.0*ac_transformed_pencil_graddivu.z)
if (AC_lpencil__mod__cparam[AC_i_visc_heat__mod__cparam-1]) {
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat+2*murho1_64_103*ac_transformed_pencil_sij2
}
if (ldiffus_total_64_103) {
ac_transformed_pencil_diffus_total=ac_transformed_pencil_diffus_total+murho1_64_103
}
}
if (AC_lvisc_rho_nu_const_bulk__mod__viscosity) {
zetarho1_64_103=AC_zeta__mod__viscosity*ac_transformed_pencil_rho1
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x+zetarho1_64_103*ac_transformed_pencil_graddivu.x
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y+zetarho1_64_103*ac_transformed_pencil_graddivu.y
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_fvisc.z+zetarho1_64_103*ac_transformed_pencil_graddivu.z
if (AC_lpencil__mod__cparam[AC_i_visc_heat__mod__cparam-1]) {
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat+zetarho1_64_103*ac_transformed_pencil_divu*ac_transformed_pencil_divu
}
if (ldiffus_total_64_103) {
ac_transformed_pencil_diffus_total=ac_transformed_pencil_diffus_total+zetarho1_64_103
}
}
if (AC_lvisc_sqrtrho_nu_const__mod__viscosity) {
murho1_64_103=AC_nu__mod__viscosity*sqrt(ac_transformed_pencil_rho1)
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x + murho1_64_103*(ac_transformed_pencil_del2u.x+1.0/3.0*ac_transformed_pencil_graddivu.x + ac_transformed_pencil_sglnrho.x)
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y + murho1_64_103*(ac_transformed_pencil_del2u.y+1.0/3.0*ac_transformed_pencil_graddivu.y + ac_transformed_pencil_sglnrho.y)
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_fvisc.z + murho1_64_103*(ac_transformed_pencil_del2u.z+1.0/3.0*ac_transformed_pencil_graddivu.z + ac_transformed_pencil_sglnrho.z)
if (AC_lpencil__mod__cparam[AC_i_visc_heat__mod__cparam-1]) {
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat+2*murho1_64_103*ac_transformed_pencil_sij2
}
if (ldiffus_total_64_103) {
ac_transformed_pencil_diffus_total=ac_transformed_pencil_diffus_total+murho1_64_103
}
}
if (AC_lvisc_mu_cspeed__mod__viscosity) {
mutt_64_103=AC_nu__mod__viscosity*ac_transformed_pencil_rho1*exp(AC_nu_cspeed__mod__viscosity*ac_transformed_pencil_lntt)
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x + mutt_64_103*(ac_transformed_pencil_del2u.x+1.0/3.0*ac_transformed_pencil_graddivu.x+2*AC_nu_cspeed__mod__viscosity*ac_transformed_pencil_sglntt.x)
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y + mutt_64_103*(ac_transformed_pencil_del2u.y+1.0/3.0*ac_transformed_pencil_graddivu.y+2*AC_nu_cspeed__mod__viscosity*ac_transformed_pencil_sglntt.y)
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_fvisc.z + mutt_64_103*(ac_transformed_pencil_del2u.z+1.0/3.0*ac_transformed_pencil_graddivu.z+2*AC_nu_cspeed__mod__viscosity*ac_transformed_pencil_sglntt.z)
if (AC_lpencil__mod__cparam[AC_i_visc_heat__mod__cparam-1]) {
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat+2*mutt_64_103*ac_transformed_pencil_sij2
}
if (ldiffus_total_64_103) {
ac_transformed_pencil_diffus_total=ac_transformed_pencil_diffus_total+mutt_64_103
}
}
if (AC_lvisc_spitzer__mod__viscosity) {
if (AC_nu_spitzer_max__mod__viscosity != 0.0) {
tmp3_64_103=AC_nu_spitzer__mod__viscosity*ac_transformed_pencil_rho1*exp(2.5*ac_transformed_pencil_lntt)
mutt_64_103=AC_nu_spitzer_max__mod__viscosity*tmp3_64_103/sqrt(pow(AC_nu_spitzer_max__mod__viscosity,2.)+pow(tmp3_64_103,2.))
}
else {
mutt_64_103=AC_nu_spitzer__mod__viscosity*ac_transformed_pencil_rho1*exp(2.5*ac_transformed_pencil_lntt)
}
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x + mutt_64_103*(ac_transformed_pencil_del2u.x+1.0/3.0*ac_transformed_pencil_graddivu.x+5.*ac_transformed_pencil_sglntt.x)
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y + mutt_64_103*(ac_transformed_pencil_del2u.y+1.0/3.0*ac_transformed_pencil_graddivu.y+5.*ac_transformed_pencil_sglntt.y)
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_fvisc.z + mutt_64_103*(ac_transformed_pencil_del2u.z+1.0/3.0*ac_transformed_pencil_graddivu.z+5.*ac_transformed_pencil_sglntt.z)
if (AC_lpencil__mod__cparam[AC_i_visc_heat__mod__cparam-1]) {
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat+2*mutt_64_103*ac_transformed_pencil_sij2
}
if (ldiffus_total_64_103) {
ac_transformed_pencil_diffus_total=ac_transformed_pencil_diffus_total+mutt_64_103
}
}
if (AC_lvisc_nu_cspeed__mod__viscosity) {
mutt_64_103=AC_nu__mod__viscosity*exp(AC_nu_cspeed__mod__viscosity*ac_transformed_pencil_lntt)
if (AC_ldensity__mod__cparam) {
ac_transformed_pencil_fvisc.x =  ac_transformed_pencil_fvisc.x + 2*mutt_64_103*ac_transformed_pencil_sglnrho.x  + mutt_64_103*(ac_transformed_pencil_del2u.x + 1./3.*ac_transformed_pencil_graddivu.x + 2*AC_nu_cspeed__mod__viscosity*ac_transformed_pencil_sglntt.x)
ac_transformed_pencil_fvisc.y =  ac_transformed_pencil_fvisc.y + 2*mutt_64_103*ac_transformed_pencil_sglnrho.y  + mutt_64_103*(ac_transformed_pencil_del2u.y + 1./3.*ac_transformed_pencil_graddivu.y + 2*AC_nu_cspeed__mod__viscosity*ac_transformed_pencil_sglntt.y)
ac_transformed_pencil_fvisc.z =  ac_transformed_pencil_fvisc.z + 2*mutt_64_103*ac_transformed_pencil_sglnrho.z  + mutt_64_103*(ac_transformed_pencil_del2u.z + 1./3.*ac_transformed_pencil_graddivu.z + 2*AC_nu_cspeed__mod__viscosity*ac_transformed_pencil_sglntt.z)
}
else {
if (AC_lmeanfield_nu__mod__viscosity) {
if (AC_meanfield_nub__mod__viscosity!=0.) {
tmp_64_103 = mutt_64_103*ac_transformed_pencil_del2u+1./3.*ac_transformed_pencil_graddivu
ac_transformed_pencil_fvisc = (1./sqrt(1.+ac_transformed_pencil_b2/AC_meanfield_nub__mod__viscosity*AC_meanfield_nub__mod__viscosity))*(ac_transformed_pencil_fvisc+tmp_64_103)
}
}
else {
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x+mutt_64_103*(ac_transformed_pencil_del2u.x+1.0/3.0*ac_transformed_pencil_graddivu.x+ac_transformed_pencil_sglntt.x)
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y+mutt_64_103*(ac_transformed_pencil_del2u.y+1.0/3.0*ac_transformed_pencil_graddivu.y+ac_transformed_pencil_sglntt.y)
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_fvisc.z+mutt_64_103*(ac_transformed_pencil_del2u.z+1.0/3.0*ac_transformed_pencil_graddivu.z+ac_transformed_pencil_sglntt.z)
}
}
if (AC_lpencil__mod__cparam[AC_i_visc_heat__mod__cparam-1]) {
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat+2*mutt_64_103*ac_transformed_pencil_sij2
}
if (ldiffus_total_64_103) {
ac_transformed_pencil_diffus_total=ac_transformed_pencil_diffus_total+mutt_64_103
}
}
if (AC_lvisc_nu_const__mod__viscosity) {
if (AC_ldensity__mod__cparam) {
fac_64_103=AC_nu__mod__viscosity
if (AC_damp_sound__mod__viscosity!=0.) {
fac_64_103 = fac_64_103+AC_damp_sound__mod__viscosity*abs(ac_transformed_pencil_divu)
}
ac_transformed_pencil_fvisc.x = ac_transformed_pencil_fvisc.x + fac_64_103*(ac_transformed_pencil_del2u.x + 2.*ac_transformed_pencil_sglnrho.x + 1./3.*ac_transformed_pencil_graddivu.x)
ac_transformed_pencil_fvisc.y = ac_transformed_pencil_fvisc.y + fac_64_103*(ac_transformed_pencil_del2u.y + 2.*ac_transformed_pencil_sglnrho.y + 1./3.*ac_transformed_pencil_graddivu.y)
ac_transformed_pencil_fvisc.z = ac_transformed_pencil_fvisc.z + fac_64_103*(ac_transformed_pencil_del2u.z + 2.*ac_transformed_pencil_sglnrho.z + 1./3.*ac_transformed_pencil_graddivu.z)
}
else {
if (AC_lmeanfield_nu__mod__viscosity) {
if (AC_meanfield_nub__mod__viscosity!=0.) {
ac_transformed_pencil_fvisc = (1./sqrt(1.+ac_transformed_pencil_b2/AC_meanfield_nub__mod__viscosity*AC_meanfield_nub__mod__viscosity))*ac_transformed_pencil_fvisc+AC_nu__mod__viscosity*(ac_transformed_pencil_del2u+1./3.*ac_transformed_pencil_graddivu)
}
}
else {
ac_transformed_pencil_fvisc=ac_transformed_pencil_fvisc+AC_nu__mod__viscosity*(ac_transformed_pencil_del2u+1.0/3.0*ac_transformed_pencil_graddivu)
}
}
if (AC_lpencil__mod__cparam[AC_i_visc_heat__mod__cparam-1]) {
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat+2*AC_nu__mod__viscosity*ac_transformed_pencil_sij2
}
if (ldiffus_total_64_103) {
ac_transformed_pencil_diffus_total=ac_transformed_pencil_diffus_total+AC_nu__mod__viscosity
}
}
if (AC_lvisc_nu_tdep__mod__viscosity  ||  AC_lvisc_hyper3_simplified_tdep__mod__viscosity) {
ac_transformed_pencil_fvisc=ac_transformed_pencil_fvisc+2*AC_nu_tdep__mod__viscosity*ac_transformed_pencil_sglnrho+AC_nu_tdep__mod__viscosity*(ac_transformed_pencil_del2u+1./3.*ac_transformed_pencil_graddivu)
if (AC_lpencil__mod__cparam[AC_i_visc_heat__mod__cparam-1]) {
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat+2*AC_nu_tdep__mod__viscosity*ac_transformed_pencil_sij2
}
if (ldiffus_total_64_103) {
ac_transformed_pencil_diffus_total=ac_transformed_pencil_diffus_total+AC_nu_tdep__mod__viscosity
}
if (ldiffus_total3_64_103) {
ac_transformed_pencil_diffus_total3=ac_transformed_pencil_diffus_total3+AC_nu_tdep__mod__viscosity
}
}
if (AC_lvisc_mixture__mod__viscosity) {
sgradnu_64_103 = ac_transformed_pencil_sij*ac_transformed_pencil_gradnu
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_nu*(ac_transformed_pencil_del2u.x+1./3.*ac_transformed_pencil_graddivu.x) + 2*sgradnu_64_103.x
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_nu*(ac_transformed_pencil_del2u.y+1./3.*ac_transformed_pencil_graddivu.y) + 2*sgradnu_64_103.y
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_nu*(ac_transformed_pencil_del2u.z+1./3.*ac_transformed_pencil_graddivu.z) + 2*sgradnu_64_103.z
if (AC_ldensity__mod__cparam) {
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x + 2*ac_transformed_pencil_nu*ac_transformed_pencil_sglnrho.x
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y + 2*ac_transformed_pencil_nu*ac_transformed_pencil_sglnrho.y
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_fvisc.z + 2*ac_transformed_pencil_nu*ac_transformed_pencil_sglnrho.z
}
if (AC_lpencil__mod__cparam[AC_i_visc_heat__mod__cparam-1]) {
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat+2*ac_transformed_pencil_nu*ac_transformed_pencil_sij2
}
if (ldiffus_total_64_103) {
ac_transformed_pencil_diffus_total=ac_transformed_pencil_diffus_total+ac_transformed_pencil_nu
}
}
if (AC_lvisc_nu_profx__mod__viscosity || AC_lvisc_nu_profr__mod__viscosity) {
if (AC_lvisc_nu_profx__mod__viscosity) {
tmp3_64_103=AC_x__mod__cdata[vertexIdx.x]
}
if (AC_lvisc_nu_profr__mod__viscosity) {
if (AC_lspherical_coords__mod__cdata || AC_lsphere_in_a_box__mod__cdata) {
tmp3_64_103=ac_transformed_pencil_r_mn
}
else {
tmp3_64_103=ac_transformed_pencil_rcyl_mn
}
}
step_vector_return_value_38_64_103 = 0.5*(1+tanh((tmp3_64_103-AC_xnu__mod__viscosity)/(AC_widthnu__mod__viscosity+AC_tini__mod__cparam)))
step_vector_return_value_39_64_103 = 0.5*(1+tanh((tmp3_64_103-AC_xnu2__mod__viscosity)/(AC_widthnu__mod__viscosity+AC_tini__mod__cparam)))
pnu__mod__viscosity = AC_nu__mod__viscosity + (AC_nu__mod__viscosity*(AC_nu_jump__mod__viscosity-1.))*(step_vector_return_value_38_64_103  -  step_vector_return_value_39_64_103)
arg_40_64_103 = abs((tmp3_64_103-AC_xnu__mod__viscosity)/(AC_widthnu__mod__viscosity+AC_tini__mod__cparam))
if (abs(arg_40_64_103)>=8.)  {
der_step_return_value_40_64_103 = 2./AC_widthnu__mod__viscosity*exp(-2.*abs(arg_40_64_103))
}
else {
der_step_return_value_40_64_103 = 0.5/(AC_widthnu__mod__viscosity*cosh(arg_40_64_103)*cosh(arg_40_64_103))
}
arg_41_64_103 = abs((tmp3_64_103-AC_xnu2__mod__viscosity)/(AC_widthnu__mod__viscosity+AC_tini__mod__cparam))
if (abs(arg_41_64_103)>=8.)  {
der_step_return_value_41_64_103 = 2./AC_widthnu__mod__viscosity*exp(-2.*abs(arg_41_64_103))
}
else {
der_step_return_value_41_64_103 = 0.5/(AC_widthnu__mod__viscosity*cosh(arg_41_64_103)*cosh(arg_41_64_103))
}
tmp4_64_103 = (AC_nu__mod__viscosity*(AC_nu_jump__mod__viscosity-1.))*(der_step_return_value_40_64_103-der_step_return_value_41_64_103)
gradnu_64_103.x = 0.
gradnu_64_103.y = 0.
gradnu_64_103.z = 0.
if (AC_lvisc_nu_profx__mod__viscosity || (AC_lvisc_nu_profr__mod__viscosity && (AC_lcylindrical_coords__mod__cdata || AC_lspherical_coords__mod__cdata))) {
gradnu_64_103.x=tmp4_64_103
gradnu_64_103.y=0
gradnu_64_103.z=0
}
else if (AC_lvisc_nu_profr__mod__viscosity && AC_lcylinder_in_a_box__mod__cdata) {
gradnu_64_103.x=tmp4_64_103*AC_x__mod__cdata[vertexIdx.x]*ac_transformed_pencil_rcyl_mn1
gradnu_64_103.y=tmp4_64_103*AC_y__mod__cdata[AC_m__mod__cdata-1]*ac_transformed_pencil_rcyl_mn1
}
else if (AC_lvisc_nu_profr__mod__viscosity && AC_lsphere_in_a_box__mod__cdata) {
gradnu_64_103.x=tmp4_64_103*AC_x__mod__cdata[vertexIdx.x]*ac_transformed_pencil_r_mn1
gradnu_64_103.y=tmp4_64_103*AC_y__mod__cdata[AC_m__mod__cdata-1]*ac_transformed_pencil_r_mn1
gradnu_64_103.z=tmp4_64_103*AC_z__mod__cdata[AC_n__mod__cdata-1]*ac_transformed_pencil_r_mn1
}
sgradnu_64_103 = ac_transformed_pencil_sij*gradnu_64_103
tmp_64_103 = pnu__mod__viscosity*2*ac_transformed_pencil_sglnrho+ac_transformed_pencil_del2u+1./3.*ac_transformed_pencil_graddivu
ac_transformed_pencil_fvisc=ac_transformed_pencil_fvisc+tmp_64_103+2*sgradnu_64_103
if (AC_lpencil__mod__cparam[AC_i_visc_heat__mod__cparam-1]) {
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat+2*pnu__mod__viscosity*ac_transformed_pencil_sij2
}
if (ldiffus_total_64_103) {
ac_transformed_pencil_diffus_total=ac_transformed_pencil_diffus_total+pnu__mod__viscosity
}
}
if (AC_lvisc_nu_profr_powerlaw__mod__viscosity) {
if (!AC_luse_nu_rmn_prof__mod__viscosity) {
if (AC_nu_rcyl_min__mod__viscosity==AC_impossible__mod__cparam) {
pnu__mod__viscosity = AC_nu__mod__viscosity*pow((ac_transformed_pencil_rcyl_mn/AC_xnu__mod__viscosity),(-AC_pnlaw__mod__viscosity))
}
else {
pnu__mod__viscosity = AC_nu__mod__viscosity*pow((max(AC_nu_rcyl_min__mod__viscosity,ac_transformed_pencil_rcyl_mn)/AC_xnu__mod__viscosity),(-AC_pnlaw__mod__viscosity))
}
if (AC_lcylindrical_coords__mod__cdata) {
gradnu_64_103.x = -AC_pnlaw__mod__viscosity*AC_nu__mod__viscosity*pow((ac_transformed_pencil_rcyl_mn/AC_xnu__mod__viscosity),(-AC_pnlaw__mod__viscosity-1))*1/AC_xnu__mod__viscosity
gradnu_64_103.y = 0.
gradnu_64_103.z = 0.
}
else if (AC_lspherical_coords__mod__cdata) {
if (AC_nu_rcyl_min__mod__viscosity==AC_impossible__mod__cparam) {
gradnu_64_103.x = -AC_pnlaw__mod__viscosity*AC_nu__mod__viscosity*pow(ac_transformed_pencil_rcyl_mn,(-AC_pnlaw__mod__viscosity-1))*AC_sinth__mod__cdata[AC_m__mod__cdata-1]
gradnu_64_103.y = -AC_pnlaw__mod__viscosity*AC_nu__mod__viscosity*pow(ac_transformed_pencil_rcyl_mn,(-AC_pnlaw__mod__viscosity-1))*AC_costh__mod__cdata[AC_m__mod__cdata-1]
gradnu_64_103.z = 0.
}
else {
gradnu_64_103.x = -AC_pnlaw__mod__viscosity*AC_nu__mod__viscosity*pow(max(AC_nu_rcyl_min__mod__viscosity,ac_transformed_pencil_rcyl_mn),(-AC_pnlaw__mod__viscosity-1))*AC_sinth__mod__cdata[AC_m__mod__cdata-1]
gradnu_64_103.y = -AC_pnlaw__mod__viscosity*AC_nu__mod__viscosity*pow(max(AC_nu_rcyl_min__mod__viscosity,ac_transformed_pencil_rcyl_mn),(-AC_pnlaw__mod__viscosity-1))*AC_costh__mod__cdata[AC_m__mod__cdata-1]
gradnu_64_103.z = 0.
}
}
else {
}
}
else {
pnu__mod__viscosity = AC_nu__mod__viscosity*pow((ac_transformed_pencil_r_mn/AC_xnu__mod__viscosity),(-AC_pnlaw__mod__viscosity))
if (AC_lspherical_coords__mod__cdata) {
gradnu_64_103.x = -AC_pnlaw__mod__viscosity*AC_nu__mod__viscosity*pow((ac_transformed_pencil_r_mn/AC_xnu__mod__viscosity),(-AC_pnlaw__mod__viscosity-1))*1/AC_xnu__mod__viscosity
gradnu_64_103.y = 0.
gradnu_64_103.z = 0.
}
else {
}
}
sgradnu_64_103 = ac_transformed_pencil_sij*gradnu_64_103
tmp_64_103 = pnu__mod__viscosity*2*ac_transformed_pencil_sglnrho+ac_transformed_pencil_del2u+1./3.*ac_transformed_pencil_graddivu
ac_transformed_pencil_fvisc=ac_transformed_pencil_fvisc+tmp_64_103+2*sgradnu_64_103
if (AC_lpencil__mod__cparam[AC_i_visc_heat__mod__cparam-1]) {
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat+2*pnu__mod__viscosity*ac_transformed_pencil_sij2
}
if (ldiffus_total_64_103) {
ac_transformed_pencil_diffus_total=ac_transformed_pencil_diffus_total+pnu__mod__viscosity
}
}
if (AC_lvisc_nu_profr_twosteps__mod__viscosity) {
if (AC_lspherical_coords__mod__cdata || AC_lsphere_in_a_box__mod__cdata) {
tmp3_64_103=ac_transformed_pencil_r_mn
}
else {
tmp3_64_103=ac_transformed_pencil_rcyl_mn
}
step_vector_return_value_43_64_103 = 0.5*(1+tanh((tmp3_64_103-AC_xnu2__mod__viscosity)/(AC_widthnu2__mod__viscosity+AC_tini__mod__cparam)))
prof2_64_103    = step_vector_return_value_43_64_103
step_vector_return_value_44_64_103 = 0.5*(1+tanh((tmp3_64_103-AC_xnu__mod__viscosity)/(AC_widthnu__mod__viscosity+AC_tini__mod__cparam)))
prof_64_103     = step_vector_return_value_44_64_103-prof2_64_103
arg_45_64_103 = abs((tmp3_64_103-AC_xnu2__mod__viscosity)/(AC_widthnu2__mod__viscosity+AC_tini__mod__cparam))
if (abs(arg_45_64_103)>=8.)  {
der_step_return_value_45_64_103 = 2./AC_widthnu2__mod__viscosity*exp(-2.*abs(arg_45_64_103))
}
else {
der_step_return_value_45_64_103 = 0.5/(AC_widthnu2__mod__viscosity*cosh(arg_45_64_103)*cosh(arg_45_64_103))
}
derprof2_64_103 = der_step_return_value_45_64_103
arg_46_64_103 = abs((tmp3_64_103-AC_xnu__mod__viscosity)/(AC_widthnu__mod__viscosity+AC_tini__mod__cparam))
if (abs(arg_46_64_103)>=8.)  {
der_step_return_value_46_64_103 = 2./AC_widthnu__mod__viscosity*exp(-2.*abs(arg_46_64_103))
}
else {
der_step_return_value_46_64_103 = 0.5/(AC_widthnu__mod__viscosity*cosh(arg_46_64_103)*cosh(arg_46_64_103))
}
derprof_64_103  = der_step_return_value_46_64_103-derprof2_64_103
pnu__mod__viscosity  = AC_nu__mod__viscosity + (AC_nu__mod__viscosity*(AC_nu_jump__mod__viscosity-1.))*prof_64_103+(AC_nu__mod__viscosity*(AC_nu_jump2__mod__viscosity-1.))*prof2_64_103
tmp4_64_103 = AC_nu__mod__viscosity + (AC_nu__mod__viscosity*(AC_nu_jump__mod__viscosity-1.))*derprof_64_103+(AC_nu__mod__viscosity*(AC_nu_jump2__mod__viscosity-1.))*derprof2_64_103
gradnu_64_103.x = 0.
gradnu_64_103.y = 0.
gradnu_64_103.z = 0.
if (AC_lvisc_nu_profx__mod__viscosity || (AC_lvisc_nu_profr_twosteps__mod__viscosity && (AC_lcylindrical_coords__mod__cdata || AC_lspherical_coords__mod__cdata))) {
gradnu_64_103.x=tmp4_64_103
gradnu_64_103.y=0
gradnu_64_103.z=0
}
else if (AC_lvisc_nu_profr_twosteps__mod__viscosity && AC_lcylinder_in_a_box__mod__cdata) {
gradnu_64_103.x=tmp4_64_103*AC_x__mod__cdata[vertexIdx.x]*ac_transformed_pencil_rcyl_mn1
gradnu_64_103.y=tmp4_64_103*AC_y__mod__cdata[AC_m__mod__cdata-1]*ac_transformed_pencil_rcyl_mn1
}
else if (AC_lvisc_nu_profr_twosteps__mod__viscosity && AC_lsphere_in_a_box__mod__cdata) {
gradnu_64_103.x=tmp4_64_103*AC_x__mod__cdata[vertexIdx.x]*ac_transformed_pencil_r_mn1
gradnu_64_103.y=tmp4_64_103*AC_y__mod__cdata[AC_m__mod__cdata-1]*ac_transformed_pencil_r_mn1
gradnu_64_103.z=tmp4_64_103*AC_z__mod__cdata[AC_n__mod__cdata-1]*ac_transformed_pencil_r_mn1
}
sgradnu_64_103 = ac_transformed_pencil_sij*gradnu_64_103
tmp_64_103 = pnu__mod__viscosity*2*ac_transformed_pencil_sglnrho+ac_transformed_pencil_del2u+1./3.*ac_transformed_pencil_graddivu
ac_transformed_pencil_fvisc=ac_transformed_pencil_fvisc+tmp_64_103+2*sgradnu_64_103
if (AC_lpencil__mod__cparam[AC_i_visc_heat__mod__cparam-1]) {
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat+2*pnu__mod__viscosity*ac_transformed_pencil_sij2
}
if (ldiffus_total_64_103) {
ac_transformed_pencil_diffus_total=ac_transformed_pencil_diffus_total+pnu__mod__viscosity
}
}
if (AC_lvisc_nu_profy_bound__mod__viscosity) {
if (AC_lspherical_coords__mod__cdata || AC_lsphere_in_a_box__mod__cdata) {
tmp3_64_103=ac_transformed_pencil_r_mn
}
else if (AC_lcylindrical_coords__mod__cdata) {
tmp3_64_103=ac_transformed_pencil_rcyl_mn
}
else {
tmp3_64_103=1.0
}
tmp4_64_103    = AC_y__mod__cdata[AC_m__mod__cdata-1]
step_vector_return_value_48_64_103 = 0.5*(1+tanh((tmp4_64_103-AC_xyz1__mod__cdata.y-3*AC_dynu__mod__viscosity)/(AC_dynu__mod__viscosity+AC_tini__mod__cparam)))
step_vector_return_value_49_64_103 = 0.5*(1+tanh((tmp4_64_103-AC_xyz0__mod__cdata.y+3*AC_dynu__mod__viscosity)/(AC_dynu__mod__viscosity+AC_tini__mod__cparam)))
prof_64_103    =     step_vector_return_value_48_64_103 +     step_vector_return_value_49_64_103
arg_50_64_103 = abs((tmp4_64_103-AC_xyz1__mod__cdata.y-3*AC_dynu__mod__viscosity)/(AC_dynu__mod__viscosity+AC_tini__mod__cparam))
if (abs(arg_50_64_103)>=8.)  {
der_step_return_value_50_64_103 = 2./AC_dynu__mod__viscosity*exp(-2.*abs(arg_50_64_103))
}
else {
der_step_return_value_50_64_103 = 0.5/(AC_dynu__mod__viscosity*cosh(arg_50_64_103)*cosh(arg_50_64_103))
}
arg_51_64_103 = abs((tmp4_64_103-AC_xyz0__mod__cdata.y+3*AC_dynu__mod__viscosity)/(AC_dynu__mod__viscosity+AC_tini__mod__cparam))
if (abs(arg_51_64_103)>=8.)  {
der_step_return_value_51_64_103 = 2./AC_dynu__mod__viscosity*exp(-2.*abs(arg_51_64_103))
}
else {
der_step_return_value_51_64_103 = 0.5/(AC_dynu__mod__viscosity*cosh(arg_51_64_103)*cosh(arg_51_64_103))
}
derprof_64_103 = der_step_return_value_50_64_103 + der_step_return_value_51_64_103
pnu__mod__viscosity  = AC_nu__mod__viscosity + (AC_nu__mod__viscosity*(AC_nu_jump__mod__viscosity-1.))*prof_64_103
gradnu_64_103.x = 0.
gradnu_64_103.y = (AC_nu__mod__viscosity*(AC_nu_jump__mod__viscosity-1.))*derprof_64_103/tmp3_64_103
gradnu_64_103.z = 0.
sgradnu_64_103 = ac_transformed_pencil_sij*gradnu_64_103
tmp_64_103 = pnu__mod__viscosity*2*ac_transformed_pencil_sglnrho+ac_transformed_pencil_del2u+1./3.*ac_transformed_pencil_graddivu
ac_transformed_pencil_fvisc=ac_transformed_pencil_fvisc+tmp_64_103+2*sgradnu_64_103
if (AC_lpencil__mod__cparam[AC_i_visc_heat__mod__cparam-1]) {
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat+2*pnu__mod__viscosity*ac_transformed_pencil_sij2
}
if (ldiffus_total_64_103) {
ac_transformed_pencil_diffus_total=ac_transformed_pencil_diffus_total+pnu__mod__viscosity
}
}
if (AC_lvisc_nut_from_magnetic__mod__viscosity) {
pnu__mod__viscosity=AC_prm_turb__mod__viscosity*AC_etat_x__mod__magnetic_meanfield[vertexIdx.x-NGHOST_VAL]*AC_etat_y__mod__magnetic_meanfield[AC_m__mod__cdata-1]*AC_etat_z__mod__magnetic_meanfield[AC_n__mod__cdata-1]
gradnu_64_103.x=AC_prm_turb__mod__viscosity*AC_detat_x__mod__magnetic_meanfield[vertexIdx.x-NGHOST_VAL]*AC_etat_y__mod__magnetic_meanfield[AC_m__mod__cdata-1]*AC_etat_z__mod__magnetic_meanfield[AC_n__mod__cdata-1]
gradnu_64_103.y=AC_prm_turb__mod__viscosity*AC_etat_x__mod__magnetic_meanfield[vertexIdx.x-NGHOST_VAL]*AC_detat_y__mod__magnetic_meanfield[AC_m__mod__cdata-1]*AC_etat_z__mod__magnetic_meanfield[AC_n__mod__cdata-1]
gradnu_64_103.z=AC_prm_turb__mod__viscosity*AC_etat_x__mod__magnetic_meanfield[vertexIdx.x-NGHOST_VAL]*AC_etat_y__mod__magnetic_meanfield[AC_m__mod__cdata-1]*AC_detat_z__mod__magnetic_meanfield[AC_n__mod__cdata-1]
sgradnu_64_103 = ac_transformed_pencil_sij*gradnu_64_103
tmp_64_103 = pnu__mod__viscosity*2*ac_transformed_pencil_sglnrho+ac_transformed_pencil_del2u+1./3.*ac_transformed_pencil_graddivu
ac_transformed_pencil_fvisc=ac_transformed_pencil_fvisc+tmp_64_103+2*sgradnu_64_103
if (AC_lpencil__mod__cparam[AC_i_visc_heat__mod__cparam-1]) {
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat+2*pnu__mod__viscosity*ac_transformed_pencil_sij2
}
if (ldiffus_total_64_103) {
ac_transformed_pencil_diffus_total=ac_transformed_pencil_diffus_total+pnu__mod__viscosity
}
}
if (AC_lvisc_nu_prof__mod__viscosity) {
step_vector_return_value_52_64_103 = 0.5*(1+tanh((ac_transformed_pencil_z_mn-AC_znu__mod__viscosity)/(AC_widthnu__mod__viscosity+AC_tini__mod__cparam)))
pnu__mod__viscosity = AC_nu__mod__viscosity + (AC_nu__mod__viscosity*(AC_nu_jump__mod__viscosity-1.))*step_vector_return_value_52_64_103
gradnu_64_103.x = 0.
gradnu_64_103.y = 0.
arg_53_64_103 = abs((ac_transformed_pencil_z_mn-AC_znu__mod__viscosity)/(AC_widthnu__mod__viscosity+AC_tini__mod__cparam))
if (abs(arg_53_64_103)>=8.)  {
der_step_return_value_53_64_103 = 2./AC_widthnu__mod__viscosity*exp(-2.*abs(arg_53_64_103))
}
else {
der_step_return_value_53_64_103 = 0.5/(AC_widthnu__mod__viscosity*cosh(arg_53_64_103)*cosh(arg_53_64_103))
}
gradnu_64_103.z = (AC_nu__mod__viscosity*(AC_nu_jump__mod__viscosity-1.))*der_step_return_value_53_64_103
sgradnu_64_103 = ac_transformed_pencil_sij*gradnu_64_103
tmp_64_103 = pnu__mod__viscosity*2*ac_transformed_pencil_sglnrho+ac_transformed_pencil_del2u+1./3.*ac_transformed_pencil_graddivu
ac_transformed_pencil_fvisc=ac_transformed_pencil_fvisc+tmp_64_103+2*sgradnu_64_103
if (AC_lpencil__mod__cparam[AC_i_visc_heat__mod__cparam-1]) {
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat+2*pnu__mod__viscosity*ac_transformed_pencil_sij2
}
if (ldiffus_total_64_103) {
ac_transformed_pencil_diffus_total=ac_transformed_pencil_diffus_total+pnu__mod__viscosity
}
}
if (AC_lvisc_nu_shock__mod__viscosity) {
tmp2_64_103 = ac_transformed_pencil_divu*ac_transformed_pencil_glnrho
tmp_64_103=tmp2_64_103 + ac_transformed_pencil_graddivu
tmp2_64_103 = AC_nu_shock__mod__viscosity*ac_transformed_pencil_shock*tmp_64_103
tmp_64_103.x=tmp2_64_103.x+AC_nu_shock__mod__viscosity*ac_transformed_pencil_divu*ac_transformed_pencil_gshock.x
tmp_64_103.y=tmp2_64_103.y+AC_nu_shock__mod__viscosity*ac_transformed_pencil_divu*ac_transformed_pencil_gshock.y
tmp_64_103.z=tmp2_64_103.z+AC_nu_shock__mod__viscosity*ac_transformed_pencil_divu*ac_transformed_pencil_gshock.z
ac_transformed_pencil_fvisc=ac_transformed_pencil_fvisc+tmp_64_103
if (ldiffus_total_64_103) {
ac_transformed_pencil_diffus_total=ac_transformed_pencil_diffus_total+(AC_nu_shock__mod__viscosity*ac_transformed_pencil_shock)
}
if (AC_lpencil__mod__cparam[AC_i_visc_heat__mod__cparam-1] && AC_lshock_heat__mod__cdata) {
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat+AC_nu_shock__mod__viscosity*ac_transformed_pencil_shock*ac_transformed_pencil_divu*ac_transformed_pencil_divu
}
}
if (AC_lvisc_nu_shock_profz__mod__viscosity) {
step_vector_return_value_55_64_103 = 0.5*(1+tanh((ac_transformed_pencil_z_mn-AC_znu_shock__mod__viscosity)/(AC_widthnu_shock__mod__viscosity+AC_tini__mod__cparam)))
pnu_shock_64_103 = AC_nu_shock__mod__viscosity + (AC_nu_shock__mod__viscosity*(AC_nu_jump_shock__mod__viscosity-1.))*step_vector_return_value_55_64_103
gradnu_shock_64_103.x = 0.
gradnu_shock_64_103.y = 0.
arg_56_64_103 = abs((ac_transformed_pencil_z_mn-AC_znu_shock__mod__viscosity)/(AC_widthnu_shock__mod__viscosity+AC_tini__mod__cparam))
if (abs(arg_56_64_103)>=8.)  {
der_step_return_value_56_64_103 = 2./AC_widthnu_shock__mod__viscosity*exp(-2.*abs(arg_56_64_103))
}
else {
der_step_return_value_56_64_103 = 0.5/(AC_widthnu_shock__mod__viscosity*cosh(arg_56_64_103)*cosh(arg_56_64_103))
}
gradnu_shock_64_103.z = (AC_nu_shock__mod__viscosity*(AC_nu_jump_shock__mod__viscosity-1.))*der_step_return_value_56_64_103
tmp2_64_103 = ac_transformed_pencil_divu*ac_transformed_pencil_glnrho
tmp_64_103=tmp2_64_103 + ac_transformed_pencil_graddivu
tmp2_64_103 = pnu_shock_64_103*ac_transformed_pencil_shock*tmp_64_103
tmp_64_103.x=tmp2_64_103.x+pnu_shock_64_103*ac_transformed_pencil_divu*ac_transformed_pencil_gshock.x
tmp_64_103.y=tmp2_64_103.y+pnu_shock_64_103*ac_transformed_pencil_divu*ac_transformed_pencil_gshock.y
tmp_64_103.z=tmp2_64_103.z+pnu_shock_64_103*ac_transformed_pencil_divu*ac_transformed_pencil_gshock.z
tmp_64_103 = tmp_64_103 + ac_transformed_pencil_shock*ac_transformed_pencil_divu*gradnu_shock_64_103
ac_transformed_pencil_fvisc=ac_transformed_pencil_fvisc+tmp_64_103
if (ldiffus_total_64_103) {
ac_transformed_pencil_diffus_total=ac_transformed_pencil_diffus_total+(pnu_shock_64_103*ac_transformed_pencil_shock)
}
if (AC_lpencil__mod__cparam[AC_i_visc_heat__mod__cparam-1] && AC_lshock_heat__mod__cdata) {
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat+pnu_shock_64_103*ac_transformed_pencil_shock*ac_transformed_pencil_divu*ac_transformed_pencil_divu
}
}
if (AC_lvisc_nu_shock_profr__mod__viscosity) {
if (AC_lspherical_coords__mod__cdata || AC_lsphere_in_a_box__mod__cdata) {
tmp3_64_103=ac_transformed_pencil_r_mn
}
else {
tmp3_64_103=ac_transformed_pencil_rcyl_mn
}
step_vector_return_value_58_64_103 = 0.5*(1+tanh((tmp3_64_103-AC_xnu_shock__mod__viscosity)/(AC_widthnu_shock__mod__viscosity+AC_tini__mod__cparam)))
pnu_shock_64_103 = AC_nu_shock__mod__viscosity + (AC_nu_shock__mod__viscosity*(AC_nu_jump_shock__mod__viscosity-1.))*step_vector_return_value_58_64_103
arg_59_64_103 = abs((tmp3_64_103-AC_xnu_shock__mod__viscosity)/(AC_widthnu_shock__mod__viscosity+AC_tini__mod__cparam))
if (abs(arg_59_64_103)>=8.)  {
der_step_return_value_59_64_103 = 2./AC_widthnu_shock__mod__viscosity*exp(-2.*abs(arg_59_64_103))
}
else {
der_step_return_value_59_64_103 = 0.5/(AC_widthnu_shock__mod__viscosity*cosh(arg_59_64_103)*cosh(arg_59_64_103))
}
gradnu_shock_64_103.x = (AC_nu_shock__mod__viscosity*(AC_nu_jump_shock__mod__viscosity-1.))*der_step_return_value_59_64_103
gradnu_shock_64_103.y = 0.
gradnu_shock_64_103.z = 0.
tmp2_64_103 = ac_transformed_pencil_divu*ac_transformed_pencil_glnrho
tmp_64_103=tmp2_64_103 + ac_transformed_pencil_graddivu
tmp2_64_103 = pnu_shock_64_103*ac_transformed_pencil_shock*tmp_64_103
tmp_64_103.x=tmp2_64_103.x+pnu_shock_64_103*ac_transformed_pencil_divu*ac_transformed_pencil_gshock.x
tmp_64_103.y=tmp2_64_103.y+pnu_shock_64_103*ac_transformed_pencil_divu*ac_transformed_pencil_gshock.y
tmp_64_103.z=tmp2_64_103.z+pnu_shock_64_103*ac_transformed_pencil_divu*ac_transformed_pencil_gshock.z
tmp_64_103 = tmp_64_103 + ac_transformed_pencil_shock*ac_transformed_pencil_divu*gradnu_shock_64_103
ac_transformed_pencil_fvisc=ac_transformed_pencil_fvisc+tmp_64_103
if (ldiffus_total_64_103) {
ac_transformed_pencil_diffus_total=ac_transformed_pencil_diffus_total+(pnu_shock_64_103*ac_transformed_pencil_shock)
}
if (AC_lpencil__mod__cparam[AC_i_visc_heat__mod__cparam-1] && AC_lshock_heat__mod__cdata) {
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat+pnu_shock_64_103*ac_transformed_pencil_shock*ac_transformed_pencil_divu*ac_transformed_pencil_divu
}
}
if (AC_lvisc_shock_simple__mod__viscosity) {
tmp3_64_103 = dot(ac_transformed_pencil_gshock,ac_transformed_pencil_uij.row(1-1))
tmp_64_103.x = tmp3_64_103 + ac_transformed_pencil_shock * ac_transformed_pencil_del2u.x
tmp3_64_103 = dot(ac_transformed_pencil_gshock,ac_transformed_pencil_uij.row(2-1))
tmp_64_103.y = tmp3_64_103 + ac_transformed_pencil_shock * ac_transformed_pencil_del2u.y
tmp3_64_103 = dot(ac_transformed_pencil_gshock,ac_transformed_pencil_uij.row(3-1))
tmp_64_103.z = tmp3_64_103 + ac_transformed_pencil_shock * ac_transformed_pencil_del2u.z
ac_transformed_pencil_fvisc = ac_transformed_pencil_fvisc + AC_nu_shock__mod__viscosity * tmp_64_103
if (ldiffus_total_64_103) {
ac_transformed_pencil_diffus_total = ac_transformed_pencil_diffus_total + AC_nu_shock__mod__viscosity * ac_transformed_pencil_shock
}
}
if (AC_lvisc_hyper2_simplified__mod__viscosity) {
ac_transformed_pencil_fvisc=ac_transformed_pencil_fvisc-AC_nu_hyper2__mod__viscosity*ac_transformed_pencil_del4u
if (AC_lfirst__mod__cdata  &&  AC_ldt__mod__cdata) {
ac_transformed_pencil_diffus_total2=ac_transformed_pencil_diffus_total2+AC_nu_hyper2__mod__viscosity
}
}
if (AC_lvisc_hyper3_simplified__mod__viscosity) {
ac_transformed_pencil_fvisc=ac_transformed_pencil_fvisc+AC_nu_hyper3__mod__viscosity*ac_transformed_pencil_del6u
if (ldiffus_total3_64_103) {
ac_transformed_pencil_diffus_total3=ac_transformed_pencil_diffus_total3+AC_nu_hyper3__mod__viscosity
}
}
if (AC_lvisc_hyper2_simplified_tdep__mod__viscosity) {
ac_transformed_pencil_fvisc=ac_transformed_pencil_fvisc-AC_nu_tdep__mod__viscosity*ac_transformed_pencil_del4u
if (AC_lfirst__mod__cdata  &&  AC_ldt__mod__cdata) {
ac_transformed_pencil_diffus_total2=ac_transformed_pencil_diffus_total2+AC_nu_tdep__mod__viscosity
}
}
if (AC_lvisc_hyper3_simplified_tdep__mod__viscosity) {
ac_transformed_pencil_fvisc=ac_transformed_pencil_fvisc+AC_nu_tdep__mod__viscosity*ac_transformed_pencil_del6u
if (ldiffus_total3_64_103) {
ac_transformed_pencil_diffus_total3=ac_transformed_pencil_diffus_total3+AC_nu_tdep__mod__viscosity
}
}
if (AC_lvisc_hyper3_polar__mod__viscosity) {
ju_64_103=1+AC_iuu__mod__cdata-1
tmp3_64_103 = der6x_ignore_spacing(Field(ju_64_103))
ac_transformed_pencil_fvisc.x = ac_transformed_pencil_fvisc.x + AC_nu_hyper3__mod__viscosity*AC_pi4_1__mod__cparam*tmp3_64_103*dline_1__mod__cdata.x*dline_1__mod__cdata.x
tmp3_64_103 = der6y_ignore_spacing(Field(ju_64_103))
ac_transformed_pencil_fvisc.x = ac_transformed_pencil_fvisc.x + AC_nu_hyper3__mod__viscosity*AC_pi4_1__mod__cparam*tmp3_64_103*dline_1__mod__cdata.y*dline_1__mod__cdata.y
tmp3_64_103 = der6z_ignore_spacing(Field(ju_64_103))
ac_transformed_pencil_fvisc.x = ac_transformed_pencil_fvisc.x + AC_nu_hyper3__mod__viscosity*AC_pi4_1__mod__cparam*tmp3_64_103*dline_1__mod__cdata.z*dline_1__mod__cdata.z
ju_64_103=2+AC_iuu__mod__cdata-1
tmp3_64_103 = der6x_ignore_spacing(Field(ju_64_103))
ac_transformed_pencil_fvisc.y = ac_transformed_pencil_fvisc.y + AC_nu_hyper3__mod__viscosity*AC_pi4_1__mod__cparam*tmp3_64_103*dline_1__mod__cdata.x*dline_1__mod__cdata.x
tmp3_64_103 = der6y_ignore_spacing(Field(ju_64_103))
ac_transformed_pencil_fvisc.y = ac_transformed_pencil_fvisc.y + AC_nu_hyper3__mod__viscosity*AC_pi4_1__mod__cparam*tmp3_64_103*dline_1__mod__cdata.y*dline_1__mod__cdata.y
tmp3_64_103 = der6z_ignore_spacing(Field(ju_64_103))
ac_transformed_pencil_fvisc.y = ac_transformed_pencil_fvisc.y + AC_nu_hyper3__mod__viscosity*AC_pi4_1__mod__cparam*tmp3_64_103*dline_1__mod__cdata.z*dline_1__mod__cdata.z
ju_64_103=3+AC_iuu__mod__cdata-1
tmp3_64_103 = der6x_ignore_spacing(Field(ju_64_103))
ac_transformed_pencil_fvisc.z = ac_transformed_pencil_fvisc.z + AC_nu_hyper3__mod__viscosity*AC_pi4_1__mod__cparam*tmp3_64_103*dline_1__mod__cdata.x*dline_1__mod__cdata.x
tmp3_64_103 = der6y_ignore_spacing(Field(ju_64_103))
ac_transformed_pencil_fvisc.z = ac_transformed_pencil_fvisc.z + AC_nu_hyper3__mod__viscosity*AC_pi4_1__mod__cparam*tmp3_64_103*dline_1__mod__cdata.y*dline_1__mod__cdata.y
tmp3_64_103 = der6z_ignore_spacing(Field(ju_64_103))
ac_transformed_pencil_fvisc.z = ac_transformed_pencil_fvisc.z + AC_nu_hyper3__mod__viscosity*AC_pi4_1__mod__cparam*tmp3_64_103*dline_1__mod__cdata.z*dline_1__mod__cdata.z
if (ldiffus_total3_64_103) {
ac_transformed_pencil_diffus_total3=ac_transformed_pencil_diffus_total3+AC_nu_hyper3__mod__viscosity*AC_pi4_1__mod__cparam*dxmin_pencil__mod__cdata*dxmin_pencil__mod__cdata*dxmin_pencil__mod__cdata*dxmin_pencil__mod__cdata
}
}
if (AC_lvisc_hyper3_mesh__mod__viscosity) {
ju_64_103=1+AC_iuu__mod__cdata-1
tmp3_64_103 = der6x_ignore_spacing(Field(ju_64_103))
if (AC_ldynamical_diffusion__mod__cdata) {
ac_transformed_pencil_fvisc.x = ac_transformed_pencil_fvisc.x + AC_nu_hyper3_mesh__mod__viscosity * tmp3_64_103 * dline_1__mod__cdata.x
}
else {
ac_transformed_pencil_fvisc.x = ac_transformed_pencil_fvisc.x + AC_nu_hyper3_mesh__mod__viscosity*AC_pi5_1__mod__cparam/60.* tmp3_64_103 *dline_1__mod__cdata.x
}
tmp3_64_103 = der6y_ignore_spacing(Field(ju_64_103))
if (AC_ldynamical_diffusion__mod__cdata) {
ac_transformed_pencil_fvisc.x = ac_transformed_pencil_fvisc.x + AC_nu_hyper3_mesh__mod__viscosity * tmp3_64_103 * dline_1__mod__cdata.y
}
else {
ac_transformed_pencil_fvisc.x = ac_transformed_pencil_fvisc.x + AC_nu_hyper3_mesh__mod__viscosity*AC_pi5_1__mod__cparam/60.* tmp3_64_103 *dline_1__mod__cdata.y
}
tmp3_64_103 = der6z_ignore_spacing(Field(ju_64_103))
if (AC_ldynamical_diffusion__mod__cdata) {
ac_transformed_pencil_fvisc.x = ac_transformed_pencil_fvisc.x + AC_nu_hyper3_mesh__mod__viscosity * tmp3_64_103 * dline_1__mod__cdata.z
}
else {
ac_transformed_pencil_fvisc.x = ac_transformed_pencil_fvisc.x + AC_nu_hyper3_mesh__mod__viscosity*AC_pi5_1__mod__cparam/60.* tmp3_64_103 *dline_1__mod__cdata.z
}
ju_64_103=2+AC_iuu__mod__cdata-1
tmp3_64_103 = der6x_ignore_spacing(Field(ju_64_103))
if (AC_ldynamical_diffusion__mod__cdata) {
ac_transformed_pencil_fvisc.y = ac_transformed_pencil_fvisc.y + AC_nu_hyper3_mesh__mod__viscosity * tmp3_64_103 * dline_1__mod__cdata.x
}
else {
ac_transformed_pencil_fvisc.y = ac_transformed_pencil_fvisc.y + AC_nu_hyper3_mesh__mod__viscosity*AC_pi5_1__mod__cparam/60.* tmp3_64_103 *dline_1__mod__cdata.x
}
tmp3_64_103 = der6y_ignore_spacing(Field(ju_64_103))
if (AC_ldynamical_diffusion__mod__cdata) {
ac_transformed_pencil_fvisc.y = ac_transformed_pencil_fvisc.y + AC_nu_hyper3_mesh__mod__viscosity * tmp3_64_103 * dline_1__mod__cdata.y
}
else {
ac_transformed_pencil_fvisc.y = ac_transformed_pencil_fvisc.y + AC_nu_hyper3_mesh__mod__viscosity*AC_pi5_1__mod__cparam/60.* tmp3_64_103 *dline_1__mod__cdata.y
}
tmp3_64_103 = der6z_ignore_spacing(Field(ju_64_103))
if (AC_ldynamical_diffusion__mod__cdata) {
ac_transformed_pencil_fvisc.y = ac_transformed_pencil_fvisc.y + AC_nu_hyper3_mesh__mod__viscosity * tmp3_64_103 * dline_1__mod__cdata.z
}
else {
ac_transformed_pencil_fvisc.y = ac_transformed_pencil_fvisc.y + AC_nu_hyper3_mesh__mod__viscosity*AC_pi5_1__mod__cparam/60.* tmp3_64_103 *dline_1__mod__cdata.z
}
ju_64_103=3+AC_iuu__mod__cdata-1
tmp3_64_103 = der6x_ignore_spacing(Field(ju_64_103))
if (AC_ldynamical_diffusion__mod__cdata) {
ac_transformed_pencil_fvisc.z = ac_transformed_pencil_fvisc.z + AC_nu_hyper3_mesh__mod__viscosity * tmp3_64_103 * dline_1__mod__cdata.x
}
else {
ac_transformed_pencil_fvisc.z = ac_transformed_pencil_fvisc.z + AC_nu_hyper3_mesh__mod__viscosity*AC_pi5_1__mod__cparam/60.* tmp3_64_103 *dline_1__mod__cdata.x
}
tmp3_64_103 = der6y_ignore_spacing(Field(ju_64_103))
if (AC_ldynamical_diffusion__mod__cdata) {
ac_transformed_pencil_fvisc.z = ac_transformed_pencil_fvisc.z + AC_nu_hyper3_mesh__mod__viscosity * tmp3_64_103 * dline_1__mod__cdata.y
}
else {
ac_transformed_pencil_fvisc.z = ac_transformed_pencil_fvisc.z + AC_nu_hyper3_mesh__mod__viscosity*AC_pi5_1__mod__cparam/60.* tmp3_64_103 *dline_1__mod__cdata.y
}
tmp3_64_103 = der6z_ignore_spacing(Field(ju_64_103))
if (AC_ldynamical_diffusion__mod__cdata) {
ac_transformed_pencil_fvisc.z = ac_transformed_pencil_fvisc.z + AC_nu_hyper3_mesh__mod__viscosity * tmp3_64_103 * dline_1__mod__cdata.z
}
else {
ac_transformed_pencil_fvisc.z = ac_transformed_pencil_fvisc.z + AC_nu_hyper3_mesh__mod__viscosity*AC_pi5_1__mod__cparam/60.* tmp3_64_103 *dline_1__mod__cdata.z
}
if (ldiffus_total3_64_103) {
if (AC_ldynamical_diffusion__mod__cdata) {
ac_transformed_pencil_diffus_total3 = ac_transformed_pencil_diffus_total3 + AC_nu_hyper3_mesh__mod__viscosity
advec_hypermesh_uu_64_103 = 0.0
}
else {
advec_hypermesh_uu_64_103=AC_nu_hyper3_mesh__mod__viscosity*AC_pi5_1__mod__cparam*sqrt(dxyz_2__mod__cdata)
}
advec2_hypermesh__mod__cdata=advec2_hypermesh__mod__cdata+advec_hypermesh_uu_64_103*advec_hypermesh_uu_64_103
}
}
if (AC_lvisc_hyper3_mesh_residual__mod__viscosity) {
ju_64_103=1+AC_iuu__mod__cdata-1
if (AC_ldynamical_diffusion__mod__cdata) {
ac_transformed_pencil_fvisc.x = ac_transformed_pencil_fvisc.x + AC_nu_hyper3_mesh__mod__viscosity * sum(ac_transformed_pencil_der6u_res.col(1-1) * dline_1__mod__cdata)
}
else {
ac_transformed_pencil_fvisc.x = ac_transformed_pencil_fvisc.x + AC_nu_hyper3_mesh__mod__viscosity*AC_pi5_1__mod__cparam/60.*sum(ac_transformed_pencil_der6u_res.col(1-1)*dline_1__mod__cdata)
}
ju_64_103=2+AC_iuu__mod__cdata-1
if (AC_ldynamical_diffusion__mod__cdata) {
ac_transformed_pencil_fvisc.y = ac_transformed_pencil_fvisc.y + AC_nu_hyper3_mesh__mod__viscosity * sum(ac_transformed_pencil_der6u_res.col(2-1) * dline_1__mod__cdata)
}
else {
ac_transformed_pencil_fvisc.y = ac_transformed_pencil_fvisc.y + AC_nu_hyper3_mesh__mod__viscosity*AC_pi5_1__mod__cparam/60.*sum(ac_transformed_pencil_der6u_res.col(2-1)*dline_1__mod__cdata)
}
ju_64_103=3+AC_iuu__mod__cdata-1
if (AC_ldynamical_diffusion__mod__cdata) {
ac_transformed_pencil_fvisc.z = ac_transformed_pencil_fvisc.z + AC_nu_hyper3_mesh__mod__viscosity * sum(ac_transformed_pencil_der6u_res.col(3-1) * dline_1__mod__cdata)
}
else {
ac_transformed_pencil_fvisc.z = ac_transformed_pencil_fvisc.z + AC_nu_hyper3_mesh__mod__viscosity*AC_pi5_1__mod__cparam/60.*sum(ac_transformed_pencil_der6u_res.col(3-1)*dline_1__mod__cdata)
}
if (ldiffus_total3_64_103) {
if (AC_ldynamical_diffusion__mod__cdata) {
ac_transformed_pencil_diffus_total3 = ac_transformed_pencil_diffus_total3 + AC_nu_hyper3_mesh__mod__viscosity
advec_hypermesh_uu_64_103 = 0.0
}
else {
advec_hypermesh_uu_64_103=AC_nu_hyper3_mesh__mod__viscosity*AC_pi5_1__mod__cparam*sqrt(dxyz_2__mod__cdata)
}
advec2_hypermesh__mod__cdata=advec2_hypermesh__mod__cdata+advec_hypermesh_uu_64_103*advec_hypermesh_uu_64_103
}
}
if (AC_lvisc_hyper3_csmesh__mod__viscosity) {
ju_64_103=1+AC_iuu__mod__cdata-1
tmp3_64_103 = der6x_ignore_spacing(Field(ju_64_103))
if (AC_ldynamical_diffusion__mod__cdata) {
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x+AC_nu_hyper3_mesh__mod__viscosity*sqrt(ac_transformed_pencil_cs2)*tmp3_64_103*dline_1__mod__cdata.x
}
else {
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x+AC_nu_hyper3_mesh__mod__viscosity*sqrt(ac_transformed_pencil_cs2)*AC_pi5_1__mod__cparam/60.*tmp3_64_103*dline_1__mod__cdata.x
}
tmp3_64_103 = der6y_ignore_spacing(Field(ju_64_103))
if (AC_ldynamical_diffusion__mod__cdata) {
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x+AC_nu_hyper3_mesh__mod__viscosity*sqrt(ac_transformed_pencil_cs2)*tmp3_64_103*dline_1__mod__cdata.y
}
else {
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x+AC_nu_hyper3_mesh__mod__viscosity*sqrt(ac_transformed_pencil_cs2)*AC_pi5_1__mod__cparam/60.*tmp3_64_103*dline_1__mod__cdata.y
}
tmp3_64_103 = der6z_ignore_spacing(Field(ju_64_103))
if (AC_ldynamical_diffusion__mod__cdata) {
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x+AC_nu_hyper3_mesh__mod__viscosity*sqrt(ac_transformed_pencil_cs2)*tmp3_64_103*dline_1__mod__cdata.z
}
else {
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x+AC_nu_hyper3_mesh__mod__viscosity*sqrt(ac_transformed_pencil_cs2)*AC_pi5_1__mod__cparam/60.*tmp3_64_103*dline_1__mod__cdata.z
}
ju_64_103=2+AC_iuu__mod__cdata-1
tmp3_64_103 = der6x_ignore_spacing(Field(ju_64_103))
if (AC_ldynamical_diffusion__mod__cdata) {
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y+AC_nu_hyper3_mesh__mod__viscosity*sqrt(ac_transformed_pencil_cs2)*tmp3_64_103*dline_1__mod__cdata.x
}
else {
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y+AC_nu_hyper3_mesh__mod__viscosity*sqrt(ac_transformed_pencil_cs2)*AC_pi5_1__mod__cparam/60.*tmp3_64_103*dline_1__mod__cdata.x
}
tmp3_64_103 = der6y_ignore_spacing(Field(ju_64_103))
if (AC_ldynamical_diffusion__mod__cdata) {
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y+AC_nu_hyper3_mesh__mod__viscosity*sqrt(ac_transformed_pencil_cs2)*tmp3_64_103*dline_1__mod__cdata.y
}
else {
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y+AC_nu_hyper3_mesh__mod__viscosity*sqrt(ac_transformed_pencil_cs2)*AC_pi5_1__mod__cparam/60.*tmp3_64_103*dline_1__mod__cdata.y
}
tmp3_64_103 = der6z_ignore_spacing(Field(ju_64_103))
if (AC_ldynamical_diffusion__mod__cdata) {
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y+AC_nu_hyper3_mesh__mod__viscosity*sqrt(ac_transformed_pencil_cs2)*tmp3_64_103*dline_1__mod__cdata.z
}
else {
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y+AC_nu_hyper3_mesh__mod__viscosity*sqrt(ac_transformed_pencil_cs2)*AC_pi5_1__mod__cparam/60.*tmp3_64_103*dline_1__mod__cdata.z
}
ju_64_103=3+AC_iuu__mod__cdata-1
tmp3_64_103 = der6x_ignore_spacing(Field(ju_64_103))
if (AC_ldynamical_diffusion__mod__cdata) {
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_fvisc.z+AC_nu_hyper3_mesh__mod__viscosity*sqrt(ac_transformed_pencil_cs2)*tmp3_64_103*dline_1__mod__cdata.x
}
else {
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_fvisc.z+AC_nu_hyper3_mesh__mod__viscosity*sqrt(ac_transformed_pencil_cs2)*AC_pi5_1__mod__cparam/60.*tmp3_64_103*dline_1__mod__cdata.x
}
tmp3_64_103 = der6y_ignore_spacing(Field(ju_64_103))
if (AC_ldynamical_diffusion__mod__cdata) {
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_fvisc.z+AC_nu_hyper3_mesh__mod__viscosity*sqrt(ac_transformed_pencil_cs2)*tmp3_64_103*dline_1__mod__cdata.y
}
else {
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_fvisc.z+AC_nu_hyper3_mesh__mod__viscosity*sqrt(ac_transformed_pencil_cs2)*AC_pi5_1__mod__cparam/60.*tmp3_64_103*dline_1__mod__cdata.y
}
tmp3_64_103 = der6z_ignore_spacing(Field(ju_64_103))
if (AC_ldynamical_diffusion__mod__cdata) {
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_fvisc.z+AC_nu_hyper3_mesh__mod__viscosity*sqrt(ac_transformed_pencil_cs2)*tmp3_64_103*dline_1__mod__cdata.z
}
else {
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_fvisc.z+AC_nu_hyper3_mesh__mod__viscosity*sqrt(ac_transformed_pencil_cs2)*AC_pi5_1__mod__cparam/60.*tmp3_64_103*dline_1__mod__cdata.z
}
if (ldiffus_total3_64_103) {
if (AC_ldynamical_diffusion__mod__cdata) {
ac_transformed_pencil_diffus_total3=ac_transformed_pencil_diffus_total3+AC_nu_hyper3_mesh__mod__viscosity*sqrt(ac_transformed_pencil_cs2)
advec_hypermesh_uu_64_103=0.0
}
else {
advec_hypermesh_uu_64_103=AC_nu_hyper3_mesh__mod__viscosity*AC_pi5_1__mod__cparam*sqrt(dxyz_2__mod__cdata*ac_transformed_pencil_cs2)
}
advec2_hypermesh__mod__cdata=advec2_hypermesh__mod__cdata+advec_hypermesh_uu_64_103*advec_hypermesh_uu_64_103
}
}
if (AC_lvisc_hyper3_rho_nu_const__mod__viscosity) {
murho1_64_103=AC_nu_hyper3__mod__viscosity*ac_transformed_pencil_rho1
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x+murho1_64_103*ac_transformed_pencil_del6u.x
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y+murho1_64_103*ac_transformed_pencil_del6u.y
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_fvisc.z+murho1_64_103*ac_transformed_pencil_del6u.z
if (ldiffus_total3_64_103) {
ac_transformed_pencil_diffus_total3=ac_transformed_pencil_diffus_total3+murho1_64_103
}
}
if (AC_lvisc_hyper3_rho_nu_const_symm__mod__viscosity) {
murho1_64_103=AC_nu_hyper3__mod__viscosity*ac_transformed_pencil_rho1
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x+murho1_64_103*(ac_transformed_pencil_del6u.x + ac_transformed_pencil_grad5divu.x)
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y+murho1_64_103*(ac_transformed_pencil_del6u.y + ac_transformed_pencil_grad5divu.y)
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_fvisc.z+murho1_64_103*(ac_transformed_pencil_del6u.z + ac_transformed_pencil_grad5divu.z)
if (AC_lpencil__mod__cparam[AC_i_visc_heat__mod__cparam-1]) {
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat + 0.5*AC_nu_hyper3__mod__viscosity*(ac_transformed_pencil_uij5[1-1][1-1]+ac_transformed_pencil_uij5[1-1][1-1])*ac_transformed_pencil_uij[1-1][1-1]
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat + 0.5*AC_nu_hyper3__mod__viscosity*(ac_transformed_pencil_uij5[1-1][2-1]+ac_transformed_pencil_uij5[2-1][1-1])*ac_transformed_pencil_uij[1-1][2-1]
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat + 0.5*AC_nu_hyper3__mod__viscosity*(ac_transformed_pencil_uij5[1-1][3-1]+ac_transformed_pencil_uij5[3-1][1-1])*ac_transformed_pencil_uij[1-1][3-1]
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat + 0.5*AC_nu_hyper3__mod__viscosity*(ac_transformed_pencil_uij5[2-1][1-1]+ac_transformed_pencil_uij5[1-1][2-1])*ac_transformed_pencil_uij[2-1][1-1]
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat + 0.5*AC_nu_hyper3__mod__viscosity*(ac_transformed_pencil_uij5[2-1][2-1]+ac_transformed_pencil_uij5[2-1][2-1])*ac_transformed_pencil_uij[2-1][2-1]
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat + 0.5*AC_nu_hyper3__mod__viscosity*(ac_transformed_pencil_uij5[2-1][3-1]+ac_transformed_pencil_uij5[3-1][2-1])*ac_transformed_pencil_uij[2-1][3-1]
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat + 0.5*AC_nu_hyper3__mod__viscosity*(ac_transformed_pencil_uij5[3-1][1-1]+ac_transformed_pencil_uij5[1-1][3-1])*ac_transformed_pencil_uij[3-1][1-1]
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat + 0.5*AC_nu_hyper3__mod__viscosity*(ac_transformed_pencil_uij5[3-1][2-1]+ac_transformed_pencil_uij5[2-1][3-1])*ac_transformed_pencil_uij[3-1][2-1]
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat + 0.5*AC_nu_hyper3__mod__viscosity*(ac_transformed_pencil_uij5[3-1][3-1]+ac_transformed_pencil_uij5[3-1][3-1])*ac_transformed_pencil_uij[3-1][3-1]
}
if (ldiffus_total3_64_103) {
ac_transformed_pencil_diffus_total3=ac_transformed_pencil_diffus_total3+murho1_64_103
}
}
if (AC_lvisc_hyper3_mu_const_strict__mod__viscosity) {
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x+AC_nu_hyper3__mod__viscosity*ac_transformed_pencil_rho1*value(Field(F_HYPVIS-1+1))
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y+AC_nu_hyper3__mod__viscosity*ac_transformed_pencil_rho1*value(Field(F_HYPVIS-1+2))
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_fvisc.z+AC_nu_hyper3__mod__viscosity*ac_transformed_pencil_rho1*value(Field(F_HYPVIS-1+3))
if (ldiffus_total3_64_103) {
ac_transformed_pencil_diffus_total3=ac_transformed_pencil_diffus_total3+AC_nu_hyper3__mod__viscosity
}
}
if (AC_lvisc_hyper3_cmu_const_strt_otf__mod__viscosity) {
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x+AC_nu_hyper3__mod__viscosity*ac_transformed_pencil_rho1*(ac_transformed_pencil_del6u_strict.x + 1./3*ac_transformed_pencil_del4graddivu.x)
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y+AC_nu_hyper3__mod__viscosity*ac_transformed_pencil_rho1*(ac_transformed_pencil_del6u_strict.y + 1./3*ac_transformed_pencil_del4graddivu.y)
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_fvisc.z+AC_nu_hyper3__mod__viscosity*ac_transformed_pencil_rho1*(ac_transformed_pencil_del6u_strict.z + 1./3*ac_transformed_pencil_del4graddivu.z)
if (ldiffus_total3_64_103) {
ac_transformed_pencil_diffus_total3=ac_transformed_pencil_diffus_total3+AC_nu_hyper3__mod__viscosity
}
}
if (AC_lvisc_hyper3_nu_const_strict__mod__viscosity) {
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x+AC_nu_hyper3__mod__viscosity*value(Field(F_HYPVIS-1+1))
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y+AC_nu_hyper3__mod__viscosity*value(Field(F_HYPVIS-1+2))
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_fvisc.z+AC_nu_hyper3__mod__viscosity*value(Field(F_HYPVIS-1+3))
if (ldiffus_total3_64_103) {
ac_transformed_pencil_diffus_total3=ac_transformed_pencil_diffus_total3+AC_nu_hyper3__mod__viscosity
}
}
if (AC_lvisc_hyper3_rho_nu_const_aniso__mod__viscosity) {
k1_61_64_103=AC_iuu__mod__cdata-1
tmp_61_64_103  = del6fj(Field(k1_61_64_103+1), AC_nu_aniso_hyper3__mod__viscosity)
tmp_64_103.x=tmp_61_64_103
tmp_61_64_103  = del6fj(Field(k1_61_64_103+2), AC_nu_aniso_hyper3__mod__viscosity)
tmp_64_103.y=tmp_61_64_103
tmp_61_64_103  = del6fj(Field(k1_61_64_103+3), AC_nu_aniso_hyper3__mod__viscosity)
tmp_64_103.z=tmp_61_64_103
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x+tmp_64_103.x*ac_transformed_pencil_rho1
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y+tmp_64_103.y*ac_transformed_pencil_rho1
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_fvisc.z+tmp_64_103.z*ac_transformed_pencil_rho1
if (ldiffus_total3_64_103) {
ac_transformed_pencil_diffus_total3=ac_transformed_pencil_diffus_total3 +  (AC_nu_aniso_hyper3__mod__viscosity.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x +  AC_nu_aniso_hyper3__mod__viscosity.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y +  AC_nu_aniso_hyper3__mod__viscosity.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z)/dxyz_6__mod__cdata
}
}
if (AC_lvisc_hyper3_nu_const_aniso__mod__viscosity) {
k1_62_64_103=AC_iuu__mod__cdata-1
tmp_62_64_103  = del6fj(Field(k1_62_64_103+1), AC_nu_aniso_hyper3__mod__viscosity)
tmp_64_103.x=tmp_62_64_103
tmp_62_64_103  = del6fj(Field(k1_62_64_103+2), AC_nu_aniso_hyper3__mod__viscosity)
tmp_64_103.y=tmp_62_64_103
tmp_62_64_103  = del6fj(Field(k1_62_64_103+3), AC_nu_aniso_hyper3__mod__viscosity)
tmp_64_103.z=tmp_62_64_103
tmp3_64_103=0.
tmp3_64_103=tmp3_64_103+ac_transformed_pencil_uij[1-1][1-1]*ac_transformed_pencil_glnrho.x*AC_nu_aniso_hyper3__mod__viscosity.x
tmp3_64_103=tmp3_64_103+ac_transformed_pencil_uij[1-1][2-1]*ac_transformed_pencil_glnrho.y*AC_nu_aniso_hyper3__mod__viscosity.y
tmp3_64_103=tmp3_64_103+ac_transformed_pencil_uij[1-1][3-1]*ac_transformed_pencil_glnrho.z*AC_nu_aniso_hyper3__mod__viscosity.z
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x+tmp_64_103.x+tmp3_64_103
tmp3_64_103=0.
tmp3_64_103=tmp3_64_103+ac_transformed_pencil_uij[2-1][1-1]*ac_transformed_pencil_glnrho.x*AC_nu_aniso_hyper3__mod__viscosity.x
tmp3_64_103=tmp3_64_103+ac_transformed_pencil_uij[2-1][2-1]*ac_transformed_pencil_glnrho.y*AC_nu_aniso_hyper3__mod__viscosity.y
tmp3_64_103=tmp3_64_103+ac_transformed_pencil_uij[2-1][3-1]*ac_transformed_pencil_glnrho.z*AC_nu_aniso_hyper3__mod__viscosity.z
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y+tmp_64_103.y+tmp3_64_103
tmp3_64_103=0.
tmp3_64_103=tmp3_64_103+ac_transformed_pencil_uij[3-1][1-1]*ac_transformed_pencil_glnrho.x*AC_nu_aniso_hyper3__mod__viscosity.x
tmp3_64_103=tmp3_64_103+ac_transformed_pencil_uij[3-1][2-1]*ac_transformed_pencil_glnrho.y*AC_nu_aniso_hyper3__mod__viscosity.y
tmp3_64_103=tmp3_64_103+ac_transformed_pencil_uij[3-1][3-1]*ac_transformed_pencil_glnrho.z*AC_nu_aniso_hyper3__mod__viscosity.z
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_fvisc.z+tmp_64_103.z+tmp3_64_103
if (ldiffus_total3_64_103) {
ac_transformed_pencil_diffus_total3=ac_transformed_pencil_diffus_total3+  (AC_nu_aniso_hyper3__mod__viscosity.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x +  AC_nu_aniso_hyper3__mod__viscosity.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y +  AC_nu_aniso_hyper3__mod__viscosity.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z)/ dxyz_6__mod__cdata
}
}
if (AC_lvisc_hyper3_rho_nu_const_bulk__mod__viscosity) {
murho1_64_103=AC_nu_hyper3__mod__viscosity*ac_transformed_pencil_rho1
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x+murho1_64_103*ac_transformed_pencil_del6u_bulk.x
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y+murho1_64_103*ac_transformed_pencil_del6u_bulk.y
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_fvisc.z+murho1_64_103*ac_transformed_pencil_del6u_bulk.z
if (ldiffus_total3_64_103) {
ac_transformed_pencil_diffus_total3=ac_transformed_pencil_diffus_total3+murho1_64_103
}
}
if (AC_lvisc_hyper3_nu_const__mod__viscosity) {
ac_transformed_pencil_fvisc=ac_transformed_pencil_fvisc+AC_nu_hyper3__mod__viscosity*(ac_transformed_pencil_del6u+ac_transformed_pencil_uij5glnrho)
if (ldiffus_total3_64_103) {
ac_transformed_pencil_diffus_total3=ac_transformed_pencil_diffus_total3+AC_nu_hyper3__mod__viscosity
}
}
if (AC_lvisc_smag__mod__cdata) {
if (AC_lnusmag_as_aux__mod__viscosity) {
ac_transformed_pencil_nu_smag=value(F_NUSMAG)
gradnu_64_103 = gradient(Field(AC_inusmag__mod__cdata))
}
else {
ac_transformed_pencil_nu_smag=pow((AC_c_smag__mod__viscosity*AC_dxmax__mod__cdata),2.)*sqrt(2.*ac_transformed_pencil_sij2)
if (AC_lvisc_smag_ma__mod__viscosity) {
ac_transformed_pencil_nu_smag=ac_transformed_pencil_nu_smag*(1.+pow(ac_transformed_pencil_ma2,AC_nu_smag_ma2_power__mod__viscosity))
}
if (AC_gamma_smag__mod__viscosity!=0.) {
ac_transformed_pencil_nu_smag=ac_transformed_pencil_nu_smag/sqrt(1.+AC_gamma_smag__mod__viscosity*ac_transformed_pencil_sij2)
}
}
tmp_64_103 = ac_transformed_pencil_nu_smag*ac_transformed_pencil_del2u+1./3.*ac_transformed_pencil_graddivu+2.*ac_transformed_pencil_sglnrho
ac_transformed_pencil_fvisc=ac_transformed_pencil_fvisc+tmp_64_103
if (AC_lnusmag_as_aux__mod__viscosity) {
sgradnu_64_103 = ac_transformed_pencil_sij*gradnu_64_103
ac_transformed_pencil_fvisc=ac_transformed_pencil_fvisc+2.*sgradnu_64_103
}
if (AC_lpencil__mod__cparam[AC_i_visc_heat__mod__cparam-1]) {
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat+2*ac_transformed_pencil_nu_smag*ac_transformed_pencil_sij2
}
if (ldiffus_total_64_103) {
ac_transformed_pencil_diffus_total=ac_transformed_pencil_diffus_total+ac_transformed_pencil_nu_smag
}
}
if (AC_lvisc_smag_simplified__mod__viscosity) {
ac_transformed_pencil_nu_smag=pow((AC_c_smag__mod__viscosity*AC_dxmax__mod__cdata),2.)*sqrt(2*ac_transformed_pencil_sij2)
if (AC_gamma_smag__mod__viscosity!=0.) {
ac_transformed_pencil_nu_smag=ac_transformed_pencil_nu_smag/sqrt(1.+AC_gamma_smag__mod__viscosity*ac_transformed_pencil_sij2)
}
tmp2_64_103 = ac_transformed_pencil_nu_smag*ac_transformed_pencil_sglnrho
tmp_64_103 = ac_transformed_pencil_nu_smag*ac_transformed_pencil_del2u+1./3.*ac_transformed_pencil_graddivu
ac_transformed_pencil_fvisc=ac_transformed_pencil_fvisc+2*tmp2_64_103+tmp_64_103
if (AC_lpencil__mod__cparam[AC_i_visc_heat__mod__cparam-1]) {
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat+2*ac_transformed_pencil_nu_smag*ac_transformed_pencil_sij2
}
if (ldiffus_total_64_103) {
ac_transformed_pencil_diffus_total=ac_transformed_pencil_diffus_total+ac_transformed_pencil_nu_smag
}
}
if (AC_lvisc_smag_cross_simplified__mod__viscosity) {
ac_transformed_pencil_nu_smag=pow((AC_c_smag__mod__viscosity*AC_dxmax__mod__cdata),2.)*ac_transformed_pencil_ss12
tmp2_64_103 = ac_transformed_pencil_nu_smag*ac_transformed_pencil_sglnrho
tmp_64_103 = ac_transformed_pencil_nu_smag*ac_transformed_pencil_del2u+1./3.*ac_transformed_pencil_graddivu
ac_transformed_pencil_fvisc=ac_transformed_pencil_fvisc+2*tmp2_64_103+tmp_64_103
if (ldiffus_total_64_103) {
ac_transformed_pencil_diffus_total=ac_transformed_pencil_diffus_total+ac_transformed_pencil_nu_smag
}
}
if (AC_lvisc_slope_limited__mod__viscosity  &&  AC_llast__mod__cdata) {
if (AC_lviscosity_heat__mod__energy) {
if (AC_lcylindrical_coords__mod__cdata  ||  AC_lspherical_coords__mod__cdata) {
not_implemented("calc_slope_diff_flux")
if (AC_lpencil__mod__cparam[AC_i_visc_heat__mod__cparam-1]) {
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat+max(0.0,tmp4_64_103)/ac_transformed_pencil_rho
}
not_implemented("calc_slope_diff_flux")
if (AC_lpencil__mod__cparam[AC_i_visc_heat__mod__cparam-1]) {
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat+max(0.0,tmp4_64_103)/ac_transformed_pencil_rho
}
not_implemented("calc_slope_diff_flux")
if (AC_lpencil__mod__cparam[AC_i_visc_heat__mod__cparam-1]) {
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat+max(0.0,tmp4_64_103)/ac_transformed_pencil_rho
}
if (AC_lcylindrical_coords__mod__cdata) {
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x+tmp2_64_103.x-(d_sld_flux_64_103[2-1][2-1])/AC_x__mod__cdata[vertexIdx.x]
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y+tmp2_64_103.y+(d_sld_flux_64_103[2-1][1-1])/AC_x__mod__cdata[vertexIdx.x]
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_fvisc.z+tmp2_64_103.z
}
else if(AC_lspherical_coords__mod__cdata) {
if (AC_lsld_notensor__mod__viscosity) {
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x+tmp2_64_103.x
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y+tmp2_64_103.y
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_fvisc.z+tmp2_64_103.z
}
else {
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x+tmp2_64_103.x-(d_sld_flux_64_103[2-1][2-1]+d_sld_flux_64_103[3-1][3-1])/AC_x__mod__cdata[vertexIdx.x]
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y+tmp2_64_103.y+(d_sld_flux_64_103[2-1][1-1]-d_sld_flux_64_103[3-1][3-1]*AC_cotth__mod__cdata[AC_m__mod__cdata-1])/AC_x__mod__cdata[vertexIdx.x]
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_fvisc.z+tmp2_64_103.z+(d_sld_flux_64_103[3-1][1-1]+d_sld_flux_64_103[3-1][2-1]*AC_cotth__mod__cdata[AC_m__mod__cdata-1])/AC_x__mod__cdata[vertexIdx.x]
}
}
}
else {
not_implemented("calc_slope_diff_flux")
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x + tmp3_64_103
if (AC_lpencil__mod__cparam[AC_i_visc_heat__mod__cparam-1]) {
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat+max(0.0,tmp4_64_103)/ac_transformed_pencil_rho
}
not_implemented("calc_slope_diff_flux")
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y + tmp3_64_103
if (AC_lpencil__mod__cparam[AC_i_visc_heat__mod__cparam-1]) {
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat+max(0.0,tmp4_64_103)/ac_transformed_pencil_rho
}
not_implemented("calc_slope_diff_flux")
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_fvisc.z + tmp3_64_103
if (AC_lpencil__mod__cparam[AC_i_visc_heat__mod__cparam-1]) {
ac_transformed_pencil_visc_heat=ac_transformed_pencil_visc_heat+max(0.0,tmp4_64_103)/ac_transformed_pencil_rho
}
}
}
else {
if (AC_lcylindrical_coords__mod__cdata  ||  AC_lspherical_coords__mod__cdata) {
not_implemented("calc_slope_diff_flux")
not_implemented("calc_slope_diff_flux")
not_implemented("calc_slope_diff_flux")
if (AC_lcylindrical_coords__mod__cdata) {
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x+tmp2_64_103.x-(d_sld_flux_64_103[2-1][2-1])/AC_x__mod__cdata[vertexIdx.x]
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y+tmp2_64_103.y+(d_sld_flux_64_103[2-1][1-1])/AC_x__mod__cdata[vertexIdx.x]
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_fvisc.z+tmp2_64_103.z
}
else if(AC_lspherical_coords__mod__cdata) {
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x+tmp2_64_103.x-(d_sld_flux_64_103[2-1][2-1]+d_sld_flux_64_103[3-1][3-1])/AC_x__mod__cdata[vertexIdx.x]
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y+tmp2_64_103.y+(d_sld_flux_64_103[2-1][1-1]-d_sld_flux_64_103[3-1][3-1]*AC_cotth__mod__cdata[AC_m__mod__cdata-1])/AC_x__mod__cdata[vertexIdx.x]
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_fvisc.z+tmp2_64_103.z+(d_sld_flux_64_103[3-1][1-1]+d_sld_flux_64_103[3-1][2-1]*AC_cotth__mod__cdata[AC_m__mod__cdata-1])/AC_x__mod__cdata[vertexIdx.x]
}
}
else {
not_implemented("calc_slope_diff_flux")
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x + tmp3_64_103
not_implemented("calc_slope_diff_flux")
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y + tmp3_64_103
not_implemented("calc_slope_diff_flux")
ac_transformed_pencil_fvisc.z=ac_transformed_pencil_fvisc.z + tmp3_64_103
}
}
}
if (AC_lvisc_schur_223__mod__viscosity) {
ac_transformed_pencil_fvisc=ac_transformed_pencil_fvisc+AC_nu__mod__viscosity*ac_transformed_pencil_del2u
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x-AC_nu__mod__viscosity*ac_transformed_pencil_d2uidxj[1-1][3-1]
ac_transformed_pencil_fvisc.x=ac_transformed_pencil_fvisc.x-AC_nu__mod__viscosity*ac_transformed_pencil_d2uidxj[1-1][3-1]
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y-AC_nu__mod__viscosity*ac_transformed_pencil_d2uidxj[2-1][3-1]
ac_transformed_pencil_fvisc.y=ac_transformed_pencil_fvisc.y-AC_nu__mod__viscosity*ac_transformed_pencil_d2uidxj[2-1][3-1]
}
if (AC_llambda_effect__mod__viscosity) {
lomega_63_64_103=ac_transformed_pencil_uu.z/(AC_sinth__mod__cdata[AC_m__mod__cdata-1]*AC_x__mod__cdata[vertexIdx.x])+AC_omega__mod__cdata
dlomega_dr_63_64_103=(AC_x__mod__cdata[vertexIdx.x]*ac_transformed_pencil_uij[3-1][1-1]-ac_transformed_pencil_uu.z)/(AC_sinth__mod__cdata[AC_m__mod__cdata-1]*AC_x__mod__cdata[vertexIdx.x]*AC_x__mod__cdata[vertexIdx.x])
dlomega_dtheta_63_64_103=(ac_transformed_pencil_uij[3-1][2-1]*AC_x__mod__cdata[vertexIdx.x]-ac_transformed_pencil_uu.z*AC_cotth__mod__cdata[AC_m__mod__cdata-1])/(AC_sinth__mod__cdata[AC_m__mod__cdata-1]*AC_x__mod__cdata[vertexIdx.x]*AC_x__mod__cdata[vertexIdx.x])
lver_63_64_103 = -(AC_lambda_v0__mod__viscosity*AC_lv0_rprof__mod__viscosity[vertexIdx.x]+AC_lambda_v1__mod__viscosity*AC_sinth__mod__cdata[AC_m__mod__cdata-1]*AC_sinth__mod__cdata[AC_m__mod__cdata-1]*AC_lv1_rprof__mod__viscosity[vertexIdx.x] )
lhor_63_64_103 = -AC_lambda_h1__mod__viscosity*AC_sinth__mod__cdata[AC_m__mod__cdata-1]*AC_sinth__mod__cdata[AC_m__mod__cdata-1]*AC_lh1_rprof__mod__viscosity[vertexIdx.x]
dlver_dr_63_64_103 = -(AC_lambda_v0__mod__viscosity*AC_der_lv0_rprof__mod__viscosity[vertexIdx.x]+AC_lambda_v1__mod__viscosity*AC_sinth__mod__cdata[AC_m__mod__cdata-1]*AC_sinth__mod__cdata[AC_m__mod__cdata-1]*AC_der_lv1_rprof__mod__viscosity[vertexIdx.x])
dlhor_dtheta_63_64_103 = -AC_lambda_h1__mod__viscosity*AC_lh1_rprof__mod__viscosity[vertexIdx.x]*2.*AC_costh__mod__cdata[AC_m__mod__cdata-1]*AC_sinth__mod__cdata[AC_m__mod__cdata-1]/AC_x__mod__cdata[vertexIdx.x]
lambda_phi_64_103 = AC_sinth__mod__cdata[AC_m__mod__cdata-1]*(lver_63_64_103*(lomega_63_64_103*ac_transformed_pencil_glnrho.x+3.*lomega_63_64_103/AC_x__mod__cdata[vertexIdx.x]+dlomega_dr_63_64_103)+lomega_63_64_103*dlver_dr_63_64_103)  +AC_costh__mod__cdata[AC_m__mod__cdata-1]*(lhor_63_64_103*(lomega_63_64_103*ac_transformed_pencil_glnrho.y  -1./AC_cotth__mod__cdata[AC_m__mod__cdata-1]*lomega_63_64_103/AC_x__mod__cdata[vertexIdx.x] + 2.*AC_cotth__mod__cdata[AC_m__mod__cdata-1]*lomega_63_64_103/AC_x__mod__cdata[vertexIdx.x]  +dlomega_dtheta_63_64_103) + lomega_63_64_103*dlhor_dtheta_63_64_103)
}
if (AC_lvisc_heat_as_aux__mod__viscosity) {
DF_VISC_HEAT = ac_transformed_pencil_visc_heat
}
if (AC_lvisc_forc_as_aux__mod__viscosity) {
DF_VISC_FORCVEC = ac_transformed_pencil_fvisc
}
if (AC_lpencil__mod__cparam[AC_i_fcont__mod__cparam-1]) {
ac_transformed_pencil_fcont=0.
}
if (AC_lpencil__mod__cparam[AC_i_aa__mod__cparam-1]) {
ac_transformed_pencil_aa=value(F_AVEC)
}
if (AC_lpencil__mod__cparam[AC_i_a2__mod__cparam-1]) {
ac_transformed_pencil_a2 = dot(ac_transformed_pencil_aa,ac_transformed_pencil_aa)
}
if (AC_lpencil__mod__cparam[AC_i_aij__mod__cparam-1]) {
ac_transformed_pencil_aij = gradient(Field3(Field(AC_iaa__mod__cdata), Field(AC_iaa__mod__cdata+1), Field(AC_iaa__mod__cdata+2)))
}
if (AC_lpencil__mod__cparam[AC_i_diva__mod__cparam-1]) {
if (AC_lpencil__mod__cparam[AC_i_aij__mod__cparam-1]  &&  ! AC_lpencil_check_at_work__mod__cdata) {
ac_transformed_pencil_diva = divergence(ac_transformed_pencil_aij)
}
else {
ac_transformed_pencil_diva = divergence(Field3(Field(AC_iaa__mod__cdata), Field(AC_iaa__mod__cdata+1), Field(AC_iaa__mod__cdata+2)))
}
if (AC_lcoulomb__mod__magnetic) {
DF_DIVA=ac_transformed_pencil_diva
}
}
if (AC_lpencil__mod__cparam[AC_i_aps__mod__cparam-1]) {
ac_transformed_pencil_aps=value(F_AZ)*ac_transformed_pencil_rcyl_mn
}
if (AC_lpencil__mod__cparam[AC_i_bb__mod__cparam-1]) {
if (AC_lbb_as_comaux__mod__magnetic) {
ac_transformed_pencil_bb = value(F_BVEC)
}
else if (AC_lpencil__mod__cparam[AC_i_aij__mod__cparam-1]  &&  ! AC_lpencil_check_at_work__mod__cdata) {
ac_transformed_pencil_bb=curl(ac_transformed_pencil_aij)
}
else {
ac_transformed_pencil_bb = curl(Field3(Field(AC_iaa__mod__cdata), Field(AC_iaa__mod__cdata+1), Field(AC_iaa__mod__cdata+2)))
}
ac_transformed_pencil_bbb = ac_transformed_pencil_bb
if (! (AC_lbb_as_comaux__mod__magnetic  &&  AC_lb_ext_in_comaux__mod__magnetic)  &&  (! AC_ladd_global_field__mod__magnetic)) {
if (AC_b_ext__mod__magnetic.x != 0.0  ||  AC_b_ext__mod__magnetic.y != 0.0  ||  AC_b_ext__mod__magnetic.z != 0.0) {
if (AC_omega_bz_ext__mod__magnetic != 0.0) {
if (AC_lcartesian_coords__mod__cdata  ||  AC_lbext_curvilinear__mod__magnetic) {
c_72_80_81_103 = cos(AC_omega_bz_ext__mod__magnetic * AC_t__mod__cdata)
s_72_80_81_103 = sin(AC_omega_bz_ext__mod__magnetic * AC_t__mod__cdata)
b_ext_80_81_103.x = AC_b_ext__mod__magnetic.x * c_72_80_81_103 - AC_b_ext__mod__magnetic.y * s_72_80_81_103
b_ext_80_81_103.y = AC_b_ext__mod__magnetic.x * s_72_80_81_103 + AC_b_ext__mod__magnetic.y * c_72_80_81_103
b_ext_80_81_103.z = AC_b_ext__mod__magnetic.z
}
else {
}
}
else if (AC_lbext_moving_layer__mod__magnetic)  {
zposbot_72_80_81_103=AC_zbot_moving_layer__mod__magnetic + AC_t__mod__cdata*AC_speed_moving_layer__mod__magnetic
zpostop_72_80_81_103=AC_ztop_moving_layer__mod__magnetic + AC_t__mod__cdata*AC_speed_moving_layer__mod__magnetic
step_scalar_return_value_68_72_80_81_103 = 0.5*(1+tanh((AC_z__mod__cdata[AC_n__mod__cdata-1]-zposbot_72_80_81_103)/AC_edge_moving_layer__mod__magnetic))
step_scalar_return_value_69_72_80_81_103 = 0.5*(1+tanh((AC_z__mod__cdata[AC_n__mod__cdata-1]-zpostop_72_80_81_103)/AC_edge_moving_layer__mod__magnetic))
zprof_72_80_81_103 = step_scalar_return_value_68_72_80_81_103-step_scalar_return_value_69_72_80_81_103
b_ext_80_81_103.x = AC_b_ext__mod__magnetic.x*zprof_72_80_81_103
b_ext_80_81_103.y = AC_b_ext__mod__magnetic.y*zprof_72_80_81_103
b_ext_80_81_103.z=AC_b_ext__mod__magnetic.z
if (true) {
arg_70_72_80_81_103 = abs((AC_z__mod__cdata[AC_n__mod__cdata-1]-zposbot_72_80_81_103)/(AC_edge_moving_layer__mod__magnetic+AC_tini__mod__cparam))
if (abs(arg_70_72_80_81_103)>=8.)  {
der_step_return_value_70_72_80_81_103 = 2./AC_edge_moving_layer__mod__magnetic*exp(-2.*abs(arg_70_72_80_81_103))
}
else {
der_step_return_value_70_72_80_81_103 = 0.5/(AC_edge_moving_layer__mod__magnetic*cosh(arg_70_72_80_81_103)*cosh(arg_70_72_80_81_103))
}
arg_71_72_80_81_103 = abs((AC_z__mod__cdata[AC_n__mod__cdata-1]-zpostop_72_80_81_103)/(AC_edge_moving_layer__mod__magnetic+AC_tini__mod__cparam))
if (abs(arg_71_72_80_81_103)>=8.)  {
der_step_return_value_71_72_80_81_103 = 2./AC_edge_moving_layer__mod__magnetic*exp(-2.*abs(arg_71_72_80_81_103))
}
else {
der_step_return_value_71_72_80_81_103 = 0.5/(AC_edge_moving_layer__mod__magnetic*cosh(arg_71_72_80_81_103)*cosh(arg_71_72_80_81_103))
}
zder_72_80_81_103 = der_step_return_value_70_72_80_81_103-der_step_return_value_71_72_80_81_103
if (AC_b_ext__mod__magnetic.x!=0.) {
j_ext_80_81_103.y =  AC_b_ext__mod__magnetic.x*zder_72_80_81_103
}
if (AC_b_ext__mod__magnetic.y!=0.) {
j_ext_80_81_103.x = -AC_b_ext__mod__magnetic.y*zder_72_80_81_103
}
}
}
else {
if (AC_lcartesian_coords__mod__cdata  ||  AC_lbext_curvilinear__mod__magnetic) {
b_ext_80_81_103 = AC_b_ext__mod__magnetic
}
else if (AC_lcylindrical_coords__mod__cdata) {
b_ext_80_81_103.x =  AC_b_ext__mod__magnetic.x * cos(AC_y__mod__cdata[AC_m__mod__cdata-1]) + AC_b_ext__mod__magnetic.y * sin(AC_y__mod__cdata[AC_m__mod__cdata-1])
b_ext_80_81_103.y = -AC_b_ext__mod__magnetic.x * sin(AC_y__mod__cdata[AC_m__mod__cdata-1]) + AC_b_ext__mod__magnetic.y * cos(AC_y__mod__cdata[AC_m__mod__cdata-1])
b_ext_80_81_103.z =  AC_b_ext__mod__magnetic.z
}
else if (AC_lspherical_coords__mod__cdata) {
b_ext_80_81_103.x =  AC_b_ext__mod__magnetic.x * AC_sinth__mod__cdata[AC_m__mod__cdata-1] * cos(AC_z__mod__cdata[AC_n__mod__cdata-1]) + AC_b_ext__mod__magnetic.y * AC_sinth__mod__cdata[AC_m__mod__cdata-1] * sin(AC_z__mod__cdata[AC_n__mod__cdata-1]) + AC_b_ext__mod__magnetic.z * AC_costh__mod__cdata[AC_m__mod__cdata-1]
b_ext_80_81_103.y =  AC_b_ext__mod__magnetic.x * AC_costh__mod__cdata[AC_m__mod__cdata-1] * cos(AC_z__mod__cdata[AC_n__mod__cdata-1]) + AC_b_ext__mod__magnetic.y * AC_costh__mod__cdata[AC_m__mod__cdata-1] * sin(AC_z__mod__cdata[AC_n__mod__cdata-1]) - AC_b_ext__mod__magnetic.z * AC_sinth__mod__cdata[AC_m__mod__cdata-1]
b_ext_80_81_103.z = -AC_b_ext__mod__magnetic.x            * sin(AC_z__mod__cdata[AC_n__mod__cdata-1]) + AC_b_ext__mod__magnetic.y            * cos(AC_z__mod__cdata[AC_n__mod__cdata-1])
}
if (true) {
j_ext_80_81_103.x = 0.
j_ext_80_81_103.y = 0.
j_ext_80_81_103.z = 0.
}
}
}
else {
b_ext_80_81_103.x = 0.
b_ext_80_81_103.y = 0.
b_ext_80_81_103.z = 0.
if (true) {
j_ext_80_81_103.x = 0.
j_ext_80_81_103.y = 0.
j_ext_80_81_103.z = 0.
}
}
if (AC_t_bext__mod__magnetic > 0.0  &&  AC_t__mod__cdata < AC_t_bext__mod__magnetic) {
if (AC_t__mod__cdata <= AC_t0_bext__mod__magnetic) {
b_ext_80_81_103 = AC_b0_ext__mod__magnetic
}
else {
b_ext_80_81_103 = AC_b0_ext__mod__magnetic + 0.5*(1.-cos(AC_pi__mod__cparam*(AC_t__mod__cdata-AC_t0_bext__mod__magnetic)/(AC_t_bext__mod__magnetic-AC_t0_bext__mod__magnetic)))*(b_ext_80_81_103-AC_b0_ext__mod__magnetic)
}
if (true) {
j_ext_80_81_103.x = 0.
j_ext_80_81_103.y = 0.
j_ext_80_81_103.z = 0.
}
}
if (b_ext_80_81_103.x != 0.  ||  b_ext_80_81_103.y != 0.  ||  b_ext_80_81_103.z != 0.) {
if(b_ext_80_81_103.x != 0.0) {
ac_transformed_pencil_bb.x = ac_transformed_pencil_bb.x + b_ext_80_81_103.x
}
if(b_ext_80_81_103.y != 0.0) {
ac_transformed_pencil_bb.y = ac_transformed_pencil_bb.y + b_ext_80_81_103.y
}
if(b_ext_80_81_103.z != 0.0) {
ac_transformed_pencil_bb.z = ac_transformed_pencil_bb.z + b_ext_80_81_103.z
}
}
if(j_ext_80_81_103.x != 0.0) {
ac_transformed_pencil_jj.x = ac_transformed_pencil_jj.x + j_ext_80_81_103.x
}
if(j_ext_80_81_103.y != 0.0) {
ac_transformed_pencil_jj.y = ac_transformed_pencil_jj.y + j_ext_80_81_103.y
}
if(j_ext_80_81_103.z != 0.0) {
ac_transformed_pencil_jj.z = ac_transformed_pencil_jj.z + j_ext_80_81_103.z
}
}
if (AC_dipole_moment__mod__magnetic != 0.) {
c_80_81_103=cos(AC_inclaa__mod__magnetic*AC_pi__mod__cparam/180)
s_80_81_103=sin(AC_inclaa__mod__magnetic*AC_pi__mod__cparam/180)
ac_transformed_pencil_bb.x = ac_transformed_pencil_bb.x + AC_dipole_moment__mod__magnetic*2*(c_80_81_103*AC_costh__mod__cdata[AC_m__mod__cdata-1] + s_80_81_103*AC_sinth__mod__cdata[AC_m__mod__cdata-1]*cos(AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_omega_bz_ext__mod__magnetic*AC_t__mod__cdata))*ac_transformed_pencil_r_mn1*ac_transformed_pencil_r_mn1*ac_transformed_pencil_r_mn1
ac_transformed_pencil_bb.y = ac_transformed_pencil_bb.y + AC_dipole_moment__mod__magnetic*  (c_80_81_103*AC_sinth__mod__cdata[AC_m__mod__cdata-1] - s_80_81_103*AC_costh__mod__cdata[AC_m__mod__cdata-1]*cos(AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_omega_bz_ext__mod__magnetic*AC_t__mod__cdata))*ac_transformed_pencil_r_mn1*ac_transformed_pencil_r_mn1*ac_transformed_pencil_r_mn1
ac_transformed_pencil_bb.z = ac_transformed_pencil_bb.z + AC_dipole_moment__mod__magnetic*  (             s_80_81_103*         sin(AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_omega_bz_ext__mod__magnetic*AC_t__mod__cdata))*ac_transformed_pencil_r_mn1*ac_transformed_pencil_r_mn1*ac_transformed_pencil_r_mn1
}
if (AC_ladd_global_field__mod__magnetic) {
if (AC_b_ext__mod__magnetic.x != 0.0  ||  AC_b_ext__mod__magnetic.y != 0.0  ||  AC_b_ext__mod__magnetic.z != 0.0) {
if (AC_omega_bz_ext__mod__magnetic != 0.0) {
if (AC_lcartesian_coords__mod__cdata  ||  AC_lbext_curvilinear__mod__magnetic) {
c_73_80_81_103 = cos(AC_omega_bz_ext__mod__magnetic * AC_t__mod__cdata)
s_73_80_81_103 = sin(AC_omega_bz_ext__mod__magnetic * AC_t__mod__cdata)
b_ext_80_81_103.x = AC_b_ext__mod__magnetic.x * c_73_80_81_103 - AC_b_ext__mod__magnetic.y * s_73_80_81_103
b_ext_80_81_103.y = AC_b_ext__mod__magnetic.x * s_73_80_81_103 + AC_b_ext__mod__magnetic.y * c_73_80_81_103
b_ext_80_81_103.z = AC_b_ext__mod__magnetic.z
}
else {
}
}
else if (AC_lbext_moving_layer__mod__magnetic)  {
zposbot_73_80_81_103=AC_zbot_moving_layer__mod__magnetic + AC_t__mod__cdata*AC_speed_moving_layer__mod__magnetic
zpostop_73_80_81_103=AC_ztop_moving_layer__mod__magnetic + AC_t__mod__cdata*AC_speed_moving_layer__mod__magnetic
step_scalar_return_value_68_73_80_81_103 = 0.5*(1+tanh((AC_z__mod__cdata[AC_n__mod__cdata-1]-zposbot_73_80_81_103)/AC_edge_moving_layer__mod__magnetic))
step_scalar_return_value_69_73_80_81_103 = 0.5*(1+tanh((AC_z__mod__cdata[AC_n__mod__cdata-1]-zpostop_73_80_81_103)/AC_edge_moving_layer__mod__magnetic))
zprof_73_80_81_103 = step_scalar_return_value_68_73_80_81_103-step_scalar_return_value_69_73_80_81_103
b_ext_80_81_103.x = AC_b_ext__mod__magnetic.x*zprof_73_80_81_103
b_ext_80_81_103.y = AC_b_ext__mod__magnetic.y*zprof_73_80_81_103
b_ext_80_81_103.z=AC_b_ext__mod__magnetic.z
if (false) {
arg_70_73_80_81_103 = abs((AC_z__mod__cdata[AC_n__mod__cdata-1]-zposbot_73_80_81_103)/(AC_edge_moving_layer__mod__magnetic+AC_tini__mod__cparam))
if (abs(arg_70_73_80_81_103)>=8.)  {
der_step_return_value_70_73_80_81_103 = 2./AC_edge_moving_layer__mod__magnetic*exp(-2.*abs(arg_70_73_80_81_103))
}
else {
der_step_return_value_70_73_80_81_103 = 0.5/(AC_edge_moving_layer__mod__magnetic*cosh(arg_70_73_80_81_103)*cosh(arg_70_73_80_81_103))
}
arg_71_73_80_81_103 = abs((AC_z__mod__cdata[AC_n__mod__cdata-1]-zpostop_73_80_81_103)/(AC_edge_moving_layer__mod__magnetic+AC_tini__mod__cparam))
if (abs(arg_71_73_80_81_103)>=8.)  {
der_step_return_value_71_73_80_81_103 = 2./AC_edge_moving_layer__mod__magnetic*exp(-2.*abs(arg_71_73_80_81_103))
}
else {
der_step_return_value_71_73_80_81_103 = 0.5/(AC_edge_moving_layer__mod__magnetic*cosh(arg_71_73_80_81_103)*cosh(arg_71_73_80_81_103))
}
zder_73_80_81_103 = der_step_return_value_70_73_80_81_103-der_step_return_value_71_73_80_81_103
}
}
else {
if (AC_lcartesian_coords__mod__cdata  ||  AC_lbext_curvilinear__mod__magnetic) {
b_ext_80_81_103 = AC_b_ext__mod__magnetic
}
else if (AC_lcylindrical_coords__mod__cdata) {
b_ext_80_81_103.x =  AC_b_ext__mod__magnetic.x * cos(AC_y__mod__cdata[AC_m__mod__cdata-1]) + AC_b_ext__mod__magnetic.y * sin(AC_y__mod__cdata[AC_m__mod__cdata-1])
b_ext_80_81_103.y = -AC_b_ext__mod__magnetic.x * sin(AC_y__mod__cdata[AC_m__mod__cdata-1]) + AC_b_ext__mod__magnetic.y * cos(AC_y__mod__cdata[AC_m__mod__cdata-1])
b_ext_80_81_103.z =  AC_b_ext__mod__magnetic.z
}
else if (AC_lspherical_coords__mod__cdata) {
b_ext_80_81_103.x =  AC_b_ext__mod__magnetic.x * AC_sinth__mod__cdata[AC_m__mod__cdata-1] * cos(AC_z__mod__cdata[AC_n__mod__cdata-1]) + AC_b_ext__mod__magnetic.y * AC_sinth__mod__cdata[AC_m__mod__cdata-1] * sin(AC_z__mod__cdata[AC_n__mod__cdata-1]) + AC_b_ext__mod__magnetic.z * AC_costh__mod__cdata[AC_m__mod__cdata-1]
b_ext_80_81_103.y =  AC_b_ext__mod__magnetic.x * AC_costh__mod__cdata[AC_m__mod__cdata-1] * cos(AC_z__mod__cdata[AC_n__mod__cdata-1]) + AC_b_ext__mod__magnetic.y * AC_costh__mod__cdata[AC_m__mod__cdata-1] * sin(AC_z__mod__cdata[AC_n__mod__cdata-1]) - AC_b_ext__mod__magnetic.z * AC_sinth__mod__cdata[AC_m__mod__cdata-1]
b_ext_80_81_103.z = -AC_b_ext__mod__magnetic.x            * sin(AC_z__mod__cdata[AC_n__mod__cdata-1]) + AC_b_ext__mod__magnetic.y            * cos(AC_z__mod__cdata[AC_n__mod__cdata-1])
}
}
}
else {
b_ext_80_81_103.x = 0.
b_ext_80_81_103.y = 0.
b_ext_80_81_103.z = 0.
}
if (AC_t_bext__mod__magnetic > 0.0  &&  AC_t__mod__cdata < AC_t_bext__mod__magnetic) {
if (AC_t__mod__cdata <= AC_t0_bext__mod__magnetic) {
b_ext_80_81_103 = AC_b0_ext__mod__magnetic
}
else {
b_ext_80_81_103 = AC_b0_ext__mod__magnetic + 0.5*(1.-cos(AC_pi__mod__cparam*(AC_t__mod__cdata-AC_t0_bext__mod__magnetic)/(AC_t_bext__mod__magnetic-AC_t0_bext__mod__magnetic)))*(b_ext_80_81_103-AC_b0_ext__mod__magnetic)
}
}
if (AC_iglobal_ext_bx__mod__cdata!=0) {
ac_transformed_pencil_bb.x=ac_transformed_pencil_bb.x+b_ext_80_81_103.y*value(F_GLOBAL_EXT_BX)+b_ext_80_81_103.x
}
if (AC_iglobal_ext_by__mod__cdata!=0) {
ac_transformed_pencil_bb.y=ac_transformed_pencil_bb.y+b_ext_80_81_103.y*value(F_GLOBAL_EXT_BY)
}
if (AC_iglobal_ext_bz__mod__cdata!=0) {
ac_transformed_pencil_bb.z=ac_transformed_pencil_bb.z+b_ext_80_81_103.y*value(F_GLOBAL_EXT_BZ)+b_ext_80_81_103.z
}
}
}
if (AC_b0_ext_z__mod__magnetic != 0.0) {
get_b0_ext_z_return_value_74_80_81_103 = AC_b0_ext_z__mod__magnetic * exp(-AC_z__mod__cdata[AC_n__mod__cdata-1] / AC_b0_ext_z_h__mod__magnetic)
ac_transformed_pencil_bb.z = ac_transformed_pencil_bb.z + get_b0_ext_z_return_value_74_80_81_103
}
if (AC_lignore_bext_in_b2__mod__magnetic  ||  (!AC_luse_bext_in_b2__mod__magnetic) ) {
if (AC_lpencil__mod__cparam[AC_i_b2__mod__cparam-1]) {
ac_transformed_pencil_b2 = dot(ac_transformed_pencil_bbb,ac_transformed_pencil_bbb)
}
}
else {
if (AC_lpencil__mod__cparam[AC_i_b2__mod__cparam-1]) {
ac_transformed_pencil_b2 = dot(ac_transformed_pencil_bb,ac_transformed_pencil_bb)
}
}
if (AC_lpencil__mod__cparam[AC_i_bf2__mod__cparam-1]) {
ac_transformed_pencil_bf2 = dot(ac_transformed_pencil_bbb,ac_transformed_pencil_bbb)
}
if (AC_lpencil__mod__cparam[AC_i_b21__mod__cparam-1]) {
if (ac_transformed_pencil_b2>AC_tini__mod__cparam) {
ac_transformed_pencil_b21=1./ac_transformed_pencil_b2
}
else {
ac_transformed_pencil_b21=0.
}
}
if (AC_lmagneto_friction__mod__magnetic && AC_lpencil__mod__cparam[AC_i_rho1__mod__cparam-1]) {
ac_transformed_pencil_rho=AC_rho0__mod__equationofstate*1.0e-2+ac_transformed_pencil_b2
ac_transformed_pencil_rho1=1./ac_transformed_pencil_rho
}
if (AC_lpencil__mod__cparam[AC_i_bunit__mod__cparam-1]) {
quench_80_81_103 = 1.0/max(AC_tini__mod__cparam,sqrt(ac_transformed_pencil_b2))
if (AC_lignore_bext_in_b2__mod__magnetic  ||  (!AC_luse_bext_in_b2__mod__magnetic) ) {
ac_transformed_pencil_bunit.x = ac_transformed_pencil_bbb.x*quench_80_81_103
ac_transformed_pencil_bunit.y = ac_transformed_pencil_bbb.y*quench_80_81_103
ac_transformed_pencil_bunit.z = ac_transformed_pencil_bbb.z*quench_80_81_103
}
else {
ac_transformed_pencil_bunit.x = ac_transformed_pencil_bb.x*quench_80_81_103
ac_transformed_pencil_bunit.y = ac_transformed_pencil_bb.y*quench_80_81_103
ac_transformed_pencil_bunit.z = ac_transformed_pencil_bb.z*quench_80_81_103
}
}
if (AC_lpencil__mod__cparam[AC_i_ab__mod__cparam-1]) {
ac_transformed_pencil_ab = dot(ac_transformed_pencil_aa,ac_transformed_pencil_bbb)
}
if (AC_lpencil__mod__cparam[AC_i_ua__mod__cparam-1]) {
ac_transformed_pencil_ua = dot(ac_transformed_pencil_uu,ac_transformed_pencil_aa)
}
if (AC_lpencil__mod__cparam[AC_i_uxb__mod__cparam-1]) {
ac_transformed_pencil_uxb = cross(ac_transformed_pencil_uu,ac_transformed_pencil_bb)
}
if (AC_lpencil__mod__cparam[AC_i_uxbb__mod__cparam-1]) {
ac_transformed_pencil_uxbb = cross(ac_transformed_pencil_uu,ac_transformed_pencil_bbb)
}
if (AC_lpencil__mod__cparam[AC_i_uga__mod__cparam-1]) {
ac_transformed_pencil_uga = ac_transformed_pencil_aij*ac_transformed_pencil_uu
if (AC_lupw_aa__mod__magnetic) ac_transformed_pencil_uga = ac_transformed_pencil_uga + del6(Field3(Field(AC_iaa__mod__cdata), Field(AC_iaa__mod__cdata+1), Field(AC_iaa__mod__cdata+2)))
}
if (AC_lpencil__mod__cparam[AC_i_uuadvec_gaa__mod__cparam-1]) {
tmp_80_81_103 = ac_transformed_pencil_aij.row(1-1)
ac_transformed_pencil_uuadvec_gaa.x = dot(ac_transformed_pencil_uu_advec,tmp_80_81_103)
tmp_80_81_103 = ac_transformed_pencil_aij.row(2-1)
ac_transformed_pencil_uuadvec_gaa.y = dot(ac_transformed_pencil_uu_advec,tmp_80_81_103)
tmp_80_81_103 = ac_transformed_pencil_aij.row(3-1)
ac_transformed_pencil_uuadvec_gaa.z = dot(ac_transformed_pencil_uu_advec,tmp_80_81_103)
if (AC_lcylindrical_coords__mod__cdata) {
ac_transformed_pencil_uuadvec_gaa.x = ac_transformed_pencil_uuadvec_gaa.x - AC_rcyl_mn1__mod__cdata[vertexIdx.x-NGHOST_VAL]*ac_transformed_pencil_uu.y*ac_transformed_pencil_aa.y
ac_transformed_pencil_uuadvec_gaa.y = ac_transformed_pencil_uuadvec_gaa.y + AC_rcyl_mn1__mod__cdata[vertexIdx.x-NGHOST_VAL]*ac_transformed_pencil_uu.y*ac_transformed_pencil_aa.x
}
else if (AC_lspherical_coords__mod__cdata) {
}
}
if (AC_lpencil__mod__cparam[AC_i_bij__mod__cparam-1] && AC_lpencil__mod__cparam[AC_i_del2a__mod__cparam-1]) {
if (AC_lcartesian_coords__mod__cdata) {
ac_transformed_pencil_bij = bij(Field3(Field(AC_iaa__mod__cdata), Field(AC_iaa__mod__cdata+1), Field(AC_iaa__mod__cdata+2)))
ac_transformed_pencil_del2a = laplace(Field3(Field(AC_iaa__mod__cdata), Field(AC_iaa__mod__cdata+1), Field(AC_iaa__mod__cdata+2)))
if (AC_lpencil__mod__cparam[AC_i_jj__mod__cparam-1]  &&  ! AC_ljj_as_comaux__mod__magnetic) {
ac_transformed_pencil_jj=curl(ac_transformed_pencil_bij)
}
}
else {
not_implemented("gij_etc with more than 6 params")
if (AC_lpencil__mod__cparam[AC_i_jj__mod__cparam-1]  &&  ! AC_ljj_as_comaux__mod__magnetic) {
ac_transformed_pencil_jj=curl(ac_transformed_pencil_bij)
}
}
}
else if (AC_lpencil__mod__cparam[AC_i_bij__mod__cparam-1] && !AC_lpencil__mod__cparam[AC_i_del2a__mod__cparam-1]) {
if (AC_lcartesian_coords__mod__cdata) {
ac_transformed_pencil_bij = bij(Field3(Field(AC_iaa__mod__cdata), Field(AC_iaa__mod__cdata+1), Field(AC_iaa__mod__cdata+2)))
if (AC_lpencil__mod__cparam[AC_i_jj__mod__cparam-1] &&  ! AC_ljj_as_comaux__mod__magnetic) {
ac_transformed_pencil_jj=curl(ac_transformed_pencil_bij)
}
}
else {
not_implemented("gij_etc with more than 6 params")
if (AC_lpencil__mod__cparam[AC_i_jj__mod__cparam-1] &&  ! AC_ljj_as_comaux__mod__magnetic) {
ac_transformed_pencil_jj=curl(ac_transformed_pencil_bij)
}
}
}
else if (AC_lpencil__mod__cparam[AC_i_del2a__mod__cparam-1] && !AC_lpencil__mod__cparam[AC_i_bij__mod__cparam-1]) {
if (AC_lcartesian_coords__mod__cdata) {
ac_transformed_pencil_del2a = laplace(Field3(Field(AC_iaa__mod__cdata), Field(AC_iaa__mod__cdata+1), Field(AC_iaa__mod__cdata+2)))
}
else {
not_implemented("gij_etc with more than 6 params")
}
}
if (AC_lpencil__mod__cparam[AC_i_bijtilde__mod__cparam-1]) {
if (AC_lcovariant_magnetic__mod__magnetic) {
not_implemented("bij_tilde in sub.f90")
}
else {
not_implemented("bij_tilde in sub.f90")
}
}
if (AC_ljj_as_comaux__mod__magnetic  &&  AC_lpencil__mod__cparam[AC_i_jj__mod__cparam-1]) {
ac_transformed_pencil_jj=value(F_JVEC)
}
chi_diamag_77_80_81_103=AC_b2_diamag__mod__magnetic/ac_transformed_pencil_b2
gchi_diamag_77_80_81_103 = chi_diamag_77_80_81_103/ac_transformed_pencil_b2*ac_transformed_pencil_gb22
jj_diamag_77_80_81_103 = cross(gchi_diamag_77_80_81_103,ac_transformed_pencil_bb)
tmp_77_80_81_103.x=jj_diamag_77_80_81_103.x+chi_diamag_77_80_81_103*ac_transformed_pencil_jj.x
tmp_77_80_81_103.y=jj_diamag_77_80_81_103.y+chi_diamag_77_80_81_103*ac_transformed_pencil_jj.y
tmp_77_80_81_103.z=jj_diamag_77_80_81_103.z+chi_diamag_77_80_81_103*ac_transformed_pencil_jj.z
jj_diamag_77_80_81_103=tmp_77_80_81_103
ac_transformed_pencil_jj=ac_transformed_pencil_jj+jj_diamag_77_80_81_103
if (AC_lpencil__mod__cparam[AC_i_jj__mod__cparam-1]) {
if (AC_iee__mod__cdata==0) {
ac_transformed_pencil_curlb=ac_transformed_pencil_jj
}
if (AC_iex__mod__cdata>0) {
if (AC_lresi_eta_tdep__mod__magnetic) {
eta_total__mod__magnetic=AC_eta_tdep__mod__magnetic
}
else {
eta_total__mod__magnetic=AC_eta__mod__magnetic
}
if (AC_lvacuum__mod__magnetic) {
ac_transformed_pencil_jj.x = 0.
ac_transformed_pencil_jj.y = 0.
ac_transformed_pencil_jj.z = 0.
ac_transformed_pencil_jj_ohm.x = 0.
ac_transformed_pencil_jj_ohm.y = 0.
ac_transformed_pencil_jj_ohm.z = 0.
}
else {
ac_transformed_pencil_jj_ohm=(ac_transformed_pencil_el+ac_transformed_pencil_uxb)*AC_mu01__mod__cdata/eta_total__mod__magnetic
if (AC_loverride_ee2__mod__magnetic) {
if (AC_ladd_disp_current_from_aux__mod__magnetic) {
if (AC_iedotx__mod__magnetic>0  &&  AC_iedotz__mod__magnetic>0) {
ac_transformed_pencil_jj=AC_mu01__mod__cdata*ac_transformed_pencil_curlb-AC_c_light21__mod__magnetic*value(F_EDOTVEC)
}
else {
}
}
else {
ac_transformed_pencil_jj=AC_mu01__mod__cdata*ac_transformed_pencil_curlb
}
}
else {
ac_transformed_pencil_jj=ac_transformed_pencil_jj_ohm
}
}
}
else {
ac_transformed_pencil_curlb=ac_transformed_pencil_jj
ac_transformed_pencil_jj=AC_mu01__mod__cdata*ac_transformed_pencil_curlb
ac_transformed_pencil_jj_ohm.x = 0.
ac_transformed_pencil_jj_ohm.y = 0.
ac_transformed_pencil_jj_ohm.z = 0.
}
if (AC_lj_ext__mod__magnetic) {
if (AC_j_ext_quench__mod__magnetic!=0) {
quench_80_81_103=1./(1.+AC_j_ext_quench__mod__magnetic*ac_transformed_pencil_b2)
ac_transformed_pencil_jj.x=ac_transformed_pencil_jj.x-j_ext_80_81_103.x*quench_80_81_103
ac_transformed_pencil_jj.y=ac_transformed_pencil_jj.y-j_ext_80_81_103.y*quench_80_81_103
ac_transformed_pencil_jj.z=ac_transformed_pencil_jj.z-j_ext_80_81_103.z*quench_80_81_103
}
else {
ac_transformed_pencil_jj.x=ac_transformed_pencil_jj.x-j_ext_80_81_103.x
ac_transformed_pencil_jj.y=ac_transformed_pencil_jj.y-j_ext_80_81_103.y
ac_transformed_pencil_jj.z=ac_transformed_pencil_jj.z-j_ext_80_81_103.z
}
}
}
if (AC_lpencil__mod__cparam[AC_i_exa__mod__cparam-1]) {
ac_transformed_pencil_exa = cross(ac_transformed_pencil_uxb+AC_eta__mod__magnetic*ac_transformed_pencil_jj,ac_transformed_pencil_aa)
}
if (AC_lpencil__mod__cparam[AC_i_exatotal__mod__cparam-1]) {
tmp_80_81_103.x = eta_total__mod__magnetic*ac_transformed_pencil_jj.x
tmp_80_81_103.y = eta_total__mod__magnetic*ac_transformed_pencil_jj.y
tmp_80_81_103.z = eta_total__mod__magnetic*ac_transformed_pencil_jj.z
ac_transformed_pencil_exatotal = cross(ac_transformed_pencil_uxb+tmp_80_81_103,ac_transformed_pencil_aa)
}
if (AC_lpencil__mod__cparam[AC_i_j2__mod__cparam-1]) {
ac_transformed_pencil_j2 = dot(ac_transformed_pencil_jj,ac_transformed_pencil_jj)
}
if (AC_lpencil__mod__cparam[AC_i_jb__mod__cparam-1]) {
ac_transformed_pencil_jb = dot(ac_transformed_pencil_jj,ac_transformed_pencil_bbb)
}
if (AC_lpencil__mod__cparam[AC_i_etava__mod__cparam-1]) {
if (AC_lresi_vaspeed__mod__magnetic) {
ac_transformed_pencil_etava = AC_eta_va__mod__magnetic * sqrt(ac_transformed_pencil_va2)/AC_varms__mod__magnetic
if (AC_va_min__mod__magnetic > 0.) {
ac_transformed_pencil_etava = set_min_val(ac_transformed_pencil_etava,AC_va_min__mod__magnetic)
}
}
else {
ac_transformed_pencil_etava = AC_mu0__mod__cdata * AC_eta_va__mod__magnetic * AC_dxmax__mod__cdata * sqrt(ac_transformed_pencil_va2)
if (AC_eta_min__mod__magnetic > 0.) {
ac_transformed_pencil_etava = set_zero_below_threshold(ac_transformed_pencil_etava,AC_eta_min__mod__magnetic)
}
}
}
if (AC_lpencil__mod__cparam[AC_i_gva__mod__cparam-1] && AC_lalfven_as_aux__mod__magnetic) {
ac_transformed_pencil_gva = gradient(Field(AC_ialfven__mod__cdata))
if (AC_lresi_vaspeed__mod__magnetic) {
if (AC_va_min__mod__magnetic > 0.) {
ac_transformed_pencil_gva = set_zero_below_threshold(ac_transformed_pencil_etava,AC_va_min__mod__magnetic)
}
}
}
if (AC_lpencil__mod__cparam[AC_i_etaj__mod__cparam-1]) {
ac_transformed_pencil_etaj = AC_mu0__mod__cdata * AC_eta_j__mod__magnetic * AC_dxmax__mod__cdata*AC_dxmax__mod__cdata * sqrt(AC_mu0__mod__cdata * ac_transformed_pencil_j2 * ac_transformed_pencil_rho1)
if (AC_eta_min__mod__magnetic > 0.) {
ac_transformed_pencil_etaj = set_zero_below_threshold(ac_transformed_pencil_etaj,AC_eta_min__mod__magnetic)
}
}
if (AC_lpencil__mod__cparam[AC_i_etaj2__mod__cparam-1]) {
ac_transformed_pencil_etaj2 = AC_etaj20__mod__magnetic * ac_transformed_pencil_j2 * ac_transformed_pencil_rho1
if (AC_eta_min__mod__magnetic > 0.) {
ac_transformed_pencil_etaj2 = set_zero_below_threshold(ac_transformed_pencil_etaj2,AC_eta_min__mod__magnetic)
}
}
if (AC_lpencil__mod__cparam[AC_i_etajrho__mod__cparam-1]) {
ac_transformed_pencil_etajrho = AC_mu0__mod__cdata * AC_eta_jrho__mod__magnetic * AC_dxmax__mod__cdata * sqrt(ac_transformed_pencil_j2) * ac_transformed_pencil_rho1
if (AC_eta_min__mod__magnetic > 0.) {
ac_transformed_pencil_etajrho = set_zero_below_threshold(ac_transformed_pencil_etajrho,AC_eta_min__mod__magnetic)
}
}
if (AC_lpencil__mod__cparam[AC_i_jxb__mod__cparam-1]) {
ac_transformed_pencil_jxb = cross(ac_transformed_pencil_jj,ac_transformed_pencil_bb)
}
if (AC_lpencil__mod__cparam[AC_i_cosjb__mod__cparam-1]) {
ac_transformed_pencil_cosjb = tini_sqrt_div(ac_transformed_pencil_jb,ac_transformed_pencil_j2,ac_transformed_pencil_b2)
}
if (AC_lpencil__mod__cparam[AC_i_jparallel__mod__cparam-1] || AC_lpencil__mod__cparam[AC_i_jperp__mod__cparam-1]) {
ac_transformed_pencil_jparallel=sqrt(ac_transformed_pencil_j2)*ac_transformed_pencil_cosjb
ac_transformed_pencil_jperp=sqrt(ac_transformed_pencil_j2)*sqrt(abs(1-ac_transformed_pencil_cosjb*ac_transformed_pencil_cosjb))
}
if (AC_lpencil__mod__cparam[AC_i_jxbr__mod__cparam-1]) {
rho1_jxb_80_81_103=ac_transformed_pencil_rho1
if (AC_rhomin_jxb__mod__magnetic>0) {
rho1_jxb_80_81_103=min(rho1_jxb_80_81_103,1/AC_rhomin_jxb__mod__magnetic)
}
if (AC_va2max_jxb__mod__magnetic>0  &&  (! AC_betamin_jxb__mod__magnetic>0)) {
rho1_jxb_80_81_103 = rho1_jxb_80_81_103 * pow((1+pow((ac_transformed_pencil_va2/AC_va2max_jxb__mod__magnetic),AC_va2power_jxb__mod__magnetic)),(-1.0/AC_va2power_jxb__mod__magnetic))
}
if (AC_betamin_jxb__mod__magnetic>0) {
va2max_beta_80_81_103 = ac_transformed_pencil_cs2/AC_betamin_jxb__mod__magnetic*2.0*AC_gamma1__mod__magnetic
if (AC_va2max_jxb__mod__magnetic > 0) {
va2max_beta_80_81_103=min(va2max_beta_80_81_103,AC_va2max_jxb__mod__magnetic)
}
rho1_jxb_80_81_103 = rho1_jxb_80_81_103 * pow((1.+pow((ac_transformed_pencil_va2/va2max_beta_80_81_103),AC_va2power_jxb__mod__magnetic)),(-1.0/AC_va2power_jxb__mod__magnetic))
}
ac_transformed_pencil_jxbr = rho1_jxb_80_81_103*ac_transformed_pencil_jxb
}
if (AC_lpencil__mod__cparam[AC_i_jxbr2__mod__cparam-1]) {
ac_transformed_pencil_jxbr2 = dot(ac_transformed_pencil_jxbr,ac_transformed_pencil_jxbr)
}
if (AC_lpencil__mod__cparam[AC_i_ub__mod__cparam-1]) {
ac_transformed_pencil_ub = dot(ac_transformed_pencil_uu,ac_transformed_pencil_bb)
}
if (AC_lpencil__mod__cparam[AC_i_ob__mod__cparam-1]) {
ac_transformed_pencil_ob = dot(ac_transformed_pencil_oo,ac_transformed_pencil_bb)
}
if (AC_lpencil__mod__cparam[AC_i_uj__mod__cparam-1]) {
ac_transformed_pencil_uj = dot(ac_transformed_pencil_uu,ac_transformed_pencil_jj)
}
if (AC_lpencil__mod__cparam[AC_i_cosub__mod__cparam-1]) {
ac_transformed_pencil_cosub = tini_sqrt_div(ac_transformed_pencil_ub,ac_transformed_pencil_u2,ac_transformed_pencil_b2)
}
if (AC_lpencil__mod__cparam[AC_i_uxb2__mod__cparam-1]) {
ac_transformed_pencil_uxb2 = dot(ac_transformed_pencil_uxb,ac_transformed_pencil_uxb)
}
if (AC_lpencil__mod__cparam[AC_i_uxj__mod__cparam-1]) {
ac_transformed_pencil_uxj = cross(ac_transformed_pencil_uu,ac_transformed_pencil_jj)
}
if (AC_lpencil__mod__cparam[AC_i_chibp__mod__cparam-1]) {
ac_transformed_pencil_chibp=atan2(ac_transformed_pencil_bb.y,ac_transformed_pencil_bb.x)+0.5*AC_pi__mod__cparam
}
if (AC_lpencil__mod__cparam[AC_i_stokesi__mod__cparam-1]) {
ac_transformed_pencil_stokesi=pow((ac_transformed_pencil_bb.x*ac_transformed_pencil_bb.x+ac_transformed_pencil_bb.y*ac_transformed_pencil_bb.y),AC_exp_epspb__mod__magnetic)
}
if (AC_lncr_correlated__mod__magnetic) {
stokesi_ncr_80_81_103=ac_transformed_pencil_stokesi*ac_transformed_pencil_b2
if (AC_lpencil__mod__cparam[AC_i_stokesq__mod__cparam-1]) {
ac_transformed_pencil_stokesq=-stokesi_ncr_80_81_103*cos(2.*ac_transformed_pencil_chibp)
}
if (AC_lpencil__mod__cparam[AC_i_stokesu__mod__cparam-1]) {
ac_transformed_pencil_stokesu=-stokesi_ncr_80_81_103*sin(2.*ac_transformed_pencil_chibp)
}
if (AC_lpencil__mod__cparam[AC_i_stokesq1__mod__cparam-1]) {
ac_transformed_pencil_stokesq1=+stokesi_ncr_80_81_103*sin(2.*ac_transformed_pencil_chibp)*ac_transformed_pencil_bb.z
}
if (AC_lpencil__mod__cparam[AC_i_stokesu1__mod__cparam-1]) {
ac_transformed_pencil_stokesu1=-stokesi_ncr_80_81_103*cos(2.*ac_transformed_pencil_chibp)*ac_transformed_pencil_bb.z
}
}
else if (AC_lncr_anticorrelated__mod__magnetic) {
stokesi_ncr_80_81_103=ac_transformed_pencil_stokesi/(1.+AC_ncr_quench__mod__magnetic*ac_transformed_pencil_b2)
if (AC_lpencil__mod__cparam[AC_i_stokesq__mod__cparam-1]) {
ac_transformed_pencil_stokesq=-stokesi_ncr_80_81_103*cos(2.*ac_transformed_pencil_chibp)
}
if (AC_lpencil__mod__cparam[AC_i_stokesu__mod__cparam-1]) {
ac_transformed_pencil_stokesu=-stokesi_ncr_80_81_103*sin(2.*ac_transformed_pencil_chibp)
}
if (AC_lpencil__mod__cparam[AC_i_stokesq1__mod__cparam-1]) {
ac_transformed_pencil_stokesq1=+stokesi_ncr_80_81_103*sin(2.*ac_transformed_pencil_chibp)*ac_transformed_pencil_bb.z
}
if (AC_lpencil__mod__cparam[AC_i_stokesu1__mod__cparam-1]) {
ac_transformed_pencil_stokesu1=-stokesi_ncr_80_81_103*cos(2.*ac_transformed_pencil_chibp)*ac_transformed_pencil_bb.z
}
}
else {
if (AC_lpencil__mod__cparam[AC_i_stokesq__mod__cparam-1]) {
ac_transformed_pencil_stokesq=-ac_transformed_pencil_stokesi*cos(2.*ac_transformed_pencil_chibp)
}
if (AC_lpencil__mod__cparam[AC_i_stokesu__mod__cparam-1]) {
ac_transformed_pencil_stokesu=-ac_transformed_pencil_stokesi*sin(2.*ac_transformed_pencil_chibp)
}
if (AC_lpencil__mod__cparam[AC_i_stokesq1__mod__cparam-1]) {
ac_transformed_pencil_stokesq1=+ac_transformed_pencil_stokesi*sin(2.*ac_transformed_pencil_chibp)*ac_transformed_pencil_bb.z
}
if (AC_lpencil__mod__cparam[AC_i_stokesu1__mod__cparam-1]) {
ac_transformed_pencil_stokesu1=-ac_transformed_pencil_stokesi*cos(2.*ac_transformed_pencil_chibp)*ac_transformed_pencil_bb.z
}
}
if (AC_lpencil__mod__cparam[AC_i_beta1__mod__cparam-1]) {
ac_transformed_pencil_beta1=0.5*ac_transformed_pencil_b2*AC_mu01__mod__cdata/ac_transformed_pencil_pp
}
if (AC_lpencil__mod__cparam[AC_i_beta__mod__cparam-1]) {
ac_transformed_pencil_beta = 2.0 * AC_mu0__mod__cdata * ac_transformed_pencil_pp / max(ac_transformed_pencil_b2, epsilon(1.0))
}
if (AC_lpencil__mod__cparam[AC_i_djuidjbi__mod__cparam-1]) {
ac_transformed_pencil_djuidjbi = contract(ac_transformed_pencil_uij,ac_transformed_pencil_bij)
}
if (AC_lpencil__mod__cparam[AC_i_jo__mod__cparam-1]) {
ac_transformed_pencil_jo = dot(ac_transformed_pencil_jj,ac_transformed_pencil_oo)
}
if (AC_lpencil__mod__cparam[AC_i_ujxb__mod__cparam-1]) {
ac_transformed_pencil_ujxb = dot(ac_transformed_pencil_uu,ac_transformed_pencil_jxb)
}
if (AC_lpencil__mod__cparam[AC_i_gb22__mod__cparam-1]) {
ac_transformed_pencil_gb22 = matmul_transpose(ac_transformed_pencil_bij,ac_transformed_pencil_bb)
}
if (AC_lpencil__mod__cparam[AC_i_ugb__mod__cparam-1]) {
ac_transformed_pencil_ugb = ac_transformed_pencil_bij*ac_transformed_pencil_uu
}
if (AC_lpencil__mod__cparam[AC_i_ugb22__mod__cparam-1]) {
ac_transformed_pencil_ugb22 = dot(ac_transformed_pencil_uu,ac_transformed_pencil_gb22)
}
if (AC_lpencil__mod__cparam[AC_i_bdivu__mod__cparam-1]) {
ac_transformed_pencil_bdivu.x=ac_transformed_pencil_bb.x*ac_transformed_pencil_divu
ac_transformed_pencil_bdivu.y=ac_transformed_pencil_bb.y*ac_transformed_pencil_divu
ac_transformed_pencil_bdivu.z=ac_transformed_pencil_bb.z*ac_transformed_pencil_divu
}
if (AC_lpencil__mod__cparam[AC_i_bgu__mod__cparam-1]) {
ac_transformed_pencil_bgu = ac_transformed_pencil_uij*ac_transformed_pencil_bb
}
if (AC_lpencil__mod__cparam[AC_i_bgb__mod__cparam-1]) {
ac_transformed_pencil_bgb = ac_transformed_pencil_bij*ac_transformed_pencil_bb
}
if (AC_lpencil__mod__cparam[AC_i_bgbp__mod__cparam-1]) {
bbgb_80_81_103 = dot(ac_transformed_pencil_bb,ac_transformed_pencil_bgb)
ac_transformed_pencil_bgbp = bbgb_80_81_103*ac_transformed_pencil_b21*ac_transformed_pencil_bb
}
if (AC_lpencil__mod__cparam[AC_i_ubgbp__mod__cparam-1]) {
ac_transformed_pencil_ubgbp = dot(ac_transformed_pencil_uu,ac_transformed_pencil_bgbp)
}
if (AC_lpencil__mod__cparam[AC_i_oxuxb__mod__cparam-1]) {
ac_transformed_pencil_oxuxb = cross(ac_transformed_pencil_oxu,ac_transformed_pencil_bb)
}
if (AC_lpencil__mod__cparam[AC_i_jxbxb__mod__cparam-1]) {
ac_transformed_pencil_jxbxb = cross(ac_transformed_pencil_jxb,ac_transformed_pencil_bb)
}
if (AC_lpencil__mod__cparam[AC_i_jxbrxb__mod__cparam-1]) {
ac_transformed_pencil_jxbrxb = cross(ac_transformed_pencil_jxbr,ac_transformed_pencil_bb)
}
if (AC_lpencil__mod__cparam[AC_i_glnrhoxb__mod__cparam-1]) {
ac_transformed_pencil_glnrhoxb = cross(ac_transformed_pencil_glnrho,ac_transformed_pencil_bb)
}
if (AC_lpencil__mod__cparam[AC_i_del4a__mod__cparam-1]) {
ac_transformed_pencil_del4a = del4(Field3(Field(AC_iaa__mod__cdata), Field(AC_iaa__mod__cdata+1), Field(AC_iaa__mod__cdata+2)))
}
if (AC_lpencil__mod__cparam[AC_i_hjj__mod__cparam-1]) {
ac_transformed_pencil_hjj = ac_transformed_pencil_del4a
}
if (AC_lpencil__mod__cparam[AC_i_hj2__mod__cparam-1]) {
ac_transformed_pencil_hj2 = dot(ac_transformed_pencil_hjj,ac_transformed_pencil_hjj)
}
if (AC_lpencil__mod__cparam[AC_i_hjb__mod__cparam-1]) {
ac_transformed_pencil_hjb = dot(ac_transformed_pencil_hjj,ac_transformed_pencil_bb)
}
if (AC_lpencil__mod__cparam[AC_i_coshjb__mod__cparam-1]) {
ac_transformed_pencil_coshjb = tini_sqrt_div_separate(ac_transformed_pencil_hjb,ac_transformed_pencil_hj2,ac_transformed_pencil_b2)
}
if (AC_lpencil__mod__cparam[AC_i_hjparallel__mod__cparam-1] || AC_lpencil__mod__cparam[AC_i_hjperp__mod__cparam-1]) {
ac_transformed_pencil_hjparallel=sqrt(ac_transformed_pencil_hj2)*ac_transformed_pencil_coshjb
ac_transformed_pencil_hjperp=sqrt(ac_transformed_pencil_hj2)*sqrt(abs(1-ac_transformed_pencil_coshjb*ac_transformed_pencil_coshjb))
}
if (AC_lpencil__mod__cparam[AC_i_del6a__mod__cparam-1]) {
ac_transformed_pencil_del6a = del6(Field3(Field(AC_iaa__mod__cdata), Field(AC_iaa__mod__cdata+1), Field(AC_iaa__mod__cdata+2)))
}
if (AC_lpencil__mod__cparam[AC_i_e3xa__mod__cparam-1]) {
ac_transformed_pencil_e3xa = cross(ac_transformed_pencil_uxb+AC_eta_hyper3__mod__magnetic*ac_transformed_pencil_del6a,ac_transformed_pencil_aa)
}
if (AC_lpencil__mod__cparam[AC_i_oxj__mod__cparam-1]) {
ac_transformed_pencil_oxj = cross(ac_transformed_pencil_oo,ac_transformed_pencil_jj)
}
if (AC_lpencil__mod__cparam[AC_i_jij__mod__cparam-1]) {
ac_transformed_pencil_jij[1-1][1-1]=0.5*(ac_transformed_pencil_bij[1-1][1-1]+ac_transformed_pencil_bij[1-1][1-1])
ac_transformed_pencil_jij[2-1][1-1]=0.5*(ac_transformed_pencil_bij[2-1][1-1]+ac_transformed_pencil_bij[1-1][2-1])
ac_transformed_pencil_jij[3-1][1-1]=0.5*(ac_transformed_pencil_bij[3-1][1-1]+ac_transformed_pencil_bij[1-1][3-1])
ac_transformed_pencil_jij[1-1][2-1]=0.5*(ac_transformed_pencil_bij[1-1][2-1]+ac_transformed_pencil_bij[2-1][1-1])
ac_transformed_pencil_jij[2-1][2-1]=0.5*(ac_transformed_pencil_bij[2-1][2-1]+ac_transformed_pencil_bij[2-1][2-1])
ac_transformed_pencil_jij[3-1][2-1]=0.5*(ac_transformed_pencil_bij[3-1][2-1]+ac_transformed_pencil_bij[2-1][3-1])
ac_transformed_pencil_jij[1-1][3-1]=0.5*(ac_transformed_pencil_bij[1-1][3-1]+ac_transformed_pencil_bij[3-1][1-1])
ac_transformed_pencil_jij[2-1][3-1]=0.5*(ac_transformed_pencil_bij[2-1][3-1]+ac_transformed_pencil_bij[3-1][2-1])
ac_transformed_pencil_jij[3-1][3-1]=0.5*(ac_transformed_pencil_bij[3-1][3-1]+ac_transformed_pencil_bij[3-1][3-1])
}
if (AC_lpencil__mod__cparam[AC_i_d6ab__mod__cparam-1]) {
ac_transformed_pencil_d6ab = dot(ac_transformed_pencil_del6a,ac_transformed_pencil_bb)
}
if (AC_lpencil__mod__cparam[AC_i_sj__mod__cparam-1]) {
ac_transformed_pencil_sj = contract(ac_transformed_pencil_sij,ac_transformed_pencil_jij)
}
if (AC_lpencil__mod__cparam[AC_i_ss12__mod__cparam-1]) {
ac_transformed_pencil_ss12=sqrt(abs(ac_transformed_pencil_sj))
}
if (AC_lpencil__mod__cparam[AC_i_vmagfric__mod__cparam-1] && AC_numag__mod__magnetic!=0.0) {
tmp1_80_81_103=AC_mu01__mod__cdata/(AC_numag__mod__magnetic*(AC_b0_magfric__mod__magnetic/AC_unit_magnetic__mod__cdata*AC_unit_magnetic__mod__cdata+ac_transformed_pencil_b2))
ac_transformed_pencil_vmagfric.x=abs(ac_transformed_pencil_jxb.x)*tmp1_80_81_103
ac_transformed_pencil_vmagfric.y=abs(ac_transformed_pencil_jxb.y)*tmp1_80_81_103
ac_transformed_pencil_vmagfric.z=abs(ac_transformed_pencil_jxb.z)*tmp1_80_81_103
}
if (AC_lpencil__mod__cparam[AC_i_lam__mod__cparam-1]) {
if (AC_lcoulomb__mod__magnetic) {
ac_transformed_pencil_lam=value(F_LAM)
}
else {
}
}
if (AC_lbb_as_aux__mod__magnetic  &&  ! AC_lbb_as_comaux__mod__magnetic) {
DF_BVEC = ac_transformed_pencil_bb
}
if (AC_ljj_as_aux__mod__magnetic  &&  ! AC_ljj_as_comaux__mod__magnetic) {
DF_JVEC = ac_transformed_pencil_jj
}
if (AC_ljxb_as_aux__mod__magnetic) {
DF_JXBVEC=ac_transformed_pencil_jxb
}
if (AC_lpencil__mod__cparam[AC_i_bb_sph__mod__cparam-1] && AC_lbb_sph_as_aux__mod__magnetic) {
ac_transformed_pencil_bb_sph=value(F_BB_SPHVEC)
}
if (AC_lpencil__mod__cparam[AC_i_mf_emf__mod__cparam-1]) {
ac_transformed_pencil_mf_emf.x = 0.0
ac_transformed_pencil_mf_emf.y = 0.0
ac_transformed_pencil_mf_emf.z = 0.0
}
if (AC_lpencil__mod__cparam[AC_i_mf_emfdotb__mod__cparam-1]) {
ac_transformed_pencil_mf_emfdotb=0.0
}
if(AC_ambipolar_diffusion_int__mod__magnetic == AC_ambipolar_diffusion_int_constant__mod__magnetic) {
ac_transformed_pencil_nu_ni1=AC_nu_ni1__mod__magnetic
}
else if(AC_ambipolar_diffusion_int__mod__magnetic == AC_ambipolar_diffusion_int_ionization_equilibrium__mod__magnetic) {
ac_transformed_pencil_nu_ni1=AC_nu_ni1__mod__magnetic*sqrt(ac_transformed_pencil_rho1)
}
else if(AC_ambipolar_diffusion_int__mod__magnetic == AC_ambipolar_diffusion_int_ionization_yh__mod__magnetic) {
ac_transformed_pencil_nu_ni1=AC_nu_ni1__mod__magnetic*sqrt(ac_transformed_pencil_rho1)*(1.-ac_transformed_pencil_yh)/ac_transformed_pencil_yh
}
else {
}
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
if (AC_lhydro__mod__cparam && AC_llorentzforce__mod__magnetic) {
rho1_jxb_80_81_103=ac_transformed_pencil_rho1
if (AC_rhomin_jxb__mod__magnetic>0) {
rho1_jxb_80_81_103=min(rho1_jxb_80_81_103,1/AC_rhomin_jxb__mod__magnetic)
}
if (AC_va2max_jxb__mod__magnetic>0  &&  (! AC_betamin_jxb__mod__magnetic>0)) {
rho1_jxb_80_81_103 = rho1_jxb_80_81_103 * pow((1+pow((ac_transformed_pencil_va2/AC_va2max_jxb__mod__magnetic),AC_va2power_jxb__mod__magnetic)),(-1.0/AC_va2power_jxb__mod__magnetic))
}
if (AC_betamin_jxb__mod__magnetic>0) {
va2max_beta_80_81_103 = ac_transformed_pencil_cs2/AC_betamin_jxb__mod__magnetic*2.0*AC_gamma1__mod__magnetic
if (AC_va2max_jxb__mod__magnetic > 0) {
va2max_beta_80_81_103=min(va2max_beta_80_81_103,AC_va2max_jxb__mod__magnetic)
}
rho1_jxb_80_81_103 = rho1_jxb_80_81_103 * pow((1+pow((ac_transformed_pencil_va2/va2max_beta_80_81_103),AC_va2power_jxb__mod__magnetic)),(-1.0/AC_va2power_jxb__mod__magnetic))
}
if (AC_lboris_correction__mod__magnetic) {
if (AC_va2max_boris__mod__magnetic>0) {
rho1_jxb_80_81_103 = rho1_jxb_80_81_103 * pow((1+pow((ac_transformed_pencil_va2/AC_va2max_boris__mod__magnetic),2.)),(-0.5))
}
if (AC_cmin__mod__magnetic>0) {
rho1_jxb_80_81_103 = rho1_jxb_80_81_103 * pow((1+pow((ac_transformed_pencil_va2/ac_transformed_pencil_clight2),2.)),(-0.5))
}
}
ac_transformed_pencil_advec_va2=sum((ac_transformed_pencil_bb*dline_1__mod__cdata)*(ac_transformed_pencil_bb*dline_1__mod__cdata))*AC_mu01__mod__cdata*rho1_jxb_80_81_103
}
else {
ac_transformed_pencil_advec_va2=0.
}
if (AC_lisotropic_advection__mod__cdata) {
if (AC_dimensionality__mod__cparam<3) {
ac_transformed_pencil_advec_va2=ac_transformed_pencil_va2*dxyz_2__mod__cdata
}
}
if (AC_lhydro__mod__cparam && AC_hall_term__mod__magnetic!=0.0) {
ac_transformed_pencil_advec_va2=( (ac_transformed_pencil_bb.x*dline_1__mod__cdata.x*( AC_hall_term__mod__magnetic*AC_pi__mod__cparam*dline_1__mod__cdata.x*AC_mu01__mod__cdata  +sqrt(AC_mu01__mod__cdata*ac_transformed_pencil_rho1 + (AC_hall_term__mod__magnetic*AC_pi__mod__cparam*dline_1__mod__cdata.x*AC_mu01__mod__cdata)*(AC_hall_term__mod__magnetic*AC_pi__mod__cparam*dline_1__mod__cdata.x*AC_mu01__mod__cdata) ) ))*(ac_transformed_pencil_bb.x*dline_1__mod__cdata.x*( AC_hall_term__mod__magnetic*AC_pi__mod__cparam*dline_1__mod__cdata.x*AC_mu01__mod__cdata  +sqrt(AC_mu01__mod__cdata*ac_transformed_pencil_rho1 + (AC_hall_term__mod__magnetic*AC_pi__mod__cparam*dline_1__mod__cdata.x*AC_mu01__mod__cdata)*(AC_hall_term__mod__magnetic*AC_pi__mod__cparam*dline_1__mod__cdata.x*AC_mu01__mod__cdata) ) ))  +(ac_transformed_pencil_bb.y*dline_1__mod__cdata.y*( AC_hall_term__mod__magnetic*AC_pi__mod__cparam*dline_1__mod__cdata.y*AC_mu01__mod__cdata  +sqrt(AC_mu01__mod__cdata*ac_transformed_pencil_rho1 + (AC_hall_term__mod__magnetic*AC_pi__mod__cparam*dline_1__mod__cdata.y*AC_mu01__mod__cdata)*(AC_hall_term__mod__magnetic*AC_pi__mod__cparam*dline_1__mod__cdata.y*AC_mu01__mod__cdata) ) ))*(ac_transformed_pencil_bb.y*dline_1__mod__cdata.y*( AC_hall_term__mod__magnetic*AC_pi__mod__cparam*dline_1__mod__cdata.y*AC_mu01__mod__cdata  +sqrt(AC_mu01__mod__cdata*ac_transformed_pencil_rho1 + (AC_hall_term__mod__magnetic*AC_pi__mod__cparam*dline_1__mod__cdata.y*AC_mu01__mod__cdata)*(AC_hall_term__mod__magnetic*AC_pi__mod__cparam*dline_1__mod__cdata.y*AC_mu01__mod__cdata) ) ))  +(ac_transformed_pencil_bb.z*dline_1__mod__cdata.z*( AC_hall_term__mod__magnetic*AC_pi__mod__cparam*dline_1__mod__cdata.z*AC_mu01__mod__cdata  +sqrt(AC_mu01__mod__cdata*ac_transformed_pencil_rho1 + (AC_hall_term__mod__magnetic*AC_pi__mod__cparam*dline_1__mod__cdata.z*AC_mu01__mod__cdata)*(AC_hall_term__mod__magnetic*AC_pi__mod__cparam*dline_1__mod__cdata.z*AC_mu01__mod__cdata) ) ))*(ac_transformed_pencil_bb.z*dline_1__mod__cdata.z*( AC_hall_term__mod__magnetic*AC_pi__mod__cparam*dline_1__mod__cdata.z*AC_mu01__mod__cdata  +sqrt(AC_mu01__mod__cdata*ac_transformed_pencil_rho1 + (AC_hall_term__mod__magnetic*AC_pi__mod__cparam*dline_1__mod__cdata.z*AC_mu01__mod__cdata)*(AC_hall_term__mod__magnetic*AC_pi__mod__cparam*dline_1__mod__cdata.z*AC_mu01__mod__cdata) ) ))  )
}
advec2__mod__cdata=advec2__mod__cdata+ac_transformed_pencil_advec_va2
if (AC_lmagneto_friction__mod__magnetic) {
tmp1_80_81_103 = dot(ac_transformed_pencil_vmagfric,ac_transformed_pencil_vmagfric)
advec2__mod__cdata=advec2__mod__cdata + tmp1_80_81_103
}
}
if (AC_lpencil__mod__cparam[AC_i_gg__mod__cparam-1]) {
ac_transformed_pencil_gg.x = 0.
ac_transformed_pencil_gg.y = 0.
ac_transformed_pencil_gg.z = 0.
}
fmax__mod__hydro=1./AC_impossible__mod__cparam
if (AC_ladvection_velocity__mod__hydro) {
if (! AC_lconservative__mod__hydro  &&  ! AC_lweno_transport__mod__cdata  &&   ! AC_lno_meridional_flow__mod__hydro  &&  ! AC_lfargo_advection__mod__cdata) {
if (AC_lschur_3d3d1d_uu__mod__hydro) {
ugu_schur_x_133 = dot(ac_transformed_pencil_uu,ac_transformed_pencil_uij.row(1-1))
ugu_schur_y_133 = dot(ac_transformed_pencil_uu,ac_transformed_pencil_uij.row(2-1))
ugu_schur_z_133=ac_transformed_pencil_uu.z*ac_transformed_pencil_uij[3-1][3-1]
DF_UX=DF_UX-ugu_schur_x_133
DF_UY=DF_UY-ugu_schur_y_133
DF_UZ=DF_UZ-ugu_schur_z_133
}
else if (AC_lschur_2d2d3d_uu__mod__hydro) {
puij_schur_133[1-1][1-1] = ac_transformed_pencil_uij[1-1][1-1]
puij_schur_133[2-1][1-1] = ac_transformed_pencil_uij[2-1][1-1]
puij_schur_133[3-1][1-1] = ac_transformed_pencil_uij[3-1][1-1]
puij_schur_133[1-1][2-1] = ac_transformed_pencil_uij[1-1][2-1]
puij_schur_133[2-1][2-1] = ac_transformed_pencil_uij[2-1][2-1]
puij_schur_133[3-1][2-1] = ac_transformed_pencil_uij[3-1][2-1]
puij_schur_133[1-1][3-1] = ac_transformed_pencil_uij[1-1][3-1]
puij_schur_133[2-1][3-1] = ac_transformed_pencil_uij[2-1][3-1]
puij_schur_133[3-1][3-1] = ac_transformed_pencil_uij[3-1][3-1]
puij_schur_133[1-1][3-1] = 0
puij_schur_133[2-1][3-1] = 0
ugu_schur_x_133 = dot(ac_transformed_pencil_uu,puij_schur_133.row(1-1))
ugu_schur_y_133 = dot(ac_transformed_pencil_uu,puij_schur_133.row(2-1))
ugu_schur_z_133 = dot(ac_transformed_pencil_uu,puij_schur_133.row(3-1))
DF_UX=DF_UX-ugu_schur_x_133
DF_UY=DF_UY-ugu_schur_y_133
DF_UZ=DF_UZ-ugu_schur_z_133
}
else if (AC_lschur_2d2d1d_uu__mod__hydro) {
puij_schur_133[1-1][1-1] = ac_transformed_pencil_uij[1-1][1-1]
puij_schur_133[2-1][1-1] = ac_transformed_pencil_uij[2-1][1-1]
puij_schur_133[3-1][1-1] = ac_transformed_pencil_uij[3-1][1-1]
puij_schur_133[1-1][2-1] = ac_transformed_pencil_uij[1-1][2-1]
puij_schur_133[2-1][2-1] = ac_transformed_pencil_uij[2-1][2-1]
puij_schur_133[3-1][2-1] = ac_transformed_pencil_uij[3-1][2-1]
puij_schur_133[1-1][3-1] = ac_transformed_pencil_uij[1-1][3-1]
puij_schur_133[2-1][3-1] = ac_transformed_pencil_uij[2-1][3-1]
puij_schur_133[3-1][3-1] = ac_transformed_pencil_uij[3-1][3-1]
puij_schur_133[1-1][3-1] = 0
puij_schur_133[2-1][3-1] = 0
ugu_schur_x_133 = dot(ac_transformed_pencil_uu,puij_schur_133.row(1-1))
ugu_schur_y_133 = dot(ac_transformed_pencil_uu,puij_schur_133.row(2-1))
ugu_schur_z_133=ac_transformed_pencil_uu.z*ac_transformed_pencil_uij[3-1][3-1]
DF_UX=DF_UX-ugu_schur_x_133
DF_UY=DF_UY-ugu_schur_y_133
DF_UZ=DF_UZ-ugu_schur_z_133
}
else {
DF_UVEC=DF_UVEC-ac_transformed_pencil_ugu
}
}
if (AC_ldensity__mod__cparam && AC_lconservative__mod__hydro) {
tmp_133 = derx(Field(AC_itij__mod__hydro+0))
DF_UX=DF_UX-tmp_133
tmp_133 = dery(Field(AC_itij__mod__hydro+1))
DF_UY=DF_UY-tmp_133
tmp_133 = derz(Field(AC_itij__mod__hydro+2))
DF_UZ=DF_UZ-tmp_133
tmp_133 = dery(Field(AC_itij__mod__hydro+3))
DF_UX=DF_UX-tmp_133
tmp_133 = derz(Field(AC_itij__mod__hydro+5))
DF_UX=DF_UX-tmp_133
tmp_133 = derx(Field(AC_itij__mod__hydro+3))
DF_UY=DF_UY-tmp_133
tmp_133 = derz(Field(AC_itij__mod__hydro+4))
DF_UY=DF_UY-tmp_133
tmp_133 = derx(Field(AC_itij__mod__hydro+5))
DF_UZ=DF_UZ-tmp_133
tmp_133 = dery(Field(AC_itij__mod__hydro+4))
DF_UZ=DF_UZ-tmp_133
}
if (AC_lweno_transport__mod__cdata) {
DF_UX=DF_UX-(ac_transformed_pencil_transpurho.x-ac_transformed_pencil_uu.x*ac_transformed_pencil_transprho)*ac_transformed_pencil_rho1
DF_UY=DF_UY-(ac_transformed_pencil_transpurho.y-ac_transformed_pencil_uu.y*ac_transformed_pencil_transprho)*ac_transformed_pencil_rho1
DF_UZ=DF_UZ-(ac_transformed_pencil_transpurho.z-ac_transformed_pencil_uu.z*ac_transformed_pencil_transprho)*ac_transformed_pencil_rho1
}
if (AC_lno_meridional_flow__mod__hydro) {
DF_UX=0.0
DF_UY=0.0
DF_UZ=DF_UZ-ac_transformed_pencil_ugu.z
}
if (AC_lfargo_advection__mod__cdata) {
DF_UVEC=DF_UVEC-ac_transformed_pencil_uuadvec_guu
}
}
if (AC_omega__mod__cdata!=0.) {
if (AC_lcylindrical_coords__mod__cdata) {
if (AC_lcoriolis_force__mod__hydro) {
if (AC_lomega_cyl_xy__mod__hydro) {
c2_108_133= 2*AC_omega__mod__cdata*cos(AC_y__mod__cdata[AC_m__mod__cdata-1])
s2_108_133=-2*AC_omega__mod__cdata*sin(AC_y__mod__cdata[AC_m__mod__cdata-1])
DF_UX=DF_UX-c2_108_133*ac_transformed_pencil_uu.z
DF_UY=DF_UY-s2_108_133*ac_transformed_pencil_uu.z
DF_UZ=DF_UZ+c2_108_133*ac_transformed_pencil_uu.x+s2_108_133*ac_transformed_pencil_uu.y
}
else {
c2_108_133=2*AC_omega__mod__cdata
DF_UX=DF_UX+c2_108_133*ac_transformed_pencil_uu.y
DF_UY=DF_UY-c2_108_133*ac_transformed_pencil_uu.x
}
}
if (AC_lcentrifugal_force__mod__hydro) {
DF_UX=DF_UX+AC_x__mod__cdata[vertexIdx.x]*AC_omega__mod__cdata*AC_omega__mod__cdata
}
}
else if (AC_lspherical_coords__mod__cdata) {
if (AC_lcoriolis_force__mod__hydro) {
c2_109_133= 2*AC_omega__mod__cdata*AC_costh__mod__cdata[AC_m__mod__cdata-1]
s2_109_133=-2*AC_omega__mod__cdata*AC_sinth__mod__cdata[AC_m__mod__cdata-1]
}
if (AC_theta__mod__cdata==0.0) {
if (AC_lcoriolis_force__mod__hydro) {
if (AC_r_omega__mod__hydro != 0.) {
DF_UX=DF_UX- s2_109_133*ac_transformed_pencil_uu.z              *AC_prof_om__mod__hydro[vertexIdx.x-NGHOST_VAL]
DF_UY=DF_UY+ c2_109_133*ac_transformed_pencil_uu.z              *AC_prof_om__mod__hydro[vertexIdx.x-NGHOST_VAL]
DF_UZ=DF_UZ-(c2_109_133*ac_transformed_pencil_uu.y-s2_109_133*ac_transformed_pencil_uu.x)*AC_prof_om__mod__hydro[vertexIdx.x-NGHOST_VAL]
}
else {
DF_UX=DF_UX-s2_109_133*ac_transformed_pencil_uu.z
DF_UY=DF_UY+c2_109_133*ac_transformed_pencil_uu.z
DF_UZ=DF_UZ-c2_109_133*ac_transformed_pencil_uu.y+s2_109_133*ac_transformed_pencil_uu.x
}
}
}
else {
cp2_109_133=2*AC_omega__mod__cdata*AC_cosph__mod__cdata[AC_n__mod__cdata-1]
cs2_109_133=c2_109_133*AC_sinph__mod__cdata[AC_n__mod__cdata-1]
ss2_109_133=s2_109_133*AC_sinph__mod__cdata[AC_n__mod__cdata-1]
if (AC_lcoriolis_force__mod__hydro) {
if (AC_r_omega__mod__hydro != 0.) {
DF_UX=DF_UX+(-cs2_109_133*ac_transformed_pencil_uu.z + cp2_109_133*ac_transformed_pencil_uu.y)*AC_prof_om__mod__hydro[vertexIdx.x-NGHOST_VAL]
DF_UY=DF_UY+(-cp2_109_133*ac_transformed_pencil_uu.x - ss2_109_133*ac_transformed_pencil_uu.z)*AC_prof_om__mod__hydro[vertexIdx.x-NGHOST_VAL]
DF_UZ=DF_UZ+(+ss2_109_133*ac_transformed_pencil_uu.y + cs2_109_133*ac_transformed_pencil_uu.x)*AC_prof_om__mod__hydro[vertexIdx.x-NGHOST_VAL]
}
else {
DF_UX=DF_UX - cs2_109_133*ac_transformed_pencil_uu.z + cp2_109_133*ac_transformed_pencil_uu.y
DF_UY=DF_UY - cp2_109_133*ac_transformed_pencil_uu.x - ss2_109_133*ac_transformed_pencil_uu.z
DF_UZ=DF_UZ + ss2_109_133*ac_transformed_pencil_uu.y + cs2_109_133*ac_transformed_pencil_uu.x
}
}
}
if (AC_lcentrifugal_force__mod__hydro) {
om2_109_133=AC_amp_centforce__mod__hydro*AC_omega__mod__cdata*AC_omega__mod__cdata
if (AC_theta__mod__cdata==0.0) {
DF_UX=DF_UX-om2_109_133*AC_x__mod__cdata[vertexIdx.x]*AC_sinth__mod__cdata[AC_m__mod__cdata-1]
}
else {
}
}
}
else if (AC_lprecession__mod__hydro) {
DF_UX=DF_UX + AC_mat_cent__mod__hydro[1-1][1-1]*ac_transformed_pencil_rr.x + AC_mat_cori__mod__hydro[1-1][1-1]*ac_transformed_pencil_uu.x
DF_UY=DF_UY + AC_mat_cent__mod__hydro[2-1][1-1]*ac_transformed_pencil_rr.x + AC_mat_cori__mod__hydro[2-1][1-1]*ac_transformed_pencil_uu.x
DF_UZ=DF_UZ + AC_mat_cent__mod__hydro[3-1][1-1]*ac_transformed_pencil_rr.x + AC_mat_cori__mod__hydro[3-1][1-1]*ac_transformed_pencil_uu.x
DF_UX=DF_UX + AC_mat_cent__mod__hydro[1-1][2-1]*ac_transformed_pencil_rr.y + AC_mat_cori__mod__hydro[1-1][2-1]*ac_transformed_pencil_uu.y
DF_UY=DF_UY + AC_mat_cent__mod__hydro[2-1][2-1]*ac_transformed_pencil_rr.y + AC_mat_cori__mod__hydro[2-1][2-1]*ac_transformed_pencil_uu.y
DF_UZ=DF_UZ + AC_mat_cent__mod__hydro[3-1][2-1]*ac_transformed_pencil_rr.y + AC_mat_cori__mod__hydro[3-1][2-1]*ac_transformed_pencil_uu.y
DF_UX=DF_UX + AC_mat_cent__mod__hydro[1-1][3-1]*ac_transformed_pencil_rr.z + AC_mat_cori__mod__hydro[1-1][3-1]*ac_transformed_pencil_uu.z
DF_UY=DF_UY + AC_mat_cent__mod__hydro[2-1][3-1]*ac_transformed_pencil_rr.z + AC_mat_cori__mod__hydro[2-1][3-1]*ac_transformed_pencil_uu.z
DF_UZ=DF_UZ + AC_mat_cent__mod__hydro[3-1][3-1]*ac_transformed_pencil_rr.z + AC_mat_cori__mod__hydro[3-1][3-1]*ac_transformed_pencil_uu.z
}
else if (AC_lrotation_xaxis__mod__hydro) {
if (AC_omega__mod__cdata != 0.  &&  AC_lcoriolis_force__mod__hydro) {
c2_111_133= 2*AC_omega__mod__cdata*cos(AC_theta__mod__cdata*AC_pi__mod__cparam/180.)
s2_111_133=-2*AC_omega__mod__cdata*sin(AC_theta__mod__cdata*AC_pi__mod__cparam/180.)
DF_UX=DF_UX-s2_111_133*ac_transformed_pencil_uu.z
DF_UY=DF_UY+c2_111_133*ac_transformed_pencil_uu.z
DF_UZ=DF_UZ-c2_111_133*ac_transformed_pencil_uu.y+s2_111_133*ac_transformed_pencil_uu.x
}
}
else {
if (AC_omega__mod__cdata !=0.) {
if (AC_theta__mod__cdata==0) {
if (AC_lcoriolis_force__mod__hydro) {
c2_112_133=2*AC_omega__mod__cdata
DF_UX=DF_UX+c2_112_133*ac_transformed_pencil_uu.y
DF_UY=DF_UY-c2_112_133*ac_transformed_pencil_uu.x
}
if (AC_lcentrifugal_force__mod__hydro) {
DF_UX=DF_UX+AC_x__mod__cdata[vertexIdx.x]*AC_amp_centforce__mod__hydro*AC_omega__mod__cdata*AC_omega__mod__cdata
DF_UY=DF_UY+AC_y__mod__cdata[AC_m__mod__cdata-1]*AC_amp_centforce__mod__hydro*AC_omega__mod__cdata*AC_omega__mod__cdata
}
}
else {
if (AC_lcoriolis_force__mod__hydro) {
c2_112_133= 2*AC_omega__mod__cdata*cos(AC_theta__mod__cdata*AC_dtor__mod__cparam)
s2_112_133=-2*AC_omega__mod__cdata*sin(AC_theta__mod__cdata*AC_dtor__mod__cparam)
DF_UX=DF_UX+c2_112_133*ac_transformed_pencil_uu.y
DF_UY=DF_UY-c2_112_133*ac_transformed_pencil_uu.x+s2_112_133*ac_transformed_pencil_uu.z
DF_UZ=DF_UZ           -s2_112_133*ac_transformed_pencil_uu.y
if (AC_lshear_in_coriolis__mod__hydro) {
DF_UX=DF_UX+c2_112_133*AC_sshear__mod__cdata*AC_x__mod__cdata[vertexIdx.x]
DF_UZ=DF_UZ-s2_112_133*AC_sshear__mod__cdata*AC_x__mod__cdata[vertexIdx.x]
}
}
}
}
}
}
c1_113_133=-2*AC_ampl_omega__mod__hydro*sin(AC_pi__mod__cparam*((AC_x__mod__cdata[vertexIdx.x])-AC_x0__mod__cdata)/AC_lx__mod__cdata)
c2_113_133= 2*AC_ampl_omega__mod__hydro*cos(AC_pi__mod__cparam*((AC_x__mod__cdata[vertexIdx.x])-AC_x0__mod__cdata)/AC_lx__mod__cdata)
DF_UX=DF_UX             +c2_113_133*ac_transformed_pencil_uu.y
DF_UY=DF_UY+c1_113_133*ac_transformed_pencil_uu.z-c2_113_133*ac_transformed_pencil_uu.x
DF_UZ=DF_UZ-c1_113_133*ac_transformed_pencil_uu.y
if (AC_lmagfield_nu__mod__viscosity) {
DF_UVEC = DF_UVEC + ac_transformed_pencil_fvisc/(1.+ac_transformed_pencil_b2/AC_meanfield_nub__mod__viscosity*AC_meanfield_nub__mod__viscosity)
}
else {
DF_UVEC = DF_UVEC + ac_transformed_pencil_fvisc
}
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
diffus_nu__mod__viscosity = ac_transformed_pencil_diffus_total*dxyz_2__mod__cdata
if (AC_ldynamical_diffusion__mod__cdata  &&  AC_lvisc_hyper3_mesh__mod__viscosity) {
diffus_nu3__mod__viscosity = ac_transformed_pencil_diffus_total3 * sum(abs(dline_1__mod__cdata))
}
else {
diffus_nu3__mod__viscosity = ac_transformed_pencil_diffus_total3*dxyz_6__mod__cdata
}
maxdiffus__mod__cdata =max(maxdiffus__mod__cdata ,diffus_nu__mod__viscosity)
maxdiffus2__mod__cdata=max(maxdiffus2__mod__cdata,ac_transformed_pencil_diffus_total2*dxyz_4__mod__cdata)
maxdiffus3__mod__cdata=max(maxdiffus3__mod__cdata,diffus_nu3__mod__viscosity)
}
if (AC_ldiagnos__mod__cdata) {
if (AC_idiag_reshock__mod__viscosity!=0) {
if (abs(ac_transformed_pencil_shock) > AC_tini__mod__cparam) {
reshock_117_118_133 = dxmax_pencil__mod__cdata*sqrt(ac_transformed_pencil_u2)/(AC_nu_shock__mod__viscosity*ac_transformed_pencil_shock)
}
else {
reshock_117_118_133=0.
}
}
if (AC_idiag_epsk_les__mod__viscosity!=0) {
if (AC_lvisc_smag_simplified__mod__viscosity) {
}
else if (AC_lvisc_smag_cross_simplified__mod__viscosity) {
}
}
if (AC_idiag_sijoiojm__mod__viscosity!=0) {
tmp_117_118_133=0.
tmp_117_118_133=tmp_117_118_133+ac_transformed_pencil_sij[1-1][1-1]*ac_transformed_pencil_oo.x*ac_transformed_pencil_oo.x
tmp_117_118_133=tmp_117_118_133+ac_transformed_pencil_sij[1-1][2-1]*ac_transformed_pencil_oo.x*ac_transformed_pencil_oo.y
tmp_117_118_133=tmp_117_118_133+ac_transformed_pencil_sij[1-1][3-1]*ac_transformed_pencil_oo.x*ac_transformed_pencil_oo.z
tmp_117_118_133=tmp_117_118_133+ac_transformed_pencil_sij[2-1][1-1]*ac_transformed_pencil_oo.y*ac_transformed_pencil_oo.x
tmp_117_118_133=tmp_117_118_133+ac_transformed_pencil_sij[2-1][2-1]*ac_transformed_pencil_oo.y*ac_transformed_pencil_oo.y
tmp_117_118_133=tmp_117_118_133+ac_transformed_pencil_sij[2-1][3-1]*ac_transformed_pencil_oo.y*ac_transformed_pencil_oo.z
tmp_117_118_133=tmp_117_118_133+ac_transformed_pencil_sij[3-1][1-1]*ac_transformed_pencil_oo.z*ac_transformed_pencil_oo.x
tmp_117_118_133=tmp_117_118_133+ac_transformed_pencil_sij[3-1][2-1]*ac_transformed_pencil_oo.z*ac_transformed_pencil_oo.y
tmp_117_118_133=tmp_117_118_133+ac_transformed_pencil_sij[3-1][3-1]*ac_transformed_pencil_oo.z*ac_transformed_pencil_oo.z
}
if (AC_lmagnetic__mod__cparam) {
if (AC_idiag_nud2uxbxm__mod__viscosity!=0 || AC_idiag_nud2uxbym__mod__viscosity!=0 || AC_idiag_nud2uxbzm__mod__viscosity!=0) {
nud2uxb_117_118_133 = cross(ac_transformed_pencil_fvisc,ac_transformed_pencil_bb)
}
}
if (AC_idiag_fviscm__mod__viscosity!=0  ||  AC_idiag_fviscrmsx__mod__viscosity!=0  ||  AC_idiag_fviscmin__mod__viscosity!=0  ||  AC_idiag_fviscmax__mod__viscosity!=0) {
fvisc2_117_118_133 = dot(ac_transformed_pencil_fvisc,ac_transformed_pencil_fvisc)
}
if (AC_idiag_qfviscm__mod__viscosity!=0) {
qfvisc_117_118_133 = dot(ac_transformed_pencil_curlo,ac_transformed_pencil_fvisc)
}
}
if (AC_l1davgfirst__mod__cdata) {
if (AC_idiag_viscforcezupmz__mod__viscosity!=0) {
if (ac_transformed_pencil_uu.z > 0.) {
uus_117_118_133 = ac_transformed_pencil_rho*ac_transformed_pencil_fvisc.z
}
else {
uus_117_118_133=0.
}
}
if (AC_idiag_viscforcezdownmz__mod__viscosity!=0) {
if (ac_transformed_pencil_uu.z < 0.) {
uus_117_118_133 = ac_transformed_pencil_rho*ac_transformed_pencil_fvisc.z
}
else {
uus_117_118_133=0.
}
}
}
if (AC_l2davgfirst__mod__cdata) {
if (AC_idiag_fviscmxy__mod__viscosity!=0) {
if (AC_lvisc_sqrtrho_nu_const__mod__viscosity) {
}
else if (AC_lvisc_rho_nu_const__mod__viscosity) {
}
else if (AC_lvisc_nu_profy_bound__mod__viscosity) {
}
else {
}
}
if (AC_idiag_fviscymxy__mod__viscosity!=0) {
if (AC_lyang__mod__cdata) {
fluxv_117_118_133.x=0.
fluxv_117_118_133.y=ac_transformed_pencil_uu.x*ac_transformed_pencil_sij[1-1][2-1]+ac_transformed_pencil_uu.y*ac_transformed_pencil_sij[2-1][2-1]+ac_transformed_pencil_uu.z*ac_transformed_pencil_sij[3-1][2-1]
fluxv_117_118_133.z=ac_transformed_pencil_uu.x*ac_transformed_pencil_sij[1-1][3-1]+ac_transformed_pencil_uu.y*ac_transformed_pencil_sij[2-1][3-1]+ac_transformed_pencil_uu.z*ac_transformed_pencil_sij[3-1][3-1]
}
else {
}
}
if (AC_idiag_fviscrsphmphi__mod__viscosity!=0) {
fluxv_117_118_133.x=ac_transformed_pencil_uu.x*ac_transformed_pencil_sij[1-1][1-1]+ac_transformed_pencil_uu.y*ac_transformed_pencil_sij[2-1][1-1]+ac_transformed_pencil_uu.z*ac_transformed_pencil_sij[3-1][1-1]
fluxv_117_118_133.y=ac_transformed_pencil_uu.x*ac_transformed_pencil_sij[1-1][2-1]+ac_transformed_pencil_uu.y*ac_transformed_pencil_sij[2-1][2-1]+ac_transformed_pencil_uu.z*ac_transformed_pencil_sij[3-1][2-1]
fluxv_117_118_133.z=ac_transformed_pencil_uu.x*ac_transformed_pencil_sij[1-1][3-1]+ac_transformed_pencil_uu.y*ac_transformed_pencil_sij[2-1][3-1]+ac_transformed_pencil_uu.z*ac_transformed_pencil_sij[3-1][3-1]
}
}
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata && AC_ladvection_velocity__mod__hydro) {
maxadvec__mod__cdata=maxadvec__mod__cdata+ac_transformed_pencil_advec_uu
}
if (AC_ekman_friction__mod__hydro!=0) {
DF_UVEC=DF_UVEC-AC_frict__mod__hydro*ac_transformed_pencil_uu
}
if (AC_lboussinesq__mod__cparam && AC_ltemperature__mod__cparam) {
if (AC_lsphere_in_a_box__mod__cdata) {
DF_UX=DF_UX + ac_transformed_pencil_r_mn*AC_ra__mod__hydro*AC_pr__mod__hydro*value(F_TT)*ac_transformed_pencil_evr.x
DF_UY=DF_UY + ac_transformed_pencil_r_mn*AC_ra__mod__hydro*AC_pr__mod__hydro*value(F_TT)*ac_transformed_pencil_evr.y
DF_UZ=DF_UZ + ac_transformed_pencil_r_mn*AC_ra__mod__hydro*AC_pr__mod__hydro*value(F_TT)*ac_transformed_pencil_evr.z
}
else {
DF_UZ=DF_UZ+AC_ra__mod__hydro*AC_pr__mod__hydro*value(F_TT)
}
}
if (AC_lforcing_cont_uu__mod__hydro) {
DF_UVEC=DF_UVEC + AC_ampl_fcont_uu__mod__hydro*ac_transformed_pencil_fcont[1-1]
}
if ((AC_dampu__mod__hydro != 0.)  &&  (AC_t__mod__cdata < AC_tdamp__mod__hydro)) {
if (AC_dampu__mod__hydro > 0.0) {
DF_UVEC = DF_UVEC - AC_fade_fact__mod__hydro*AC_dampu__mod__hydro*value(F_UVEC)
}
else {
DF_UVEC = DF_UVEC + AC_fade_fact__mod__hydro*AC_dampu__mod__hydro/AC_dt__mod__cdata*value(F_UVEC)
}
}
if (AC_dampuext__mod__hydro > 0.0  &&  AC_rdampext__mod__hydro != AC_impossible__mod__cparam) {
step_vector_return_value_120_126_133 = 0.5*(1+tanh((ac_transformed_pencil_r_mn-AC_rdampext__mod__hydro)/(AC_wdamp__mod__hydro+AC_tini__mod__cparam)))
pdamp_126_133 = step_vector_return_value_120_126_133
DF_UX = DF_UX - AC_dampuext__mod__hydro*pdamp_126_133*value(F_UX)
DF_UY = DF_UY - AC_dampuext__mod__hydro*pdamp_126_133*value(F_UY)
DF_UZ = DF_UZ - AC_dampuext__mod__hydro*pdamp_126_133*value(F_UZ)
}
if (AC_dampuint__mod__hydro > 0.0  &&  AC_rdampint__mod__hydro != AC_impossible__mod__cparam) {
step_vector_return_value_121_126_133 = 0.5*(1+tanh((ac_transformed_pencil_r_mn-AC_rdampint__mod__hydro)/(AC_wdamp__mod__hydro+AC_tini__mod__cparam)))
pdamp_126_133 = 1 - step_vector_return_value_121_126_133
DF_UX = DF_UX - AC_dampuint__mod__hydro*pdamp_126_133*value(F_UX)
DF_UY = DF_UY - AC_dampuint__mod__hydro*pdamp_126_133*value(F_UY)
DF_UZ = DF_UZ - AC_dampuint__mod__hydro*pdamp_126_133*value(F_UZ)
}
if (AC_lomega_int__mod__hydro) {
if (AC_lcylinder_in_a_box__mod__cdata) {
step_vector_return_value_122_126_133 = 0.5*(1+tanh((ac_transformed_pencil_rcyl_mn-AC_rdampext__mod__hydro)/(AC_wdamp__mod__hydro+AC_tini__mod__cparam)))
pdamp_126_133 = step_vector_return_value_122_126_133
}
else {
step_vector_return_value_123_126_133 = 0.5*(1+tanh((ac_transformed_pencil_r_mn-AC_rdampext__mod__hydro)/(AC_wdamp__mod__hydro+AC_tini__mod__cparam)))
pdamp_126_133 = step_vector_return_value_123_126_133
}
fext__mod__hydro = -AC_dampuext__mod__hydro*pdamp_126_133*value(F_UVEC)
DF_UVEC=DF_UVEC+fext__mod__hydro
if (AC_dampuint__mod__hydro > 0.0) {
if (AC_lcylinder_in_a_box__mod__cdata) {
step_vector_return_value_124_126_133 = 0.5*(1+tanh((ac_transformed_pencil_rcyl_mn-AC_rdampint__mod__hydro)/(AC_wdamp__mod__hydro+AC_tini__mod__cparam)))
pdamp_126_133 = 1 - step_vector_return_value_124_126_133
}
else {
step_vector_return_value_125_126_133 = 0.5*(1+tanh((ac_transformed_pencil_r_mn-AC_rdampint__mod__hydro)/(AC_wdamp__mod__hydro+AC_tini__mod__cparam)))
pdamp_126_133 = 1 - step_vector_return_value_125_126_133
}
fint__mod__hydro.x=-AC_dampuint__mod__hydro*pdamp_126_133*(value(F_UX)+AC_y__mod__cdata[AC_m__mod__cdata-1]*AC_omega_int__mod__hydro)
fint__mod__hydro.y=-AC_dampuint__mod__hydro*pdamp_126_133*(value(F_UY)-AC_x__mod__cdata[vertexIdx.x]*AC_omega_int__mod__hydro)
fint__mod__hydro.z=-AC_dampuint__mod__hydro*pdamp_126_133*(value(F_UZ))
DF_UVEC=DF_UVEC+fint__mod__hydro
}
}
if (AC_velocity_ceiling__mod__hydro>0.0) {
if (value(F_UX)> AC_velocity_ceiling__mod__hydro) {
DF_UX= AC_velocity_ceiling__mod__hydro
}
if (value(F_UX)<-AC_velocity_ceiling__mod__hydro) {
DF_UX=-AC_velocity_ceiling__mod__hydro
}
if (value(F_UY)> AC_velocity_ceiling__mod__hydro) {
DF_UY= AC_velocity_ceiling__mod__hydro
}
if (value(F_UY)<-AC_velocity_ceiling__mod__hydro) {
DF_UY=-AC_velocity_ceiling__mod__hydro
}
if (value(F_UZ)> AC_velocity_ceiling__mod__hydro) {
DF_UY= AC_velocity_ceiling__mod__hydro
}
if (value(F_UZ)<-AC_velocity_ceiling__mod__hydro) {
DF_UY=-AC_velocity_ceiling__mod__hydro
}
}
if (AC_ladv_der_as_aux__mod__cdata) {
DF__ADV_DERVEC = ac_transformed_pencil_fpres + ac_transformed_pencil_fvisc
if (AC_lgrav__mod__cparam) {
DF__ADV_DERVEC = value(F__ADV_DERVEC) + ac_transformed_pencil_gg
}
}
if (AC_luu_sph_as_aux__mod__hydro && AC_lsphere_in_a_box__mod__cdata) {
DF_UU_SPHR = ac_transformed_pencil_uu.x*ac_transformed_pencil_evr.x+ac_transformed_pencil_uu.y*ac_transformed_pencil_evr.y+ac_transformed_pencil_uu.z*ac_transformed_pencil_evr.z
DF_UU_SPHT = ac_transformed_pencil_uu.x*ac_transformed_pencil_evth.x+ac_transformed_pencil_uu.y*ac_transformed_pencil_evth.y+ac_transformed_pencil_uu.z*ac_transformed_pencil_evth.z
DF_UU_SPHP = ac_transformed_pencil_uu.x*ac_transformed_pencil_phix+ac_transformed_pencil_uu.y*ac_transformed_pencil_phiy
}
if (AC_tau_damp_ruxm__mod__hydro!=0.) {
DF_UX=DF_UX-AC_ruxm__mod__hydro*ac_transformed_pencil_rho1*AC_tau_damp_ruxm1__mod__hydro
}
if (AC_tau_damp_ruym__mod__hydro!=0.) {
DF_UY=DF_UY-AC_ruym__mod__hydro*ac_transformed_pencil_rho1*AC_tau_damp_ruym1__mod__hydro
}
if (AC_tau_damp_ruzm__mod__hydro!=0.) {
DF_UZ=DF_UZ-AC_ruzm__mod__hydro*ac_transformed_pencil_rho1*AC_tau_damp_ruzm1__mod__hydro
}
lborder_driving_132_133 = true
if(AC_borderuu_int__mod__hydro.x == AC_borderuu_int_zero__mod__hydro) {
f_target_132_133.x=0.
}
else if(AC_borderuu_int__mod__hydro.x == AC_borderuu_int_constant__mod__hydro) {
f_target_132_133.x = AC_uu_const__mod__hydro.x
}
else if(AC_borderuu_int__mod__hydro.x == AC_borderuu_int_initial_condition__mod__hydro) {
ju_132_133=1+AC_iuu__mod__cdata-1
}
else if(AC_borderuu_int__mod__hydro.x == AC_borderuu_int_nothing__mod__hydro) {
}
if(AC_borderuu_int__mod__hydro.y == AC_borderuu_int_zero__mod__hydro) {
f_target_132_133.y=0.
}
else if(AC_borderuu_int__mod__hydro.y == AC_borderuu_int_constant__mod__hydro) {
f_target_132_133.y = AC_uu_const__mod__hydro.y
}
else if(AC_borderuu_int__mod__hydro.y == AC_borderuu_int_initial_condition__mod__hydro) {
ju_132_133=2+AC_iuu__mod__cdata-1
}
else if(AC_borderuu_int__mod__hydro.y == AC_borderuu_int_nothing__mod__hydro) {
}
if(AC_borderuu_int__mod__hydro.z == AC_borderuu_int_zero__mod__hydro) {
f_target_132_133.z=0.
}
else if(AC_borderuu_int__mod__hydro.z == AC_borderuu_int_constant__mod__hydro) {
f_target_132_133.z = AC_uu_const__mod__hydro.z
}
else if(AC_borderuu_int__mod__hydro.z == AC_borderuu_int_initial_condition__mod__hydro) {
ju_132_133=3+AC_iuu__mod__cdata-1
}
else if(AC_borderuu_int__mod__hydro.z == AC_borderuu_int_nothing__mod__hydro) {
}
if ( AC_lfirst__mod__cdata && AC_ldt__mod__cdata && (AC_lcdt_tauf__mod__hydro || AC_ldiagnos__mod__cdata && AC_idiag_dtf__mod__hydro!=0)  ||   AC_ldiagnos__mod__cdata && AC_idiag_taufmin__mod__hydro!=0 ) {
if (abs(ac_transformed_pencil_uu.x)>1) {
uu1_133=1./ac_transformed_pencil_uu.x
}
else {
uu1_133=1.
}
ftot_133=abs(DF_UX*uu1_133)
if (AC_ldt__mod__cdata && AC_lcdt_tauf__mod__hydro) {
dt1_max__mod__cdata=max(dt1_max__mod__cdata,ftot_133/AC_cdtf__mod__cdata)
}
if (AC_ldiagnos__mod__cdata && (AC_idiag_dtf__mod__hydro!=0 || AC_idiag_taufmin__mod__hydro!=0)) {
fmax__mod__hydro=max(fmax__mod__hydro,ftot_133)
}
if (abs(ac_transformed_pencil_uu.y)>1) {
uu1_133=1./ac_transformed_pencil_uu.y
}
else {
uu1_133=1.
}
ftot_133=abs(DF_UY*uu1_133)
if (AC_ldt__mod__cdata && AC_lcdt_tauf__mod__hydro) {
dt1_max__mod__cdata=max(dt1_max__mod__cdata,ftot_133/AC_cdtf__mod__cdata)
}
if (AC_ldiagnos__mod__cdata && (AC_idiag_dtf__mod__hydro!=0 || AC_idiag_taufmin__mod__hydro!=0)) {
fmax__mod__hydro=max(fmax__mod__hydro,ftot_133)
}
if (abs(ac_transformed_pencil_uu.z)>1) {
uu1_133=1./ac_transformed_pencil_uu.z
}
else {
uu1_133=1.
}
ftot_133=abs(DF_UY*uu1_133)
if (AC_ldt__mod__cdata && AC_lcdt_tauf__mod__hydro) {
dt1_max__mod__cdata=max(dt1_max__mod__cdata,ftot_133/AC_cdtf__mod__cdata)
}
if (AC_ldiagnos__mod__cdata && (AC_idiag_dtf__mod__hydro!=0 || AC_idiag_taufmin__mod__hydro!=0)) {
fmax__mod__hydro=max(fmax__mod__hydro,ftot_133)
}
}
if (AC_lschur_3d3d1d__mod__density) {
}
else {
if (AC_lcontinuity_gas__mod__density) {
if (! AC_lweno_transport__mod__cdata  &&  ! AC_lffree__mod__density  &&  ! AC_lreduced_sound_speed__mod__density  &&   AC_ieos_profile_int__mod__density ==AC_ieos_profile_int_nothing__mod__density  &&  ! AC_lfargo_advection__mod__cdata) {
if (AC_ldensity_nolog__mod__cdata) {
if (AC_lconservative__mod__hydro) {
density_rhs_146=-ac_transformed_pencil_divss
}
else {
density_rhs_146=-ac_transformed_pencil_rho*ac_transformed_pencil_divu
if (AC_ladvection_density__mod__density) {
density_rhs_146 = density_rhs_146 - ac_transformed_pencil_ugrho
}
if (AC_lrelativistic_eos__mod__density) {
density_rhs_146=AC_fourthird__mod__cparam*density_rhs_146
}
}
}
else {
density_rhs_146= - ac_transformed_pencil_divu
if (AC_ladvection_density__mod__density) {
density_rhs_146 = density_rhs_146 - ac_transformed_pencil_uglnrho
}
if (AC_lrelativistic_eos__mod__density && !AC_lconservative__mod__hydro) {
if (AC_lhydro__mod__cparam) {
tmpv_146.x=ac_transformed_pencil_uu.x*density_rhs_146
tmpv_146.y=ac_transformed_pencil_uu.y*density_rhs_146
tmpv_146.z=ac_transformed_pencil_uu.z*density_rhs_146
DF_UVEC=DF_UVEC-AC_onethird__mod__cparam*tmpv_146
}
density_rhs_146=AC_fourthird__mod__cparam*density_rhs_146
}
}
}
else {
density_rhs_146=0.
}
if (AC_lweno_transport__mod__cdata) {
density_rhs_146= density_rhs_146 - ac_transformed_pencil_transprho
}
if (AC_ieos_profile_int__mod__density==AC_ieos_profile_int_surface_z__mod__density) {
if (AC_ldensity_nolog__mod__cdata) {
density_rhs_146= density_rhs_146 - AC_profz_eos__mod__density[AC_n__mod__cdata-1]*(ac_transformed_pencil_ugrho + ac_transformed_pencil_rho*ac_transformed_pencil_divu)
if (AC_ldensity_profile_masscons__mod__density) {
density_rhs_146 = density_rhs_146-AC_dprofz_eos__mod__density[AC_n__mod__cdata-1]*ac_transformed_pencil_rho*ac_transformed_pencil_uu.z
}
}
else {
density_rhs_146= density_rhs_146 - AC_profz_eos__mod__density[AC_n__mod__cdata-1]*(ac_transformed_pencil_uglnrho + ac_transformed_pencil_divu)
if (AC_ldensity_profile_masscons__mod__density) {
density_rhs_146 = density_rhs_146 -AC_dprofz_eos__mod__density[AC_n__mod__cdata-1]*ac_transformed_pencil_uu.z
}
}
}
if (AC_lffree__mod__density) {
if (AC_ldensity_nolog__mod__cdata) {
density_rhs_146= density_rhs_146 - AC_profx_ffree__mod__density[vertexIdx.x-NGHOST_VAL]*AC_profy_ffree__mod__density[AC_m__mod__cdata-1]*AC_profz_ffree__mod__density[AC_n__mod__cdata-1]*(ac_transformed_pencil_ugrho + ac_transformed_pencil_rho*ac_transformed_pencil_divu)
if (AC_ldensity_profile_masscons__mod__density) {
density_rhs_146=density_rhs_146 - ac_transformed_pencil_rho*( AC_dprofx_ffree__mod__density[vertexIdx.x-NGHOST_VAL]   *ac_transformed_pencil_uu.x  +AC_dprofy_ffree__mod__density[AC_m__mod__cdata-1]*ac_transformed_pencil_uu.y  +AC_dprofz_ffree__mod__density[AC_n__mod__cdata-1]*ac_transformed_pencil_uu.z)
}
}
else {
density_rhs_146= density_rhs_146 - AC_profx_ffree__mod__density[vertexIdx.x-NGHOST_VAL]*(AC_profy_ffree__mod__density[AC_m__mod__cdata-1]*AC_profz_ffree__mod__density[AC_n__mod__cdata-1])*(ac_transformed_pencil_uglnrho + ac_transformed_pencil_divu)
if (AC_ldensity_profile_masscons__mod__density) {
density_rhs_146=density_rhs_146-AC_dprofx_ffree__mod__density[vertexIdx.x-NGHOST_VAL]   *ac_transformed_pencil_uu.x  -AC_dprofy_ffree__mod__density[AC_m__mod__cdata-1]*ac_transformed_pencil_uu.y  -AC_dprofz_ffree__mod__density[AC_n__mod__cdata-1]*ac_transformed_pencil_uu.z
}
}
}
if (AC_lreduced_sound_speed__mod__density) {
if (AC_ldensity_nolog__mod__cdata) {
density_rhs_146 = density_rhs_146 - AC_reduce_cs2_profx__mod__density[vertexIdx.x-NGHOST_VAL]*AC_reduce_cs2_profz__mod__density[AC_n__mod__cdata-1]*(ac_transformed_pencil_ugrho + ac_transformed_pencil_rho*ac_transformed_pencil_divu)
}
else {
density_rhs_146 = density_rhs_146 - AC_reduce_cs2_profx__mod__density[vertexIdx.x-NGHOST_VAL]*AC_reduce_cs2_profz__mod__density[AC_n__mod__cdata-1]*(ac_transformed_pencil_uglnrho + ac_transformed_pencil_divu)
}
}
if (AC_lfargo_advection__mod__cdata) {
if (AC_ldensity_nolog__mod__cdata) {
density_rhs_146 = density_rhs_146 - ac_transformed_pencil_uuadvec_grho   - ac_transformed_pencil_rho*ac_transformed_pencil_divu
}
else {
density_rhs_146 = density_rhs_146 - ac_transformed_pencil_uuadvec_glnrho - ac_transformed_pencil_divu
}
}
DF_LNRHO = DF_LNRHO + density_rhs_146
}
if(AC_mass_source_profile_int__mod__density == AC_mass_source_profile_int_nothing__mod__density) {
}
else if(AC_mass_source_profile_int__mod__density == AC_mass_source_profile_int_exponential__mod__density) {
dlnrhodt_138_146=AC_mass_source_mdot__mod__density
}
else if(AC_mass_source_profile_int__mod__density == AC_mass_source_profile_int_bump__mod__density) {
dlnrhodt_138_146=(AC_mass_source_mdot__mod__density/AC_fnorm__mod__density)*exp(-0.5*(ac_transformed_pencil_r_mn/AC_mass_source_sigma__mod__density)*(ac_transformed_pencil_r_mn/AC_mass_source_sigma__mod__density))
}
else if(AC_mass_source_profile_int__mod__density == AC_mass_source_profile_int_bump2__mod__density) {
dlnrhodt_138_146=AC_fprofile_z__mod__density[AC_n__mod__cdata-AC_n1__mod__cparam+1-1]
}
else if(AC_mass_source_profile_int__mod__density == AC_mass_source_profile_int_bumpr__mod__density) {
radius2_138_146=(AC_x__mod__cdata[vertexIdx.x]-AC_xblob__mod__density[1-1])*(AC_x__mod__cdata[vertexIdx.x]-AC_xblob__mod__density[1-1])+(AC_y__mod__cdata[AC_m__mod__cdata-1]-AC_yblob__mod__density[1-1])*(AC_y__mod__cdata[AC_m__mod__cdata-1]-AC_yblob__mod__density[1-1])+(AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_zblob__mod__density[1-1])*(AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_zblob__mod__density[1-1])
fprofile_138_146=(AC_mass_source_mdot__mod__density/AC_fnorm__mod__density)*exp(-0.5*radius2_138_146/AC_mass_source_sigma__mod__density*AC_mass_source_sigma__mod__density)
if (AC_lmass_source_random__mod__density) {
}
else {
dlnrhodt_138_146=fprofile_138_146*cos(AC_mass_source_omega__mod__density*AC_t__mod__cdata)
}
}
else if(AC_mass_source_profile_int__mod__density == AC_mass_source_profile_int_bumpx__mod__density || AC_mass_source_profile_int__mod__density == AC_mass_source_profile_int_sph_step_down__mod__density) {
dlnrhodt_138_146=AC_fprofile_x__mod__density[vertexIdx.x-NGHOST_VAL]
}
else if(AC_mass_source_profile_int__mod__density == AC_mass_source_profile_int_const__mod__density) {
dlnrhodt_138_146=-AC_mass_source_tau1__mod__density*(value(F_LNRHO)-AC_lnrho0__mod__equationofstate)
}
else if(AC_mass_source_profile_int__mod__density == AC_mass_source_profile_int_cylindric__mod__density) {
step_vector_return_value_136_138_146 = 0.5*(1+tanh((ac_transformed_pencil_rcyl_mn-AC_r_int__mod__cdata)/(AC_wdamp__mod__density+AC_tini__mod__cparam)))
pdamp_138_146=1.-step_vector_return_value_136_138_146
dlnrhodt_138_146=-AC_damplnrho_int__mod__density*pdamp_138_146*(value(F_LNRHO)-AC_lnrho_int__mod__density)
step_vector_return_value_137_138_146 = 0.5*(1+tanh((ac_transformed_pencil_rcyl_mn-AC_r_ext__mod__cdata)/(AC_wdamp__mod__density+AC_tini__mod__cparam)))
pdamp_138_146=step_vector_return_value_137_138_146
dlnrhodt_138_146=dlnrhodt_138_146-AC_damplnrho_ext__mod__density*pdamp_138_146*(value(F_LNRHO)-AC_lnrho_ext__mod__density)
}
else {
}
if (AC_ldensity_nolog__mod__cdata) {
DF_RHO=DF_RHO+ac_transformed_pencil_rho*dlnrhodt_138_146
}
else {
DF_LNRHO=DF_LNRHO+dlnrhodt_138_146
}
if (AC_lentropy__mod__cparam) {
DF_SS=DF_SS+(AC_gamma1__mod__density-1.0)*dlnrhodt_138_146
}
diffus_diffrho__mod__density=0.
diffus_diffrho3__mod__density=0.
fdiff_146=0.0
ldt_up_146 = AC_lfirst__mod__cdata && AC_ldt__mod__cdata
if (AC_ldiff_normal__mod__density) {
if (AC_ldensity_nolog__mod__cdata) {
fdiff_146 = fdiff_146 + AC_diffrho__mod__density*ac_transformed_pencil_del2rho
}
else {
if (AC_ldiffusion_nolog__mod__density) {
fdiff_146 = fdiff_146 + AC_diffrho__mod__density*ac_transformed_pencil_rho1*ac_transformed_pencil_del2rho
}
else {
fdiff_146 = fdiff_146 + AC_diffrho__mod__density*(ac_transformed_pencil_del2lnrho+ac_transformed_pencil_glnrho2)
}
}
if (ldt_up_146) {
diffus_diffrho__mod__density=diffus_diffrho__mod__density+AC_diffrho__mod__density
}
}
if (AC_ldiff_cspeed__mod__density) {
if (AC_ldensity_nolog__mod__cdata) {
fdiff_146 = fdiff_146 + AC_diffrho__mod__density*pow(ac_transformed_pencil_tt,AC_diff_cspeed__mod__density)*ac_transformed_pencil_del2rho
}
else {
if (AC_ldiffusion_nolog__mod__density) {
fdiff_146 = fdiff_146 + AC_diffrho__mod__density*pow(ac_transformed_pencil_tt,AC_diff_cspeed__mod__density)*ac_transformed_pencil_rho1*ac_transformed_pencil_del2rho
}
else {
fdiff_146 = fdiff_146 + AC_diffrho__mod__density*pow(ac_transformed_pencil_tt,AC_diff_cspeed__mod__density)*(ac_transformed_pencil_del2lnrho+ac_transformed_pencil_glnrho2)
}
}
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
diffus_diffrho__mod__density=diffus_diffrho__mod__density+AC_diffrho__mod__density
}
}
if (AC_ldiff_shock__mod__density) {
if (AC_ldensity_nolog__mod__cdata) {
tmp_146 = dot(ac_transformed_pencil_gshock,ac_transformed_pencil_grho)
fdiff_146 = fdiff_146 + AC_diffrho_shock__mod__density * (ac_transformed_pencil_shock * ac_transformed_pencil_del2rho + tmp_146)
}
else {
if (AC_ldiffusion_nolog__mod__density) {
tmp_146 = dot(ac_transformed_pencil_gshock,ac_transformed_pencil_grho)
fdiff_146 = fdiff_146 + ac_transformed_pencil_rho1 * AC_diffrho_shock__mod__density * (ac_transformed_pencil_shock * ac_transformed_pencil_del2rho + tmp_146)
}
else {
tmp_146 = dot(ac_transformed_pencil_gshock,ac_transformed_pencil_glnrho)
fdiff_146 = fdiff_146 + AC_diffrho_shock__mod__density * (ac_transformed_pencil_shock * (ac_transformed_pencil_del2lnrho + ac_transformed_pencil_glnrho2) + tmp_146)
if (AC_lanti_shockdiffusion__mod__density) {
fdiff_146 = fdiff_146 - AC_diffrho_shock__mod__density * (ac_transformed_pencil_shock*(AC_del2lnrho_glnrho2_init_z__mod__density[AC_n__mod__cdata-1] +  2*(ac_transformed_pencil_glnrho.z-AC_dlnrhodz_init_z__mod__density[AC_n__mod__cdata-1])*AC_dlnrhodz_init_z__mod__density[AC_n__mod__cdata-1]) +  ac_transformed_pencil_gshock.z*AC_dlnrhodz_init_z__mod__density[AC_n__mod__cdata-1] )
}
}
}
if (ldt_up_146) {
diffus_diffrho__mod__density=diffus_diffrho__mod__density+AC_diffrho_shock__mod__density*ac_transformed_pencil_shock
}
}
if (AC_ldensity_slope_limited__mod__density && AC_llast__mod__cdata) {
if (AC_ldensity_nolog__mod__cdata) {
not_implemented("calc_slope_diff_flux")
fdiff_146=fdiff_146+tmp_146
}
else {
not_implemented("calc_slope_diff_flux")
fdiff_146=fdiff_146+tmp_146*ac_transformed_pencil_rho1
}
}
if (AC_lmassdiff_fix__mod__density && !AC_lconservative__mod__hydro) {
if (AC_ldensity_nolog__mod__cdata) {
tmp_146 = fdiff_146*ac_transformed_pencil_rho1
}
else {
tmp_146 = fdiff_146
}
if (AC_lhydro__mod__cparam && (!AC_lhydro_potential__mod__cparam)) {
DF_UVEC = DF_UVEC - ac_transformed_pencil_uu*tmp_146
}
if (AC_lentropy__mod__cparam && (!AC_pretend_lntt__mod__cdata)) {
DF_SS = DF_SS - ac_transformed_pencil_cv*tmp_146
}
else if (AC_lentropy__mod__cparam && AC_pretend_lntt__mod__cdata) {
DF_LNTT = DF_LNTT - tmp_146
}
else if (AC_ltemperature__mod__cparam && (! AC_ltemperature_nolog__mod__cdata)) {
DF_LNTT = DF_LNTT - tmp_146
}
else if (AC_ltemperature__mod__cparam && AC_ltemperature_nolog__mod__cdata) {
DF_TT = DF_TT - tmp_146*ac_transformed_pencil_tt
}
else if (AC_lthermal_energy__mod__cparam) {
DF_ETH = DF_ETH + 0.5 * fdiff_146 * ac_transformed_pencil_u2
}
}
if (AC_ldiff_hyper3__mod__density || AC_ldiff_hyper3_strict__mod__density) {
if (AC_ldensity_nolog__mod__cdata) {
fdiff_146 = fdiff_146 + AC_diffrho_hyper3__mod__density*ac_transformed_pencil_del6rho
}
else {
if (AC_ldiffusion_nolog__mod__density) {
fdiff_146 = fdiff_146 + AC_diffrho_hyper3__mod__density*ac_transformed_pencil_rho1*ac_transformed_pencil_del6rho
}
}
if (ldt_up_146) {
diffus_diffrho3__mod__density=diffus_diffrho3__mod__density+AC_diffrho_hyper3__mod__density
}
}
if (AC_ldiff_hyper3_polar__mod__density) {
if (AC_ldensity_nolog__mod__cdata) {
tmp_146 = der6x_ignore_spacing(Field(AC_irho__mod__cdata))
}
else {
tmp_146 = der6x_ignore_spacing(Field(AC_ilnrho__mod__cdata))
}
fdiff_146 = fdiff_146 + AC_diffrho_hyper3__mod__density*AC_pi4_1__mod__cparam*tmp_146*dline_1__mod__cdata.x*dline_1__mod__cdata.x
if (AC_ldensity_nolog__mod__cdata) {
tmp_146 = der6y_ignore_spacing(Field(AC_irho__mod__cdata))
}
else {
tmp_146 = der6y_ignore_spacing(Field(AC_ilnrho__mod__cdata))
}
fdiff_146 = fdiff_146 + AC_diffrho_hyper3__mod__density*AC_pi4_1__mod__cparam*tmp_146*dline_1__mod__cdata.y*dline_1__mod__cdata.y
if (AC_ldensity_nolog__mod__cdata) {
tmp_146 = der6z_ignore_spacing(Field(AC_irho__mod__cdata))
}
else {
tmp_146 = der6z_ignore_spacing(Field(AC_ilnrho__mod__cdata))
}
fdiff_146 = fdiff_146 + AC_diffrho_hyper3__mod__density*AC_pi4_1__mod__cparam*tmp_146*dline_1__mod__cdata.z*dline_1__mod__cdata.z
if (ldt_up_146) {
diffus_diffrho3__mod__density=diffus_diffrho3__mod__density+AC_diffrho_hyper3__mod__density*AC_pi4_1__mod__cparam*dxmin_pencil__mod__cdata*dxmin_pencil__mod__cdata*dxmin_pencil__mod__cdata*dxmin_pencil__mod__cdata
}
}
if (AC_ldiff_hyper3_mesh__mod__density) {
tmp_146 = der6x_ignore_spacing(Field(AC_ilnrho__mod__cdata))
if (AC_ldynamical_diffusion__mod__cdata) {
fdiff_146 = fdiff_146 + AC_diffrho_hyper3_mesh__mod__density * tmp_146 * dline_1__mod__cdata.x
}
else {
fdiff_146 = fdiff_146 + AC_diffrho_hyper3_mesh__mod__density*AC_pi5_1__mod__cparam/60.*tmp_146*dline_1__mod__cdata.x
}
tmp_146 = der6y_ignore_spacing(Field(AC_ilnrho__mod__cdata))
if (AC_ldynamical_diffusion__mod__cdata) {
fdiff_146 = fdiff_146 + AC_diffrho_hyper3_mesh__mod__density * tmp_146 * dline_1__mod__cdata.y
}
else {
fdiff_146 = fdiff_146 + AC_diffrho_hyper3_mesh__mod__density*AC_pi5_1__mod__cparam/60.*tmp_146*dline_1__mod__cdata.y
}
tmp_146 = der6z_ignore_spacing(Field(AC_ilnrho__mod__cdata))
if (AC_ldynamical_diffusion__mod__cdata) {
fdiff_146 = fdiff_146 + AC_diffrho_hyper3_mesh__mod__density * tmp_146 * dline_1__mod__cdata.z
}
else {
fdiff_146 = fdiff_146 + AC_diffrho_hyper3_mesh__mod__density*AC_pi5_1__mod__cparam/60.*tmp_146*dline_1__mod__cdata.z
}
if (ldt_up_146) {
if (AC_ldynamical_diffusion__mod__cdata) {
diffus_diffrho3__mod__density = diffus_diffrho3__mod__density + AC_diffrho_hyper3_mesh__mod__density
advec_hypermesh_rho_146=0.
}
else {
advec_hypermesh_rho_146=AC_diffrho_hyper3_mesh__mod__density*AC_pi5_1__mod__cparam*sqrt(dxyz_2__mod__cdata)
}
advec2_hypermesh__mod__cdata=advec2_hypermesh__mod__cdata+advec_hypermesh_rho_146*advec_hypermesh_rho_146
}
}
if (AC_ldiff_hyper3_aniso__mod__density) {
tmp_146  = del6fj(Field(AC_ilnrho__mod__cdata), AC_diffrho_hyper3_aniso__mod__density)
fdiff_146 = fdiff_146 + tmp_146
if (AC_lsubtract_init_stratification__mod__density) {
tmp_146  = del6fj(Field(AC_iglobal_lnrho0__mod__cdata), AC_diffrho_hyper3_aniso__mod__density)
fdiff_146 = fdiff_146 - tmp_146
}
if (ldt_up_146) {
diffus_diffrho3__mod__density=diffus_diffrho3__mod__density +  (AC_diffrho_hyper3_aniso__mod__density.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x +  AC_diffrho_hyper3_aniso__mod__density.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y +  AC_diffrho_hyper3_aniso__mod__density.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z)/dxyz_6__mod__cdata
}
}
if (AC_ldiff_hyper3lnrho__mod__density  ||  AC_ldiff_hyper3lnrho_strict__mod__density) {
if (! AC_ldensity_nolog__mod__cdata) {
fdiff_146 = fdiff_146 + AC_diffrho_hyper3__mod__density*ac_transformed_pencil_del6lnrho
}
if (ldt_up_146) {
diffus_diffrho3__mod__density=diffus_diffrho3__mod__density+AC_diffrho_hyper3__mod__density
}
}
if (AC_ldensity_nolog__mod__cdata) {
DF_RHO   = DF_RHO   + fdiff_146
}
else {
DF_LNRHO = DF_LNRHO + fdiff_146
}
if (ldt_up_146) {
diffus_diffrho__mod__density = diffus_diffrho__mod__density*dxyz_2__mod__cdata
if (AC_ldynamical_diffusion__mod__cdata  &&  AC_ldiff_hyper3_mesh__mod__density) {
diffus_diffrho3__mod__density = diffus_diffrho3__mod__density * sum(abs(dline_1__mod__cdata))
}
else {
diffus_diffrho3__mod__density = diffus_diffrho3__mod__density*dxyz_6__mod__cdata
}
maxdiffus__mod__cdata=max(maxdiffus__mod__cdata,diffus_diffrho__mod__density)
maxdiffus3__mod__cdata=max(maxdiffus3__mod__cdata,diffus_diffrho3__mod__density)
}
if(AC_borderlnrho_int__mod__density == AC_borderlnrho_int_zero__mod__density) {
if (AC_ldensity_nolog__mod__cdata) {
f_target_145_146=0.
}
else {
f_target_145_146=1.
}
}
else if(AC_borderlnrho_int__mod__density == AC_borderlnrho_int_constant__mod__density) {
if (AC_ldensity_nolog__mod__cdata) {
f_target_145_146=AC_rho_const__mod__density
}
else {
f_target_145_146=AC_lnrho_const__mod__density
}
}
else if(AC_borderlnrho_int__mod__density == AC_borderlnrho_int_initial_condition__mod__density) {
}
else if(AC_borderlnrho_int__mod__density == AC_borderlnrho_int_nothing__mod__density) {
}
}
hmax__mod__energy = 1./AC_impossible__mod__cparam
ssmax__mod__energy = 1./AC_impossible__mod__cparam
if (AC_lhydro__mod__cparam) {
if (AC_lpressuregradient_gas__mod__hydro) {
DF_UVEC = DF_UVEC + ac_transformed_pencil_fpres
if (AC_lreference_state__mod__cdata) {
DF_UX = DF_UX + AC_reference_state__mod__density[vertexIdx.x][AC_iref_gp__mod__cparam-1]*ac_transformed_pencil_rho1
}
}
if (AC_beta_glnrho_scaled__mod__density.x != 0.0  ||  AC_beta_glnrho_scaled__mod__density.y != 0.0  ||  AC_beta_glnrho_scaled__mod__density.z != 0.0) {
DF_UVEC = DF_UVEC - ac_transformed_pencil_cs2*AC_beta_glnrho_scaled__mod__density
}
if (AC_tau_cor__mod__energy>0) {
ztop_254=AC_xyz0__mod__cdata.z+AC_lxyz__mod__cdata.z
if (AC_z__mod__cdata[AC_n__mod__cdata-1]>=AC_z_cor__mod__energy) {
xi_254=(AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_z_cor__mod__energy)/(ztop_254-AC_z_cor__mod__energy)
profile_cor_254=xi_254*xi_254*(3-2*xi_254)
DF_UVEC = DF_UVEC - profile_cor_254*value(F_UVEC)/AC_tau_cor__mod__energy
}
}
}
if (AC_ladvection_entropy__mod__energy) {
if (AC_pretend_lntt__mod__cdata) {
DF_SS = DF_SS - ac_transformed_pencil_divu*AC_gamma_m1__mod__energy-ac_transformed_pencil_uglntt
}
else {
if (AC_lweno_transport__mod__cdata) {
DF_SS=DF_SS - ac_transformed_pencil_transprhos*ac_transformed_pencil_rho1 + ac_transformed_pencil_ss*ac_transformed_pencil_rho1*ac_transformed_pencil_transprho
}
else if (AC_lfargo_advection__mod__cdata) {
DF_SS = DF_SS - ac_transformed_pencil_uuadvec_gss
}
else {
DF_SS = DF_SS - ac_transformed_pencil_ugss
}
}
}
if (AC_grads0_imposed__mod__energy.x!=0.) {
DF_SS=DF_SS-AC_grads0_imposed__mod__energy.x*ac_transformed_pencil_uu.x
}
if (AC_grads0_imposed__mod__energy.y!=0.) {
DF_SS=DF_SS-AC_grads0_imposed__mod__energy.y*ac_transformed_pencil_uu.y
}
if (AC_grads0_imposed__mod__energy.z!=0.) {
DF_SS=DF_SS-AC_grads0_imposed__mod__energy.z*ac_transformed_pencil_uu.z
}
diffus_chi__mod__energy=0.
diffus_chi3__mod__energy=0.
if (AC_lentropy__mod__cparam) {
if (AC_pretend_lntt__mod__cdata) {
DF_SS = DF_SS + ac_transformed_pencil_cv1*ac_transformed_pencil_tt1*ac_transformed_pencil_visc_heat
}
else {
DF_SS = DF_SS + ac_transformed_pencil_tt1*ac_transformed_pencil_visc_heat
}
}
else if (AC_ltemperature__mod__cparam) {
if (AC_ltemperature_nolog__mod__cdata) {
DF_TT = DF_TT + ac_transformed_pencil_cv1*ac_transformed_pencil_visc_heat
}
else {
if (AC_lno_visc_heat_zbound__mod__viscosity) {
if (false) {
}
else {
relshift_148_149_254=0.0
}
xi_148_149_254 = (AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_no_visc_heat_z0__mod__viscosity)/(AC_no_visc_heat_zwidth__mod__viscosity+AC_tini__mod__cparam) - relshift_148_149_254
xi_148_149_254 = max(xi_148_149_254,-1.0)
xi_148_149_254 = min(xi_148_149_254, 1.0)
cubic_step_pt_return_value_148_149_254 = 0.5 + xi_148_149_254*(0.75-xi_148_149_254*xi_148_149_254*0.25)
DF_LNTT = DF_LNTT +  ac_transformed_pencil_cv1*ac_transformed_pencil_tt1*ac_transformed_pencil_visc_heat*cubic_step_pt_return_value_148_149_254
}
else {
DF_LNTT = DF_LNTT + ac_transformed_pencil_cv1*ac_transformed_pencil_tt1*ac_transformed_pencil_visc_heat
}
}
}
else if (AC_lthermal_energy__mod__cparam) {
if (AC_lstratz__mod__cdata) {
DF_ETH = DF_ETH + ac_transformed_pencil_rho * ac_transformed_pencil_visc_heat / AC_eth0z__mod__viscosity[AC_n__mod__cdata-1]
}
else {
DF_ETH = DF_ETH + ac_transformed_pencil_rho * ac_transformed_pencil_visc_heat
}
}
if (AC_ldt__mod__cdata && AC_lfirst__mod__cdata  ||  AC_ldiagnos__mod__cdata) {
hmax__mod__energy=hmax__mod__energy+ac_transformed_pencil_visc_heat
}
if (AC_hcond0__mod__energy!=0. || AC_lread_hcond__mod__energy) {
if (!AC_lmultilayer__mod__energy) {
hcond__mod__energy=AC_hcond0__mod__energy
glhc_159_254.x = 0.
glhc_159_254.y = 0.
glhc_159_254.z = 0.
}
if (AC_lmultilayer__mod__energy) {
if (AC_lgravz__mod__cdata) {
hcond__mod__energy=AC_hcond_prof__mod__energy[AC_n__mod__cdata-AC_NGHOST_VAL__mod__cparam-1]
glhc_159_254.z=AC_dlnhcond_prof__mod__energy[AC_n__mod__cdata-AC_NGHOST_VAL__mod__cparam-1]
glhc_159_254.x=0.
glhc_159_254.y=0.
}
else if (AC_lsphere_in_a_box__mod__cdata || AC_lcylinder_in_a_box__mod__cdata) {
if (true && AC_lhcond_global__mod__energy) {
hcond__mod__energy = value(F_GLOBAL_HCOND)
glhc_159_254= value(F_GLOBAL_GLHVEC)
}
else {
if (true) {
r_mn_157_159_254=ac_transformed_pencil_r_mn
r_mn1_157_159_254=ac_transformed_pencil_r_mn1
}
else {
r_mn_157_159_254=sqrt(AC_x__mod__cdata[vertexIdx.x]*AC_x__mod__cdata[vertexIdx.x]+AC_y__mod__cdata[AC_m__mod__cdata-1]*AC_y__mod__cdata[AC_m__mod__cdata-1]+AC_z__mod__cdata[AC_n__mod__cdata-1]*AC_z__mod__cdata[AC_n__mod__cdata-1])
r_mn1_157_159_254=1./r_mn_157_159_254
}
arg_152_157_159_254 = abs((r_mn_157_159_254-AC_r_bcz__mod__energy)/(AC_widthss__mod__energy+AC_tini__mod__cparam))
if (abs(arg_152_157_159_254)>=8.)  {
der_step_return_value_152_157_159_254 = 2./AC_widthss__mod__energy*exp(-2.*abs(arg_152_157_159_254))
}
else {
der_step_return_value_152_157_159_254 = 0.5/(AC_widthss__mod__energy*cosh(arg_152_157_159_254)*cosh(arg_152_157_159_254))
}
arg_153_157_159_254 = abs((r_mn_157_159_254-AC_r_ext__mod__cdata)/(AC_widthss__mod__energy+AC_tini__mod__cparam))
if (abs(arg_153_157_159_254)>=8.)  {
der_step_return_value_153_157_159_254 = 2./AC_widthss__mod__energy*exp(-2.*abs(arg_153_157_159_254))
}
else {
der_step_return_value_153_157_159_254 = 0.5/(AC_widthss__mod__energy*cosh(arg_153_157_159_254)*cosh(arg_153_157_159_254))
}
hcond__mod__energy =  (AC_hcond1__mod__energy-1.)*der_step_return_value_152_157_159_254  +(AC_hcond2__mod__energy-1.)*der_step_return_value_153_157_159_254
glhc_159_254.x = hcond__mod__energy*AC_x__mod__cdata[vertexIdx.x]*r_mn1_157_159_254
glhc_159_254.y = hcond__mod__energy*AC_y__mod__cdata[AC_m__mod__cdata-1]*r_mn1_157_159_254
if (AC_lcylinder_in_a_box__mod__cdata) {
glhc_159_254.z = 0.0
}
else {
glhc_159_254.z = hcond__mod__energy*AC_z__mod__cdata[AC_n__mod__cdata-1]*r_mn1_157_159_254
}
step_vector_return_value_154_157_159_254 = 0.5*(1+tanh((r_mn_157_159_254-AC_r_bcz__mod__energy)/(AC_widthss__mod__energy+AC_tini__mod__cparam)))
step_vector_return_value_155_157_159_254 = 0.5*(1+tanh((r_mn_157_159_254-AC_r_ext__mod__cdata)/(AC_widthss__mod__energy+AC_tini__mod__cparam)))
hcond__mod__energy = 1.+(AC_hcond1__mod__energy-1.)*step_vector_return_value_154_157_159_254  +(AC_hcond2__mod__energy-1.)*step_vector_return_value_155_157_159_254
loptest_return_value_156_157_159_254 = false
if (true) {
loptest_return_value_156_157_159_254=true
}
else if (false) {
}
if (loptest_return_value_156_157_159_254) {
glhc_159_254.x=glhc_159_254.x/hcond__mod__energy
glhc_159_254.y=glhc_159_254.y/hcond__mod__energy
glhc_159_254.z=glhc_159_254.z/hcond__mod__energy
}
else {
glhc_159_254 = AC_hcond0__mod__energy*glhc_159_254
}
hcond__mod__energy = AC_hcond0__mod__energy*hcond__mod__energy
}
}
else {
hcond__mod__energy=AC_hcond_prof__mod__energy[vertexIdx.x]
glhc_159_254.x=AC_dlnhcond_prof__mod__energy[vertexIdx.x]
glhc_159_254.y=0.
glhc_159_254.z=0.
}
}
chix_159_254 = ac_transformed_pencil_rho1*hcond__mod__energy*ac_transformed_pencil_cp1
glnthcond_159_254 = ac_transformed_pencil_glntt + glhc_159_254
g2_159_254 = dot(ac_transformed_pencil_glntt,glnthcond_159_254)
if (AC_pretend_lntt__mod__cdata) {
thdiff_159_254 = ac_transformed_pencil_cv1*ac_transformed_pencil_rho1*hcond__mod__energy * (ac_transformed_pencil_del2lntt + g2_159_254)
}
else {
if (AC_lhcond0_density_dep__mod__energy) {
glnrhoglnt_159_254 = dot(ac_transformed_pencil_glntt,ac_transformed_pencil_glnrho)
thdiff_159_254 = sqrt(ac_transformed_pencil_rho1)*hcond__mod__energy * (ac_transformed_pencil_del2lntt + g2_159_254+0.5*glnrhoglnt_159_254)
chix_159_254 = sqrt(ac_transformed_pencil_rho1)*hcond__mod__energy*ac_transformed_pencil_cp1
}
else {
thdiff_159_254 = ac_transformed_pencil_rho1*hcond__mod__energy * (ac_transformed_pencil_del2lntt + g2_159_254)
}
}
}
if (AC_chi_t__mod__energy!=0.) {
if (!AC_lmultilayer__mod__energy) {
chit_prof__mod__energy=1.
gradchit_prof_159_254.x = 0.
gradchit_prof_159_254.y = 0.
gradchit_prof_159_254.z = 0.
}
if (AC_lmultilayer__mod__energy) {
if (AC_lgravz__mod__cdata) {
chit_prof__mod__energy=AC_chit_prof_stored__mod__energy[AC_n__mod__cdata-AC_NGHOST_VAL__mod__cparam-1]
gradchit_prof_159_254.z=AC_dchit_prof_stored__mod__energy[AC_n__mod__cdata-AC_NGHOST_VAL__mod__cparam-1]
gradchit_prof_159_254.x=0.
gradchit_prof_159_254.y=0.
}
else if (AC_lsphere_in_a_box__mod__cdata) {
if (true && AC_lhcond_global__mod__energy) {
chit_prof__mod__energy = value(F_GLOBAL_HCOND)
gradchit_prof_159_254= value(F_GLOBAL_GLHVEC)
}
else {
if (true) {
r_mn_158_159_254=ac_transformed_pencil_r_mn
r_mn1_158_159_254=ac_transformed_pencil_r_mn1
}
else {
r_mn_158_159_254=sqrt(AC_x__mod__cdata[vertexIdx.x]*AC_x__mod__cdata[vertexIdx.x]+AC_y__mod__cdata[AC_m__mod__cdata-1]*AC_y__mod__cdata[AC_m__mod__cdata-1]+AC_z__mod__cdata[AC_n__mod__cdata-1]*AC_z__mod__cdata[AC_n__mod__cdata-1])
r_mn1_158_159_254=1./r_mn_158_159_254
}
arg_152_158_159_254 = abs((r_mn_158_159_254-AC_xbot__mod__energy)/(AC_widthss__mod__energy+AC_tini__mod__cparam))
if (abs(arg_152_158_159_254)>=8.)  {
der_step_return_value_152_158_159_254 = 2./AC_widthss__mod__energy*exp(-2.*abs(arg_152_158_159_254))
}
else {
der_step_return_value_152_158_159_254 = 0.5/(AC_widthss__mod__energy*cosh(arg_152_158_159_254)*cosh(arg_152_158_159_254))
}
arg_153_158_159_254 = abs((r_mn_158_159_254-AC_xtop__mod__energy)/(AC_widthss__mod__energy+AC_tini__mod__cparam))
if (abs(arg_153_158_159_254)>=8.)  {
der_step_return_value_153_158_159_254 = 2./AC_widthss__mod__energy*exp(-2.*abs(arg_153_158_159_254))
}
else {
der_step_return_value_153_158_159_254 = 0.5/(AC_widthss__mod__energy*cosh(arg_153_158_159_254)*cosh(arg_153_158_159_254))
}
chit_prof__mod__energy =  (AC_chit_prof1__mod__energy-1.)*der_step_return_value_152_158_159_254  +(AC_chit_prof2__mod__energy-1.)*der_step_return_value_153_158_159_254
gradchit_prof_159_254.x = chit_prof__mod__energy*AC_x__mod__cdata[vertexIdx.x]*r_mn1_158_159_254
gradchit_prof_159_254.y = chit_prof__mod__energy*AC_y__mod__cdata[AC_m__mod__cdata-1]*r_mn1_158_159_254
if (AC_lcylinder_in_a_box__mod__cdata) {
gradchit_prof_159_254.z = 0.0
}
else {
gradchit_prof_159_254.z = chit_prof__mod__energy*AC_z__mod__cdata[AC_n__mod__cdata-1]*r_mn1_158_159_254
}
step_vector_return_value_154_158_159_254 = 0.5*(1+tanh((r_mn_158_159_254-AC_xbot__mod__energy)/(AC_widthss__mod__energy+AC_tini__mod__cparam)))
step_vector_return_value_155_158_159_254 = 0.5*(1+tanh((r_mn_158_159_254-AC_xtop__mod__energy)/(AC_widthss__mod__energy+AC_tini__mod__cparam)))
chit_prof__mod__energy = 1.+(AC_chit_prof1__mod__energy-1.)*step_vector_return_value_154_158_159_254  +(AC_chit_prof2__mod__energy-1.)*step_vector_return_value_155_158_159_254
loptest_return_value_156_158_159_254 = false
if (false) {
}
else if (false) {
}
if (loptest_return_value_156_158_159_254) {
gradchit_prof_159_254.x=gradchit_prof_159_254.x/chit_prof__mod__energy
gradchit_prof_159_254.y=gradchit_prof_159_254.y/chit_prof__mod__energy
gradchit_prof_159_254.z=gradchit_prof_159_254.z/chit_prof__mod__energy
}
else {
gradchit_prof_159_254 = 1.*gradchit_prof_159_254
}
chit_prof__mod__energy = 1.*chit_prof__mod__energy
}
}
else {
chit_prof__mod__energy=AC_chit_prof_stored__mod__energy[vertexIdx.x]
gradchit_prof_159_254.x=AC_dchit_prof_stored__mod__energy[vertexIdx.x]
gradchit_prof_159_254.y=0.
gradchit_prof_159_254.z=0.
}
}
if (AC_lcalc_ssmean__mod__energy  ||  AC_lcalc_ssmeanxy__mod__energy) {
if (AC_lcalc_ssmean__mod__energy) {
gss1__mod__energy.x=ac_transformed_pencil_gss.x-AC_gssmz__mod__energy[AC_n__mod__cdata-AC_n1__mod__cparam+1-1][1-1]
gss1__mod__energy.y=ac_transformed_pencil_gss.y-AC_gssmz__mod__energy[AC_n__mod__cdata-AC_n1__mod__cparam+1-1][2-1]
gss1__mod__energy.z=ac_transformed_pencil_gss.z-AC_gssmz__mod__energy[AC_n__mod__cdata-AC_n1__mod__cparam+1-1][3-1]
del2ss1_159_254=ac_transformed_pencil_del2ss-AC_del2ssmz__mod__energy[AC_n__mod__cdata-AC_n1__mod__cparam+1-1]
}
else if (AC_lcalc_ssmeanxy__mod__energy) {
gss1__mod__energy.x=ac_transformed_pencil_gss.x-AC_gssmx__mod__energy[vertexIdx.x][1-1]
gss1__mod__energy.y=ac_transformed_pencil_gss.y-AC_gssmx__mod__energy[vertexIdx.x][2-1]
gss1__mod__energy.z=ac_transformed_pencil_gss.z-AC_gssmx__mod__energy[vertexIdx.x][3-1]
del2ss1_159_254=ac_transformed_pencil_del2ss-AC_del2ssmx__mod__energy[vertexIdx.x-NGHOST_VAL]
}
if (AC_lchit_not__mod__energy) {
g2_159_254 = dot(ac_transformed_pencil_glnrho,gss1__mod__energy)
}
else {
g2_159_254 = dot(ac_transformed_pencil_glnrho+ac_transformed_pencil_glntt,gss1__mod__energy)
}
thdiff_159_254=thdiff_159_254+AC_chi_t__mod__energy*chit_prof__mod__energy*(del2ss1_159_254+g2_159_254)
g2_159_254 = dot(gradchit_prof_159_254,gss1__mod__energy)
thdiff_159_254=thdiff_159_254+AC_chi_t__mod__energy*g2_159_254
}
else {
if (AC_lchit_not__mod__energy) {
g2_159_254 = dot(ac_transformed_pencil_glnrho,ac_transformed_pencil_gss)
}
else {
g2_159_254 = dot(ac_transformed_pencil_glnrho+ac_transformed_pencil_glntt,ac_transformed_pencil_gss)
}
thdiff_159_254=thdiff_159_254+AC_chi_t__mod__energy*chit_prof__mod__energy*(ac_transformed_pencil_del2ss+g2_159_254)
g2_159_254 = dot(gradchit_prof_159_254,ac_transformed_pencil_gss)
thdiff_159_254=thdiff_159_254+AC_chi_t__mod__energy*g2_159_254
}
if (AC_chit_aniso__mod__energy!=0.0  &&  AC_lspherical_coords__mod__cdata) {
sc_159_254=AC_sinth__mod__cdata[AC_m__mod__cdata-1]*AC_costh__mod__cdata[AC_m__mod__cdata-1]
c2_159_254=AC_costh__mod__cdata[AC_m__mod__cdata-1]*AC_costh__mod__cdata[AC_m__mod__cdata-1]
s2_159_254=AC_sinth__mod__cdata[AC_m__mod__cdata-1]*AC_sinth__mod__cdata[AC_m__mod__cdata-1]
if (AC_lchit_aniso_simplified__mod__energy) {
tmp_159_254 = hessian(Field(AC_iss__mod__cdata))
thdiff_159_254 = thdiff_159_254+AC_chit_aniso_prof__mod__energy[vertexIdx.x-NGHOST_VAL]*((1.-3.*c2_159_254)*AC_r1_mn__mod__cdata[vertexIdx.x-NGHOST_VAL]*ac_transformed_pencil_gss.x +  (-sc_159_254*tmp_159_254[1-1][2-1])+(ac_transformed_pencil_glnrho.y+ac_transformed_pencil_glntt.y)*(-sc_159_254*ac_transformed_pencil_gss.x))
}
else {
thdiff_159_254=thdiff_159_254 + ((AC_dchit_aniso_prof__mod__energy[vertexIdx.x-NGHOST_VAL]*c2_159_254+AC_chit_aniso_prof__mod__energy[vertexIdx.x-NGHOST_VAL]/AC_x__mod__cdata[vertexIdx.x])*ac_transformed_pencil_gss.x+  sc_159_254*(AC_chit_aniso_prof__mod__energy[vertexIdx.x-NGHOST_VAL]/AC_x__mod__cdata[vertexIdx.x]-AC_dchit_aniso_prof__mod__energy[vertexIdx.x-NGHOST_VAL])*ac_transformed_pencil_gss.y)
tmp_159_254 = hessian(Field(AC_iss__mod__cdata))
thdiff_159_254=thdiff_159_254+AC_chit_aniso_prof__mod__energy[vertexIdx.x-NGHOST_VAL]*  ((-sc_159_254*(tmp_159_254[1-1][2-1]+tmp_159_254[2-1][1-1])+c2_159_254*tmp_159_254[1-1][1-1]+s2_159_254*tmp_159_254[2-1][2-1])+  ((ac_transformed_pencil_glnrho.x+ac_transformed_pencil_glntt.x)*(c2_159_254*ac_transformed_pencil_gss.x-sc_159_254*ac_transformed_pencil_gss.y)+  ( ac_transformed_pencil_glnrho.y+ac_transformed_pencil_glntt.y)*(s2_159_254*ac_transformed_pencil_gss.y-sc_159_254*ac_transformed_pencil_gss.x)))
}
}
}
if (AC_hcond0__mod__energy!=0. || AC_lread_hcond__mod__energy || AC_chi_t__mod__energy!=0.) {
DF_SS = DF_SS + thdiff_159_254
}
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
if (AC_hcond0__mod__energy!=0. || AC_lread_hcond__mod__energy) {
diffus_chi__mod__energy=diffus_chi__mod__energy+ac_transformed_pencil_rho1*hcond__mod__energy*AC_cv1__mod__energy*dxyz_2__mod__cdata
}
if (AC_chi_t__mod__energy!=0.) {
diffus_chi__mod__energy=diffus_chi__mod__energy+AC_chi_t__mod__energy*chit_prof__mod__energy*dxyz_2__mod__cdata
}
}
chix_160_254 = ac_transformed_pencil_rho1*AC_hcond_kconst__mod__energy*ac_transformed_pencil_cp1
if (AC_chib__mod__energy!=0.) {
chix_160_254 = chix_160_254/(1.+AC_chib__mod__energy*ac_transformed_pencil_b2)
}
g2_160_254 = dot(ac_transformed_pencil_glntt,ac_transformed_pencil_glntt)
if (AC_pretend_lntt__mod__cdata) {
thdiff_160_254 = AC_gamma__mod__energy*chix_160_254 * (ac_transformed_pencil_del2lntt + g2_160_254)
}
else {
thdiff_160_254 = ac_transformed_pencil_rho1*AC_hcond_kconst__mod__energy * (ac_transformed_pencil_del2lntt + g2_160_254)
}
DF_SS = DF_SS + thdiff_160_254
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
diffus_chi__mod__energy=diffus_chi__mod__energy+AC_gamma__mod__energy*chix_160_254*dxyz_2__mod__cdata
}
if (AC_chi_t__mod__energy!=0.) {
if (AC_lcalc_ssmean__mod__energy  ||  AC_lcalc_ssmeanxy__mod__energy) {
if (AC_lcalc_ssmean__mod__energy) {
gss1__mod__energy.x=ac_transformed_pencil_gss.x-AC_gssmz__mod__energy[AC_n__mod__cdata-AC_n1__mod__cparam+1-1][1-1]
gss1__mod__energy.y=ac_transformed_pencil_gss.y-AC_gssmz__mod__energy[AC_n__mod__cdata-AC_n1__mod__cparam+1-1][2-1]
gss1__mod__energy.z=ac_transformed_pencil_gss.z-AC_gssmz__mod__energy[AC_n__mod__cdata-AC_n1__mod__cparam+1-1][3-1]
del2ss1_161_254=ac_transformed_pencil_del2ss-AC_del2ssmz__mod__energy[AC_n__mod__cdata-AC_n1__mod__cparam+1-1]
}
else if (AC_lcalc_ssmeanxy__mod__energy) {
gss1__mod__energy.x=ac_transformed_pencil_gss.x-AC_gssmx__mod__energy[vertexIdx.x][1-1]
gss1__mod__energy.y=ac_transformed_pencil_gss.y-AC_gssmx__mod__energy[vertexIdx.x][2-1]
gss1__mod__energy.z=ac_transformed_pencil_gss.z-AC_gssmx__mod__energy[vertexIdx.x][3-1]
del2ss1_161_254=ac_transformed_pencil_del2ss-AC_del2ssmx__mod__energy[vertexIdx.x-NGHOST_VAL]
}
g2_161_254 = dot(ac_transformed_pencil_glnrho+ac_transformed_pencil_glntt,gss1__mod__energy)
thdiff_161_254=AC_chi_t__mod__energy*(del2ss1_161_254+g2_161_254)
}
}
DF_SS = DF_SS + thdiff_161_254
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
diffus_chi__mod__energy=diffus_chi__mod__energy+AC_chi_t__mod__energy*dxyz_2__mod__cdata
}
g2_163_254 = dot(ac_transformed_pencil_glnrho+ac_transformed_pencil_glntt,ac_transformed_pencil_glntt)
if (AC_pretend_lntt__mod__cdata) {
thdiff_163_254=AC_gamma__mod__energy*AC_chi__mod__energy*(ac_transformed_pencil_del2lntt+g2_163_254)
}
else {
thdiff_163_254=AC_chi__mod__energy*ac_transformed_pencil_cp*(ac_transformed_pencil_del2lntt+g2_163_254)
}
if (AC_chi_t__mod__energy!=0.) {
if (!AC_lmultilayer__mod__energy) {
chit_prof__mod__energy=1.
gradchit_prof_163_254.x = 0.
gradchit_prof_163_254.y = 0.
gradchit_prof_163_254.z = 0.
}
if (AC_lmultilayer__mod__energy) {
if (AC_lgravz__mod__cdata) {
chit_prof__mod__energy=AC_chit_prof_stored__mod__energy[AC_n__mod__cdata-AC_NGHOST_VAL__mod__cparam-1]
gradchit_prof_163_254.z=AC_dchit_prof_stored__mod__energy[AC_n__mod__cdata-AC_NGHOST_VAL__mod__cparam-1]
gradchit_prof_163_254.x=0.
gradchit_prof_163_254.y=0.
}
else if (AC_lsphere_in_a_box__mod__cdata) {
if (true && AC_lhcond_global__mod__energy) {
chit_prof__mod__energy = value(F_GLOBAL_HCOND)
gradchit_prof_163_254= value(F_GLOBAL_GLHVEC)
}
else {
if (true) {
r_mn_162_163_254=ac_transformed_pencil_r_mn
r_mn1_162_163_254=ac_transformed_pencil_r_mn1
}
else {
r_mn_162_163_254=sqrt(AC_x__mod__cdata[vertexIdx.x]*AC_x__mod__cdata[vertexIdx.x]+AC_y__mod__cdata[AC_m__mod__cdata-1]*AC_y__mod__cdata[AC_m__mod__cdata-1]+AC_z__mod__cdata[AC_n__mod__cdata-1]*AC_z__mod__cdata[AC_n__mod__cdata-1])
r_mn1_162_163_254=1./r_mn_162_163_254
}
arg_152_162_163_254 = abs((r_mn_162_163_254-AC_xbot__mod__energy)/(AC_widthss__mod__energy+AC_tini__mod__cparam))
if (abs(arg_152_162_163_254)>=8.)  {
der_step_return_value_152_162_163_254 = 2./AC_widthss__mod__energy*exp(-2.*abs(arg_152_162_163_254))
}
else {
der_step_return_value_152_162_163_254 = 0.5/(AC_widthss__mod__energy*cosh(arg_152_162_163_254)*cosh(arg_152_162_163_254))
}
arg_153_162_163_254 = abs((r_mn_162_163_254-AC_xtop__mod__energy)/(AC_widthss__mod__energy+AC_tini__mod__cparam))
if (abs(arg_153_162_163_254)>=8.)  {
der_step_return_value_153_162_163_254 = 2./AC_widthss__mod__energy*exp(-2.*abs(arg_153_162_163_254))
}
else {
der_step_return_value_153_162_163_254 = 0.5/(AC_widthss__mod__energy*cosh(arg_153_162_163_254)*cosh(arg_153_162_163_254))
}
chit_prof__mod__energy =  (AC_chit_prof1__mod__energy-1.)*der_step_return_value_152_162_163_254  +(AC_chit_prof2__mod__energy-1.)*der_step_return_value_153_162_163_254
gradchit_prof_163_254.x = chit_prof__mod__energy*AC_x__mod__cdata[vertexIdx.x]*r_mn1_162_163_254
gradchit_prof_163_254.y = chit_prof__mod__energy*AC_y__mod__cdata[AC_m__mod__cdata-1]*r_mn1_162_163_254
if (AC_lcylinder_in_a_box__mod__cdata) {
gradchit_prof_163_254.z = 0.0
}
else {
gradchit_prof_163_254.z = chit_prof__mod__energy*AC_z__mod__cdata[AC_n__mod__cdata-1]*r_mn1_162_163_254
}
step_vector_return_value_154_162_163_254 = 0.5*(1+tanh((r_mn_162_163_254-AC_xbot__mod__energy)/(AC_widthss__mod__energy+AC_tini__mod__cparam)))
step_vector_return_value_155_162_163_254 = 0.5*(1+tanh((r_mn_162_163_254-AC_xtop__mod__energy)/(AC_widthss__mod__energy+AC_tini__mod__cparam)))
chit_prof__mod__energy = 1.+(AC_chit_prof1__mod__energy-1.)*step_vector_return_value_154_162_163_254  +(AC_chit_prof2__mod__energy-1.)*step_vector_return_value_155_162_163_254
loptest_return_value_156_162_163_254 = false
if (false) {
}
else if (false) {
}
if (loptest_return_value_156_162_163_254) {
gradchit_prof_163_254.x=gradchit_prof_163_254.x/chit_prof__mod__energy
gradchit_prof_163_254.y=gradchit_prof_163_254.y/chit_prof__mod__energy
gradchit_prof_163_254.z=gradchit_prof_163_254.z/chit_prof__mod__energy
}
else {
gradchit_prof_163_254 = 1.*gradchit_prof_163_254
}
chit_prof__mod__energy = 1.*chit_prof__mod__energy
}
}
else {
chit_prof__mod__energy=AC_chit_prof_stored__mod__energy[vertexIdx.x]
gradchit_prof_163_254.x=AC_dchit_prof_stored__mod__energy[vertexIdx.x]
gradchit_prof_163_254.y=0.
gradchit_prof_163_254.z=0.
}
}
g2_163_254 = dot(ac_transformed_pencil_glnrho+ac_transformed_pencil_glntt,ac_transformed_pencil_gss)
thdiff_163_254=thdiff_163_254+AC_chi_t__mod__energy*chit_prof__mod__energy*(ac_transformed_pencil_del2ss+g2_163_254)
g2_163_254 = dot(gradchit_prof_163_254,ac_transformed_pencil_gss)
thdiff_163_254=thdiff_163_254+AC_chi_t__mod__energy*g2_163_254
}
DF_SS=DF_SS+thdiff_163_254
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
if (AC_leos_idealgas__mod__cparam) {
diffus_chi__mod__energy=diffus_chi__mod__energy+(AC_gamma__mod__energy*AC_chi__mod__energy)*dxyz_2__mod__cdata
}
else {
diffus_chi__mod__energy=diffus_chi__mod__energy+AC_chi__mod__energy*dxyz_2__mod__cdata
}
if (AC_chi_t__mod__energy!=0.) {
diffus_chi__mod__energy = diffus_chi__mod__energy+AC_chi_t__mod__energy*chit_prof__mod__energy*dxyz_2__mod__cdata
}
}
thchi_164_254=AC_chi__mod__energy*exp(AC_chi_cspeed__mod__energy*ac_transformed_pencil_lntt)
if (AC_pretend_lntt__mod__cdata) {
g2_164_254 = dot(ac_transformed_pencil_glnrho+(1.+AC_chi_cspeed__mod__energy)*ac_transformed_pencil_glntt,ac_transformed_pencil_glntt)
thdiff_164_254=AC_gamma__mod__energy*thchi_164_254*(ac_transformed_pencil_del2lntt+g2_164_254)
if (AC_chi_t__mod__energy!=0.) {
g2_164_254 = dot(ac_transformed_pencil_glnrho+ac_transformed_pencil_glntt,ac_transformed_pencil_gss)
thdiff_164_254=thdiff_164_254+AC_chi_t__mod__energy*(ac_transformed_pencil_del2ss+g2_164_254)
}
}
else {
g2_164_254 = dot(ac_transformed_pencil_glnrho+(1.+AC_chi_cspeed__mod__energy)*ac_transformed_pencil_glntt,ac_transformed_pencil_glntt)
thdiff_164_254=thchi_164_254*(ac_transformed_pencil_del2lntt+g2_164_254)*ac_transformed_pencil_cp
if (AC_chi_t__mod__energy!=0.) {
g2_164_254 = dot(ac_transformed_pencil_glnrho+ac_transformed_pencil_glntt,ac_transformed_pencil_gss)
if (AC_chib__mod__energy==0.) {
thdiff_164_254=thdiff_164_254+AC_chi_t__mod__energy*(ac_transformed_pencil_del2ss+g2_164_254)
}
else {
thdiff_164_254=thdiff_164_254+AC_chi_t__mod__energy*(ac_transformed_pencil_del2ss+g2_164_254)/(1.+AC_chib__mod__energy*ac_transformed_pencil_b2)
}
}
}
DF_SS=DF_SS+thdiff_164_254
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
if (AC_leos_idealgas__mod__cparam) {
diffus_chi__mod__energy=diffus_chi__mod__energy+(AC_gamma__mod__energy*thchi_164_254+AC_chi_t__mod__energy)*dxyz_2__mod__cdata
}
else {
diffus_chi__mod__energy=diffus_chi__mod__energy+(thchi_164_254+AC_chi_t__mod__energy)*dxyz_2__mod__cdata
}
}
rhochi_165_254=AC_chi_rho__mod__energy*sqrt(ac_transformed_pencil_rho1)
if (AC_pretend_lntt__mod__cdata) {
g2_165_254 = dot(ac_transformed_pencil_glnrho+ac_transformed_pencil_glntt,ac_transformed_pencil_glntt)
thdiff_165_254=AC_gamma__mod__energy*rhochi_165_254*(ac_transformed_pencil_del2lntt+g2_165_254)
if (AC_chi_t__mod__energy!=0.) {
g2_165_254 = dot(ac_transformed_pencil_glnrho+ac_transformed_pencil_glntt,ac_transformed_pencil_gss)
thdiff_165_254=thdiff_165_254+AC_chi_t__mod__energy*(ac_transformed_pencil_del2ss+g2_165_254)
}
}
else {
g2_165_254 = dot(ac_transformed_pencil_glnrho+ac_transformed_pencil_glntt,ac_transformed_pencil_glntt)
thdiff_165_254=rhochi_165_254*(ac_transformed_pencil_del2lntt+g2_165_254)/ac_transformed_pencil_cp1
if (AC_chi_t__mod__energy!=0.) {
g2_165_254 = dot(ac_transformed_pencil_glnrho+ac_transformed_pencil_glntt,ac_transformed_pencil_gss)
if (AC_chib__mod__energy==0.) {
thdiff_165_254=thdiff_165_254+AC_chi_t__mod__energy*(ac_transformed_pencil_del2ss+g2_165_254)
}
else {
thdiff_165_254=thdiff_165_254+AC_chi_t__mod__energy*(ac_transformed_pencil_del2ss+g2_165_254)/(1.+AC_chib__mod__energy*ac_transformed_pencil_b2)
}
}
}
DF_SS=DF_SS+thdiff_165_254
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
if (AC_leos_idealgas__mod__cparam) {
diffus_chi__mod__energy=diffus_chi__mod__energy+(AC_gamma__mod__energy*rhochi_165_254+AC_chi_t__mod__energy)*dxyz_2__mod__cdata
}
else {
diffus_chi__mod__energy=diffus_chi__mod__energy+(rhochi_165_254+AC_chi_t__mod__energy)*dxyz_2__mod__cdata
}
}
gshockglntt_166_254 = dot(ac_transformed_pencil_gshock,ac_transformed_pencil_glntt)
g2_166_254 = dot(ac_transformed_pencil_glnrho+ac_transformed_pencil_glntt,ac_transformed_pencil_glntt)
if (AC_lheatc_shock__mod__energy) {
if (AC_pretend_lntt__mod__cdata) {
thdiff_166_254=AC_gamma__mod__energy*AC_chi_shock__mod__energy*(ac_transformed_pencil_shock*(ac_transformed_pencil_del2lnrho+g2_166_254)+gshockglntt_166_254)
}
else {
if (AC_lchi_shock_density_dep__mod__energy) {
gshockgss_166_254 = dot(ac_transformed_pencil_gshock,ac_transformed_pencil_gss)
g2_166_254 = dot(AC_twothird__mod__cparam*ac_transformed_pencil_glnrho+ac_transformed_pencil_glntt,ac_transformed_pencil_gss)
thdiff_166_254=exp(-AC_onethird__mod__cparam*ac_transformed_pencil_lnrho)*AC_chi_shock__mod__energy*  (ac_transformed_pencil_shock*(exp(AC_twothird__mod__cparam*ac_transformed_pencil_lnrho)*ac_transformed_pencil_del2ss+g2_166_254)+gshockgss_166_254)
}
else {
thdiff_166_254=AC_chi_shock__mod__energy*(ac_transformed_pencil_shock*(ac_transformed_pencil_del2lntt+g2_166_254)+gshockglntt_166_254)
}
}
}
if (AC_lheatc_shock2__mod__energy) {
if (AC_pretend_lntt__mod__cdata) {
thdiff_166_254=AC_gamma__mod__energy*AC_chi_shock2__mod__energy*(ac_transformed_pencil_shock*ac_transformed_pencil_shock*(ac_transformed_pencil_del2lnrho+g2_166_254)+gshockglntt_166_254)
}
else {
if (AC_lchi_shock_density_dep__mod__energy) {
gshockgss_166_254 = dot(ac_transformed_pencil_gshock,ac_transformed_pencil_gss)
g2_166_254 = dot(AC_twothird__mod__cparam*ac_transformed_pencil_glnrho+ac_transformed_pencil_glntt,ac_transformed_pencil_gss)
thdiff_166_254=exp(-AC_onethird__mod__cparam*ac_transformed_pencil_lnrho)*AC_chi_shock2__mod__energy*  (ac_transformed_pencil_shock*ac_transformed_pencil_shock*(exp(AC_twothird__mod__cparam*ac_transformed_pencil_lnrho)*ac_transformed_pencil_del2ss+g2_166_254)+2*ac_transformed_pencil_shock*gshockgss_166_254)
}
else {
thdiff_166_254=AC_chi_shock2__mod__energy*(ac_transformed_pencil_shock*ac_transformed_pencil_shock*(ac_transformed_pencil_del2lntt+g2_166_254)+2*ac_transformed_pencil_shock*gshockglntt_166_254)
}
}
}
DF_SS = DF_SS + thdiff_166_254
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
if (AC_leos_idealgas__mod__cparam) {
if (AC_lchi_shock_density_dep__mod__energy) {
if (AC_lheatc_shock__mod__energy) {
diffus_chi__mod__energy=diffus_chi__mod__energy+exp(-AC_onethird__mod__cparam*ac_transformed_pencil_lnrho)*AC_chi_shock__mod__energy*ac_transformed_pencil_shock*ac_transformed_pencil_cp1*dxyz_2__mod__cdata
}
if (AC_lheatc_shock2__mod__energy) {
diffus_chi__mod__energy=diffus_chi__mod__energy+exp(-AC_onethird__mod__cparam*ac_transformed_pencil_lnrho)*AC_chi_shock2__mod__energy*ac_transformed_pencil_shock*ac_transformed_pencil_shock*ac_transformed_pencil_cp1*dxyz_2__mod__cdata
}
}
else {
if (AC_lheatc_shock__mod__energy ) {
diffus_chi__mod__energy=diffus_chi__mod__energy+(AC_gamma__mod__energy*AC_chi_shock__mod__energy*ac_transformed_pencil_shock)*dxyz_2__mod__cdata
}
if (AC_lheatc_shock2__mod__energy) {
diffus_chi__mod__energy=diffus_chi__mod__energy+(AC_gamma__mod__energy*AC_chi_shock2__mod__energy*ac_transformed_pencil_shock*ac_transformed_pencil_shock)*dxyz_2__mod__cdata
}
}
}
else {
if (AC_lheatc_shock__mod__energy ) {
diffus_chi__mod__energy=diffus_chi__mod__energy+(AC_chi_shock__mod__energy*ac_transformed_pencil_shock)*dxyz_2__mod__cdata
}
if (AC_lheatc_shock2__mod__energy) {
diffus_chi__mod__energy=diffus_chi__mod__energy+(AC_chi_shock2__mod__energy*ac_transformed_pencil_shock*ac_transformed_pencil_shock)*dxyz_2__mod__cdata
}
}
}
step_vector_return_value_167_169_254 = 0.5*(1+tanh((ac_transformed_pencil_r_mn-AC_xchi_shock__mod__energy)/(AC_widthchi_shock__mod__energy+AC_tini__mod__cparam)))
pchi_shock_169_254 = AC_chi_shock__mod__energy + AC_chi_shock__mod__energy*(AC_chi_jump_shock__mod__energy-1.)*step_vector_return_value_167_169_254
arg_168_169_254 = abs((ac_transformed_pencil_r_mn-AC_xchi_shock__mod__energy)/(AC_widthchi_shock__mod__energy+AC_tini__mod__cparam))
if (abs(arg_168_169_254)>=8.)  {
der_step_return_value_168_169_254 = 2./AC_widthchi_shock__mod__energy*exp(-2.*abs(arg_168_169_254))
}
else {
der_step_return_value_168_169_254 = 0.5/(AC_widthchi_shock__mod__energy*cosh(arg_168_169_254)*cosh(arg_168_169_254))
}
gradchi_shock_169_254.x = AC_chi_shock__mod__energy*(AC_chi_jump_shock__mod__energy-1.)*der_step_return_value_168_169_254
gradchi_shock_169_254.y = 0.
gradchi_shock_169_254.z = 0.
gshockglntt_169_254 = dot(ac_transformed_pencil_gshock,ac_transformed_pencil_glntt)
g2_169_254 = dot(ac_transformed_pencil_glnrho+ac_transformed_pencil_glntt,ac_transformed_pencil_glntt)
gshockglntt_169_254 = dot(ac_transformed_pencil_gshock,ac_transformed_pencil_glntt)
g2_169_254 = dot(ac_transformed_pencil_glnrho+ac_transformed_pencil_glntt,ac_transformed_pencil_glntt)
gchiglntt_169_254 = dot(gradchi_shock_169_254,ac_transformed_pencil_glntt)
if (AC_pretend_lntt__mod__cdata) {
thdiff_169_254=AC_gamma__mod__energy*(pchi_shock_169_254*(ac_transformed_pencil_shock*(ac_transformed_pencil_del2lnrho+g2_169_254)+gshockglntt_169_254)+gchiglntt_169_254*ac_transformed_pencil_shock)
}
else {
thdiff_169_254=pchi_shock_169_254*(ac_transformed_pencil_shock*(ac_transformed_pencil_del2lntt+g2_169_254)+gshockglntt_169_254)+gchiglntt_169_254*ac_transformed_pencil_shock
}
DF_SS = DF_SS + thdiff_169_254
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
if (AC_leos_idealgas__mod__cparam) {
diffus_chi__mod__energy=diffus_chi__mod__energy+(AC_gamma__mod__energy*pchi_shock_169_254*ac_transformed_pencil_shock)*dxyz_2__mod__cdata
}
else {
diffus_chi__mod__energy=diffus_chi__mod__energy+(pchi_shock_169_254*ac_transformed_pencil_shock)*dxyz_2__mod__cdata
}
}
thdiff_170_254 = AC_chi_hyper3__mod__energy * ac_transformed_pencil_del6ss
DF_SS = DF_SS + thdiff_170_254
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
diffus_chi3__mod__energy=diffus_chi3__mod__energy+AC_chi_hyper3__mod__energy*dxyz_6__mod__cdata
}
bb2_172_254 = dot(ac_transformed_pencil_bb,ac_transformed_pencil_bb)
b1_172_254=1./max(AC_REAL_MIN,bb2_172_254)
vkpara_172_254 = AC_kgpara__mod__energy * pow(exp(ac_transformed_pencil_lntt),3.5)
vkperp_172_254 = AC_kgperp__mod__energy * b1_172_254*exp(2*ac_transformed_pencil_lnrho+0.5*ac_transformed_pencil_lntt)
tmps_172_254 = 3.5 * vkpara_172_254
gvkpara_172_254 = tmps_172_254*ac_transformed_pencil_glntt
tmpv_172_254.x=0.
tmpv_172_254.x=tmpv_172_254.x + ac_transformed_pencil_bb.x*ac_transformed_pencil_bij[1-1][1-1]
tmpv_172_254.x=tmpv_172_254.x + ac_transformed_pencil_bb.y*ac_transformed_pencil_bij[2-1][1-1]
tmpv_172_254.x=tmpv_172_254.x + ac_transformed_pencil_bb.z*ac_transformed_pencil_bij[3-1][1-1]
tmpv_172_254.y=0.
tmpv_172_254.y=tmpv_172_254.y + ac_transformed_pencil_bb.x*ac_transformed_pencil_bij[1-1][2-1]
tmpv_172_254.y=tmpv_172_254.y + ac_transformed_pencil_bb.y*ac_transformed_pencil_bij[2-1][2-1]
tmpv_172_254.y=tmpv_172_254.y + ac_transformed_pencil_bb.z*ac_transformed_pencil_bij[3-1][2-1]
tmpv_172_254.z=0.
tmpv_172_254.z=tmpv_172_254.z + ac_transformed_pencil_bb.x*ac_transformed_pencil_bij[1-1][3-1]
tmpv_172_254.z=tmpv_172_254.z + ac_transformed_pencil_bb.y*ac_transformed_pencil_bij[2-1][3-1]
tmpv_172_254.z=tmpv_172_254.z + ac_transformed_pencil_bb.z*ac_transformed_pencil_bij[3-1][3-1]
tmpv2_172_254 = 2*b1_172_254*tmpv_172_254
tmpv_172_254=2.*ac_transformed_pencil_glnrho+0.5*ac_transformed_pencil_glntt-tmpv2_172_254
gvkperp_172_254 = vkperp_172_254*tmpv_172_254
abs_b_171_172_254 = sqrt(dot(ac_transformed_pencil_bb,ac_transformed_pencil_bb))
b1_171_172_254=1./max(AC_tini__mod__cparam,abs_b_171_172_254)
bunit_171_172_254 = b1_171_172_254*ac_transformed_pencil_bb
del2ecr_171_172_254=0.
del2ecr_171_172_254=del2ecr_171_172_254+ac_transformed_pencil_hlntt[1-1][1-1]
hhh_171_172_254.x=0.
tmpj_171_172_254=0.
tmpj_171_172_254=tmpj_171_172_254-2.*bunit_171_172_254.x*ac_transformed_pencil_bij[1-1][1-1]
tmpj_171_172_254=tmpj_171_172_254-2.*bunit_171_172_254.y*ac_transformed_pencil_bij[2-1][1-1]
tmpj_171_172_254=tmpj_171_172_254-2.*bunit_171_172_254.z*ac_transformed_pencil_bij[3-1][1-1]
hhh_171_172_254.x=hhh_171_172_254.x+bunit_171_172_254.x*(ac_transformed_pencil_bij[1-1][1-1]+bunit_171_172_254.x*tmpj_171_172_254)
tmpj_171_172_254=0.
tmpj_171_172_254=tmpj_171_172_254-2.*bunit_171_172_254.x*ac_transformed_pencil_bij[1-1][2-1]
tmpj_171_172_254=tmpj_171_172_254-2.*bunit_171_172_254.y*ac_transformed_pencil_bij[2-1][2-1]
tmpj_171_172_254=tmpj_171_172_254-2.*bunit_171_172_254.z*ac_transformed_pencil_bij[3-1][2-1]
hhh_171_172_254.x=hhh_171_172_254.x+bunit_171_172_254.y*(ac_transformed_pencil_bij[1-1][2-1]+bunit_171_172_254.x*tmpj_171_172_254)
tmpj_171_172_254=0.
tmpj_171_172_254=tmpj_171_172_254-2.*bunit_171_172_254.x*ac_transformed_pencil_bij[1-1][3-1]
tmpj_171_172_254=tmpj_171_172_254-2.*bunit_171_172_254.y*ac_transformed_pencil_bij[2-1][3-1]
tmpj_171_172_254=tmpj_171_172_254-2.*bunit_171_172_254.z*ac_transformed_pencil_bij[3-1][3-1]
hhh_171_172_254.x=hhh_171_172_254.x+bunit_171_172_254.z*(ac_transformed_pencil_bij[1-1][3-1]+bunit_171_172_254.x*tmpj_171_172_254)
del2ecr_171_172_254=del2ecr_171_172_254+ac_transformed_pencil_hlntt[2-1][2-1]
hhh_171_172_254.y=0.
tmpj_171_172_254=0.
tmpj_171_172_254=tmpj_171_172_254-2.*bunit_171_172_254.x*ac_transformed_pencil_bij[1-1][1-1]
tmpj_171_172_254=tmpj_171_172_254-2.*bunit_171_172_254.y*ac_transformed_pencil_bij[2-1][1-1]
tmpj_171_172_254=tmpj_171_172_254-2.*bunit_171_172_254.z*ac_transformed_pencil_bij[3-1][1-1]
hhh_171_172_254.y=hhh_171_172_254.y+bunit_171_172_254.x*(ac_transformed_pencil_bij[2-1][1-1]+bunit_171_172_254.y*tmpj_171_172_254)
tmpj_171_172_254=0.
tmpj_171_172_254=tmpj_171_172_254-2.*bunit_171_172_254.x*ac_transformed_pencil_bij[1-1][2-1]
tmpj_171_172_254=tmpj_171_172_254-2.*bunit_171_172_254.y*ac_transformed_pencil_bij[2-1][2-1]
tmpj_171_172_254=tmpj_171_172_254-2.*bunit_171_172_254.z*ac_transformed_pencil_bij[3-1][2-1]
hhh_171_172_254.y=hhh_171_172_254.y+bunit_171_172_254.y*(ac_transformed_pencil_bij[2-1][2-1]+bunit_171_172_254.y*tmpj_171_172_254)
tmpj_171_172_254=0.
tmpj_171_172_254=tmpj_171_172_254-2.*bunit_171_172_254.x*ac_transformed_pencil_bij[1-1][3-1]
tmpj_171_172_254=tmpj_171_172_254-2.*bunit_171_172_254.y*ac_transformed_pencil_bij[2-1][3-1]
tmpj_171_172_254=tmpj_171_172_254-2.*bunit_171_172_254.z*ac_transformed_pencil_bij[3-1][3-1]
hhh_171_172_254.y=hhh_171_172_254.y+bunit_171_172_254.z*(ac_transformed_pencil_bij[2-1][3-1]+bunit_171_172_254.y*tmpj_171_172_254)
del2ecr_171_172_254=del2ecr_171_172_254+ac_transformed_pencil_hlntt[3-1][3-1]
hhh_171_172_254.z=0.
tmpj_171_172_254=0.
tmpj_171_172_254=tmpj_171_172_254-2.*bunit_171_172_254.x*ac_transformed_pencil_bij[1-1][1-1]
tmpj_171_172_254=tmpj_171_172_254-2.*bunit_171_172_254.y*ac_transformed_pencil_bij[2-1][1-1]
tmpj_171_172_254=tmpj_171_172_254-2.*bunit_171_172_254.z*ac_transformed_pencil_bij[3-1][1-1]
hhh_171_172_254.z=hhh_171_172_254.z+bunit_171_172_254.x*(ac_transformed_pencil_bij[3-1][1-1]+bunit_171_172_254.z*tmpj_171_172_254)
tmpj_171_172_254=0.
tmpj_171_172_254=tmpj_171_172_254-2.*bunit_171_172_254.x*ac_transformed_pencil_bij[1-1][2-1]
tmpj_171_172_254=tmpj_171_172_254-2.*bunit_171_172_254.y*ac_transformed_pencil_bij[2-1][2-1]
tmpj_171_172_254=tmpj_171_172_254-2.*bunit_171_172_254.z*ac_transformed_pencil_bij[3-1][2-1]
hhh_171_172_254.z=hhh_171_172_254.z+bunit_171_172_254.y*(ac_transformed_pencil_bij[3-1][2-1]+bunit_171_172_254.z*tmpj_171_172_254)
tmpj_171_172_254=0.
tmpj_171_172_254=tmpj_171_172_254-2.*bunit_171_172_254.x*ac_transformed_pencil_bij[1-1][3-1]
tmpj_171_172_254=tmpj_171_172_254-2.*bunit_171_172_254.y*ac_transformed_pencil_bij[2-1][3-1]
tmpj_171_172_254=tmpj_171_172_254-2.*bunit_171_172_254.z*ac_transformed_pencil_bij[3-1][3-1]
hhh_171_172_254.z=hhh_171_172_254.z+bunit_171_172_254.z*(ac_transformed_pencil_bij[3-1][3-1]+bunit_171_172_254.z*tmpj_171_172_254)
tmpv_171_172_254 = b1_171_172_254*hhh_171_172_254
hhh2_171_172_254 = sqrt(dot(tmpv_171_172_254,tmpv_171_172_254))
quenchfactor_171_172_254=1./max(1.,limiter_tensordiff_171_172_254*hhh2_171_172_254*AC_dxmax__mod__cdata)
hhh_171_172_254 = quenchfactor_171_172_254*tmpv_171_172_254
tmp_171_172_254 = dot(hhh_171_172_254,ac_transformed_pencil_glntt)
hhh_171_172_254 = ac_transformed_pencil_hlntt*bunit_171_172_254
tmpj_171_172_254 = dot(hhh_171_172_254,bunit_171_172_254)
tmp_171_172_254 = tmp_171_172_254+tmpj_171_172_254
gecr2_171_172_254=0.
if (false) {
tmpi_171_172_254 = dot(ac_transformed_pencil_glntt,bunit_171_172_254)
tmp_171_172_254=tmp_171_172_254+tmpi_171_172_254*tmpi_171_172_254
gecr2_171_172_254 = dot(ac_transformed_pencil_glntt,ac_transformed_pencil_glntt)
}
if (true) {
gvkpara1_171_172_254=gvkpara_172_254
}
else {
gvkpara1_171_172_254.x = 0.
gvkpara1_171_172_254.y = 0.
gvkpara1_171_172_254.z = 0.
}
if (true) {
gvkperp1_171_172_254=gvkperp_172_254
}
else {
gvkperp1_171_172_254.x = 0.
gvkperp1_171_172_254.y = 0.
gvkperp1_171_172_254.z = 0.
}
tmpj_171_172_254 = dot(gvkperp1_171_172_254,ac_transformed_pencil_glntt)
tmpi_171_172_254 = dot(bunit_171_172_254,gvkpara1_171_172_254-gvkperp1_171_172_254)
tmpk_171_172_254 = dot(bunit_171_172_254,ac_transformed_pencil_glntt)
tmpj_171_172_254 = tmpj_171_172_254+tmpi_171_172_254*tmpk_171_172_254
thdiff_172_254=vkperp_172_254*(del2ecr_171_172_254+gecr2_171_172_254) + (vkpara_172_254-vkperp_172_254)*tmp_171_172_254 + tmpj_171_172_254
thdiff_172_254 = thdiff_172_254*exp(-ac_transformed_pencil_lnrho-ac_transformed_pencil_lntt)
DF_SS=DF_SS + thdiff_172_254
kappa0_cgs_173_254=2.0e-6
kappa0_173_254=kappa0_cgs_173_254*AC_unit_density__mod__cdata/AC_unit_length__mod__cdata
kappa_173_254=kappa0_173_254*ac_transformed_pencil_tt*ac_transformed_pencil_tt
if (AC_nzgrid__mod__cparam==1) {
tau_173_254 = 0.5*kappa_173_254*ac_transformed_pencil_rho
a1_173_254=0.375*tau_173_254
a2_173_254=0.433013
a3_173_254=0.25/tau_173_254
cooling_173_254 = 2*AC_sigmasb__mod__cdata*ac_transformed_pencil_tt*ac_transformed_pencil_tt*ac_transformed_pencil_tt*ac_transformed_pencil_tt/(a1_173_254+a2_173_254+a3_173_254)
DF_SS=DF_SS - AC_cool_fac__mod__energy*cooling_173_254
}
k_kramers__mod__energy = AC_hcond0_kramers__mod__energy*pow(ac_transformed_pencil_rho1,(2.*AC_nkramers__mod__energy))*pow(ac_transformed_pencil_tt,(6.5*AC_nkramers__mod__energy))
krho1_175_254 = k_kramers__mod__energy*ac_transformed_pencil_rho1
if (AC_chimax_kramers__mod__energy>0.) {
krho1_175_254 = max(min(krho1_175_254,AC_chimax_kramers__mod__energy/ac_transformed_pencil_cp1),AC_chimin_kramers__mod__energy/ac_transformed_pencil_cp1)
}
g2_175_254 = dot(2.*AC_nkramers__mod__energy*ac_transformed_pencil_glnrho+(6.5*AC_nkramers__mod__energy+1)*ac_transformed_pencil_glntt,ac_transformed_pencil_glntt)
thdiff_175_254 = krho1_175_254*(ac_transformed_pencil_del2lntt+g2_175_254)
if (AC_chi_t__mod__energy!=0.0) {
if (AC_lcalc_ssmean__mod__energy) {
gss1__mod__energy.x=ac_transformed_pencil_gss.x-AC_gssmz__mod__energy[AC_n__mod__cdata-AC_n1__mod__cparam+1-1][1-1]
gss1__mod__energy.y=ac_transformed_pencil_gss.y-AC_gssmz__mod__energy[AC_n__mod__cdata-AC_n1__mod__cparam+1-1][2-1]
gss1__mod__energy.z=ac_transformed_pencil_gss.z-AC_gssmz__mod__energy[AC_n__mod__cdata-AC_n1__mod__cparam+1-1][3-1]
del2ss1_175_254=ac_transformed_pencil_del2ss-AC_del2ssmz__mod__energy[AC_n__mod__cdata-AC_n1__mod__cparam+1-1]
}
else if (AC_lcalc_ssmeanxy__mod__energy) {
gss1__mod__energy.x=ac_transformed_pencil_gss.x-AC_gssmx__mod__energy[vertexIdx.x][1-1]
gss1__mod__energy.y=ac_transformed_pencil_gss.y-AC_gssmx__mod__energy[vertexIdx.x][2-1]
gss1__mod__energy.z=ac_transformed_pencil_gss.z-AC_gssmx__mod__energy[vertexIdx.x][3-1]
del2ss1_175_254=ac_transformed_pencil_del2ss-AC_del2ssmx__mod__energy[vertexIdx.x-NGHOST_VAL]
}
else {
gss1__mod__energy.x=ac_transformed_pencil_gss.x
gss1__mod__energy.y=ac_transformed_pencil_gss.y
gss1__mod__energy.z=ac_transformed_pencil_gss.z
del2ss1_175_254=ac_transformed_pencil_del2ss
}
g2_175_254 = dot(ac_transformed_pencil_glnrho+ac_transformed_pencil_glntt,gss1__mod__energy)
if (!AC_lmultilayer__mod__energy) {
chit_prof__mod__energy=1.
gradchit_prof_175_254.x = 0.
gradchit_prof_175_254.y = 0.
gradchit_prof_175_254.z = 0.
}
if (AC_lmultilayer__mod__energy) {
if (AC_lgravz__mod__cdata) {
chit_prof__mod__energy=AC_chit_prof_stored__mod__energy[AC_n__mod__cdata-AC_NGHOST_VAL__mod__cparam-1]
gradchit_prof_175_254.z=AC_dchit_prof_stored__mod__energy[AC_n__mod__cdata-AC_NGHOST_VAL__mod__cparam-1]
gradchit_prof_175_254.x=0.
gradchit_prof_175_254.y=0.
}
else if (AC_lsphere_in_a_box__mod__cdata) {
if (true && AC_lhcond_global__mod__energy) {
chit_prof__mod__energy = value(F_GLOBAL_HCOND)
gradchit_prof_175_254= value(F_GLOBAL_GLHVEC)
}
else {
if (true) {
r_mn_174_175_254=ac_transformed_pencil_r_mn
r_mn1_174_175_254=ac_transformed_pencil_r_mn1
}
else {
r_mn_174_175_254=sqrt(AC_x__mod__cdata[vertexIdx.x]*AC_x__mod__cdata[vertexIdx.x]+AC_y__mod__cdata[AC_m__mod__cdata-1]*AC_y__mod__cdata[AC_m__mod__cdata-1]+AC_z__mod__cdata[AC_n__mod__cdata-1]*AC_z__mod__cdata[AC_n__mod__cdata-1])
r_mn1_174_175_254=1./r_mn_174_175_254
}
arg_152_174_175_254 = abs((r_mn_174_175_254-AC_xbot__mod__energy)/(AC_widthss__mod__energy+AC_tini__mod__cparam))
if (abs(arg_152_174_175_254)>=8.)  {
der_step_return_value_152_174_175_254 = 2./AC_widthss__mod__energy*exp(-2.*abs(arg_152_174_175_254))
}
else {
der_step_return_value_152_174_175_254 = 0.5/(AC_widthss__mod__energy*cosh(arg_152_174_175_254)*cosh(arg_152_174_175_254))
}
arg_153_174_175_254 = abs((r_mn_174_175_254-AC_xtop__mod__energy)/(AC_widthss__mod__energy+AC_tini__mod__cparam))
if (abs(arg_153_174_175_254)>=8.)  {
der_step_return_value_153_174_175_254 = 2./AC_widthss__mod__energy*exp(-2.*abs(arg_153_174_175_254))
}
else {
der_step_return_value_153_174_175_254 = 0.5/(AC_widthss__mod__energy*cosh(arg_153_174_175_254)*cosh(arg_153_174_175_254))
}
chit_prof__mod__energy =  (AC_chit_prof1__mod__energy-1.)*der_step_return_value_152_174_175_254  +(AC_chit_prof2__mod__energy-1.)*der_step_return_value_153_174_175_254
gradchit_prof_175_254.x = chit_prof__mod__energy*AC_x__mod__cdata[vertexIdx.x]*r_mn1_174_175_254
gradchit_prof_175_254.y = chit_prof__mod__energy*AC_y__mod__cdata[AC_m__mod__cdata-1]*r_mn1_174_175_254
if (AC_lcylinder_in_a_box__mod__cdata) {
gradchit_prof_175_254.z = 0.0
}
else {
gradchit_prof_175_254.z = chit_prof__mod__energy*AC_z__mod__cdata[AC_n__mod__cdata-1]*r_mn1_174_175_254
}
step_vector_return_value_154_174_175_254 = 0.5*(1+tanh((r_mn_174_175_254-AC_xbot__mod__energy)/(AC_widthss__mod__energy+AC_tini__mod__cparam)))
step_vector_return_value_155_174_175_254 = 0.5*(1+tanh((r_mn_174_175_254-AC_xtop__mod__energy)/(AC_widthss__mod__energy+AC_tini__mod__cparam)))
chit_prof__mod__energy = 1.+(AC_chit_prof1__mod__energy-1.)*step_vector_return_value_154_174_175_254  +(AC_chit_prof2__mod__energy-1.)*step_vector_return_value_155_174_175_254
loptest_return_value_156_174_175_254 = false
if (false) {
}
else if (false) {
}
if (loptest_return_value_156_174_175_254) {
gradchit_prof_175_254.x=gradchit_prof_175_254.x/chit_prof__mod__energy
gradchit_prof_175_254.y=gradchit_prof_175_254.y/chit_prof__mod__energy
gradchit_prof_175_254.z=gradchit_prof_175_254.z/chit_prof__mod__energy
}
else {
gradchit_prof_175_254 = 1.*gradchit_prof_175_254
}
chit_prof__mod__energy = 1.*chit_prof__mod__energy
}
}
else {
chit_prof__mod__energy=AC_chit_prof_stored__mod__energy[vertexIdx.x]
gradchit_prof_175_254.x=AC_dchit_prof_stored__mod__energy[vertexIdx.x]
gradchit_prof_175_254.y=0.
gradchit_prof_175_254.z=0.
}
}
thdiff_175_254=thdiff_175_254+AC_chi_t__mod__energy*chit_prof__mod__energy*(del2ss1_175_254+g2_175_254)
g2_175_254 = dot(gradchit_prof_175_254,gss1__mod__energy)
thdiff_175_254=thdiff_175_254+AC_chi_t__mod__energy*g2_175_254
}
if (AC_pretend_lntt__mod__cdata) {
thdiff_175_254 = ac_transformed_pencil_cv1*thdiff_175_254
}
DF_SS = DF_SS + thdiff_175_254
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
diffus_chi__mod__energy=diffus_chi__mod__energy+(ac_transformed_pencil_cv1*krho1_175_254+AC_chi_t__mod__energy)*dxyz_2__mod__cdata
}
thdiff_179_254=0.
if (AC_chi_t0__mod__energy!=0.) {
if (!AC_lmultilayer__mod__energy) {
chit_prof__mod__energy=1.
gradchit_prof_179_254.x = 0.
gradchit_prof_179_254.y = 0.
gradchit_prof_179_254.z = 0.
}
if (AC_lmultilayer__mod__energy) {
if (AC_lgravz__mod__cdata) {
chit_prof__mod__energy=AC_chit_prof_stored__mod__energy[AC_n__mod__cdata-AC_NGHOST_VAL__mod__cparam-1]
gradchit_prof_179_254.z=AC_dchit_prof_stored__mod__energy[AC_n__mod__cdata-AC_NGHOST_VAL__mod__cparam-1]
gradchit_prof_179_254.x=0.
gradchit_prof_179_254.y=0.
}
else if (AC_lsphere_in_a_box__mod__cdata) {
if (true && AC_lhcond_global__mod__energy) {
chit_prof__mod__energy = value(F_GLOBAL_HCOND)
gradchit_prof_179_254= value(F_GLOBAL_GLHVEC)
}
else {
if (true) {
r_mn_176_179_254=ac_transformed_pencil_r_mn
r_mn1_176_179_254=ac_transformed_pencil_r_mn1
}
else {
r_mn_176_179_254=sqrt(AC_x__mod__cdata[vertexIdx.x]*AC_x__mod__cdata[vertexIdx.x]+AC_y__mod__cdata[AC_m__mod__cdata-1]*AC_y__mod__cdata[AC_m__mod__cdata-1]+AC_z__mod__cdata[AC_n__mod__cdata-1]*AC_z__mod__cdata[AC_n__mod__cdata-1])
r_mn1_176_179_254=1./r_mn_176_179_254
}
arg_152_176_179_254 = abs((r_mn_176_179_254-AC_xbot__mod__energy)/(AC_widthss__mod__energy+AC_tini__mod__cparam))
if (abs(arg_152_176_179_254)>=8.)  {
der_step_return_value_152_176_179_254 = 2./AC_widthss__mod__energy*exp(-2.*abs(arg_152_176_179_254))
}
else {
der_step_return_value_152_176_179_254 = 0.5/(AC_widthss__mod__energy*cosh(arg_152_176_179_254)*cosh(arg_152_176_179_254))
}
arg_153_176_179_254 = abs((r_mn_176_179_254-AC_xtop__mod__energy)/(AC_widthss__mod__energy+AC_tini__mod__cparam))
if (abs(arg_153_176_179_254)>=8.)  {
der_step_return_value_153_176_179_254 = 2./AC_widthss__mod__energy*exp(-2.*abs(arg_153_176_179_254))
}
else {
der_step_return_value_153_176_179_254 = 0.5/(AC_widthss__mod__energy*cosh(arg_153_176_179_254)*cosh(arg_153_176_179_254))
}
chit_prof__mod__energy =  (AC_chit_prof1__mod__energy-1.)*der_step_return_value_152_176_179_254  +(AC_chit_prof2__mod__energy-1.)*der_step_return_value_153_176_179_254
gradchit_prof_179_254.x = chit_prof__mod__energy*AC_x__mod__cdata[vertexIdx.x]*r_mn1_176_179_254
gradchit_prof_179_254.y = chit_prof__mod__energy*AC_y__mod__cdata[AC_m__mod__cdata-1]*r_mn1_176_179_254
if (AC_lcylinder_in_a_box__mod__cdata) {
gradchit_prof_179_254.z = 0.0
}
else {
gradchit_prof_179_254.z = chit_prof__mod__energy*AC_z__mod__cdata[AC_n__mod__cdata-1]*r_mn1_176_179_254
}
step_vector_return_value_154_176_179_254 = 0.5*(1+tanh((r_mn_176_179_254-AC_xbot__mod__energy)/(AC_widthss__mod__energy+AC_tini__mod__cparam)))
step_vector_return_value_155_176_179_254 = 0.5*(1+tanh((r_mn_176_179_254-AC_xtop__mod__energy)/(AC_widthss__mod__energy+AC_tini__mod__cparam)))
chit_prof__mod__energy = 1.+(AC_chit_prof1__mod__energy-1.)*step_vector_return_value_154_176_179_254  +(AC_chit_prof2__mod__energy-1.)*step_vector_return_value_155_176_179_254
loptest_return_value_156_176_179_254 = false
if (false) {
}
else if (false) {
}
if (loptest_return_value_156_176_179_254) {
gradchit_prof_179_254.x=gradchit_prof_179_254.x/chit_prof__mod__energy
gradchit_prof_179_254.y=gradchit_prof_179_254.y/chit_prof__mod__energy
gradchit_prof_179_254.z=gradchit_prof_179_254.z/chit_prof__mod__energy
}
else {
gradchit_prof_179_254 = 1.*gradchit_prof_179_254
}
chit_prof__mod__energy = 1.*chit_prof__mod__energy
}
}
else {
chit_prof__mod__energy=AC_chit_prof_stored__mod__energy[vertexIdx.x]
gradchit_prof_179_254.x=AC_dchit_prof_stored__mod__energy[vertexIdx.x]
gradchit_prof_179_254.y=0.
gradchit_prof_179_254.z=0.
}
}
if (AC_lchit_total__mod__energy) {
if (AC_lchit_not__mod__energy) {
g2_179_254 = dot(ac_transformed_pencil_glnrho,ac_transformed_pencil_gss)
}
else {
g2_179_254 = dot(ac_transformed_pencil_glnrho+ac_transformed_pencil_glntt,ac_transformed_pencil_gss)
}
thdiff_179_254=thdiff_179_254+AC_chi_t0__mod__energy*chit_prof__mod__energy*(ac_transformed_pencil_del2ss+g2_179_254)
g2_179_254 = dot(gradchit_prof_179_254,ac_transformed_pencil_gss)
thdiff_179_254=thdiff_179_254+AC_chi_t0__mod__energy*g2_179_254
}
if (AC_lchit_mean__mod__energy  &&  (AC_lcalc_ssmean__mod__energy  ||  AC_lcalc_ssmeanxy__mod__energy)) {
if (AC_lcalc_ssmean__mod__energy) {
gss0__mod__energy.x=AC_gssmz__mod__energy[AC_n__mod__cdata-AC_n1__mod__cparam+1-1][1-1]
gss0__mod__energy.y=AC_gssmz__mod__energy[AC_n__mod__cdata-AC_n1__mod__cparam+1-1][2-1]
gss0__mod__energy.z=AC_gssmz__mod__energy[AC_n__mod__cdata-AC_n1__mod__cparam+1-1][3-1]
del2ss0_179_254=AC_del2ssmz__mod__energy[AC_n__mod__cdata-AC_n1__mod__cparam+1-1]
}
else if (AC_lcalc_ssmeanxy__mod__energy) {
gss0__mod__energy.x=AC_gssmx__mod__energy[vertexIdx.x][1-1]
gss0__mod__energy.y=AC_gssmx__mod__energy[vertexIdx.x][2-1]
gss0__mod__energy.z=AC_gssmx__mod__energy[vertexIdx.x][3-1]
del2ss0_179_254=AC_del2ssmx__mod__energy[vertexIdx.x-NGHOST_VAL]
}
if (AC_lchit_not__mod__energy) {
g2_179_254 = dot(ac_transformed_pencil_glnrho,gss0__mod__energy)
}
else {
g2_179_254 = dot(ac_transformed_pencil_glnrho+ac_transformed_pencil_glntt,gss0__mod__energy)
}
thdiff_179_254=thdiff_179_254+AC_chi_t0__mod__energy*chit_prof__mod__energy*(del2ss0_179_254+g2_179_254)
g2_179_254 = dot(gradchit_prof_179_254,gss0__mod__energy)
thdiff_179_254=thdiff_179_254+AC_chi_t0__mod__energy*g2_179_254
}
}
if (AC_lchit_fluct__mod__energy && AC_chi_t1__mod__energy!=0.) {
if (AC_lcalc_ssmean__mod__energy  ||  AC_lcalc_ssmeanxy__mod__energy  ||  AC_lss_running_aver__mod__energy) {
if ((AC_lgravr__mod__cdata || AC_lgravx__mod__cdata || AC_lgravz__mod__cdata) && !(AC_lsphere_in_a_box__mod__cdata || AC_lchi_t1_noprof__mod__energy)) {
if (!AC_lmultilayer__mod__energy) {
gradchit_prof_fluct_179_254.x = 0.
gradchit_prof_fluct_179_254.y = 0.
gradchit_prof_fluct_179_254.z = 0.
}
if (AC_lmultilayer__mod__energy) {
if (AC_lgravz__mod__cdata) {
chit_prof_fluct__mod__energy=AC_chit_prof_fluct_stored__mod__energy[AC_n__mod__cdata-AC_NGHOST_VAL__mod__cparam-1]
gradchit_prof_fluct_179_254.z=AC_dchit_prof_fluct_stored__mod__energy[AC_n__mod__cdata-AC_NGHOST_VAL__mod__cparam-1]
gradchit_prof_fluct_179_254.x=0.
gradchit_prof_fluct_179_254.y=0.
}
else if (false) {
if (false && AC_lhcond_global__mod__energy) {
}
else {
if (false) {
r_mn_177_179_254=ac_transformed_pencil_r_mn
r_mn1_177_179_254=ac_transformed_pencil_r_mn1
}
else {
r_mn_177_179_254=sqrt(AC_x__mod__cdata[vertexIdx.x]*AC_x__mod__cdata[vertexIdx.x]+AC_y__mod__cdata[AC_m__mod__cdata-1]*AC_y__mod__cdata[AC_m__mod__cdata-1]+AC_z__mod__cdata[AC_n__mod__cdata-1]*AC_z__mod__cdata[AC_n__mod__cdata-1])
r_mn1_177_179_254=1./r_mn_177_179_254
}
if (abs(arg_152_177_179_254)>=8.)  {
der_step_return_value_152_177_179_254 = 2./AC_widthss__mod__energy*exp(-2.*abs(arg_152_177_179_254))
}
else {
der_step_return_value_152_177_179_254 = 0.5/(AC_widthss__mod__energy*cosh(arg_152_177_179_254)*cosh(arg_152_177_179_254))
}
if (abs(arg_153_177_179_254)>=8.)  {
der_step_return_value_153_177_179_254 = 2./AC_widthss__mod__energy*exp(-2.*abs(arg_153_177_179_254))
}
else {
der_step_return_value_153_177_179_254 = 0.5/(AC_widthss__mod__energy*cosh(arg_153_177_179_254)*cosh(arg_153_177_179_254))
}
gradchit_prof_fluct_179_254.x = chit_prof_fluct__mod__energy*AC_x__mod__cdata[vertexIdx.x]*r_mn1_177_179_254
gradchit_prof_fluct_179_254.y = chit_prof_fluct__mod__energy*AC_y__mod__cdata[AC_m__mod__cdata-1]*r_mn1_177_179_254
if (AC_lcylinder_in_a_box__mod__cdata) {
gradchit_prof_fluct_179_254.z = 0.0
}
else {
gradchit_prof_fluct_179_254.z = chit_prof_fluct__mod__energy*AC_z__mod__cdata[AC_n__mod__cdata-1]*r_mn1_177_179_254
}
loptest_return_value_156_177_179_254 = false
if (false) {
}
else if (false) {
}
if (loptest_return_value_156_177_179_254) {
gradchit_prof_fluct_179_254.x=gradchit_prof_fluct_179_254.x/chit_prof_fluct__mod__energy
gradchit_prof_fluct_179_254.y=gradchit_prof_fluct_179_254.y/chit_prof_fluct__mod__energy
gradchit_prof_fluct_179_254.z=gradchit_prof_fluct_179_254.z/chit_prof_fluct__mod__energy
}
else {
}
}
}
else {
chit_prof_fluct__mod__energy=AC_chit_prof_fluct_stored__mod__energy[vertexIdx.x]
gradchit_prof_fluct_179_254.x=AC_dchit_prof_fluct_stored__mod__energy[vertexIdx.x]
gradchit_prof_fluct_179_254.y=0.
gradchit_prof_fluct_179_254.z=0.
}
}
}
else {
chit_prof_fluct__mod__energy=AC_chi_t1__mod__energy
gradchit_prof_fluct_179_254.x = 0.
gradchit_prof_fluct_179_254.y = 0.
gradchit_prof_fluct_179_254.z = 0.
}
}
if (AC_lcalc_ssmean__mod__energy  ||  AC_lcalc_ssmeanxy__mod__energy) {
if (AC_lcalc_ssmean__mod__energy) {
gss1__mod__energy.x=ac_transformed_pencil_gss.x-AC_gssmz__mod__energy[AC_n__mod__cdata-AC_n1__mod__cparam+1-1][1-1]
gss1__mod__energy.y=ac_transformed_pencil_gss.y-AC_gssmz__mod__energy[AC_n__mod__cdata-AC_n1__mod__cparam+1-1][2-1]
gss1__mod__energy.z=ac_transformed_pencil_gss.z-AC_gssmz__mod__energy[AC_n__mod__cdata-AC_n1__mod__cparam+1-1][3-1]
del2ss1_179_254=ac_transformed_pencil_del2ss-AC_del2ssmz__mod__energy[AC_n__mod__cdata-AC_n1__mod__cparam+1-1]
}
else if (AC_lcalc_ssmeanxy__mod__energy) {
gss1__mod__energy.x=ac_transformed_pencil_gss.x-AC_gssmx__mod__energy[vertexIdx.x][1-1]
gss1__mod__energy.y=ac_transformed_pencil_gss.y-AC_gssmx__mod__energy[vertexIdx.x][2-1]
gss1__mod__energy.z=ac_transformed_pencil_gss.z-AC_gssmx__mod__energy[vertexIdx.x][3-1]
del2ss1_179_254=ac_transformed_pencil_del2ss-AC_del2ssmx__mod__energy[vertexIdx.x-NGHOST_VAL]
}
if (AC_lchit_not__mod__energy) {
g2_179_254 = dot(ac_transformed_pencil_glnrho,gss1__mod__energy)
}
else {
g2_179_254 = dot(ac_transformed_pencil_glnrho+ac_transformed_pencil_glntt,gss1__mod__energy)
}
if ((AC_lgravr__mod__cdata || AC_lgravx__mod__cdata || AC_lgravz__mod__cdata) && !AC_lsphere_in_a_box__mod__cdata) {
thdiff_179_254=thdiff_179_254+chit_prof_fluct__mod__energy*(del2ss1_179_254+g2_179_254)
g2_179_254 = dot(gradchit_prof_fluct_179_254,gss1__mod__energy)
thdiff_179_254=thdiff_179_254+g2_179_254
}
}
if (AC_lss_running_aver__mod__energy) {
if (AC_lrmv__mod__cdata) {
g2_179_254 = der6x_ignore_spacing(Field(AC_iss_run_aver__mod__cdata))
thdiff1_179_254 = AC_chi_hyper3_mesh__mod__energy*AC_pi5_1__mod__cparam/60.*g2_179_254*dline_1__mod__cdata.x
g2_179_254 = der6y_ignore_spacing(Field(AC_iss_run_aver__mod__cdata))
thdiff1_179_254 = AC_chi_hyper3_mesh__mod__energy*AC_pi5_1__mod__cparam/60.*g2_179_254*dline_1__mod__cdata.y
g2_179_254 = der6z_ignore_spacing(Field(AC_iss_run_aver__mod__cdata))
thdiff1_179_254 = AC_chi_hyper3_mesh__mod__energy*AC_pi5_1__mod__cparam/60.*g2_179_254*dline_1__mod__cdata.z
DF_SS_RUN_AVER = DF_SS_RUN_AVER + thdiff1_179_254
}
if (!AC_lmultilayer__mod__energy) {
chit_prof_fluct__mod__energy=AC_chi_t1__mod__energy
gradchit_prof_fluct_179_254.x = 0.
gradchit_prof_fluct_179_254.y = 0.
gradchit_prof_fluct_179_254.z = 0.
}
if (AC_lmultilayer__mod__energy) {
if (AC_lgravz__mod__cdata) {
chit_prof_fluct__mod__energy=AC_chit_prof_fluct_stored__mod__energy[AC_n__mod__cdata-AC_NGHOST_VAL__mod__cparam-1]
gradchit_prof_fluct_179_254.z=AC_dchit_prof_fluct_stored__mod__energy[AC_n__mod__cdata-AC_NGHOST_VAL__mod__cparam-1]
gradchit_prof_fluct_179_254.x=0.
gradchit_prof_fluct_179_254.y=0.
}
else if (AC_lsphere_in_a_box__mod__cdata) {
if (true && AC_lhcond_global__mod__energy) {
chit_prof_fluct__mod__energy = value(F_GLOBAL_HCOND)
gradchit_prof_fluct_179_254= value(F_GLOBAL_GLHVEC)
}
else {
if (true) {
r_mn_178_179_254=ac_transformed_pencil_r_mn
r_mn1_178_179_254=ac_transformed_pencil_r_mn1
}
else {
r_mn_178_179_254=sqrt(AC_x__mod__cdata[vertexIdx.x]*AC_x__mod__cdata[vertexIdx.x]+AC_y__mod__cdata[AC_m__mod__cdata-1]*AC_y__mod__cdata[AC_m__mod__cdata-1]+AC_z__mod__cdata[AC_n__mod__cdata-1]*AC_z__mod__cdata[AC_n__mod__cdata-1])
r_mn1_178_179_254=1./r_mn_178_179_254
}
arg_152_178_179_254 = abs((r_mn_178_179_254-AC_xbot__mod__energy)/(AC_widthss__mod__energy+AC_tini__mod__cparam))
if (abs(arg_152_178_179_254)>=8.)  {
der_step_return_value_152_178_179_254 = 2./AC_widthss__mod__energy*exp(-2.*abs(arg_152_178_179_254))
}
else {
der_step_return_value_152_178_179_254 = 0.5/(AC_widthss__mod__energy*cosh(arg_152_178_179_254)*cosh(arg_152_178_179_254))
}
arg_153_178_179_254 = abs((r_mn_178_179_254-AC_xtop__mod__energy)/(AC_widthss__mod__energy+AC_tini__mod__cparam))
if (abs(arg_153_178_179_254)>=8.)  {
der_step_return_value_153_178_179_254 = 2./AC_widthss__mod__energy*exp(-2.*abs(arg_153_178_179_254))
}
else {
der_step_return_value_153_178_179_254 = 0.5/(AC_widthss__mod__energy*cosh(arg_153_178_179_254)*cosh(arg_153_178_179_254))
}
chit_prof_fluct__mod__energy =  (AC_chit_fluct_prof1__mod__energy-1.)*der_step_return_value_152_178_179_254  +(AC_chit_fluct_prof2__mod__energy-1.)*der_step_return_value_153_178_179_254
gradchit_prof_fluct_179_254.x = chit_prof_fluct__mod__energy*AC_x__mod__cdata[vertexIdx.x]*r_mn1_178_179_254
gradchit_prof_fluct_179_254.y = chit_prof_fluct__mod__energy*AC_y__mod__cdata[AC_m__mod__cdata-1]*r_mn1_178_179_254
if (AC_lcylinder_in_a_box__mod__cdata) {
gradchit_prof_fluct_179_254.z = 0.0
}
else {
gradchit_prof_fluct_179_254.z = chit_prof_fluct__mod__energy*AC_z__mod__cdata[AC_n__mod__cdata-1]*r_mn1_178_179_254
}
step_vector_return_value_154_178_179_254 = 0.5*(1+tanh((r_mn_178_179_254-AC_xbot__mod__energy)/(AC_widthss__mod__energy+AC_tini__mod__cparam)))
step_vector_return_value_155_178_179_254 = 0.5*(1+tanh((r_mn_178_179_254-AC_xtop__mod__energy)/(AC_widthss__mod__energy+AC_tini__mod__cparam)))
chit_prof_fluct__mod__energy = 1.+(AC_chit_fluct_prof1__mod__energy-1.)*step_vector_return_value_154_178_179_254  +(AC_chit_fluct_prof2__mod__energy-1.)*step_vector_return_value_155_178_179_254
loptest_return_value_156_178_179_254 = false
if (false) {
}
else if (false) {
}
if (loptest_return_value_156_178_179_254) {
gradchit_prof_fluct_179_254.x=gradchit_prof_fluct_179_254.x/chit_prof_fluct__mod__energy
gradchit_prof_fluct_179_254.y=gradchit_prof_fluct_179_254.y/chit_prof_fluct__mod__energy
gradchit_prof_fluct_179_254.z=gradchit_prof_fluct_179_254.z/chit_prof_fluct__mod__energy
}
else {
gradchit_prof_fluct_179_254 = AC_chi_t1__mod__energy*gradchit_prof_fluct_179_254
}
chit_prof_fluct__mod__energy = AC_chi_t1__mod__energy*chit_prof_fluct__mod__energy
}
}
else {
chit_prof_fluct__mod__energy=AC_chit_prof_fluct_stored__mod__energy[vertexIdx.x]
gradchit_prof_fluct_179_254.x=AC_dchit_prof_fluct_stored__mod__energy[vertexIdx.x]
gradchit_prof_fluct_179_254.y=0.
gradchit_prof_fluct_179_254.z=0.
}
}
gss1__mod__energy = gradient(Field(AC_iss_run_aver__mod__cdata))
gss0__mod__energy.x=ac_transformed_pencil_gss.x-gss1__mod__energy.x
gss0__mod__energy.y=ac_transformed_pencil_gss.y-gss1__mod__energy.y
gss0__mod__energy.z=ac_transformed_pencil_gss.z-gss1__mod__energy.z
del2ss1_179_254 = laplace(Field(AC_iss_run_aver__mod__cdata))
del2ss0_179_254=ac_transformed_pencil_del2ss-del2ss1_179_254
if (AC_lchit_not__mod__energy) {
g2_179_254 = dot(ac_transformed_pencil_glnrho,gss0__mod__energy)
}
else {
g2_179_254 = dot(ac_transformed_pencil_glnrho+ac_transformed_pencil_glntt,gss0__mod__energy)
}
thdiff_179_254=thdiff_179_254+chit_prof_fluct__mod__energy*(del2ss0_179_254+g2_179_254)
g2_179_254 = dot(gradchit_prof_fluct_179_254,gss0__mod__energy)
thdiff_179_254=thdiff_179_254+g2_179_254
}
}
DF_SS = DF_SS + thdiff_179_254
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
if (AC_chi_t0__mod__energy!=0. && (AC_lchit_total__mod__energy  ||  AC_lchit_mean__mod__energy)) {
diffus_chi__mod__energy=diffus_chi__mod__energy+AC_chi_t0__mod__energy*chit_prof__mod__energy*dxyz_2__mod__cdata
}
if (AC_lcalc_ssmean__mod__energy  ||  AC_lcalc_ssmeanxy__mod__energy  ||  AC_lss_running_aver__mod__energy) {
if (AC_chi_t1__mod__energy!=0. && AC_lchit_fluct__mod__energy) {
diffus_chi__mod__energy=diffus_chi__mod__energy+chit_prof_fluct__mod__energy*dxyz_2__mod__cdata
}
}
}
thdiff_180_254=0.
if (AC_lcalc_ssmean__mod__energy) {
gss1__mod__energy.x=ac_transformed_pencil_gss.x-AC_gssmz__mod__energy[AC_n__mod__cdata-AC_n1__mod__cparam+1-1][1-1]
gss1__mod__energy.y=ac_transformed_pencil_gss.y-AC_gssmz__mod__energy[AC_n__mod__cdata-AC_n1__mod__cparam+1-1][2-1]
gss1__mod__energy.z=ac_transformed_pencil_gss.z-AC_gssmz__mod__energy[AC_n__mod__cdata-AC_n1__mod__cparam+1-1][3-1]
del2ss1_180_254=ac_transformed_pencil_del2ss-AC_del2ssmz__mod__energy[AC_n__mod__cdata-AC_n1__mod__cparam+1-1]
}
else if (AC_lcalc_ssmeanxy__mod__energy) {
del2ss1_180_254=ac_transformed_pencil_del2ss-AC_del2ssmx__mod__energy[vertexIdx.x-NGHOST_VAL]
}
else {
gss1__mod__energy=ac_transformed_pencil_gss
del2ss1_180_254=ac_transformed_pencil_del2ss
}
if (AC_lchit_not__mod__energy) {
g2_180_254 = dot(ac_transformed_pencil_glnrho,gss1__mod__energy)
}
else {
g2_180_254 = dot(ac_transformed_pencil_glnrho+ac_transformed_pencil_glntt,gss1__mod__energy)
}
thdiff_180_254=AC_pr_smag1__mod__energy*ac_transformed_pencil_nu_smag*(del2ss1_180_254+g2_180_254)
gradnu_180_254 = gradient(Field(AC_inusmag__mod__cdata))
g2_180_254 = dot(gradnu_180_254,gss1__mod__energy)
thdiff_180_254=thdiff_180_254+AC_pr_smag1__mod__energy*g2_180_254
chix_180_254 = AC_pr_smag1__mod__energy*ac_transformed_pencil_nu_smag
DF_SS = DF_SS + thdiff_180_254
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
diffus_chi__mod__energy=diffus_chi__mod__energy+(ac_transformed_pencil_cv1/ac_transformed_pencil_cp1*chix_180_254)*dxyz_2__mod__cdata
}
if (AC_lheatc_corona__mod__energy) {
bb2_181_254 = dot(ac_transformed_pencil_bb,ac_transformed_pencil_bb)
b1_181_254=1./max(AC_REAL_MIN,bb2_181_254)
vkpara_181_254 = AC_kgpara__mod__energy * pow(exp(ac_transformed_pencil_lntt),3.5)
vkperp_181_254 = AC_kgperp__mod__energy * b1_181_254*exp(2*ac_transformed_pencil_lnrho+0.5*ac_transformed_pencil_lntt)
tmps_181_254 = 3.5 * vkpara_181_254
gvkpara_181_254 = tmps_181_254*ac_transformed_pencil_glntt
tmpv_181_254.x=0.
tmpv_181_254.x=tmpv_181_254.x + ac_transformed_pencil_bb.x*ac_transformed_pencil_bij[1-1][1-1]
tmpv_181_254.x=tmpv_181_254.x + ac_transformed_pencil_bb.y*ac_transformed_pencil_bij[2-1][1-1]
tmpv_181_254.x=tmpv_181_254.x + ac_transformed_pencil_bb.z*ac_transformed_pencil_bij[3-1][1-1]
tmpv_181_254.y=0.
tmpv_181_254.y=tmpv_181_254.y + ac_transformed_pencil_bb.x*ac_transformed_pencil_bij[1-1][2-1]
tmpv_181_254.y=tmpv_181_254.y + ac_transformed_pencil_bb.y*ac_transformed_pencil_bij[2-1][2-1]
tmpv_181_254.y=tmpv_181_254.y + ac_transformed_pencil_bb.z*ac_transformed_pencil_bij[3-1][2-1]
tmpv_181_254.z=0.
tmpv_181_254.z=tmpv_181_254.z + ac_transformed_pencil_bb.x*ac_transformed_pencil_bij[1-1][3-1]
tmpv_181_254.z=tmpv_181_254.z + ac_transformed_pencil_bb.y*ac_transformed_pencil_bij[2-1][3-1]
tmpv_181_254.z=tmpv_181_254.z + ac_transformed_pencil_bb.z*ac_transformed_pencil_bij[3-1][3-1]
tmpv2_181_254 = 2*b1_181_254*tmpv_181_254
tmpv_181_254=2.*ac_transformed_pencil_glnrho+0.5*ac_transformed_pencil_glntt-tmpv2_181_254
gvkperp_181_254 = vkperp_181_254*tmpv_181_254
abs_b_171_181_254 = sqrt(dot(ac_transformed_pencil_bb,ac_transformed_pencil_bb))
b1_171_181_254=1./max(AC_tini__mod__cparam,abs_b_171_181_254)
bunit_171_181_254 = b1_171_181_254*ac_transformed_pencil_bb
del2ecr_171_181_254=0.
del2ecr_171_181_254=del2ecr_171_181_254+ac_transformed_pencil_hlntt[1-1][1-1]
hhh_171_181_254.x=0.
tmpj_171_181_254=0.
tmpj_171_181_254=tmpj_171_181_254-2.*bunit_171_181_254.x*ac_transformed_pencil_bij[1-1][1-1]
tmpj_171_181_254=tmpj_171_181_254-2.*bunit_171_181_254.y*ac_transformed_pencil_bij[2-1][1-1]
tmpj_171_181_254=tmpj_171_181_254-2.*bunit_171_181_254.z*ac_transformed_pencil_bij[3-1][1-1]
hhh_171_181_254.x=hhh_171_181_254.x+bunit_171_181_254.x*(ac_transformed_pencil_bij[1-1][1-1]+bunit_171_181_254.x*tmpj_171_181_254)
tmpj_171_181_254=0.
tmpj_171_181_254=tmpj_171_181_254-2.*bunit_171_181_254.x*ac_transformed_pencil_bij[1-1][2-1]
tmpj_171_181_254=tmpj_171_181_254-2.*bunit_171_181_254.y*ac_transformed_pencil_bij[2-1][2-1]
tmpj_171_181_254=tmpj_171_181_254-2.*bunit_171_181_254.z*ac_transformed_pencil_bij[3-1][2-1]
hhh_171_181_254.x=hhh_171_181_254.x+bunit_171_181_254.y*(ac_transformed_pencil_bij[1-1][2-1]+bunit_171_181_254.x*tmpj_171_181_254)
tmpj_171_181_254=0.
tmpj_171_181_254=tmpj_171_181_254-2.*bunit_171_181_254.x*ac_transformed_pencil_bij[1-1][3-1]
tmpj_171_181_254=tmpj_171_181_254-2.*bunit_171_181_254.y*ac_transformed_pencil_bij[2-1][3-1]
tmpj_171_181_254=tmpj_171_181_254-2.*bunit_171_181_254.z*ac_transformed_pencil_bij[3-1][3-1]
hhh_171_181_254.x=hhh_171_181_254.x+bunit_171_181_254.z*(ac_transformed_pencil_bij[1-1][3-1]+bunit_171_181_254.x*tmpj_171_181_254)
del2ecr_171_181_254=del2ecr_171_181_254+ac_transformed_pencil_hlntt[2-1][2-1]
hhh_171_181_254.y=0.
tmpj_171_181_254=0.
tmpj_171_181_254=tmpj_171_181_254-2.*bunit_171_181_254.x*ac_transformed_pencil_bij[1-1][1-1]
tmpj_171_181_254=tmpj_171_181_254-2.*bunit_171_181_254.y*ac_transformed_pencil_bij[2-1][1-1]
tmpj_171_181_254=tmpj_171_181_254-2.*bunit_171_181_254.z*ac_transformed_pencil_bij[3-1][1-1]
hhh_171_181_254.y=hhh_171_181_254.y+bunit_171_181_254.x*(ac_transformed_pencil_bij[2-1][1-1]+bunit_171_181_254.y*tmpj_171_181_254)
tmpj_171_181_254=0.
tmpj_171_181_254=tmpj_171_181_254-2.*bunit_171_181_254.x*ac_transformed_pencil_bij[1-1][2-1]
tmpj_171_181_254=tmpj_171_181_254-2.*bunit_171_181_254.y*ac_transformed_pencil_bij[2-1][2-1]
tmpj_171_181_254=tmpj_171_181_254-2.*bunit_171_181_254.z*ac_transformed_pencil_bij[3-1][2-1]
hhh_171_181_254.y=hhh_171_181_254.y+bunit_171_181_254.y*(ac_transformed_pencil_bij[2-1][2-1]+bunit_171_181_254.y*tmpj_171_181_254)
tmpj_171_181_254=0.
tmpj_171_181_254=tmpj_171_181_254-2.*bunit_171_181_254.x*ac_transformed_pencil_bij[1-1][3-1]
tmpj_171_181_254=tmpj_171_181_254-2.*bunit_171_181_254.y*ac_transformed_pencil_bij[2-1][3-1]
tmpj_171_181_254=tmpj_171_181_254-2.*bunit_171_181_254.z*ac_transformed_pencil_bij[3-1][3-1]
hhh_171_181_254.y=hhh_171_181_254.y+bunit_171_181_254.z*(ac_transformed_pencil_bij[2-1][3-1]+bunit_171_181_254.y*tmpj_171_181_254)
del2ecr_171_181_254=del2ecr_171_181_254+ac_transformed_pencil_hlntt[3-1][3-1]
hhh_171_181_254.z=0.
tmpj_171_181_254=0.
tmpj_171_181_254=tmpj_171_181_254-2.*bunit_171_181_254.x*ac_transformed_pencil_bij[1-1][1-1]
tmpj_171_181_254=tmpj_171_181_254-2.*bunit_171_181_254.y*ac_transformed_pencil_bij[2-1][1-1]
tmpj_171_181_254=tmpj_171_181_254-2.*bunit_171_181_254.z*ac_transformed_pencil_bij[3-1][1-1]
hhh_171_181_254.z=hhh_171_181_254.z+bunit_171_181_254.x*(ac_transformed_pencil_bij[3-1][1-1]+bunit_171_181_254.z*tmpj_171_181_254)
tmpj_171_181_254=0.
tmpj_171_181_254=tmpj_171_181_254-2.*bunit_171_181_254.x*ac_transformed_pencil_bij[1-1][2-1]
tmpj_171_181_254=tmpj_171_181_254-2.*bunit_171_181_254.y*ac_transformed_pencil_bij[2-1][2-1]
tmpj_171_181_254=tmpj_171_181_254-2.*bunit_171_181_254.z*ac_transformed_pencil_bij[3-1][2-1]
hhh_171_181_254.z=hhh_171_181_254.z+bunit_171_181_254.y*(ac_transformed_pencil_bij[3-1][2-1]+bunit_171_181_254.z*tmpj_171_181_254)
tmpj_171_181_254=0.
tmpj_171_181_254=tmpj_171_181_254-2.*bunit_171_181_254.x*ac_transformed_pencil_bij[1-1][3-1]
tmpj_171_181_254=tmpj_171_181_254-2.*bunit_171_181_254.y*ac_transformed_pencil_bij[2-1][3-1]
tmpj_171_181_254=tmpj_171_181_254-2.*bunit_171_181_254.z*ac_transformed_pencil_bij[3-1][3-1]
hhh_171_181_254.z=hhh_171_181_254.z+bunit_171_181_254.z*(ac_transformed_pencil_bij[3-1][3-1]+bunit_171_181_254.z*tmpj_171_181_254)
tmpv_171_181_254 = b1_171_181_254*hhh_171_181_254
hhh2_171_181_254 = sqrt(dot(tmpv_171_181_254,tmpv_171_181_254))
quenchfactor_171_181_254=1./max(1.,limiter_tensordiff_171_181_254*hhh2_171_181_254*AC_dxmax__mod__cdata)
hhh_171_181_254 = quenchfactor_171_181_254*tmpv_171_181_254
tmp_171_181_254 = dot(hhh_171_181_254,ac_transformed_pencil_glntt)
hhh_171_181_254 = ac_transformed_pencil_hlntt*bunit_171_181_254
tmpj_171_181_254 = dot(hhh_171_181_254,bunit_171_181_254)
tmp_171_181_254 = tmp_171_181_254+tmpj_171_181_254
gecr2_171_181_254=0.
if (false) {
tmpi_171_181_254 = dot(ac_transformed_pencil_glntt,bunit_171_181_254)
tmp_171_181_254=tmp_171_181_254+tmpi_171_181_254*tmpi_171_181_254
gecr2_171_181_254 = dot(ac_transformed_pencil_glntt,ac_transformed_pencil_glntt)
}
if (true) {
gvkpara1_171_181_254=gvkpara_181_254
}
else {
gvkpara1_171_181_254.x = 0.
gvkpara1_171_181_254.y = 0.
gvkpara1_171_181_254.z = 0.
}
if (true) {
gvkperp1_171_181_254=gvkperp_181_254
}
else {
gvkperp1_171_181_254.x = 0.
gvkperp1_171_181_254.y = 0.
gvkperp1_171_181_254.z = 0.
}
tmpj_171_181_254 = dot(gvkperp1_171_181_254,ac_transformed_pencil_glntt)
tmpi_171_181_254 = dot(bunit_171_181_254,gvkpara1_171_181_254-gvkperp1_171_181_254)
tmpk_171_181_254 = dot(bunit_171_181_254,ac_transformed_pencil_glntt)
tmpj_171_181_254 = tmpj_171_181_254+tmpi_171_181_254*tmpk_171_181_254
thdiff_181_254=vkperp_181_254*(del2ecr_171_181_254+gecr2_171_181_254) + (vkpara_181_254-vkperp_181_254)*tmp_171_181_254 + tmpj_171_181_254
thdiff_181_254 = thdiff_181_254*exp(-ac_transformed_pencil_lnrho-ac_transformed_pencil_lntt)
DF_SS=DF_SS + thdiff_181_254
if (AC_z__mod__cdata[AC_n__mod__cdata-1] < AC_prof_z__mod__energy[1-1] ) {
lnttor_182_254 = AC_prof_lnt__mod__energy[1-1]
}
else if (AC_z__mod__cdata[AC_n__mod__cdata-1] >= AC_prof_z__mod__energy[AC_prof_nz__mod__energy-1]) {
lnttor_182_254 = AC_prof_lnt__mod__energy[AC_prof_nz__mod__energy-1]
}
else {
i_182_254 = AC_index_on_profile__mod__energy
lnttor_182_254 = (AC_prof_lnt__mod__energy[i_182_254-1]*(AC_prof_z__mod__energy[1+i_182_254-1] - AC_z__mod__cdata[AC_n__mod__cdata-1]) +  AC_prof_lnt__mod__energy[1+i_182_254-1]*(AC_z__mod__cdata[AC_n__mod__cdata-1] - AC_prof_z__mod__energy[i_182_254-1]) ) / (AC_prof_z__mod__energy[1+i_182_254-1]-AC_prof_z__mod__energy[i_182_254-1])
}
if (AC_dt__mod__cdata!=0.0)  {
newton_182_254 = AC_tdown__mod__energy/AC_gamma__mod__energy/AC_dt__mod__cdata*((lnttor_182_254 - ac_transformed_pencil_lntt) )
newton_182_254 = newton_182_254 * exp(AC_allp__mod__energy*(-abs(ac_transformed_pencil_lnrho-AC_lnrho0__mod__equationofstate)))
DF_SS = DF_SS + newton_182_254
}
unit_lnq_183_254=3*log(AC_unit_velocity__mod__cdata)+5*log(AC_unit_length__mod__cdata)+log(AC_unit_density__mod__cdata)
if (AC_unit_system_int__mod__cdata == AC_unit_system_int_cgs__mod__cdata) {
unit_lnq_183_254 = unit_lnq_183_254+log(1.e13)
}
lntt_si_183_254 = ac_transformed_pencil_lntt + log(AC_unit_temperature__mod__cdata)
lnneni_183_254 = 2*ac_transformed_pencil_lnrho + log(1.2) - 2*log(1.4*AC_m_p__mod__cdata)
rtv_cool_183_254=0.
if(AC_cool_type__mod__energy == 1) {
imax_183_254 = 10
lnq_183_254=0.0
for i_183_254 in 1:imax_183_254-1+1 {
lnq_183_254=lnq_183_254 + (lnh_1_183_254[i_183_254-1] + b_1_183_254[i_183_254-1]*lntt_si_183_254)*(( intlnt_1_183_254[i_183_254-1] <= lntt_si_183_254  ||  i_183_254==1 )  &&  lntt_si_183_254 < intlnt_1_183_254[1+i_183_254-1] )
}
lnq_183_254 = lnq_183_254 + (lnh_1_183_254[imax_183_254-1-1] + b_1_183_254[imax_183_254-1-1]*intlnt_1_183_254[imax_183_254-1])*(lntt_si_183_254 >= intlnt_1_183_254[imax_183_254-1] )
if (AC_pres_cutoff__mod__energy!=AC_impossible__mod__cparam) {
rtv_cool_183_254=exp(lnneni_183_254+lnq_183_254-unit_lnq_183_254-ac_transformed_pencil_lntt-ac_transformed_pencil_lnrho)*exp(-ac_transformed_pencil_rho*ac_transformed_pencil_cs2*AC_gamma1__mod__energy/AC_pres_cutoff__mod__energy)
}
else {
rtv_cool_183_254=exp(lnneni_183_254+lnq_183_254-unit_lnq_183_254-ac_transformed_pencil_lntt-ac_transformed_pencil_lnrho)
}
}
else if(AC_cool_type__mod__energy == 2) {
imax_183_254 = 7
lnq_183_254=0.0
for i_183_254 in 1:imax_183_254-1+1 {
lnq_183_254=lnq_183_254 + lnh_2_183_254[i_183_254-1] + b_2_183_254[i_183_254-1]*lntt_si_183_254*(( intlnt_2_183_254[i_183_254-1] <= lntt_si_183_254  ||  i_183_254==1 )  &&  lntt_si_183_254 < intlnt_2_183_254[1+i_183_254-1] )
}
lnq_183_254 = lnq_183_254 + lnh_2_183_254[imax_183_254-1-1] + b_2_183_254[imax_183_254-1-1]*intlnt_2_183_254[imax_183_254-1]*(lntt_si_183_254 >= intlnt_2_183_254[imax_183_254-1] )
if (AC_pres_cutoff__mod__energy!=AC_impossible__mod__cparam) {
rtv_cool_183_254=exp(lnneni_183_254+lnq_183_254-unit_lnq_183_254-ac_transformed_pencil_lntt-ac_transformed_pencil_lnrho)*exp(-ac_transformed_pencil_rho*ac_transformed_pencil_cs2*AC_gamma1__mod__energy/AC_pres_cutoff__mod__energy)
}
else {
rtv_cool_183_254=exp(lnneni_183_254+lnq_183_254-unit_lnq_183_254-ac_transformed_pencil_lntt-ac_transformed_pencil_lnrho)
}
}
else if(AC_cool_type__mod__energy == 3) {
}
else {
rtv_cool_183_254=0.
}
rtv_cool_183_254=rtv_cool_183_254 * AC_cool_rtv__mod__energy
DF_SS = DF_SS-rtv_cool_183_254
}
vkpara_185_254 = AC_kgpara__mod__energy
vkperp_185_254 = AC_kgperp__mod__energy
abs_b_184_185_254 = sqrt(dot(ac_transformed_pencil_bb,ac_transformed_pencil_bb))
b1_184_185_254=1./max(AC_tini__mod__cparam,abs_b_184_185_254)
bunit_184_185_254 = b1_184_185_254*ac_transformed_pencil_bb
del2ecr_184_185_254=0.
del2ecr_184_185_254=del2ecr_184_185_254+ac_transformed_pencil_hlntt[1-1][1-1]
hhh_184_185_254.x=0.
tmpj_184_185_254=0.
tmpj_184_185_254=tmpj_184_185_254-2.*bunit_184_185_254.x*ac_transformed_pencil_bij[1-1][1-1]
tmpj_184_185_254=tmpj_184_185_254-2.*bunit_184_185_254.y*ac_transformed_pencil_bij[2-1][1-1]
tmpj_184_185_254=tmpj_184_185_254-2.*bunit_184_185_254.z*ac_transformed_pencil_bij[3-1][1-1]
hhh_184_185_254.x=hhh_184_185_254.x+bunit_184_185_254.x*(ac_transformed_pencil_bij[1-1][1-1]+bunit_184_185_254.x*tmpj_184_185_254)
tmpj_184_185_254=0.
tmpj_184_185_254=tmpj_184_185_254-2.*bunit_184_185_254.x*ac_transformed_pencil_bij[1-1][2-1]
tmpj_184_185_254=tmpj_184_185_254-2.*bunit_184_185_254.y*ac_transformed_pencil_bij[2-1][2-1]
tmpj_184_185_254=tmpj_184_185_254-2.*bunit_184_185_254.z*ac_transformed_pencil_bij[3-1][2-1]
hhh_184_185_254.x=hhh_184_185_254.x+bunit_184_185_254.y*(ac_transformed_pencil_bij[1-1][2-1]+bunit_184_185_254.x*tmpj_184_185_254)
tmpj_184_185_254=0.
tmpj_184_185_254=tmpj_184_185_254-2.*bunit_184_185_254.x*ac_transformed_pencil_bij[1-1][3-1]
tmpj_184_185_254=tmpj_184_185_254-2.*bunit_184_185_254.y*ac_transformed_pencil_bij[2-1][3-1]
tmpj_184_185_254=tmpj_184_185_254-2.*bunit_184_185_254.z*ac_transformed_pencil_bij[3-1][3-1]
hhh_184_185_254.x=hhh_184_185_254.x+bunit_184_185_254.z*(ac_transformed_pencil_bij[1-1][3-1]+bunit_184_185_254.x*tmpj_184_185_254)
del2ecr_184_185_254=del2ecr_184_185_254+ac_transformed_pencil_hlntt[2-1][2-1]
hhh_184_185_254.y=0.
tmpj_184_185_254=0.
tmpj_184_185_254=tmpj_184_185_254-2.*bunit_184_185_254.x*ac_transformed_pencil_bij[1-1][1-1]
tmpj_184_185_254=tmpj_184_185_254-2.*bunit_184_185_254.y*ac_transformed_pencil_bij[2-1][1-1]
tmpj_184_185_254=tmpj_184_185_254-2.*bunit_184_185_254.z*ac_transformed_pencil_bij[3-1][1-1]
hhh_184_185_254.y=hhh_184_185_254.y+bunit_184_185_254.x*(ac_transformed_pencil_bij[2-1][1-1]+bunit_184_185_254.y*tmpj_184_185_254)
tmpj_184_185_254=0.
tmpj_184_185_254=tmpj_184_185_254-2.*bunit_184_185_254.x*ac_transformed_pencil_bij[1-1][2-1]
tmpj_184_185_254=tmpj_184_185_254-2.*bunit_184_185_254.y*ac_transformed_pencil_bij[2-1][2-1]
tmpj_184_185_254=tmpj_184_185_254-2.*bunit_184_185_254.z*ac_transformed_pencil_bij[3-1][2-1]
hhh_184_185_254.y=hhh_184_185_254.y+bunit_184_185_254.y*(ac_transformed_pencil_bij[2-1][2-1]+bunit_184_185_254.y*tmpj_184_185_254)
tmpj_184_185_254=0.
tmpj_184_185_254=tmpj_184_185_254-2.*bunit_184_185_254.x*ac_transformed_pencil_bij[1-1][3-1]
tmpj_184_185_254=tmpj_184_185_254-2.*bunit_184_185_254.y*ac_transformed_pencil_bij[2-1][3-1]
tmpj_184_185_254=tmpj_184_185_254-2.*bunit_184_185_254.z*ac_transformed_pencil_bij[3-1][3-1]
hhh_184_185_254.y=hhh_184_185_254.y+bunit_184_185_254.z*(ac_transformed_pencil_bij[2-1][3-1]+bunit_184_185_254.y*tmpj_184_185_254)
del2ecr_184_185_254=del2ecr_184_185_254+ac_transformed_pencil_hlntt[3-1][3-1]
hhh_184_185_254.z=0.
tmpj_184_185_254=0.
tmpj_184_185_254=tmpj_184_185_254-2.*bunit_184_185_254.x*ac_transformed_pencil_bij[1-1][1-1]
tmpj_184_185_254=tmpj_184_185_254-2.*bunit_184_185_254.y*ac_transformed_pencil_bij[2-1][1-1]
tmpj_184_185_254=tmpj_184_185_254-2.*bunit_184_185_254.z*ac_transformed_pencil_bij[3-1][1-1]
hhh_184_185_254.z=hhh_184_185_254.z+bunit_184_185_254.x*(ac_transformed_pencil_bij[3-1][1-1]+bunit_184_185_254.z*tmpj_184_185_254)
tmpj_184_185_254=0.
tmpj_184_185_254=tmpj_184_185_254-2.*bunit_184_185_254.x*ac_transformed_pencil_bij[1-1][2-1]
tmpj_184_185_254=tmpj_184_185_254-2.*bunit_184_185_254.y*ac_transformed_pencil_bij[2-1][2-1]
tmpj_184_185_254=tmpj_184_185_254-2.*bunit_184_185_254.z*ac_transformed_pencil_bij[3-1][2-1]
hhh_184_185_254.z=hhh_184_185_254.z+bunit_184_185_254.y*(ac_transformed_pencil_bij[3-1][2-1]+bunit_184_185_254.z*tmpj_184_185_254)
tmpj_184_185_254=0.
tmpj_184_185_254=tmpj_184_185_254-2.*bunit_184_185_254.x*ac_transformed_pencil_bij[1-1][3-1]
tmpj_184_185_254=tmpj_184_185_254-2.*bunit_184_185_254.y*ac_transformed_pencil_bij[2-1][3-1]
tmpj_184_185_254=tmpj_184_185_254-2.*bunit_184_185_254.z*ac_transformed_pencil_bij[3-1][3-1]
hhh_184_185_254.z=hhh_184_185_254.z+bunit_184_185_254.z*(ac_transformed_pencil_bij[3-1][3-1]+bunit_184_185_254.z*tmpj_184_185_254)
tmpv_184_185_254 = b1_184_185_254*hhh_184_185_254
hhh2_184_185_254 = sqrt(dot(tmpv_184_185_254,tmpv_184_185_254))
quenchfactor_184_185_254=1./max(1.,limiter_tensordiff_184_185_254*hhh2_184_185_254*AC_dxmax__mod__cdata)
hhh_184_185_254 = quenchfactor_184_185_254*tmpv_184_185_254
tmp_184_185_254 = dot(hhh_184_185_254,ac_transformed_pencil_glntt)
hhh_184_185_254 = ac_transformed_pencil_hlntt*bunit_184_185_254
tmpj_184_185_254 = dot(hhh_184_185_254,bunit_184_185_254)
tmp_184_185_254 = tmp_184_185_254+tmpj_184_185_254
gecr2_184_185_254=0.
if (true) {
tmpi_184_185_254 = dot(ac_transformed_pencil_glntt,bunit_184_185_254)
tmp_184_185_254=tmp_184_185_254+tmpi_184_185_254*tmpi_184_185_254
gecr2_184_185_254 = dot(ac_transformed_pencil_glntt,ac_transformed_pencil_glntt)
}
if (false) {
}
else {
gvkpara1_184_185_254.x = 0.
gvkpara1_184_185_254.y = 0.
gvkpara1_184_185_254.z = 0.
}
if (false) {
}
else {
gvkperp1_184_185_254.x = 0.
gvkperp1_184_185_254.y = 0.
gvkperp1_184_185_254.z = 0.
}
tmpj_184_185_254 = dot(gvkperp1_184_185_254,ac_transformed_pencil_glntt)
tmpi_184_185_254 = dot(bunit_184_185_254,gvkpara1_184_185_254-gvkperp1_184_185_254)
tmpk_184_185_254 = dot(bunit_184_185_254,ac_transformed_pencil_glntt)
tmpj_184_185_254 = tmpj_184_185_254+tmpi_184_185_254*tmpk_184_185_254
rhs_185_254=vkperp_185_254*(del2ecr_184_185_254+gecr2_184_185_254) + (vkpara_185_254-vkperp_185_254)*tmp_184_185_254 + tmpj_184_185_254
if (ac_transformed_pencil_rho <= AC_REAL_MIN) {
ac_transformed_pencil_rho1=0.0
}
DF_SS=DF_SS+rhs_185_254*ac_transformed_pencil_rho1
cosbgt_185_254 = dot(ac_transformed_pencil_bb,ac_transformed_pencil_glntt)
gt2_185_254 = dot(ac_transformed_pencil_glntt,ac_transformed_pencil_glntt)
b2_185_254 = dot(ac_transformed_pencil_bb,ac_transformed_pencil_bb)
if ((gt2_185_254<=AC_tini__mod__cparam) || (b2_185_254<=AC_tini__mod__cparam)) {
cosbgt_185_254=0.
}
else {
cosbgt_185_254=cosbgt_185_254/sqrt(gt2_185_254*b2_185_254)
}
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
diffus_chi__mod__energy=diffus_chi__mod__energy + cosbgt_185_254*ac_transformed_pencil_cv1*AC_kgpara__mod__energy*exp(-ac_transformed_pencil_lnrho)*dxyz_2__mod__cdata
}
thdiff_186_254=0.
tmp_186_254 = der6x_ignore_spacing(Field(AC_iss__mod__cdata))
thdiff_186_254 = thdiff_186_254 + AC_chi_hyper3__mod__energy*AC_pi4_1__mod__cparam*tmp_186_254*dline_1__mod__cdata.x*dline_1__mod__cdata.x
tmp_186_254 = der6y_ignore_spacing(Field(AC_iss__mod__cdata))
thdiff_186_254 = thdiff_186_254 + AC_chi_hyper3__mod__energy*AC_pi4_1__mod__cparam*tmp_186_254*dline_1__mod__cdata.y*dline_1__mod__cdata.y
tmp_186_254 = der6z_ignore_spacing(Field(AC_iss__mod__cdata))
thdiff_186_254 = thdiff_186_254 + AC_chi_hyper3__mod__energy*AC_pi4_1__mod__cparam*tmp_186_254*dline_1__mod__cdata.z*dline_1__mod__cdata.z
DF_SS = DF_SS + thdiff_186_254
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
diffus_chi3__mod__energy=diffus_chi3__mod__energy+AC_chi_hyper3__mod__energy*AC_pi4_1__mod__cparam*dxmin_pencil__mod__cdata*dxmin_pencil__mod__cdata*dxmin_pencil__mod__cdata*dxmin_pencil__mod__cdata
}
thdiff_187_254=0.0
tmp_187_254 = der6x_ignore_spacing(Field(AC_iss__mod__cdata))
if (AC_ldynamical_diffusion__mod__cdata) {
thdiff_187_254 = thdiff_187_254 + AC_chi_hyper3_mesh__mod__energy * tmp_187_254 * dline_1__mod__cdata.x
}
else {
thdiff_187_254 = thdiff_187_254 + AC_chi_hyper3_mesh__mod__energy*AC_pi5_1__mod__cparam/60.*tmp_187_254*dline_1__mod__cdata.x
}
tmp_187_254 = der6y_ignore_spacing(Field(AC_iss__mod__cdata))
if (AC_ldynamical_diffusion__mod__cdata) {
thdiff_187_254 = thdiff_187_254 + AC_chi_hyper3_mesh__mod__energy * tmp_187_254 * dline_1__mod__cdata.y
}
else {
thdiff_187_254 = thdiff_187_254 + AC_chi_hyper3_mesh__mod__energy*AC_pi5_1__mod__cparam/60.*tmp_187_254*dline_1__mod__cdata.y
}
tmp_187_254 = der6z_ignore_spacing(Field(AC_iss__mod__cdata))
if (AC_ldynamical_diffusion__mod__cdata) {
thdiff_187_254 = thdiff_187_254 + AC_chi_hyper3_mesh__mod__energy * tmp_187_254 * dline_1__mod__cdata.z
}
else {
thdiff_187_254 = thdiff_187_254 + AC_chi_hyper3_mesh__mod__energy*AC_pi5_1__mod__cparam/60.*tmp_187_254*dline_1__mod__cdata.z
}
DF_SS = DF_SS + thdiff_187_254
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
if (AC_ldynamical_diffusion__mod__cdata) {
diffus_chi3__mod__energy = diffus_chi3__mod__energy + AC_chi_hyper3_mesh__mod__energy * sum(abs(dline_1__mod__cdata))
advec_hypermesh_ss_187_254 = 0.0
}
else {
advec_hypermesh_ss_187_254=AC_chi_hyper3_mesh__mod__energy*AC_pi5_1__mod__cparam*sqrt(dxyz_2__mod__cdata)
}
advec2_hypermesh__mod__cdata=advec2_hypermesh__mod__cdata+advec_hypermesh_ss_187_254*advec_hypermesh_ss_187_254
}
thdiff_188_254  = del6fj(Field(AC_iss__mod__cdata), AC_chi_hyper3_aniso__mod__energy)
DF_SS = DF_SS + thdiff_188_254
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
diffus_chi3__mod__energy=diffus_chi3__mod__energy + (AC_chi_hyper3_aniso__mod__energy.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x +  AC_chi_hyper3_aniso__mod__energy.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y +  AC_chi_hyper3_aniso__mod__energy.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z)
}
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
maxdiffus__mod__cdata=max(maxdiffus__mod__cdata,diffus_chi__mod__energy)
maxdiffus3__mod__cdata=max(maxdiffus3__mod__cdata,diffus_chi3__mod__energy)
}
heat_236_254=0.0
if(AC_cooling_profile_int__mod__energy == AC_cooling_profile_int_gaussian_z__mod__energy) {
prof_199_236_254=exp(-0.5*((AC_zcool__mod__energy-AC_z__mod__cdata[AC_n__mod__cdata-1])/AC_wcool__mod__energy)*((AC_zcool__mod__energy-AC_z__mod__cdata[AC_n__mod__cdata-1])/AC_wcool__mod__energy))
}
else if(AC_cooling_profile_int__mod__energy == AC_cooling_profile_int_lin_z__mod__energy) {
prof_199_236_254=AC_z__mod__cdata[AC_n__mod__cdata-1]/AC_wcool__mod__energy
}
else if(AC_cooling_profile_int__mod__energy == AC_cooling_profile_int_sin_z__mod__energy) {
prof_199_236_254=sin(AC_z__mod__cdata[AC_n__mod__cdata-1]/AC_wcool__mod__energy)
}
else if(AC_cooling_profile_int__mod__energy == AC_cooling_profile_int_surface_z__mod__energy) {
z_189_199_236_254 = abs((AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_zcool__mod__energy)/AC_wcool__mod__energy)
t_189_199_236_254 = 1.0 / ( 1.0 + 0.5 * z_189_199_236_254 )
dumerfc_189_199_236_254 =  t_189_199_236_254 * exp(-z_189_199_236_254 * z_189_199_236_254 - 1.26551223 + t_189_199_236_254 *         ( 1.00002368 + t_189_199_236_254 * ( 0.37409196 + t_189_199_236_254 *            ( 0.09678418 + t_189_199_236_254 * (-0.18628806 + t_189_199_236_254 *            ( 0.27886807 + t_189_199_236_254 * (-1.13520398 + t_189_199_236_254 *            ( 1.48851587 + t_189_199_236_254 * (-0.82215223 + t_189_199_236_254 * 0.17087277 )))))))))
if ((AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_zcool__mod__energy)/AC_wcool__mod__energy<0.0) {
dumerfc_189_199_236_254 = 2.0 - dumerfc_189_199_236_254
}
erfunc_return_value_189_199_236_254 = 1.0 - dumerfc_189_199_236_254
prof_199_236_254=0.5*(1.+erfunc_return_value_189_199_236_254)
}
else if(AC_cooling_profile_int__mod__energy == AC_cooling_profile_int_surface_x__mod__energy) {
z_190_199_236_254 = abs((AC_x__mod__cdata[vertexIdx.x]-AC_rcool__mod__energy)/AC_wcool__mod__energy)
t_190_199_236_254 = 1.0 / ( 1.0 + 0.5 * z_190_199_236_254 )
dumerfc_190_199_236_254 =  t_190_199_236_254 * exp(-z_190_199_236_254 * z_190_199_236_254 - 1.26551223 + t_190_199_236_254 *         ( 1.00002368 + t_190_199_236_254 * ( 0.37409196 + t_190_199_236_254 *            ( 0.09678418 + t_190_199_236_254 * (-0.18628806 + t_190_199_236_254 *            ( 0.27886807 + t_190_199_236_254 * (-1.13520398 + t_190_199_236_254 *            ( 1.48851587 + t_190_199_236_254 * (-0.82215223 + t_190_199_236_254 * 0.17087277 )))))))))
if ((AC_x__mod__cdata[vertexIdx.x]-AC_rcool__mod__energy)/AC_wcool__mod__energy<0.0) {
dumerfc_190_199_236_254 = 2.0 - dumerfc_190_199_236_254
}
erfunc_return_value_190_199_236_254 = 1.0 - dumerfc_190_199_236_254
prof_199_236_254=0.5*(1.+erfunc_return_value_190_199_236_254)
}
else if(AC_cooling_profile_int__mod__energy == AC_cooling_profile_int_two_layer__mod__energy) {
z_191_199_236_254 = abs((AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_zcool__mod__energy )/AC_wcool__mod__energy)
t_191_199_236_254 = 1.0 / ( 1.0 + 0.5 * z_191_199_236_254 )
dumerfc_191_199_236_254 =  t_191_199_236_254 * exp(-z_191_199_236_254 * z_191_199_236_254 - 1.26551223 + t_191_199_236_254 *         ( 1.00002368 + t_191_199_236_254 * ( 0.37409196 + t_191_199_236_254 *            ( 0.09678418 + t_191_199_236_254 * (-0.18628806 + t_191_199_236_254 *            ( 0.27886807 + t_191_199_236_254 * (-1.13520398 + t_191_199_236_254 *            ( 1.48851587 + t_191_199_236_254 * (-0.82215223 + t_191_199_236_254 * 0.17087277 )))))))))
if ((AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_zcool__mod__energy )/AC_wcool__mod__energy<0.0) {
dumerfc_191_199_236_254 = 2.0 - dumerfc_191_199_236_254
}
erfunc_return_value_191_199_236_254 = 1.0 - dumerfc_191_199_236_254
prof_199_236_254 =0.5*(1.+erfunc_return_value_191_199_236_254)
z_192_199_236_254 = abs((AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_zcool2__mod__energy)/AC_wcool2__mod__energy)
t_192_199_236_254 = 1.0 / ( 1.0 + 0.5 * z_192_199_236_254 )
dumerfc_192_199_236_254 =  t_192_199_236_254 * exp(-z_192_199_236_254 * z_192_199_236_254 - 1.26551223 + t_192_199_236_254 *         ( 1.00002368 + t_192_199_236_254 * ( 0.37409196 + t_192_199_236_254 *            ( 0.09678418 + t_192_199_236_254 * (-0.18628806 + t_192_199_236_254 *            ( 0.27886807 + t_192_199_236_254 * (-1.13520398 + t_192_199_236_254 *            ( 1.48851587 + t_192_199_236_254 * (-0.82215223 + t_192_199_236_254 * 0.17087277 )))))))))
if ((AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_zcool2__mod__energy)/AC_wcool2__mod__energy<0.0) {
dumerfc_192_199_236_254 = 2.0 - dumerfc_192_199_236_254
}
erfunc_return_value_192_199_236_254 = 1.0 - dumerfc_192_199_236_254
prof2_199_236_254=0.5*(1.+erfunc_return_value_192_199_236_254)
}
else if(AC_cooling_profile_int__mod__energy == AC_cooling_profile_int_square_well__mod__energy) {
z_193_199_236_254 = abs((AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_zcool__mod__energy)/AC_wcool__mod__energy)
t_193_199_236_254 = 1.0 / ( 1.0 + 0.5 * z_193_199_236_254 )
dumerfc_193_199_236_254 =  t_193_199_236_254 * exp(-z_193_199_236_254 * z_193_199_236_254 - 1.26551223 + t_193_199_236_254 *         ( 1.00002368 + t_193_199_236_254 * ( 0.37409196 + t_193_199_236_254 *            ( 0.09678418 + t_193_199_236_254 * (-0.18628806 + t_193_199_236_254 *            ( 0.27886807 + t_193_199_236_254 * (-1.13520398 + t_193_199_236_254 *            ( 1.48851587 + t_193_199_236_254 * (-0.82215223 + t_193_199_236_254 * 0.17087277 )))))))))
if ((AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_zcool__mod__energy)/AC_wcool__mod__energy<0.0) {
dumerfc_193_199_236_254 = 2.0 - dumerfc_193_199_236_254
}
erfunc_return_value_193_199_236_254 = 1.0 - dumerfc_193_199_236_254
z_194_199_236_254 = abs((AC_z__mod__cdata[AC_n__mod__cdata-1]+AC_zcool__mod__energy)/AC_wcool__mod__energy)
t_194_199_236_254 = 1.0 / ( 1.0 + 0.5 * z_194_199_236_254 )
dumerfc_194_199_236_254 =  t_194_199_236_254 * exp(-z_194_199_236_254 * z_194_199_236_254 - 1.26551223 + t_194_199_236_254 *         ( 1.00002368 + t_194_199_236_254 * ( 0.37409196 + t_194_199_236_254 *            ( 0.09678418 + t_194_199_236_254 * (-0.18628806 + t_194_199_236_254 *            ( 0.27886807 + t_194_199_236_254 * (-1.13520398 + t_194_199_236_254 *            ( 1.48851587 + t_194_199_236_254 * (-0.82215223 + t_194_199_236_254 * 0.17087277 )))))))))
if ((AC_z__mod__cdata[AC_n__mod__cdata-1]+AC_zcool__mod__energy)/AC_wcool__mod__energy<0.0) {
dumerfc_194_199_236_254 = 2.0 - dumerfc_194_199_236_254
}
erfunc_return_value_194_199_236_254 = 1.0 - dumerfc_194_199_236_254
prof_199_236_254=(1.+0.5*(erfunc_return_value_193_199_236_254-  erfunc_return_value_194_199_236_254))
}
else if(AC_cooling_profile_int__mod__energy == AC_cooling_profile_int_cubic_step__mod__energy) {
ztop_199_236_254=AC_xyz0__mod__cdata.z+AC_lxyz__mod__cdata.z
if (false) {
}
else {
relshift_195_199_236_254=0.0
}
xi_195_199_236_254 = (AC_z__mod__cdata[AC_n__mod__cdata-1]-(ztop_199_236_254+AC_z_cor__mod__energy)/2)/((ztop_199_236_254-AC_z_cor__mod__energy)/2+AC_tini__mod__cparam) - relshift_195_199_236_254
xi_195_199_236_254 = max(xi_195_199_236_254,-1.0)
xi_195_199_236_254 = min(xi_195_199_236_254, 1.0)
cubic_step_pt_return_value_195_199_236_254 = 0.5 + xi_195_199_236_254*(0.75-xi_195_199_236_254*xi_195_199_236_254*0.25)
prof_199_236_254 = cubic_step_pt_return_value_195_199_236_254
}
else if(AC_cooling_profile_int__mod__energy == AC_cooling_profile_int_cubic_step_topbot__mod__energy) {
zbot_199_236_254=AC_xyz0__mod__cdata.z
ztop_199_236_254=AC_xyz0__mod__cdata.z+AC_lxyz__mod__cdata.z
if (false) {
}
else {
relshift_196_199_236_254=0.0
}
xi_196_199_236_254 = (AC_z__mod__cdata[AC_n__mod__cdata-1]-(ztop_199_236_254+AC_z_cor__mod__energy)/2)/((ztop_199_236_254-AC_z_cor__mod__energy)/2+AC_tini__mod__cparam) - relshift_196_199_236_254
xi_196_199_236_254 = max(xi_196_199_236_254,-1.0)
xi_196_199_236_254 = min(xi_196_199_236_254, 1.0)
cubic_step_pt_return_value_196_199_236_254 = 0.5 + xi_196_199_236_254*(0.75-xi_196_199_236_254*xi_196_199_236_254*0.25)
if (false) {
}
else {
relshift_197_199_236_254=0.0
}
xi_197_199_236_254 = (AC_z__mod__cdata[AC_n__mod__cdata-1]-(zbot_199_236_254-AC_z_cor__mod__energy)/2)/((zbot_199_236_254+AC_z_cor__mod__energy)/2+AC_tini__mod__cparam) - relshift_197_199_236_254
xi_197_199_236_254 = max(xi_197_199_236_254,-1.0)
xi_197_199_236_254 = min(xi_197_199_236_254, 1.0)
cubic_step_pt_return_value_197_199_236_254 = 0.5 + xi_197_199_236_254*(0.75-xi_197_199_236_254*xi_197_199_236_254*0.25)
prof_199_236_254 = cubic_step_pt_return_value_196_199_236_254  +cubic_step_pt_return_value_197_199_236_254
}
else if(AC_cooling_profile_int__mod__energy == AC_cooling_profile_int_surface_pp__mod__energy) {
z_198_199_236_254 = abs((ac_transformed_pencil_pp-AC_ppcool__mod__energy)/AC_wcool__mod__energy)
t_198_199_236_254 = 1.0 / ( 1.0 + 0.5 * z_198_199_236_254 )
dumerfc_198_199_236_254 =  t_198_199_236_254 * exp(-z_198_199_236_254 * z_198_199_236_254 - 1.26551223 + t_198_199_236_254 *         ( 1.00002368 + t_198_199_236_254 * ( 0.37409196 + t_198_199_236_254 *            ( 0.09678418 + t_198_199_236_254 * (-0.18628806 + t_198_199_236_254 *            ( 0.27886807 + t_198_199_236_254 * (-1.13520398 + t_198_199_236_254 *            ( 1.48851587 + t_198_199_236_254 * (-0.82215223 + t_198_199_236_254 * 0.17087277 )))))))))
if ((ac_transformed_pencil_pp-AC_ppcool__mod__energy)/AC_wcool__mod__energy<0.0) {
dumerfc_198_199_236_254 = 2.0 - dumerfc_198_199_236_254
}
erfunc_return_value_198_199_236_254 = 1.0 - dumerfc_198_199_236_254
prof_199_236_254=0.5*(1.-erfunc_return_value_198_199_236_254)
}
if(AC_cooltype_int__mod__energy == AC_cooltype_int_constant__mod__energy) {
heat_236_254=heat_236_254-AC_cool__mod__energy*prof_199_236_254
}
else if(AC_cooltype_int__mod__energy == AC_cooltype_int_corona__mod__energy) {
heat_236_254=heat_236_254-AC_cool__mod__energy*prof_199_236_254*ac_transformed_pencil_cv*ac_transformed_pencil_rho*(ac_transformed_pencil_tt-AC_tt_cor__mod__energy)
}
else if(AC_cooltype_int__mod__energy == AC_cooltype_int_temp__mod__energy) {
heat_236_254=heat_236_254-AC_cool__mod__energy*(ac_transformed_pencil_cs2-(AC_cs20__mod__equationofstate-prof_199_236_254*AC_cs2cool__mod__energy))/AC_cs2cool__mod__energy
}
else if(AC_cooltype_int__mod__energy == AC_cooltype_int_temp2__mod__energy) {
heat_236_254=heat_236_254-AC_cool__mod__energy*prof_199_236_254*(ac_transformed_pencil_cs2-AC_cs2cool__mod__energy)/AC_cs2cool__mod__energy
}
else if(AC_cooltype_int__mod__energy == AC_cooltype_int_rho_cs2__mod__energy || AC_cooltype_int__mod__energy == AC_cooltype_int_square_well__mod__energy) {
heat_236_254=heat_236_254-AC_cool__mod__energy*prof_199_236_254*ac_transformed_pencil_rho*(ac_transformed_pencil_cs2-AC_cs2cool__mod__energy)
}
else if(AC_cooltype_int__mod__energy == AC_cooltype_int_two_layer__mod__energy) {
heat_236_254 = heat_236_254 - AC_cool__mod__energy *prof_199_236_254 *ac_transformed_pencil_rho*(ac_transformed_pencil_cs2-AC_cs2cool__mod__energy) - AC_cool2__mod__energy*prof2_199_236_254*ac_transformed_pencil_rho*(ac_transformed_pencil_cs2-AC_cs2cool2__mod__energy)
}
else if(AC_cooltype_int__mod__energy == AC_cooltype_int_two_layer_mean__mod__energy) {
heat_236_254 = heat_236_254 - AC_cool__mod__energy*prof_199_236_254*ac_transformed_pencil_rho*(AC_cs2mz__mod__energy[AC_n__mod__cdata-1]-AC_cs2cool__mod__energy)  - AC_cool2__mod__energy*prof2_199_236_254*ac_transformed_pencil_rho*(AC_cs2mz__mod__energy[AC_n__mod__cdata-1]-AC_cs2cool2__mod__energy)
}
else if(AC_cooltype_int__mod__energy == AC_cooltype_int_plain__mod__energy) {
heat_236_254=heat_236_254-AC_cool__mod__energy*prof_199_236_254
}
else {
}
zbot_203_236_254=AC_xyz0__mod__cdata.z
ztop_203_236_254=AC_xyz0__mod__cdata.z+AC_lxyz__mod__cdata.z
if (AC_luminosity__mod__energy!=0.0) {
if (AC_nygrid__mod__cparam==1) {
prof_203_236_254 = exp(-0.5*((AC_z__mod__cdata[AC_n__mod__cdata-1]-zbot_203_236_254)/AC_wheat__mod__energy)*((AC_z__mod__cdata[AC_n__mod__cdata-1]-zbot_203_236_254)/AC_wheat__mod__energy))/(sqrt(AC_pi__mod__cparam/2.)*AC_wheat__mod__energy*AC_lx__mod__cdata)
}
else {
prof_203_236_254 = exp(-0.5*((AC_z__mod__cdata[AC_n__mod__cdata-1]-zbot_203_236_254)/AC_wheat__mod__energy)*((AC_z__mod__cdata[AC_n__mod__cdata-1]-zbot_203_236_254)/AC_wheat__mod__energy))/(sqrt(AC_pi__mod__cparam/2.)*AC_wheat__mod__energy*AC_lx__mod__cdata*AC_ly__mod__cdata)
}
heat_236_254 = AC_luminosity__mod__energy*prof_203_236_254
if ((AC_ttransient__mod__cdata>0)  &&  (AC_t__mod__cdata<AC_ttransient__mod__cdata)) {
heat_236_254 = heat_236_254 * AC_t__mod__cdata*(2*AC_ttransient__mod__cdata-AC_t__mod__cdata)/AC_ttransient__mod__cdata*AC_ttransient__mod__cdata
}
}
if(AC_cooling_profile_int__mod__energy == AC_cooling_profile_int_gaussian__mod__energy) {
prof_203_236_254 = exp(-0.5*((ztop_203_236_254-AC_z__mod__cdata[AC_n__mod__cdata-1])/AC_wcool__mod__energy)*((ztop_203_236_254-AC_z__mod__cdata[AC_n__mod__cdata-1])/AC_wcool__mod__energy))
}
else if(AC_cooling_profile_int__mod__energy == AC_cooling_profile_int_step__mod__energy) {
step_scalar_return_value_200_203_236_254 = 0.5*(1+tanh((AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_z2__mod__gravity)/AC_wcool__mod__energy))
prof_203_236_254 = step_scalar_return_value_200_203_236_254
}
else if(AC_cooling_profile_int__mod__energy == AC_cooling_profile_int_step2__mod__energy) {
step_scalar_return_value_201_203_236_254 = 0.5*(1+tanh((AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_zcool__mod__energy)/AC_wcool__mod__energy))
prof_203_236_254 = step_scalar_return_value_201_203_236_254
}
else if(AC_cooling_profile_int__mod__energy == AC_cooling_profile_int_cubic_step__mod__energy) {
if (false) {
}
else {
relshift_202_203_236_254=0.0
}
xi_202_203_236_254 = (AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_z2__mod__gravity)/(AC_wcool__mod__energy+AC_tini__mod__cparam) - relshift_202_203_236_254
xi_202_203_236_254 = max(xi_202_203_236_254,-1.0)
xi_202_203_236_254 = min(xi_202_203_236_254, 1.0)
cubic_step_pt_return_value_202_203_236_254 = 0.5 + xi_202_203_236_254*(0.75-xi_202_203_236_254*xi_202_203_236_254*0.25)
prof_203_236_254 = cubic_step_pt_return_value_202_203_236_254
}
else if(AC_cooling_profile_int__mod__energy == AC_cooling_profile_int_surfcool__mod__energy) {
prof_203_236_254 = 1+tanh((AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_zcool__mod__energy)/(AC_wcool__mod__energy))
heat_236_254 = heat_236_254 - AC_cool__mod__energy*prof_203_236_254
}
else if(AC_cooling_profile_int__mod__energy == AC_cooling_profile_int_volheat_surfcool__mod__energy) {
prof_203_236_254 = 1+tanh((AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_zcool__mod__energy)/(AC_wcool__mod__energy))
heat_236_254 = heat_236_254 + AC_cool__mod__energy*prof_203_236_254
prof_203_236_254 = (1-(tanh((AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_zcool1__mod__energy)/(AC_wcool1__mod__energy)))*(tanh((AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_zcool1__mod__energy)/(AC_wcool1__mod__energy))))
heat_236_254 = heat_236_254 + AC_cool1__mod__energy*prof_203_236_254
}
else if(AC_cooling_profile_int__mod__energy == AC_cooling_profile_int_lin_z__mod__energy) {
prof_203_236_254=AC_z__mod__cdata[AC_n__mod__cdata-1]/AC_wcool__mod__energy
}
else {
}
if (AC_lcalc_cs2mz_mean__mod__energy  && ! AC_lheat_cool_gravz__mod__energy) {
heat_236_254 = heat_236_254 - AC_cool__mod__energy*prof_203_236_254*(AC_cs2mz__mod__energy[AC_n__mod__cdata-1]-AC_cs2cool__mod__energy)/AC_cs2cool__mod__energy
}
else {
heat_236_254 = heat_236_254 - AC_cool__mod__energy*prof_203_236_254*(ac_transformed_pencil_cs2-AC_cs2cool__mod__energy)/AC_cs2cool__mod__energy
}
if(AC_heattype_int__mod__energy == AC_heattype_int_gaussian__mod__energy) {
if (AC_nzgrid__mod__cparam == 1) {
prof_210_236_254 = exp(-0.5*(ac_transformed_pencil_r_mn/AC_wheat__mod__energy)*(ac_transformed_pencil_r_mn/AC_wheat__mod__energy)) * pow((2*AC_pi__mod__cparam*AC_wheat__mod__energy*AC_wheat__mod__energy),(-1.))
}
else {
prof_210_236_254 = exp(-0.5*(ac_transformed_pencil_r_mn/AC_wheat__mod__energy)*(ac_transformed_pencil_r_mn/AC_wheat__mod__energy)) * pow((2*AC_pi__mod__cparam*AC_wheat__mod__energy*AC_wheat__mod__energy),(-1.5))
}
heat_236_254 = AC_luminosity__mod__energy*prof_210_236_254
div_heat_210_236_254 = AC_luminosity__mod__energy*prof_210_236_254
}
else if(AC_heattype_int__mod__energy == AC_heattype_int_cs2_rho__mod__energy) {
prof_210_236_254 = pow((ac_transformed_pencil_rho/AC_rho0__mod__equationofstate),AC_nheat_rho__mod__energy)*pow((ac_transformed_pencil_cs2/AC_cs20__mod__equationofstate),AC_nheat_tt__mod__energy)
heat_236_254 = AC_luminosity__mod__energy*prof_210_236_254
div_heat_210_236_254 = AC_luminosity__mod__energy*prof_210_236_254
}
else {
}
if (AC_lcylindrical_coords__mod__cdata) {
step_vector_return_value_204_210_236_254 = 0.5*(1+tanh((ac_transformed_pencil_rcyl_mn-AC_rcool__mod__energy)/(AC_wcool__mod__energy+AC_tini__mod__cparam)))
prof_210_236_254 = step_vector_return_value_204_210_236_254
}
else {
step_vector_return_value_205_210_236_254 = 0.5*(1+tanh((ac_transformed_pencil_r_mn-AC_rcool__mod__energy)/(AC_wcool__mod__energy+AC_tini__mod__cparam)))
prof_210_236_254 = step_vector_return_value_205_210_236_254
}
if(AC_cooltype_int__mod__energy == AC_cooltype_int_cs2__mod__energy || AC_cooltype_int__mod__energy == AC_cooltype_int_temp__mod__energy) {
heat_236_254 = heat_236_254 - AC_cool__mod__energy*prof_210_236_254*(ac_transformed_pencil_cs2-AC_cs2cool__mod__energy)/AC_cs2cool__mod__energy
div_cool_210_236_254 = - AC_cool__mod__energy*prof_210_236_254*(ac_transformed_pencil_cs2-AC_cs2cool__mod__energy)/AC_cs2cool__mod__energy
}
else if(AC_cooltype_int__mod__energy == AC_cooltype_int_cs2_rho__mod__energy || AC_cooltype_int__mod__energy == AC_cooltype_int_temp_rho__mod__energy) {
heat_236_254 = heat_236_254 - AC_cool__mod__energy*prof_210_236_254*(ac_transformed_pencil_cs2-AC_cs2cool__mod__energy)/AC_cs2cool__mod__energy/ac_transformed_pencil_rho1
div_cool_210_236_254 = - AC_cool__mod__energy*prof_210_236_254*(ac_transformed_pencil_cs2-AC_cs2cool__mod__energy)/AC_cs2cool__mod__energy/ac_transformed_pencil_rho1
}
else if(AC_cooltype_int__mod__energy == AC_cooltype_int_entropy__mod__energy) {
heat_236_254 = heat_236_254 - AC_cool__mod__energy*prof_210_236_254*(ac_transformed_pencil_ss-0.)
div_cool_210_236_254 = - AC_cool__mod__energy*prof_210_236_254*(ac_transformed_pencil_ss-0.)
}
else if(AC_cooltype_int__mod__energy == AC_cooltype_int_pressure__mod__energy) {
prof_210_236_254= 0.5*(1.-tanh((ac_transformed_pencil_pp-AC_ppcool__mod__energy)/AC_wpres__mod__energy))
heat_236_254 = heat_236_254 - AC_cool__mod__energy*prof_210_236_254*(ac_transformed_pencil_cs2-AC_cs2cool__mod__energy)/AC_cs2cool__mod__energy/ac_transformed_pencil_rho1
div_cool_210_236_254 = - AC_cool__mod__energy*prof_210_236_254*(ac_transformed_pencil_cs2-AC_cs2cool__mod__energy)/AC_cs2cool__mod__energy/ac_transformed_pencil_rho1
}
else if(AC_cooltype_int__mod__energy == AC_cooltype_int_shell__mod__energy) {
if (AC_deltat_poleq__mod__energy!=0.) {
theta_profile_210_236_254=(AC_onethird__mod__cparam-(ac_transformed_pencil_rcyl_mn/ac_transformed_pencil_z_mn)*(ac_transformed_pencil_rcyl_mn/ac_transformed_pencil_z_mn))*AC_deltat_poleq__mod__energy
step_vector_return_value_206_210_236_254 = 0.5*(1+tanh((ac_transformed_pencil_r_mn-AC_r_ext__mod__cdata)/(AC_wcool__mod__energy+AC_tini__mod__cparam)))
prof_210_236_254 = step_vector_return_value_206_210_236_254
heat_236_254 = heat_236_254 - AC_cool_ext__mod__energy*prof_210_236_254*(ac_transformed_pencil_cs2-AC_cs2_ext__mod__energy)/AC_cs2_ext__mod__energy*theta_profile_210_236_254
div_cool_210_236_254 = - AC_cool_ext__mod__energy*prof_210_236_254*(ac_transformed_pencil_cs2-AC_cs2_ext__mod__energy)/AC_cs2_ext__mod__energy*theta_profile_210_236_254
step_vector_return_value_207_210_236_254 = 0.5*(1+tanh((ac_transformed_pencil_r_mn-AC_r_int__mod__cdata)/(AC_wcool__mod__energy+AC_tini__mod__cparam)))
prof_210_236_254 = 1. - step_vector_return_value_207_210_236_254
heat_236_254 = heat_236_254 - AC_cool_int__mod__energy*prof_210_236_254*(ac_transformed_pencil_cs2-AC_cs2_int__mod__energy)/AC_cs2_int__mod__energy*theta_profile_210_236_254
div_cool_210_236_254 = div_cool_210_236_254 - AC_cool_int__mod__energy*prof_210_236_254*(ac_transformed_pencil_cs2-AC_cs2_int__mod__energy)/AC_cs2_int__mod__energy*theta_profile_210_236_254
}
else {
step_vector_return_value_208_210_236_254 = 0.5*(1+tanh((ac_transformed_pencil_r_mn-AC_r_ext__mod__cdata)/(AC_wcool__mod__energy+AC_tini__mod__cparam)))
prof_210_236_254 = step_vector_return_value_208_210_236_254
heat_236_254 = heat_236_254 - AC_cool_ext__mod__energy*prof_210_236_254*(ac_transformed_pencil_cs2-AC_cs2_ext__mod__energy)/AC_cs2_ext__mod__energy
div_cool_210_236_254 = - AC_cool_ext__mod__energy*prof_210_236_254*(ac_transformed_pencil_cs2-AC_cs2_ext__mod__energy)/AC_cs2_ext__mod__energy
step_vector_return_value_209_210_236_254 = 0.5*(1+tanh((ac_transformed_pencil_r_mn-AC_r_int__mod__cdata)/(AC_wcool__mod__energy+AC_tini__mod__cparam)))
prof_210_236_254 = 1. - step_vector_return_value_209_210_236_254
heat_236_254 = heat_236_254 - AC_cool_int__mod__energy*prof_210_236_254*(ac_transformed_pencil_cs2-AC_cs2_int__mod__energy)/AC_cs2_int__mod__energy
div_cool_210_236_254 = div_cool_210_236_254 - AC_cool_int__mod__energy*prof_210_236_254*(ac_transformed_pencil_cs2-AC_cs2_int__mod__energy)/AC_cs2_int__mod__energy
}
}
else {
}
if (AC_nzgrid__mod__cparam==1) {
prof_227_236_254 = exp(-0.5*(AC_x__mod__cdata[vertexIdx.x]/AC_wheat__mod__energy)*(AC_x__mod__cdata[vertexIdx.x]/AC_wheat__mod__energy)) * pow((2*AC_pi__mod__cparam*AC_wheat__mod__energy*AC_wheat__mod__energy),(-1.))
}
else {
prof_227_236_254 = exp(-0.5*(AC_x__mod__cdata[vertexIdx.x]/AC_wheat__mod__energy)*(AC_x__mod__cdata[vertexIdx.x]/AC_wheat__mod__energy)) * pow((2*AC_pi__mod__cparam*AC_wheat__mod__energy*AC_wheat__mod__energy),(-1.5))
}
heat_236_254 = AC_luminosity__mod__energy*prof_227_236_254
if(AC_cooltype_int__mod__energy == AC_cooltype_int_shell__mod__energy) {
step_vector_return_value_211_227_236_254 = 0.5*(1+tanh((AC_x__mod__cdata[vertexIdx.x]-AC_rcool__mod__energy)/(AC_wcool__mod__energy+AC_tini__mod__cparam)))
prof_227_236_254 = step_vector_return_value_211_227_236_254
heat_236_254 = heat_236_254 - AC_cool__mod__energy*prof_227_236_254*(ac_transformed_pencil_cs2-AC_cs2cool__mod__energy)/AC_cs2cool__mod__energy
}
else if(AC_cooltype_int__mod__energy == AC_cooltype_int_shell2__mod__energy) {
step_vector_return_value_212_227_236_254 = 0.5*(1+tanh((AC_x__mod__cdata[vertexIdx.x]-AC_rcool2__mod__energy)/(AC_wcool2__mod__energy+AC_tini__mod__cparam)))
prof2_227_236_254= step_vector_return_value_212_227_236_254
step_vector_return_value_213_227_236_254 = 0.5*(1+tanh((AC_x__mod__cdata[vertexIdx.x]-AC_rcool__mod__energy)/(AC_wcool__mod__energy+AC_tini__mod__cparam)))
prof_227_236_254 = step_vector_return_value_213_227_236_254-prof2_227_236_254
heat_236_254 = heat_236_254 - AC_cool__mod__energy*prof_227_236_254*(ac_transformed_pencil_cs2-AC_cs2cool__mod__energy)/AC_cs2cool__mod__energy-AC_cool2__mod__energy*prof2_227_236_254*(ac_transformed_pencil_cs2-AC_cs2cool2__mod__energy)/AC_cs2cool2__mod__energy
}
else if(AC_cooltype_int__mod__energy == AC_cooltype_int_shell3__mod__energy) {
step_vector_return_value_214_227_236_254 = 0.5*(1+tanh((AC_x__mod__cdata[vertexIdx.x]-AC_rcool__mod__energy)/(AC_wcool__mod__energy+AC_tini__mod__cparam)))
prof_227_236_254 = step_vector_return_value_214_227_236_254
step_vector_return_value_215_227_236_254 = 0.5*(1+tanh((AC_x__mod__cdata[vertexIdx.x]-AC_rcool2__mod__energy)/(AC_wcool2__mod__energy+AC_tini__mod__cparam)))
prof2_227_236_254 = AC_cs2cool__mod__energy + abs(AC_cs2cool2__mod__energy-AC_cs2cool__mod__energy)*step_vector_return_value_215_227_236_254
heat_236_254 = heat_236_254 - AC_cool__mod__energy*prof_227_236_254*(ac_transformed_pencil_cs2-prof2_227_236_254)/prof2_227_236_254
}
else if(AC_cooltype_int__mod__energy == AC_cooltype_int_shell_mean_yz__mod__energy) {
step_vector_return_value_216_227_236_254 = 0.5*(1+tanh((AC_x__mod__cdata[vertexIdx.x]-AC_rcool__mod__energy)/(AC_wcool__mod__energy+AC_tini__mod__cparam)))
prof_227_236_254 = step_vector_return_value_216_227_236_254
if (AC_lcalc_cs2mean__mod__energy) {
heat_236_254 = heat_236_254 - AC_cool__mod__energy*prof_227_236_254*(AC_cs2mx__mod__energy[vertexIdx.x-NGHOST_VAL]-AC_cs2cool_x__mod__energy[vertexIdx.x-NGHOST_VAL])
}
else {
heat_236_254 = heat_236_254 - AC_cool__mod__energy*prof_227_236_254*(ac_transformed_pencil_cs2-AC_cs2cool_x__mod__energy[vertexIdx.x-NGHOST_VAL])
}
}
else if(AC_cooltype_int__mod__energy == AC_cooltype_int_shell_mean_yz2__mod__energy) {
step_vector_return_value_217_227_236_254 = 0.5*(1+tanh((AC_x__mod__cdata[vertexIdx.x]-AC_rcool__mod__energy)/(AC_wcool__mod__energy+AC_tini__mod__cparam)))
prof_227_236_254 = step_vector_return_value_217_227_236_254
cs2_tmp_227_236_254=ac_transformed_pencil_cs2-AC_cs2cool_x__mod__energy[vertexIdx.x-NGHOST_VAL]
if (cs2_tmp_227_236_254 < 0.) {
cs2_tmp_227_236_254=0.
}
heat_236_254 = heat_236_254 - AC_cool__mod__energy*prof_227_236_254*(ac_transformed_pencil_cs2-AC_cs2cool_x__mod__energy[vertexIdx.x-NGHOST_VAL])
}
else if(AC_cooltype_int__mod__energy == AC_cooltype_int_shell_mean_downflow__mod__energy) {
step_vector_return_value_218_227_236_254 = 0.5*(1+tanh((AC_x__mod__cdata[vertexIdx.x]-AC_rcool__mod__energy)/(AC_wcool__mod__energy+AC_tini__mod__cparam)))
prof_227_236_254 = step_vector_return_value_218_227_236_254
cs2_tmp_227_236_254=ac_transformed_pencil_cs2-AC_cs2cool_x__mod__energy[vertexIdx.x-NGHOST_VAL]
if (ac_transformed_pencil_uu.x > 0.) {
fac_tmp_227_236_254=0.
}
else {
fac_tmp_227_236_254=1.
}
heat_236_254 = heat_236_254 - AC_cool__mod__energy*prof_227_236_254*fac_tmp_227_236_254*(ac_transformed_pencil_cs2-AC_downflow_cs2cool_fac__mod__energy*AC_cs2cool_x__mod__energy[vertexIdx.x-NGHOST_VAL])
}
else if(AC_cooltype_int__mod__energy == AC_cooltype_int_latheat__mod__energy) {
step_vector_return_value_219_227_236_254 = 0.5*(1+tanh((AC_x__mod__cdata[vertexIdx.x]-AC_rcool1__mod__energy)/(AC_wcool__mod__energy+AC_tini__mod__cparam)))
step_vector_return_value_220_227_236_254 = 0.5*(1+tanh((AC_x__mod__cdata[vertexIdx.x]-AC_rcool2__mod__energy)/(AC_wcool__mod__energy+AC_tini__mod__cparam)))
prof_227_236_254 = step_vector_return_value_219_227_236_254-step_vector_return_value_220_227_236_254
prof1_227_236_254= 1.+AC_deltat__mod__energy*cos(2.*AC_pi__mod__cparam*(AC_y__mod__cdata[AC_m__mod__cdata-1]-AC_y0__mod__cdata)/AC_ly__mod__cdata)
heat_236_254 = heat_236_254 - AC_cool__mod__energy*prof_227_236_254*(AC_cs2mxy__mod__energy[vertexIdx.x][vertexIdx.y]-prof1_227_236_254*AC_cs2mx__mod__energy[vertexIdx.x-NGHOST_VAL])
}
else if(AC_cooltype_int__mod__energy == AC_cooltype_int_shell_plus_latheat__mod__energy) {
step_vector_return_value_221_227_236_254 = 0.5*(1+tanh((AC_x__mod__cdata[vertexIdx.x]-AC_rcool1__mod__energy)/(AC_wcool__mod__energy+AC_tini__mod__cparam)))
step_vector_return_value_222_227_236_254 = 0.5*(1+tanh((AC_x__mod__cdata[vertexIdx.x]-AC_rcool2__mod__energy)/(AC_wcool__mod__energy+AC_tini__mod__cparam)))
prof_227_236_254 = step_vector_return_value_221_227_236_254-step_vector_return_value_222_227_236_254
prof1_227_236_254= 1.+AC_deltat__mod__energy*cos(2.*AC_pi__mod__cparam*(AC_y__mod__cdata[AC_m__mod__cdata-1]-AC_y0__mod__cdata)/AC_ly__mod__cdata)
heat_236_254 = heat_236_254 - AC_cool__mod__energy*prof_227_236_254*(AC_cs2mxy__mod__energy[vertexIdx.x][vertexIdx.y]-prof1_227_236_254*AC_cs2mx__mod__energy[vertexIdx.x-NGHOST_VAL])
step_vector_return_value_223_227_236_254 = 0.5*(1+tanh((AC_x__mod__cdata[vertexIdx.x]-AC_rcool__mod__energy)/(AC_wcool__mod__energy+AC_tini__mod__cparam)))
prof2_227_236_254= step_vector_return_value_223_227_236_254
heat_236_254 = heat_236_254 - AC_cool__mod__energy*prof2_227_236_254*(ac_transformed_pencil_cs2-AC_cs2cool__mod__energy)/AC_cs2cool__mod__energy
}
else if(AC_cooltype_int__mod__energy == AC_cooltype_int_shell_plus_latss__mod__energy) {
step_vector_return_value_224_227_236_254 = 0.5*(1+tanh((AC_x__mod__cdata[vertexIdx.x]-AC_rcool1__mod__energy)/(AC_wcool__mod__energy+AC_tini__mod__cparam)))
step_vector_return_value_225_227_236_254 = 0.5*(1+tanh((AC_x__mod__cdata[vertexIdx.x]-AC_rcool2__mod__energy)/(AC_wcool__mod__energy+AC_tini__mod__cparam)))
prof_227_236_254 = step_vector_return_value_224_227_236_254-step_vector_return_value_225_227_236_254
prof1_227_236_254= 1.+AC_deltat__mod__energy*cos(2.*AC_pi__mod__cparam*(AC_y__mod__cdata[AC_m__mod__cdata-1]-AC_y0__mod__cdata)/AC_ly__mod__cdata)
heat_236_254 = heat_236_254 - AC_cool__mod__energy*prof_227_236_254*(AC_ssmxy__mod__energy[vertexIdx.x][vertexIdx.y]-prof1_227_236_254*AC_ssmx__mod__energy[vertexIdx.x+NGHOST_VAL])
step_vector_return_value_226_227_236_254 = 0.5*(1+tanh((AC_x__mod__cdata[vertexIdx.x]-AC_rcool__mod__energy)/(AC_wcool__mod__energy+AC_tini__mod__cparam)))
prof2_227_236_254= step_vector_return_value_226_227_236_254
heat_236_254 = heat_236_254 - AC_cool__mod__energy*prof2_227_236_254*(ac_transformed_pencil_cs2-AC_cs2cool__mod__energy)/AC_cs2cool__mod__energy
}
else {
}
if (AC_nzgrid__mod__cparam == 1) {
prof_229_236_254 = exp(-0.5*(AC_x__mod__cdata[vertexIdx.x]/AC_wheat__mod__energy)*(AC_x__mod__cdata[vertexIdx.x]/AC_wheat__mod__energy)) * pow((2*AC_pi__mod__cparam*AC_wheat__mod__energy*AC_wheat__mod__energy),(-1.))
}
else {
prof_229_236_254 = exp(-0.5*(AC_x__mod__cdata[vertexIdx.x]/AC_wheat__mod__energy)*(AC_x__mod__cdata[vertexIdx.x]/AC_wheat__mod__energy)) * pow((2*AC_pi__mod__cparam*AC_wheat__mod__energy*AC_wheat__mod__energy),(-1.5))
}
heat_236_254 = AC_luminosity__mod__energy*prof_229_236_254
if(AC_cooltype_int__mod__energy == AC_cooltype_int_top_layer__mod__energy) {
step_vector_return_value_228_229_236_254 = 0.5*(1+tanh((AC_x__mod__cdata[vertexIdx.x]-AC_rcool__mod__energy)/(AC_wcool__mod__energy+AC_tini__mod__cparam)))
prof_229_236_254 = step_vector_return_value_228_229_236_254
heat_236_254 = heat_236_254 - AC_cool__mod__energy*prof_229_236_254*(ac_transformed_pencil_cs2-AC_cs2cool__mod__energy)/AC_cs2cool__mod__energy
}
else {
}
if (AC_heat_gaussianz__mod__energy!=0.0) {
heat_236_254=heat_236_254+AC_heat_gaussianz__mod__energy*exp(-0.5*AC_z__mod__cdata[AC_n__mod__cdata-1]*AC_z__mod__cdata[AC_n__mod__cdata-1]/AC_heat_gaussianz_sigma__mod__energy*AC_heat_gaussianz_sigma__mod__energy)/(sqrt(2*AC_pi__mod__cparam)*AC_heat_gaussianz_sigma__mod__energy)
}
if (AC_heat_gaussianblob__mod__energy!=0.0) {
tmp_236_254 =  (AC_x__mod__cdata[vertexIdx.x]-AC_heat_gaussianblob_r0__mod__energy.x)*(AC_x__mod__cdata[vertexIdx.x]-AC_heat_gaussianblob_r0__mod__energy.x) + (AC_y__mod__cdata[AC_m__mod__cdata-1]-AC_heat_gaussianblob_r0__mod__energy.y)*(AC_y__mod__cdata[AC_m__mod__cdata-1]-AC_heat_gaussianblob_r0__mod__energy.y)  + (AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_heat_gaussianblob_r0__mod__energy.z)*(AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_heat_gaussianblob_r0__mod__energy.z)
heat_236_254=heat_236_254+AC_heat_gaussianblob__mod__energy*exp(-0.5*tmp_236_254/AC_heat_gaussianblob_sigma__mod__energy*AC_heat_gaussianblob_sigma__mod__energy)/  (sqrt(2*AC_pi__mod__cparam)*AC_heat_gaussianblob_sigma__mod__energy)*(sqrt(2*AC_pi__mod__cparam)*AC_heat_gaussianblob_sigma__mod__energy)*(sqrt(2*AC_pi__mod__cparam)*AC_heat_gaussianblob_sigma__mod__energy)
}
if (AC_heat_uniform__mod__energy!=0.0) {
if (AC_zheat_uniform_range__mod__energy!=0.) {
if (abs(AC_z__mod__cdata[AC_n__mod__cdata-1]) <= AC_zheat_uniform_range__mod__energy) {
heat_236_254=heat_236_254+AC_heat_uniform__mod__energy
}
}
else {
heat_236_254=heat_236_254+AC_heat_uniform__mod__energy
}
}
if (AC_cool_uniform__mod__energy!=0.0) {
heat_236_254=heat_236_254-AC_cool_uniform__mod__energy*ac_transformed_pencil_rho*ac_transformed_pencil_cp*ac_transformed_pencil_tt
}
if (AC_cool_newton__mod__energy!=0.0) {
if (AC_lchromospheric_cooling__mod__energy) {
rgas_236_254=(1.0-AC_gamma1__mod__energy)/AC_cp1__mod__energy
xi_236_254=(AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_z_cor__mod__energy)/(AC_xyz1__mod__cdata.z-AC_z_cor__mod__energy)
profile_buffer_236_254=xi_236_254*xi_236_254*(3-2*xi_236_254)
tt_drive_236_254=(AC_cs0__mod__equationofstate*AC_cs0__mod__equationofstate*(exp(ac_transformed_pencil_cv1*ac_transformed_pencil_initss + AC_gamma_m1__mod__energy*(ac_transformed_pencil_initlnrho-AC_lnrho0__mod__equationofstate))))/(AC_gamma__mod__energy*rgas_236_254)
if (AC_z__mod__cdata[AC_n__mod__cdata-1]>-1.0) {
heat_236_254=heat_236_254-AC_cool_newton__mod__energy*ac_transformed_pencil_cp*ac_transformed_pencil_rho*profile_buffer_236_254*(ac_transformed_pencil_tt-tt_drive_236_254)
}
}
else {
heat_236_254=heat_236_254-AC_cool_newton__mod__energy*ac_transformed_pencil_tt*ac_transformed_pencil_tt*ac_transformed_pencil_tt*ac_transformed_pencil_tt
}
}
if (AC_tau_cool__mod__energy!=0.0) {
if (!AC_ltau_cool_variable__mod__energy) {
if (AC_lphotoelectric_heating__mod__energy) {
tt_drive_236_254=AC_ttref_cool__mod__energy*ac_transformed_pencil_rhop
}
else {
tt_drive_236_254=AC_ttref_cool__mod__energy
}
if(tt_drive_236_254 < AC_tt_floor__mod__energy) {
tt_drive_236_254=AC_tt_floor__mod__energy
}
heat_236_254=heat_236_254-ac_transformed_pencil_rho*ac_transformed_pencil_cv*(ac_transformed_pencil_tt-tt_drive_236_254)/AC_tau_cool__mod__energy
}
else {
rr1_234_236_254=ac_transformed_pencil_rcyl_mn1
oo_234_236_254=pow(rr1_234_236_254,1.5)
if (AC_lphotoelectric_heating__mod__energy) {
tt_drive_234_236_254=AC_ttref_cool__mod__energy*pow(rr1_234_236_254,AC_tt_powerlaw__mod__energy)*ac_transformed_pencil_rhop*AC_rho01__mod__energy
}
else {
tt_drive_234_236_254=AC_ttref_cool__mod__energy*pow(rr1_234_236_254,AC_tt_powerlaw__mod__energy)
}
if(tt_drive_234_236_254 < AC_tt_floor__mod__energy) {
tt_drive_234_236_254=AC_tt_floor__mod__energy
}
if (AC_lborder_heat_variable__mod__energy) {
if (true) {
relshift_232_234_236_254=1.
}
else {
relshift_232_234_236_254=0.0
}
xi_232_234_236_254 = (AC_x__mod__cdata[vertexIdx.x]-AC_r_int__mod__cdata)/(AC_widthss__mod__energy+AC_tini__mod__cparam) - relshift_232_234_236_254
xi_232_234_236_254 = max(xi_232_234_236_254,-1.0)
xi_232_234_236_254 = min(xi_232_234_236_254, 1.0)
quintic_step_mn_return_value_232_234_236_254 = 0.5 + xi_232_234_236_254*(0.9375 + xi_232_234_236_254*xi_232_234_236_254*(-0.625 + xi_232_234_236_254*xi_232_234_236_254*0.1875))
if (true) {
relshift_233_234_236_254=-1.
}
else {
relshift_233_234_236_254=0.0
}
xi_233_234_236_254 = (AC_x__mod__cdata[vertexIdx.x]-AC_r_ext__mod__cdata)/(AC_widthss__mod__energy+AC_tini__mod__cparam) - relshift_233_234_236_254
xi_233_234_236_254 = max(xi_233_234_236_254,-1.0)
xi_233_234_236_254 = min(xi_233_234_236_254, 1.0)
quintic_step_mn_return_value_233_234_236_254 = 0.5 + xi_233_234_236_254*(0.9375 + xi_233_234_236_254*xi_233_234_236_254*(-0.625 + xi_233_234_236_254*xi_233_234_236_254*0.1875))
pborder_234_236_254=quintic_step_mn_return_value_232_234_236_254 -  quintic_step_mn_return_value_233_234_236_254
}
else {
pborder_234_236_254=1.
}
heat_236_254=heat_236_254-ac_transformed_pencil_rho*ac_transformed_pencil_cv*(ac_transformed_pencil_tt-tt_drive_234_236_254)*AC_tau1_cool__mod__energy*oo_234_236_254*pborder_234_236_254
}
}
if (AC_lphotoelectric_heating_radius__mod__energy) {
if (AC_lcylindrical_coords__mod__cdata  &&  AC_nzgrid__mod__cparam==1) {
heat_236_254=heat_236_254+AC_peh_factor__mod__energy*ac_transformed_pencil_peh*AC_dx_1__mod__cdata[vertexIdx.x]*AC_dy_1__mod__cdata[AC_m__mod__cdata-1]/ac_transformed_pencil_r_mn
}
}
if (AC_tau_cool2__mod__energy!=0.0) {
if (AC_lcalc_cs2mz_mean__mod__energy) {
heat_236_254=heat_236_254-ac_transformed_pencil_rho*(AC_cs2mz__mod__energy[AC_n__mod__cdata-1]-AC_cs2cool__mod__energy)/AC_tau_cool2__mod__energy
}
else {
heat_236_254=heat_236_254-ac_transformed_pencil_rho*(ac_transformed_pencil_cs2-AC_cs2cool__mod__energy)/AC_tau_cool2__mod__energy
}
}
ztop_235_236_254=AC_xyz0__mod__cdata.z+AC_lxyz__mod__cdata.z
if (AC_z__mod__cdata[AC_n__mod__cdata-1]>=AC_z_cor__mod__energy) {
xi_235_236_254=(AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_z_cor__mod__energy)/(ztop_235_236_254-AC_z_cor__mod__energy)
profile_cor_235_236_254=xi_235_236_254*xi_235_236_254*(3-2*xi_235_236_254)
if (AC_lcalc_cs2mz_mean__mod__energy) {
heat_236_254=heat_236_254+profile_cor_235_236_254*(AC_tt_cor__mod__energy-AC_cs2mz__mod__energy[AC_n__mod__cdata-1]/AC_gamma_m1__mod__energy*ac_transformed_pencil_cp1)/(ac_transformed_pencil_rho1*AC_tau_cor__mod__energy*ac_transformed_pencil_cp1)
}
else {
heat_236_254=heat_236_254+profile_cor_235_236_254*(AC_tt_cor__mod__energy-1/ac_transformed_pencil_tt1)/(ac_transformed_pencil_rho1*AC_tau_cor__mod__energy*ac_transformed_pencil_cp1)
}
}
if (AC_tauheat_buffer__mod__energy!=0.) {
profile_buffer_236_254=0.5*(1.+tanh(AC_dheat_buffer1__mod__energy*(AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_zheat_buffer__mod__energy)))
heat_236_254=heat_236_254+profile_buffer_236_254*ac_transformed_pencil_ss*(AC_ttheat_buffer__mod__energy-1/ac_transformed_pencil_tt1)/(ac_transformed_pencil_rho1*AC_tauheat_buffer__mod__energy)
}
if (AC_limpose_heat_ceiling__mod__energy) {
if(heat_236_254>AC_heat_ceiling__mod__energy) {
heat_236_254=AC_heat_ceiling__mod__energy
}
}
DF_SS = DF_SS + ac_transformed_pencil_tt1*ac_transformed_pencil_rho1*heat_236_254
if (AC_ldt__mod__cdata) {
if (AC_lfirst__mod__cdata) {
hmax__mod__energy=hmax__mod__energy+heat_236_254*ac_transformed_pencil_rho1
}
}
else {
if (AC_ldiagnos__mod__cdata) {
hmax__mod__energy=hmax__mod__energy+heat_236_254*ac_transformed_pencil_rho1
}
}
if (AC_tau_cool_ss__mod__energy!=0.) {
if (AC_lcalc_ss_volaverage__mod__energy) {
DF_SS=DF_SS-(AC_ss_volaverage__mod__energy-AC_ss_const__mod__energy)/AC_tau_cool_ss__mod__energy
}
else if (AC_lcooling_ss_mz__mod__cdata) {
DF_SS=DF_SS-(ac_transformed_pencil_ss-AC_ss_mz__mod__energy[AC_n__mod__cdata-1])/AC_tau_cool_ss__mod__energy
}
else {
DF_SS=DF_SS-(ac_transformed_pencil_ss-AC_ss_const__mod__energy)/AC_tau_cool_ss__mod__energy
}
}
if (AC_tau_relax_ss__mod__energy!=0.) {
prof_236_254=exp(-0.5*(AC_x__mod__cdata[vertexIdx.x]/AC_radius_ss_x__mod__energy[1-1])*(AC_x__mod__cdata[vertexIdx.x]/AC_radius_ss_x__mod__energy[1-1]))
if (AC_lcalc_ssmean__mod__energy) {
DF_SS=DF_SS-(AC_ssmz__mod__energy[AC_n__mod__cdata-1]-AC_ss_const__mod__energy-AC_ampl_imp_ss__mod__energy*prof_236_254)/AC_tau_relax_ss__mod__energy
}
else {
DF_SS=DF_SS-(ac_transformed_pencil_ss-AC_ss_const__mod__energy-AC_ampl_imp_ss__mod__energy*prof_236_254)*prof_236_254/AC_tau_relax_ss__mod__energy
}
}
if (AC_z__mod__cdata[AC_n__mod__cdata-1] < AC_prof_z__mod__energy[1-1] ) {
lnttor_237_254 = AC_prof_lnt__mod__energy[1-1]
}
else if (AC_z__mod__cdata[AC_n__mod__cdata-1] >= AC_prof_z__mod__energy[AC_prof_nz__mod__energy-1]) {
lnttor_237_254 = AC_prof_lnt__mod__energy[AC_prof_nz__mod__energy-1]
}
else {
i_237_254 = AC_index_on_profile__mod__energy
lnttor_237_254 = (AC_prof_lnt__mod__energy[i_237_254-1]*(AC_prof_z__mod__energy[1+i_237_254-1] - AC_z__mod__cdata[AC_n__mod__cdata-1]) +  AC_prof_lnt__mod__energy[1+i_237_254-1]*(AC_z__mod__cdata[AC_n__mod__cdata-1] - AC_prof_z__mod__energy[i_237_254-1]) ) / (AC_prof_z__mod__energy[1+i_237_254-1]-AC_prof_z__mod__energy[i_237_254-1])
}
if (AC_dt__mod__cdata!=0.0)  {
newton_237_254 = AC_tdown__mod__energy/AC_gamma__mod__energy/AC_dt__mod__cdata*((lnttor_237_254 - ac_transformed_pencil_lntt) )
newton_237_254 = newton_237_254 * exp(AC_allp__mod__energy*(-abs(ac_transformed_pencil_lnrho-AC_lnrho0__mod__equationofstate)))
DF_SS = DF_SS + newton_237_254
}
unit_lnq_238_254=3*log(AC_unit_velocity__mod__cdata)+5*log(AC_unit_length__mod__cdata)+log(AC_unit_density__mod__cdata)
if (AC_unit_system_int__mod__cdata == AC_unit_system_int_cgs__mod__cdata) {
unit_lnq_238_254 = unit_lnq_238_254+log(1.e13)
}
lntt_si_238_254 = ac_transformed_pencil_lntt + log(AC_unit_temperature__mod__cdata)
lnneni_238_254 = 2*ac_transformed_pencil_lnrho + log(1.2) - 2*log(1.4*AC_m_p__mod__cdata)
rtv_cool_238_254=0.
if(AC_cool_type__mod__energy == 1) {
imax_238_254 = 10
lnq_238_254=0.0
for i_238_254 in 1:imax_238_254-1+1 {
lnq_238_254=lnq_238_254 + (lnh_1_238_254[i_238_254-1] + b_1_238_254[i_238_254-1]*lntt_si_238_254)*(( intlnt_1_238_254[i_238_254-1] <= lntt_si_238_254  ||  i_238_254==1 )  &&  lntt_si_238_254 < intlnt_1_238_254[1+i_238_254-1] )
}
lnq_238_254 = lnq_238_254 + (lnh_1_238_254[imax_238_254-1-1] + b_1_238_254[imax_238_254-1-1]*intlnt_1_238_254[imax_238_254-1])*(lntt_si_238_254 >= intlnt_1_238_254[imax_238_254-1] )
if (AC_pres_cutoff__mod__energy!=AC_impossible__mod__cparam) {
rtv_cool_238_254=exp(lnneni_238_254+lnq_238_254-unit_lnq_238_254-ac_transformed_pencil_lntt-ac_transformed_pencil_lnrho)*exp(-ac_transformed_pencil_rho*ac_transformed_pencil_cs2*AC_gamma1__mod__energy/AC_pres_cutoff__mod__energy)
}
else {
rtv_cool_238_254=exp(lnneni_238_254+lnq_238_254-unit_lnq_238_254-ac_transformed_pencil_lntt-ac_transformed_pencil_lnrho)
}
}
else if(AC_cool_type__mod__energy == 2) {
imax_238_254 = 7
lnq_238_254=0.0
for i_238_254 in 1:imax_238_254-1+1 {
lnq_238_254=lnq_238_254 + lnh_2_238_254[i_238_254-1] + b_2_238_254[i_238_254-1]*lntt_si_238_254*(( intlnt_2_238_254[i_238_254-1] <= lntt_si_238_254  ||  i_238_254==1 )  &&  lntt_si_238_254 < intlnt_2_238_254[1+i_238_254-1] )
}
lnq_238_254 = lnq_238_254 + lnh_2_238_254[imax_238_254-1-1] + b_2_238_254[imax_238_254-1-1]*intlnt_2_238_254[imax_238_254-1]*(lntt_si_238_254 >= intlnt_2_238_254[imax_238_254-1] )
if (AC_pres_cutoff__mod__energy!=AC_impossible__mod__cparam) {
rtv_cool_238_254=exp(lnneni_238_254+lnq_238_254-unit_lnq_238_254-ac_transformed_pencil_lntt-ac_transformed_pencil_lnrho)*exp(-ac_transformed_pencil_rho*ac_transformed_pencil_cs2*AC_gamma1__mod__energy/AC_pres_cutoff__mod__energy)
}
else {
rtv_cool_238_254=exp(lnneni_238_254+lnq_238_254-unit_lnq_238_254-ac_transformed_pencil_lntt-ac_transformed_pencil_lnrho)
}
}
else if(AC_cool_type__mod__energy == 3) {
}
else {
rtv_cool_238_254=0.
}
rtv_cool_238_254=rtv_cool_238_254 * AC_cool_rtv__mod__energy
DF_SS = DF_SS-rtv_cool_238_254
if (AC_ldensity_nolog__mod__cdata) {
if (AC_lreference_state__mod__cdata) {
if(AC_irho_ss__mod__equationofstate == AC_ilnrho_ss__mod__equationofstate || AC_irho_ss__mod__equationofstate == AC_irho_ss__mod__equationofstate) {
if (AC_lstratz__mod__cdata) {
}
else if (AC_irho_ss__mod__equationofstate == AC_ilnrho_ss__mod__equationofstate) {
lnrho__239_242_254 = value(F_RHO)+AC_reference_state__mod__density[vertexIdx.x][AC_iref_rho__mod__cparam-1]
}
else {
lnrho__239_242_254 = log(value(F_RHO)+AC_reference_state__mod__density[vertexIdx.x][AC_iref_rho__mod__cparam-1])
}
if (AC_pretend_lntt__mod__cdata) {
lntt__239_242_254=value(F_SS)+AC_reference_state__mod__density[vertexIdx.x][AC_iref_s__mod__cparam-1]
}
else {
ss__239_242_254=value(F_SS)+AC_reference_state__mod__density[vertexIdx.x][AC_iref_s__mod__cparam-1]
lntt__239_242_254=AC_lntt0__mod__equationofstate+AC_cv1__mod__equationofstate*ss__239_242_254+AC_gamma_m1__mod__equationofstate*(lnrho__239_242_254-AC_lnrho0__mod__equationofstate)
}
ee__239_242_254=AC_cv__mod__equationofstate*exp(lntt__239_242_254)
if (true) {
pp__239_242_254=(AC_cp__mod__equationofstate-AC_cv__mod__equationofstate)*exp(lntt__239_242_254+lnrho__239_242_254)
}
cs2__239_242_254=AC_cs20__mod__equationofstate*AC_cv1__mod__equationofstate*ee__239_242_254
}
else if(AC_irho_ss__mod__equationofstate == AC_ilnrho_ee__mod__equationofstate || AC_irho_ss__mod__equationofstate == AC_irho_ee__mod__equationofstate) {
ee__239_242_254=value(F_SS)+AC_reference_state__mod__density[vertexIdx.x][AC_iref_s__mod__cparam-1]
if (AC_irho_ss__mod__equationofstate==AC_ilnrho_ee__mod__equationofstate) {
lnrho__239_242_254=value(F_RHO)+AC_reference_state__mod__density[vertexIdx.x][AC_iref_rho__mod__cparam-1]
pp__239_242_254=AC_gamma_m1__mod__equationofstate*ee__239_242_254*exp(value(F_RHO)+AC_reference_state__mod__density[vertexIdx.x][AC_iref_rho__mod__cparam-1])
}
else {
lnrho__239_242_254=log(value(F_RHO)+AC_reference_state__mod__density[vertexIdx.x][AC_iref_rho__mod__cparam-1])
pp__239_242_254=AC_gamma_m1__mod__equationofstate*ee__239_242_254*value(F_RHO)+AC_reference_state__mod__density[vertexIdx.x][AC_iref_rho__mod__cparam-1]
}
lntt__239_242_254=log(AC_cv1__mod__equationofstate*ee__239_242_254)
}
else if(AC_irho_ss__mod__equationofstate == AC_ilnrho_pp__mod__equationofstate || AC_irho_ss__mod__equationofstate == AC_irho_pp__mod__equationofstate) {
pp__239_242_254=value(F_SS)+AC_reference_state__mod__density[vertexIdx.x][AC_iref_s__mod__cparam-1]
if (AC_irho_ss__mod__equationofstate==AC_ilnrho_pp__mod__equationofstate) {
lnrho__239_242_254=value(F_RHO)+AC_reference_state__mod__density[vertexIdx.x][AC_iref_rho__mod__cparam-1]
ee__239_242_254=pp__239_242_254*exp(-lnrho__239_242_254)/AC_gamma_m1__mod__equationofstate
}
else {
lnrho__239_242_254=log(value(F_RHO)+AC_reference_state__mod__density[vertexIdx.x][AC_iref_rho__mod__cparam-1])
ee__239_242_254=pp__239_242_254/value(F_RHO)+AC_reference_state__mod__density[vertexIdx.x][AC_iref_rho__mod__cparam-1]/AC_gamma_m1__mod__equationofstate
}
}
else if(AC_irho_ss__mod__equationofstate == AC_ilnrho_lntt__mod__equationofstate) {
lnrho__239_242_254=value(F_RHO)+AC_reference_state__mod__density[vertexIdx.x][AC_iref_rho__mod__cparam-1]
lntt__239_242_254=value(F_SS)+AC_reference_state__mod__density[vertexIdx.x][AC_iref_s__mod__cparam-1]
ee__239_242_254=AC_cv__mod__equationofstate*exp(lntt__239_242_254)
if (true) {
pp__239_242_254=ee__239_242_254*exp(lnrho__239_242_254)*AC_gamma_m1__mod__equationofstate
}
}
else if(AC_irho_ss__mod__equationofstate == AC_ilnrho_tt__mod__equationofstate) {
lnrho__239_242_254=value(F_RHO)+AC_reference_state__mod__density[vertexIdx.x][AC_iref_rho__mod__cparam-1]
tt__239_242_254=value(F_SS)+AC_reference_state__mod__density[vertexIdx.x][AC_iref_s__mod__cparam-1]
ee__239_242_254=AC_cv__mod__equationofstate*tt__239_242_254
if (true) {
pp__239_242_254=ee__239_242_254*exp(lnrho__239_242_254)*AC_gamma_m1__mod__equationofstate
}
}
else if(AC_irho_ss__mod__equationofstate == AC_irho_tt__mod__equationofstate) {
lnrho__239_242_254=log(value(F_RHO)+AC_reference_state__mod__density[vertexIdx.x][AC_iref_rho__mod__cparam-1])
tt__239_242_254=value(F_SS)+AC_reference_state__mod__density[vertexIdx.x][AC_iref_s__mod__cparam-1]
ee__239_242_254=AC_cv__mod__equationofstate*tt__239_242_254
if (true) {
pp__239_242_254=ee__239_242_254*value(F_RHO)+AC_reference_state__mod__density[vertexIdx.x][AC_iref_rho__mod__cparam-1]*AC_gamma_m1__mod__equationofstate
}
}
else if(AC_irho_ss__mod__equationofstate == AC_ipp_ss__mod__equationofstate) {
pp__239_242_254=value(F_RHO)+AC_reference_state__mod__density[vertexIdx.x][AC_iref_rho__mod__cparam-1]
if (AC_pretend_lntt__mod__cdata) {
lntt__239_242_254=value(F_SS)+AC_reference_state__mod__density[vertexIdx.x][AC_iref_s__mod__cparam-1]
lnrho__239_242_254=log(pp__239_242_254)-lntt__239_242_254-log(AC_gamma_m1__mod__equationofstate*AC_cv__mod__equationofstate)
ee__239_242_254=AC_cv__mod__equationofstate*exp(lntt__239_242_254)
}
else {
ss__239_242_254=value(F_SS)+AC_reference_state__mod__density[vertexIdx.x][AC_iref_s__mod__cparam-1]
lnrho__239_242_254=log(pp__239_242_254)/AC_gamma__mod__equationofstate-ss__239_242_254/AC_cp__mod__equationofstate
tt__239_242_254=pp__239_242_254/(AC_gamma_m1__mod__equationofstate*AC_cv__mod__equationofstate*exp(lnrho__239_242_254))
}
}
else if(AC_irho_ss__mod__equationofstate == AC_irho_eth__mod__equationofstate || AC_irho_ss__mod__equationofstate == AC_ilnrho_eth__mod__equationofstate) {
if (AC_lstratz__mod__cdata) {
}
else {
if (AC_ldensity_nolog__mod__cdata) {
rho_239_242_254 = value(F_RHO)+AC_reference_state__mod__density[vertexIdx.x][AC_iref_rho__mod__cparam-1]
}
else {
rho_239_242_254 = exp(value(F_RHO)+AC_reference_state__mod__density[vertexIdx.x][AC_iref_rho__mod__cparam-1])
}
eth_239_242_254 = value(F_SS)+AC_reference_state__mod__density[vertexIdx.x][AC_iref_s__mod__cparam-1]
}
if (true) {
pp__239_242_254 = AC_gamma_m1__mod__equationofstate * eth_239_242_254
}
}
else {
}
if (true) {
pp_242_254=pp__239_242_254
}
}
else {
if(AC_irho_ss__mod__equationofstate == AC_ilnrho_ss__mod__equationofstate || AC_irho_ss__mod__equationofstate == AC_irho_ss__mod__equationofstate) {
if (AC_lstratz__mod__cdata) {
}
else if (AC_irho_ss__mod__equationofstate == AC_ilnrho_ss__mod__equationofstate) {
lnrho__240_242_254 = value(F_RHO)
}
else {
lnrho__240_242_254 = log(value(F_RHO))
}
if (AC_pretend_lntt__mod__cdata) {
lntt__240_242_254=value(F_SS)
}
else {
ss__240_242_254=value(F_SS)
lntt__240_242_254=AC_lntt0__mod__equationofstate+AC_cv1__mod__equationofstate*ss__240_242_254+AC_gamma_m1__mod__equationofstate*(lnrho__240_242_254-AC_lnrho0__mod__equationofstate)
}
ee__240_242_254=AC_cv__mod__equationofstate*exp(lntt__240_242_254)
if (true) {
pp__240_242_254=(AC_cp__mod__equationofstate-AC_cv__mod__equationofstate)*exp(lntt__240_242_254+lnrho__240_242_254)
}
cs2__240_242_254=AC_cs20__mod__equationofstate*AC_cv1__mod__equationofstate*ee__240_242_254
}
else if(AC_irho_ss__mod__equationofstate == AC_ilnrho_ee__mod__equationofstate || AC_irho_ss__mod__equationofstate == AC_irho_ee__mod__equationofstate) {
ee__240_242_254=value(F_SS)
if (AC_irho_ss__mod__equationofstate==AC_ilnrho_ee__mod__equationofstate) {
lnrho__240_242_254=value(F_RHO)
pp__240_242_254=AC_gamma_m1__mod__equationofstate*ee__240_242_254*exp(value(F_RHO))
}
else {
lnrho__240_242_254=log(value(F_RHO))
pp__240_242_254=AC_gamma_m1__mod__equationofstate*ee__240_242_254*value(F_RHO)
}
lntt__240_242_254=log(AC_cv1__mod__equationofstate*ee__240_242_254)
}
else if(AC_irho_ss__mod__equationofstate == AC_ilnrho_pp__mod__equationofstate || AC_irho_ss__mod__equationofstate == AC_irho_pp__mod__equationofstate) {
pp__240_242_254=value(F_SS)
if (AC_irho_ss__mod__equationofstate==AC_ilnrho_pp__mod__equationofstate) {
lnrho__240_242_254=value(F_RHO)
ee__240_242_254=pp__240_242_254*exp(-lnrho__240_242_254)/AC_gamma_m1__mod__equationofstate
}
else {
lnrho__240_242_254=log(value(F_RHO))
ee__240_242_254=pp__240_242_254/value(F_RHO)/AC_gamma_m1__mod__equationofstate
}
}
else if(AC_irho_ss__mod__equationofstate == AC_ilnrho_lntt__mod__equationofstate) {
lnrho__240_242_254=value(F_RHO)
lntt__240_242_254=value(F_SS)
ee__240_242_254=AC_cv__mod__equationofstate*exp(lntt__240_242_254)
if (true) {
pp__240_242_254=ee__240_242_254*exp(lnrho__240_242_254)*AC_gamma_m1__mod__equationofstate
}
}
else if(AC_irho_ss__mod__equationofstate == AC_ilnrho_tt__mod__equationofstate) {
lnrho__240_242_254=value(F_RHO)
tt__240_242_254=value(F_SS)
ee__240_242_254=AC_cv__mod__equationofstate*tt__240_242_254
if (true) {
pp__240_242_254=ee__240_242_254*exp(lnrho__240_242_254)*AC_gamma_m1__mod__equationofstate
}
}
else if(AC_irho_ss__mod__equationofstate == AC_irho_tt__mod__equationofstate) {
lnrho__240_242_254=log(value(F_RHO))
tt__240_242_254=value(F_SS)
ee__240_242_254=AC_cv__mod__equationofstate*tt__240_242_254
if (true) {
pp__240_242_254=ee__240_242_254*value(F_RHO)*AC_gamma_m1__mod__equationofstate
}
}
else if(AC_irho_ss__mod__equationofstate == AC_ipp_ss__mod__equationofstate) {
pp__240_242_254=value(F_RHO)
if (AC_pretend_lntt__mod__cdata) {
lntt__240_242_254=value(F_SS)
lnrho__240_242_254=log(pp__240_242_254)-lntt__240_242_254-log(AC_gamma_m1__mod__equationofstate*AC_cv__mod__equationofstate)
ee__240_242_254=AC_cv__mod__equationofstate*exp(lntt__240_242_254)
}
else {
ss__240_242_254=value(F_SS)
lnrho__240_242_254=log(pp__240_242_254)/AC_gamma__mod__equationofstate-ss__240_242_254/AC_cp__mod__equationofstate
tt__240_242_254=pp__240_242_254/(AC_gamma_m1__mod__equationofstate*AC_cv__mod__equationofstate*exp(lnrho__240_242_254))
}
}
else if(AC_irho_ss__mod__equationofstate == AC_irho_eth__mod__equationofstate || AC_irho_ss__mod__equationofstate == AC_ilnrho_eth__mod__equationofstate) {
if (AC_lstratz__mod__cdata) {
}
else {
if (AC_ldensity_nolog__mod__cdata) {
rho_240_242_254 = value(F_RHO)
}
else {
rho_240_242_254 = exp(value(F_RHO))
}
eth_240_242_254 = value(F_SS)
}
if (true) {
pp__240_242_254 = AC_gamma_m1__mod__equationofstate * eth_240_242_254
}
}
else {
}
if (true) {
pp_242_254=pp__240_242_254
}
}
}
else {
if(AC_ilnrho_ss__mod__equationofstate == AC_ilnrho_ss__mod__equationofstate || AC_ilnrho_ss__mod__equationofstate == AC_irho_ss__mod__equationofstate) {
if (AC_lstratz__mod__cdata) {
}
else if (AC_ilnrho_ss__mod__equationofstate == AC_ilnrho_ss__mod__equationofstate) {
lnrho__241_242_254 = value(F_LNRHO)
}
else {
lnrho__241_242_254 = log(value(F_LNRHO))
}
if (AC_pretend_lntt__mod__cdata) {
lntt__241_242_254=value(F_SS)
}
else {
ss__241_242_254=value(F_SS)
lntt__241_242_254=AC_lntt0__mod__equationofstate+AC_cv1__mod__equationofstate*ss__241_242_254+AC_gamma_m1__mod__equationofstate*(lnrho__241_242_254-AC_lnrho0__mod__equationofstate)
}
ee__241_242_254=AC_cv__mod__equationofstate*exp(lntt__241_242_254)
if (true) {
pp__241_242_254=(AC_cp__mod__equationofstate-AC_cv__mod__equationofstate)*exp(lntt__241_242_254+lnrho__241_242_254)
}
cs2__241_242_254=AC_cs20__mod__equationofstate*AC_cv1__mod__equationofstate*ee__241_242_254
}
else if(AC_ilnrho_ss__mod__equationofstate == AC_ilnrho_ee__mod__equationofstate || AC_ilnrho_ss__mod__equationofstate == AC_irho_ee__mod__equationofstate) {
ee__241_242_254=value(F_SS)
if (AC_ilnrho_ss__mod__equationofstate==AC_ilnrho_ee__mod__equationofstate) {
lnrho__241_242_254=value(F_LNRHO)
pp__241_242_254=AC_gamma_m1__mod__equationofstate*ee__241_242_254*exp(value(F_LNRHO))
}
else {
lnrho__241_242_254=log(value(F_LNRHO))
pp__241_242_254=AC_gamma_m1__mod__equationofstate*ee__241_242_254*value(F_LNRHO)
}
lntt__241_242_254=log(AC_cv1__mod__equationofstate*ee__241_242_254)
}
else if(AC_ilnrho_ss__mod__equationofstate == AC_ilnrho_pp__mod__equationofstate || AC_ilnrho_ss__mod__equationofstate == AC_irho_pp__mod__equationofstate) {
pp__241_242_254=value(F_SS)
if (AC_ilnrho_ss__mod__equationofstate==AC_ilnrho_pp__mod__equationofstate) {
lnrho__241_242_254=value(F_LNRHO)
ee__241_242_254=pp__241_242_254*exp(-lnrho__241_242_254)/AC_gamma_m1__mod__equationofstate
}
else {
lnrho__241_242_254=log(value(F_LNRHO))
ee__241_242_254=pp__241_242_254/value(F_LNRHO)/AC_gamma_m1__mod__equationofstate
}
}
else if(AC_ilnrho_ss__mod__equationofstate == AC_ilnrho_lntt__mod__equationofstate) {
lnrho__241_242_254=value(F_LNRHO)
lntt__241_242_254=value(F_SS)
ee__241_242_254=AC_cv__mod__equationofstate*exp(lntt__241_242_254)
if (true) {
pp__241_242_254=ee__241_242_254*exp(lnrho__241_242_254)*AC_gamma_m1__mod__equationofstate
}
}
else if(AC_ilnrho_ss__mod__equationofstate == AC_ilnrho_tt__mod__equationofstate) {
lnrho__241_242_254=value(F_LNRHO)
tt__241_242_254=value(F_SS)
ee__241_242_254=AC_cv__mod__equationofstate*tt__241_242_254
if (true) {
pp__241_242_254=ee__241_242_254*exp(lnrho__241_242_254)*AC_gamma_m1__mod__equationofstate
}
}
else if(AC_ilnrho_ss__mod__equationofstate == AC_irho_tt__mod__equationofstate) {
lnrho__241_242_254=log(value(F_LNRHO))
tt__241_242_254=value(F_SS)
ee__241_242_254=AC_cv__mod__equationofstate*tt__241_242_254
if (true) {
pp__241_242_254=ee__241_242_254*value(F_LNRHO)*AC_gamma_m1__mod__equationofstate
}
}
else if(AC_ilnrho_ss__mod__equationofstate == AC_ipp_ss__mod__equationofstate) {
pp__241_242_254=value(F_LNRHO)
if (AC_pretend_lntt__mod__cdata) {
lntt__241_242_254=value(F_SS)
lnrho__241_242_254=log(pp__241_242_254)-lntt__241_242_254-log(AC_gamma_m1__mod__equationofstate*AC_cv__mod__equationofstate)
ee__241_242_254=AC_cv__mod__equationofstate*exp(lntt__241_242_254)
}
else {
ss__241_242_254=value(F_SS)
lnrho__241_242_254=log(pp__241_242_254)/AC_gamma__mod__equationofstate-ss__241_242_254/AC_cp__mod__equationofstate
tt__241_242_254=pp__241_242_254/(AC_gamma_m1__mod__equationofstate*AC_cv__mod__equationofstate*exp(lnrho__241_242_254))
}
}
else if(AC_ilnrho_ss__mod__equationofstate == AC_irho_eth__mod__equationofstate || AC_ilnrho_ss__mod__equationofstate == AC_ilnrho_eth__mod__equationofstate) {
if (AC_lstratz__mod__cdata) {
}
else {
if (AC_ldensity_nolog__mod__cdata) {
rho_241_242_254 = value(F_LNRHO)
}
else {
rho_241_242_254 = exp(value(F_LNRHO))
}
eth_241_242_254 = value(F_SS)
}
if (true) {
pp__241_242_254 = AC_gamma_m1__mod__equationofstate * eth_241_242_254
}
}
else {
}
if (true) {
pp_242_254=pp__241_242_254
}
}
DF_SS = DF_SS + 0.5*pp_242_254*ac_transformed_pencil_divu
if (AC_z__mod__cdata[AC_n__mod__cdata-1]>AC_zgrav__mod__gravity) {
scl_244_254=1./AC_tau_ss_exterior__mod__energy
DF_SS=DF_SS-scl_244_254*ac_transformed_pencil_ss
}
if(AC_borderss_int__mod__energy == AC_borderss_int_zero__mod__energy) {
f_target_253_254=0.0
}
else if(AC_borderss_int__mod__energy == AC_borderss_int_constant__mod__energy) {
f_target_253_254=AC_ss_const__mod__energy
}
else if(AC_borderss_int__mod__energy == AC_borderss_int_initial_condition__mod__energy) {
}
else if(AC_borderss_int__mod__energy == AC_borderss_int_initial_temperature__mod__energy) {
if (AC_ldensity_nolog__mod__cdata) {
lnrho_init_253_254 = log(rho_init_253_254)
}
else {
}
f_target_253_254 = ss_init_253_254 - AC_gamma_m1__mod__energy*AC_cv__mod__energy*(ac_transformed_pencil_lnrho-lnrho_init_253_254)
}
else if(AC_borderss_int__mod__energy == AC_borderss_int_nothing__mod__energy) {
}
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
if (AC_lhydro__mod__cparam && AC_ldensity__mod__cparam) {
advec_cs2__mod__cdata=ac_transformed_pencil_advec_cs2
}
if (AC_lthdiff_hmax__mod__energy || AC_idiag_dth__mod__energy!=0) {
if (AC_lthdiff_hmax__mod__energy) {
ssmax__mod__energy=max(ssmax__mod__energy,abs(DF_SS)*ac_transformed_pencil_cv1)
dt1_max__mod__cdata=max(dt1_max__mod__cdata,ssmax__mod__energy/AC_cdts__mod__cdata)
}
else if (AC_lrhs_max__mod__energy) {
dt1_max__mod__cdata=max(dt1_max__mod__cdata,abs(hmax__mod__energy/ac_transformed_pencil_ee/AC_cdts__mod__cdata))
}
}
else if (AC_ldiagnos__mod__cdata && AC_idiag_tauhmin__mod__energy!=0) {
ssmax__mod__energy=max(ssmax__mod__energy,abs(DF_SS)*ac_transformed_pencil_cv1)
}
}
dadt_304.x = 0.
dadt_304.y = 0.
dadt_304.z = 0.
fmax__mod__magnetic=1./AC_impossible__mod__cparam
damax__mod__magnetic=1./AC_impossible__mod__cparam
ssmax__mod__magnetic=1./AC_impossible__mod__cparam
if (AC_b_ext__mod__magnetic.x != 0.0  ||  AC_b_ext__mod__magnetic.y != 0.0  ||  AC_b_ext__mod__magnetic.z != 0.0) {
if (AC_omega_bz_ext__mod__magnetic != 0.0) {
if (AC_lcartesian_coords__mod__cdata  ||  AC_lbext_curvilinear__mod__magnetic) {
c_265_304 = cos(AC_omega_bz_ext__mod__magnetic * AC_t__mod__cdata)
s_265_304 = sin(AC_omega_bz_ext__mod__magnetic * AC_t__mod__cdata)
b_ext_304.x = AC_b_ext__mod__magnetic.x * c_265_304 - AC_b_ext__mod__magnetic.y * s_265_304
b_ext_304.y = AC_b_ext__mod__magnetic.x * s_265_304 + AC_b_ext__mod__magnetic.y * c_265_304
b_ext_304.z = AC_b_ext__mod__magnetic.z
}
else {
}
}
else if (AC_lbext_moving_layer__mod__magnetic)  {
zposbot_265_304=AC_zbot_moving_layer__mod__magnetic + AC_t__mod__cdata*AC_speed_moving_layer__mod__magnetic
zpostop_265_304=AC_ztop_moving_layer__mod__magnetic + AC_t__mod__cdata*AC_speed_moving_layer__mod__magnetic
step_scalar_return_value_68_265_304 = 0.5*(1+tanh((AC_z__mod__cdata[AC_n__mod__cdata-1]-zposbot_265_304)/AC_edge_moving_layer__mod__magnetic))
step_scalar_return_value_69_265_304 = 0.5*(1+tanh((AC_z__mod__cdata[AC_n__mod__cdata-1]-zpostop_265_304)/AC_edge_moving_layer__mod__magnetic))
zprof_265_304 = step_scalar_return_value_68_265_304-step_scalar_return_value_69_265_304
b_ext_304.x = AC_b_ext__mod__magnetic.x*zprof_265_304
b_ext_304.y = AC_b_ext__mod__magnetic.y*zprof_265_304
b_ext_304.z=AC_b_ext__mod__magnetic.z
if (false) {
arg_70_265_304 = abs((AC_z__mod__cdata[AC_n__mod__cdata-1]-zposbot_265_304)/(AC_edge_moving_layer__mod__magnetic+AC_tini__mod__cparam))
if (abs(arg_70_265_304)>=8.)  {
der_step_return_value_70_265_304 = 2./AC_edge_moving_layer__mod__magnetic*exp(-2.*abs(arg_70_265_304))
}
else {
der_step_return_value_70_265_304 = 0.5/(AC_edge_moving_layer__mod__magnetic*cosh(arg_70_265_304)*cosh(arg_70_265_304))
}
arg_71_265_304 = abs((AC_z__mod__cdata[AC_n__mod__cdata-1]-zpostop_265_304)/(AC_edge_moving_layer__mod__magnetic+AC_tini__mod__cparam))
if (abs(arg_71_265_304)>=8.)  {
der_step_return_value_71_265_304 = 2./AC_edge_moving_layer__mod__magnetic*exp(-2.*abs(arg_71_265_304))
}
else {
der_step_return_value_71_265_304 = 0.5/(AC_edge_moving_layer__mod__magnetic*cosh(arg_71_265_304)*cosh(arg_71_265_304))
}
zder_265_304 = der_step_return_value_70_265_304-der_step_return_value_71_265_304
}
}
else {
if (AC_lcartesian_coords__mod__cdata  ||  AC_lbext_curvilinear__mod__magnetic) {
b_ext_304 = AC_b_ext__mod__magnetic
}
else if (AC_lcylindrical_coords__mod__cdata) {
b_ext_304.x =  AC_b_ext__mod__magnetic.x * cos(AC_y__mod__cdata[AC_m__mod__cdata-1]) + AC_b_ext__mod__magnetic.y * sin(AC_y__mod__cdata[AC_m__mod__cdata-1])
b_ext_304.y = -AC_b_ext__mod__magnetic.x * sin(AC_y__mod__cdata[AC_m__mod__cdata-1]) + AC_b_ext__mod__magnetic.y * cos(AC_y__mod__cdata[AC_m__mod__cdata-1])
b_ext_304.z =  AC_b_ext__mod__magnetic.z
}
else if (AC_lspherical_coords__mod__cdata) {
b_ext_304.x =  AC_b_ext__mod__magnetic.x * AC_sinth__mod__cdata[AC_m__mod__cdata-1] * cos(AC_z__mod__cdata[AC_n__mod__cdata-1]) + AC_b_ext__mod__magnetic.y * AC_sinth__mod__cdata[AC_m__mod__cdata-1] * sin(AC_z__mod__cdata[AC_n__mod__cdata-1]) + AC_b_ext__mod__magnetic.z * AC_costh__mod__cdata[AC_m__mod__cdata-1]
b_ext_304.y =  AC_b_ext__mod__magnetic.x * AC_costh__mod__cdata[AC_m__mod__cdata-1] * cos(AC_z__mod__cdata[AC_n__mod__cdata-1]) + AC_b_ext__mod__magnetic.y * AC_costh__mod__cdata[AC_m__mod__cdata-1] * sin(AC_z__mod__cdata[AC_n__mod__cdata-1]) - AC_b_ext__mod__magnetic.z * AC_sinth__mod__cdata[AC_m__mod__cdata-1]
b_ext_304.z = -AC_b_ext__mod__magnetic.x            * sin(AC_z__mod__cdata[AC_n__mod__cdata-1]) + AC_b_ext__mod__magnetic.y            * cos(AC_z__mod__cdata[AC_n__mod__cdata-1])
}
}
}
else {
b_ext_304.x = 0.
b_ext_304.y = 0.
b_ext_304.z = 0.
}
if (AC_t_bext__mod__magnetic > 0.0  &&  AC_t__mod__cdata < AC_t_bext__mod__magnetic) {
if (AC_t__mod__cdata <= AC_t0_bext__mod__magnetic) {
b_ext_304 = AC_b0_ext__mod__magnetic
}
else {
b_ext_304 = AC_b0_ext__mod__magnetic + 0.5*(1.-cos(AC_pi__mod__cparam*(AC_t__mod__cdata-AC_t0_bext__mod__magnetic)/(AC_t_bext__mod__magnetic-AC_t0_bext__mod__magnetic)))*(b_ext_304-AC_b0_ext__mod__magnetic)
}
}
if (AC_lhydro__mod__cparam) {
if (!AC_lkinematic__mod__magnetic) {
if (AC_llorentzforce__mod__magnetic) {
if (AC_lboris_correction__mod__magnetic) {
DF_UX=DF_UX+ac_transformed_pencil_gamma_a2*ac_transformed_pencil_jxbr.x+ (ac_transformed_pencil_ugu.x+ac_transformed_pencil_rho1gpp.x-ac_transformed_pencil_gg.x)*(1-ac_transformed_pencil_gamma_a2)- AC_mu01__mod__cdata*(ac_transformed_pencil_gamma_a2*ac_transformed_pencil_gamma_a2*ac_transformed_pencil_rho1/ac_transformed_pencil_clight2)*  (ac_transformed_pencil_bb.x*ac_transformed_pencil_bb.x*(ac_transformed_pencil_ugu.x+ac_transformed_pencil_rho1gpp.x-ac_transformed_pencil_gg.x)+ ac_transformed_pencil_bb.x*ac_transformed_pencil_bb.y*(ac_transformed_pencil_ugu.y+ac_transformed_pencil_rho1gpp.y-ac_transformed_pencil_gg.y)+ ac_transformed_pencil_bb.x*ac_transformed_pencil_bb.z*(ac_transformed_pencil_ugu.z+ac_transformed_pencil_rho1gpp.z-ac_transformed_pencil_gg.z))
DF_UY=DF_UY+ac_transformed_pencil_gamma_a2*ac_transformed_pencil_jxbr.y+ (ac_transformed_pencil_ugu.y+ac_transformed_pencil_rho1gpp.y-ac_transformed_pencil_gg.y)*(1-ac_transformed_pencil_gamma_a2)- AC_mu01__mod__cdata*(ac_transformed_pencil_gamma_a2*ac_transformed_pencil_gamma_a2*ac_transformed_pencil_rho1/ac_transformed_pencil_clight2)*  (ac_transformed_pencil_bb.y*ac_transformed_pencil_bb.y*(ac_transformed_pencil_ugu.y+ac_transformed_pencil_rho1gpp.y-ac_transformed_pencil_gg.y)+ ac_transformed_pencil_bb.y*ac_transformed_pencil_bb.x*(ac_transformed_pencil_ugu.x+ac_transformed_pencil_rho1gpp.x-ac_transformed_pencil_gg.x)+ ac_transformed_pencil_bb.y*ac_transformed_pencil_bb.z*(ac_transformed_pencil_ugu.z+ac_transformed_pencil_rho1gpp.z-ac_transformed_pencil_gg.z))
DF_UZ=DF_UZ+ac_transformed_pencil_gamma_a2*ac_transformed_pencil_jxbr.z+ (ac_transformed_pencil_ugu.z+ac_transformed_pencil_rho1gpp.z-ac_transformed_pencil_gg.z)*(1-ac_transformed_pencil_gamma_a2)- AC_mu01__mod__cdata*(ac_transformed_pencil_gamma_a2*ac_transformed_pencil_gamma_a2*ac_transformed_pencil_rho1/ac_transformed_pencil_clight2)*  (ac_transformed_pencil_bb.z*ac_transformed_pencil_bb.z*(ac_transformed_pencil_ugu.z+ac_transformed_pencil_rho1gpp.z-ac_transformed_pencil_gg.z)+ ac_transformed_pencil_bb.z*ac_transformed_pencil_bb.x*(ac_transformed_pencil_ugu.x+ac_transformed_pencil_rho1gpp.x-ac_transformed_pencil_gg.x)+ ac_transformed_pencil_bb.z*ac_transformed_pencil_bb.y*(ac_transformed_pencil_ugu.y+ac_transformed_pencil_rho1gpp.y-ac_transformed_pencil_gg.y))
}
else if (AC_llorentz_rhoref__mod__magnetic) {
DF_UVEC=DF_UVEC+ac_transformed_pencil_jxb*AC_rhoref1__mod__magnetic
}
else {
if (AC_lrelativistic_eos__mod__density) {
tmp1_304 = dot(ac_transformed_pencil_uu,ac_transformed_pencil_jxbr)
DF_LNRHO=DF_LNRHO+tmp1_304
DF_UVEC=DF_UVEC+0.75*ac_transformed_pencil_jxbr
}
else {
if (AC_iphiuu__mod__cdata==0) {
if (AC_lconservative__mod__hydro) {
DF_UVEC=DF_UVEC+ac_transformed_pencil_jxb
}
else {
DF_UVEC=DF_UVEC+ac_transformed_pencil_jxbr
}
}
else {
DF_PHIUU=DF_PHIUU-0.5*(ac_transformed_pencil_b2-AC_b_ext2__mod__magnetic)
}
}
}
}
}
}
if (AC_iex__mod__cdata==0 || AC_loverride_ee__mod__magnetic) {
fres__mod__magnetic.x = 0.
fres__mod__magnetic.y = 0.
fres__mod__magnetic.z = 0.
eta_total__mod__magnetic=0.
diffus_eta2__mod__magnetic=0.
diffus_eta3__mod__magnetic=0.
if (AC_lresi_eta_const__mod__magnetic) {
if (! AC_limplicit_resistivity__mod__magnetic) {
if (AC_lweyl_gauge__mod__magnetic) {
fres__mod__magnetic = fres__mod__magnetic - AC_eta__mod__magnetic * AC_mu0__mod__cdata * ac_transformed_pencil_jj
}
else {
fres__mod__magnetic = fres__mod__magnetic + AC_eta__mod__magnetic * ac_transformed_pencil_del2a
}
if (AC_ladd_efield__mod__magnetic) {
tanhx2_304 = tanh( AC_x__mod__cdata[vertexIdx.x] )*tanh( AC_x__mod__cdata[vertexIdx.x] )
del2aa_ini_304 = AC_ampl_efield__mod__magnetic*(-2 + 8*tanhx2_304 - 6*tanhx2_304*tanhx2_304 )
fres__mod__magnetic.z = fres__mod__magnetic.z - AC_eta__mod__magnetic*AC_mu0__mod__cdata*del2aa_ini_304
}
eta_total__mod__magnetic = eta_total__mod__magnetic + AC_eta__mod__magnetic
}
}
if (AC_lresi_eta_tdep__mod__magnetic) {
if (AC_lresi_eta_ztdep__mod__magnetic) {
if (AC_lweyl_gauge__mod__magnetic) {
fres__mod__magnetic = fres__mod__magnetic                 -AC_eta_tdep__mod__magnetic* AC_feta_ztdep__mod__magnetic[AC_n__mod__cdata-1]    *AC_mu0__mod__cdata*ac_transformed_pencil_jj
}
else {
fres__mod__magnetic = fres__mod__magnetic+AC_eta_tdep__mod__magnetic*ac_transformed_pencil_del2a-AC_eta_tdep__mod__magnetic*(AC_feta_ztdep__mod__magnetic[AC_n__mod__cdata-1]-1.)*AC_mu0__mod__cdata*ac_transformed_pencil_jj
}
}
else {
if (AC_lweyl_gauge__mod__magnetic) {
fres__mod__magnetic = fres__mod__magnetic - AC_eta_tdep__mod__magnetic * AC_mu0__mod__cdata * ac_transformed_pencil_jj
}
else {
fres__mod__magnetic = fres__mod__magnetic + AC_eta_tdep__mod__magnetic * ac_transformed_pencil_del2a
}
}
eta_total__mod__magnetic = eta_total__mod__magnetic + AC_eta_tdep__mod__magnetic
}
if (AC_lresi_zdep__mod__magnetic) {
if (! AC_limplicit_resistivity__mod__magnetic) {
if (AC_lweyl_gauge__mod__magnetic) {
fres__mod__magnetic = fres__mod__magnetic - AC_eta_z__mod__magnetic[AC_n__mod__cdata-1] * AC_mu0__mod__cdata * ac_transformed_pencil_jj
}
else {
fres__mod__magnetic = fres__mod__magnetic + AC_eta_z__mod__magnetic[AC_n__mod__cdata-1] * ac_transformed_pencil_del2a
fres__mod__magnetic.z = fres__mod__magnetic.z + AC_geta_z__mod__magnetic[AC_n__mod__cdata-1] * ac_transformed_pencil_diva
}
eta_total__mod__magnetic = eta_total__mod__magnetic + AC_eta_z__mod__magnetic[AC_n__mod__cdata-1]
}
else {
fres__mod__magnetic.z = fres__mod__magnetic.z + AC_geta_z__mod__magnetic[AC_n__mod__cdata-1] * ac_transformed_pencil_diva
if (AC_lfirst__mod__cdata  &&  AC_ldt__mod__cdata) {
maxadvec__mod__cdata = maxadvec__mod__cdata + abs(AC_geta_z__mod__magnetic[AC_n__mod__cdata-1]) * AC_dz_1__mod__cdata[AC_n__mod__cdata-1]
}
}
}
if (AC_lresi_sqrtrhoeta_const__mod__magnetic) {
if (AC_lweyl_gauge__mod__magnetic) {
fres__mod__magnetic.x=fres__mod__magnetic.x-AC_eta__mod__magnetic*sqrt(ac_transformed_pencil_rho1)*AC_mu0__mod__cdata*ac_transformed_pencil_jj.x
fres__mod__magnetic.y=fres__mod__magnetic.y-AC_eta__mod__magnetic*sqrt(ac_transformed_pencil_rho1)*AC_mu0__mod__cdata*ac_transformed_pencil_jj.y
fres__mod__magnetic.z=fres__mod__magnetic.z-AC_eta__mod__magnetic*sqrt(ac_transformed_pencil_rho1)*AC_mu0__mod__cdata*ac_transformed_pencil_jj.z
}
else {
fres__mod__magnetic.x=fres__mod__magnetic.x+AC_eta__mod__magnetic*sqrt(ac_transformed_pencil_rho1) * (ac_transformed_pencil_del2a.x-0.5*ac_transformed_pencil_diva*ac_transformed_pencil_glnrho.x)
fres__mod__magnetic.y=fres__mod__magnetic.y+AC_eta__mod__magnetic*sqrt(ac_transformed_pencil_rho1) * (ac_transformed_pencil_del2a.y-0.5*ac_transformed_pencil_diva*ac_transformed_pencil_glnrho.y)
fres__mod__magnetic.z=fres__mod__magnetic.z+AC_eta__mod__magnetic*sqrt(ac_transformed_pencil_rho1) * (ac_transformed_pencil_del2a.z-0.5*ac_transformed_pencil_diva*ac_transformed_pencil_glnrho.z)
}
eta_total__mod__magnetic=eta_total__mod__magnetic+AC_eta__mod__magnetic*sqrt(ac_transformed_pencil_rho1)
}
if (AC_lresi_eta_aniso__mod__magnetic) {
cosalp_304=cos(AC_alp_aniso__mod__magnetic*AC_dtor__mod__cparam)
sinalp_304=sin(AC_alp_aniso__mod__magnetic*AC_dtor__mod__cparam)
if (AC_eta1_aniso_r__mod__magnetic==0.) {
prof_304=AC_eta1_aniso__mod__magnetic
}
else {
step_vector_return_value_266_304 = 0.5*(1+tanh((AC_x__mod__cdata[vertexIdx.x]-AC_eta1_aniso_r__mod__magnetic)/(AC_eta1_aniso_d__mod__magnetic+AC_tini__mod__cparam)))
prof_304=AC_eta1_aniso__mod__magnetic*(1.-step_vector_return_value_266_304)
}
if (AC_lquench_eta_aniso__mod__magnetic) {
prof_304=prof_304/(1.+AC_quench_aniso__mod__magnetic*AC_arms__mod__magnetic)
}
fres__mod__magnetic.x=fres__mod__magnetic.x-prof_304*cosalp_304*(cosalp_304*ac_transformed_pencil_jj.x+sinalp_304*ac_transformed_pencil_jj.y)
fres__mod__magnetic.y=fres__mod__magnetic.y-prof_304*sinalp_304*(cosalp_304*ac_transformed_pencil_jj.x+sinalp_304*ac_transformed_pencil_jj.y)
eta_total__mod__magnetic=eta_total__mod__magnetic+abs(AC_eta1_aniso__mod__magnetic)
}
if (AC_lresi_etass__mod__magnetic) {
etass_304=AC_alphassm__mod__magnetic*ac_transformed_pencil_cs2/omegass_304
fres__mod__magnetic.x=fres__mod__magnetic.x-etass_304*ac_transformed_pencil_jj.x
fres__mod__magnetic.y=fres__mod__magnetic.y-etass_304*ac_transformed_pencil_jj.y
fres__mod__magnetic.z=fres__mod__magnetic.z-etass_304*ac_transformed_pencil_jj.z
eta_total__mod__magnetic=eta_total__mod__magnetic+etass_304
}
if (AC_lresi_xydep__mod__magnetic) {
fres__mod__magnetic.x=fres__mod__magnetic.x+AC_eta_xy__mod__magnetic[vertexIdx.x][AC_m__mod__cdata-1]*ac_transformed_pencil_del2a.x+AC_geta_xy__mod__magnetic[vertexIdx.x][AC_m__mod__cdata-1][1-1]*ac_transformed_pencil_diva
fres__mod__magnetic.y=fres__mod__magnetic.y+AC_eta_xy__mod__magnetic[vertexIdx.x][AC_m__mod__cdata-1]*ac_transformed_pencil_del2a.y+AC_geta_xy__mod__magnetic[vertexIdx.x][AC_m__mod__cdata-1][2-1]*ac_transformed_pencil_diva
fres__mod__magnetic.z=fres__mod__magnetic.z+AC_eta_xy__mod__magnetic[vertexIdx.x][AC_m__mod__cdata-1]*ac_transformed_pencil_del2a.z+AC_geta_xy__mod__magnetic[vertexIdx.x][AC_m__mod__cdata-1][3-1]*ac_transformed_pencil_diva
eta_total__mod__magnetic=eta_total__mod__magnetic+AC_eta_xy__mod__magnetic[vertexIdx.x][AC_m__mod__cdata-1]
}
if (AC_lresi_xdep__mod__magnetic) {
if (AC_lweyl_gauge__mod__magnetic) {
fres__mod__magnetic.x = fres__mod__magnetic.x - AC_eta_x__mod__magnetic[vertexIdx.x] * AC_mu0__mod__cdata * ac_transformed_pencil_jj.x
fres__mod__magnetic.y = fres__mod__magnetic.y - AC_eta_x__mod__magnetic[vertexIdx.x] * AC_mu0__mod__cdata * ac_transformed_pencil_jj.y
fres__mod__magnetic.z = fres__mod__magnetic.z - AC_eta_x__mod__magnetic[vertexIdx.x] * AC_mu0__mod__cdata * ac_transformed_pencil_jj.z
}
else {
fres__mod__magnetic.x=fres__mod__magnetic.x+AC_eta_x__mod__magnetic[vertexIdx.x]*ac_transformed_pencil_del2a.x
fres__mod__magnetic.y=fres__mod__magnetic.y+AC_eta_x__mod__magnetic[vertexIdx.x]*ac_transformed_pencil_del2a.y
fres__mod__magnetic.z=fres__mod__magnetic.z+AC_eta_x__mod__magnetic[vertexIdx.x]*ac_transformed_pencil_del2a.z
fres__mod__magnetic.x=fres__mod__magnetic.x+AC_geta_x__mod__magnetic[vertexIdx.x]*ac_transformed_pencil_diva
}
eta_total__mod__magnetic=eta_total__mod__magnetic+AC_eta_x__mod__magnetic[vertexIdx.x]
}
if (AC_lresi_rdep__mod__magnetic) {
if(AC_rdep_profile_int__mod__magnetic == AC_rdep_profile_int_step__mod__magnetic) {
tmp1_277_304=ac_transformed_pencil_r_mn
step_vector_return_value_267_277_304 = 0.5*(1+tanh((tmp1_277_304-AC_eta_r0__mod__magnetic)/(AC_eta_rwidth__mod__magnetic+AC_tini__mod__cparam)))
eta_r__mod__magnetic = AC_eta__mod__magnetic + AC_eta__mod__magnetic*(AC_eta_jump__mod__magnetic-1.)*step_vector_return_value_267_277_304
arg_268_277_304 = abs((tmp1_277_304-AC_eta_r0__mod__magnetic)/(AC_eta_rwidth__mod__magnetic+AC_tini__mod__cparam))
if (abs(arg_268_277_304)>=8.)  {
der_step_return_value_268_277_304 = 2./AC_eta_rwidth__mod__magnetic*exp(-2.*abs(arg_268_277_304))
}
else {
der_step_return_value_268_277_304 = 0.5/(AC_eta_rwidth__mod__magnetic*cosh(arg_268_277_304)*cosh(arg_268_277_304))
}
tmp2_277_304 = AC_eta__mod__magnetic*(AC_eta_jump__mod__magnetic-1.)*der_step_return_value_268_277_304
geta_r__mod__magnetic.x=tmp2_277_304*AC_x__mod__cdata[vertexIdx.x]*ac_transformed_pencil_r_mn1
geta_r__mod__magnetic.y=tmp2_277_304*AC_y__mod__cdata[AC_m__mod__cdata-1]*ac_transformed_pencil_r_mn1
geta_r__mod__magnetic.z=tmp2_277_304*AC_z__mod__cdata[AC_n__mod__cdata-1]*ac_transformed_pencil_r_mn1
}
else if(AC_rdep_profile_int__mod__magnetic == AC_rdep_profile_int_two_step__mod__magnetic) {
step_vector_return_value_269_277_304 = 0.5*(1+tanh((ac_transformed_pencil_r_mn-AC_eta_r0__mod__magnetic)/(AC_eta_rwidth0__mod__magnetic+AC_tini__mod__cparam)))
step_vector_return_value_270_277_304 = 0.5*(1+tanh((ac_transformed_pencil_r_mn-AC_eta_r1__mod__magnetic)/(AC_eta_rwidth1__mod__magnetic+AC_tini__mod__cparam)))
eta_r__mod__magnetic = AC_eta__mod__magnetic + AC_eta__mod__magnetic*(AC_eta_jump__mod__magnetic - 1.)*  (step_vector_return_value_269_277_304 - step_vector_return_value_270_277_304)
arg_271_277_304 = abs((ac_transformed_pencil_r_mn-AC_eta_r0__mod__magnetic)/(AC_eta_rwidth0__mod__magnetic+AC_tini__mod__cparam))
if (abs(arg_271_277_304)>=8.)  {
der_step_return_value_271_277_304 = 2./AC_eta_rwidth0__mod__magnetic*exp(-2.*abs(arg_271_277_304))
}
else {
der_step_return_value_271_277_304 = 0.5/(AC_eta_rwidth0__mod__magnetic*cosh(arg_271_277_304)*cosh(arg_271_277_304))
}
arg_272_277_304 = abs((ac_transformed_pencil_r_mn-AC_eta_r1__mod__magnetic)/(AC_eta_rwidth1__mod__magnetic+AC_tini__mod__cparam))
if (abs(arg_272_277_304)>=8.)  {
der_step_return_value_272_277_304 = 2./AC_eta_rwidth1__mod__magnetic*exp(-2.*abs(arg_272_277_304))
}
else {
der_step_return_value_272_277_304 = 0.5/(AC_eta_rwidth1__mod__magnetic*cosh(arg_272_277_304)*cosh(arg_272_277_304))
}
tmp1_277_304 = AC_eta__mod__magnetic*(AC_eta_jump__mod__magnetic-1.)*(  der_step_return_value_271_277_304 - der_step_return_value_272_277_304)
geta_r__mod__magnetic.x=tmp1_277_304*AC_x__mod__cdata[vertexIdx.x]*ac_transformed_pencil_r_mn1
geta_r__mod__magnetic.y=tmp1_277_304*AC_y__mod__cdata[AC_m__mod__cdata-1]*ac_transformed_pencil_r_mn1
geta_r__mod__magnetic.z=tmp1_277_304*AC_z__mod__cdata[AC_n__mod__cdata-1]*ac_transformed_pencil_r_mn1
}
else if(AC_rdep_profile_int__mod__magnetic == AC_rdep_profile_int_two_step2__mod__magnetic) {
step_vector_return_value_273_277_304 = 0.5*(1+tanh((ac_transformed_pencil_r_mn-AC_eta_r1__mod__magnetic)/(AC_eta_rwidth1__mod__magnetic+AC_tini__mod__cparam)))
prof1_277_304    = step_vector_return_value_273_277_304
step_vector_return_value_274_277_304 = 0.5*(1+tanh((ac_transformed_pencil_r_mn-AC_eta_r0__mod__magnetic)/(AC_eta_rwidth0__mod__magnetic+AC_tini__mod__cparam)))
prof0_277_304    = step_vector_return_value_274_277_304 - prof1_277_304
arg_275_277_304 = abs((ac_transformed_pencil_r_mn-AC_eta_r1__mod__magnetic)/(AC_eta_rwidth1__mod__magnetic+AC_tini__mod__cparam))
if (abs(arg_275_277_304)>=8.)  {
der_step_return_value_275_277_304 = 2./AC_eta_rwidth1__mod__magnetic*exp(-2.*abs(arg_275_277_304))
}
else {
der_step_return_value_275_277_304 = 0.5/(AC_eta_rwidth1__mod__magnetic*cosh(arg_275_277_304)*cosh(arg_275_277_304))
}
derprof1_277_304 = der_step_return_value_275_277_304
arg_276_277_304 = abs((ac_transformed_pencil_r_mn-AC_eta_r0__mod__magnetic)/(AC_eta_rwidth0__mod__magnetic+AC_tini__mod__cparam))
if (abs(arg_276_277_304)>=8.)  {
der_step_return_value_276_277_304 = 2./AC_eta_rwidth0__mod__magnetic*exp(-2.*abs(arg_276_277_304))
}
else {
der_step_return_value_276_277_304 = 0.5/(AC_eta_rwidth0__mod__magnetic*cosh(arg_276_277_304)*cosh(arg_276_277_304))
}
derprof0_277_304 = der_step_return_value_276_277_304 - derprof1_277_304
eta_r__mod__magnetic = AC_eta__mod__magnetic + (AC_eta__mod__magnetic*(AC_eta_jump0__mod__magnetic-1.))*prof0_277_304 + (AC_eta__mod__magnetic*(AC_eta_jump1__mod__magnetic-1.))*prof1_277_304
tmp1_277_304  = AC_eta__mod__magnetic + (AC_eta__mod__magnetic*(AC_eta_jump0__mod__magnetic-1.))*derprof0_277_304 + (AC_eta__mod__magnetic*(AC_eta_jump1__mod__magnetic-1.))*derprof1_277_304
geta_r__mod__magnetic.x=tmp1_277_304*AC_x__mod__cdata[vertexIdx.x]*ac_transformed_pencil_r_mn1
geta_r__mod__magnetic.y=tmp1_277_304*AC_y__mod__cdata[AC_m__mod__cdata-1]*ac_transformed_pencil_r_mn1
geta_r__mod__magnetic.z=tmp1_277_304*AC_z__mod__cdata[AC_n__mod__cdata-1]*ac_transformed_pencil_r_mn1
}
fres__mod__magnetic.x=fres__mod__magnetic.x+eta_r__mod__magnetic*ac_transformed_pencil_del2a.x+geta_r__mod__magnetic.x*ac_transformed_pencil_diva
fres__mod__magnetic.y=fres__mod__magnetic.y+eta_r__mod__magnetic*ac_transformed_pencil_del2a.y+geta_r__mod__magnetic.y*ac_transformed_pencil_diva
fres__mod__magnetic.z=fres__mod__magnetic.z+eta_r__mod__magnetic*ac_transformed_pencil_del2a.z+geta_r__mod__magnetic.z*ac_transformed_pencil_diva
eta_total__mod__magnetic=eta_total__mod__magnetic+eta_r__mod__magnetic
}
if (AC_lresi_ydep__mod__magnetic) {
fres__mod__magnetic.x=fres__mod__magnetic.x+AC_eta_y__mod__magnetic[AC_m__mod__cdata-1]*ac_transformed_pencil_del2a.x
fres__mod__magnetic.y=fres__mod__magnetic.y+AC_eta_y__mod__magnetic[AC_m__mod__cdata-1]*ac_transformed_pencil_del2a.y
fres__mod__magnetic.z=fres__mod__magnetic.z+AC_eta_y__mod__magnetic[AC_m__mod__cdata-1]*ac_transformed_pencil_del2a.z
if (AC_lspherical_coords__mod__cdata) {
fres__mod__magnetic.y=fres__mod__magnetic.y+ac_transformed_pencil_r_mn1*AC_geta_y__mod__magnetic[AC_m__mod__cdata-1]*ac_transformed_pencil_diva
}
else {
fres__mod__magnetic.y=fres__mod__magnetic.y+AC_geta_y__mod__magnetic[AC_m__mod__cdata-1]*ac_transformed_pencil_diva
}
eta_total__mod__magnetic=eta_total__mod__magnetic+AC_eta_y__mod__magnetic[AC_m__mod__cdata-1]
}
if (AC_lresi_hyper2__mod__magnetic) {
fres__mod__magnetic=fres__mod__magnetic+AC_eta_hyper2__mod__magnetic*ac_transformed_pencil_del4a
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
diffus_eta2__mod__magnetic=diffus_eta2__mod__magnetic+AC_eta_hyper2__mod__magnetic
}
}
if (AC_lresi_hyper3__mod__magnetic) {
fres__mod__magnetic=fres__mod__magnetic+AC_eta_hyper3__mod__magnetic*ac_transformed_pencil_del6a
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
diffus_eta3__mod__magnetic=diffus_eta3__mod__magnetic+AC_eta_hyper3__mod__magnetic
}
}
if (AC_lresi_hyper2_tdep__mod__magnetic) {
fres__mod__magnetic=fres__mod__magnetic-AC_eta_tdep__mod__magnetic*ac_transformed_pencil_del4a
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
diffus_eta2__mod__magnetic=diffus_eta2__mod__magnetic+AC_eta_tdep__mod__magnetic
}
}
if (AC_lresi_hyper3_tdep__mod__magnetic) {
fres__mod__magnetic=fres__mod__magnetic+AC_eta_tdep__mod__magnetic*ac_transformed_pencil_del6a
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
diffus_eta3__mod__magnetic=diffus_eta3__mod__magnetic+AC_eta_tdep__mod__magnetic
}
}
if (AC_lresi_hyper3_polar__mod__magnetic) {
ju_304=1+AC_iaa__mod__cdata-1
tmp1_304 = der6x_ignore_spacing(Field(ju_304))
fres__mod__magnetic.x=fres__mod__magnetic.x+AC_eta_hyper3__mod__magnetic*AC_pi4_1__mod__cparam*tmp1_304*dline_1__mod__cdata.x*dline_1__mod__cdata.x
tmp1_304 = der6y_ignore_spacing(Field(ju_304))
fres__mod__magnetic.x=fres__mod__magnetic.x+AC_eta_hyper3__mod__magnetic*AC_pi4_1__mod__cparam*tmp1_304*dline_1__mod__cdata.y*dline_1__mod__cdata.y
tmp1_304 = der6z_ignore_spacing(Field(ju_304))
fres__mod__magnetic.x=fres__mod__magnetic.x+AC_eta_hyper3__mod__magnetic*AC_pi4_1__mod__cparam*tmp1_304*dline_1__mod__cdata.z*dline_1__mod__cdata.z
ju_304=2+AC_iaa__mod__cdata-1
tmp1_304 = der6x_ignore_spacing(Field(ju_304))
fres__mod__magnetic.y=fres__mod__magnetic.y+AC_eta_hyper3__mod__magnetic*AC_pi4_1__mod__cparam*tmp1_304*dline_1__mod__cdata.x*dline_1__mod__cdata.x
tmp1_304 = der6y_ignore_spacing(Field(ju_304))
fres__mod__magnetic.y=fres__mod__magnetic.y+AC_eta_hyper3__mod__magnetic*AC_pi4_1__mod__cparam*tmp1_304*dline_1__mod__cdata.y*dline_1__mod__cdata.y
tmp1_304 = der6z_ignore_spacing(Field(ju_304))
fres__mod__magnetic.y=fres__mod__magnetic.y+AC_eta_hyper3__mod__magnetic*AC_pi4_1__mod__cparam*tmp1_304*dline_1__mod__cdata.z*dline_1__mod__cdata.z
ju_304=3+AC_iaa__mod__cdata-1
tmp1_304 = der6x_ignore_spacing(Field(ju_304))
fres__mod__magnetic.z=fres__mod__magnetic.z+AC_eta_hyper3__mod__magnetic*AC_pi4_1__mod__cparam*tmp1_304*dline_1__mod__cdata.x*dline_1__mod__cdata.x
tmp1_304 = der6y_ignore_spacing(Field(ju_304))
fres__mod__magnetic.z=fres__mod__magnetic.z+AC_eta_hyper3__mod__magnetic*AC_pi4_1__mod__cparam*tmp1_304*dline_1__mod__cdata.y*dline_1__mod__cdata.y
tmp1_304 = der6z_ignore_spacing(Field(ju_304))
fres__mod__magnetic.z=fres__mod__magnetic.z+AC_eta_hyper3__mod__magnetic*AC_pi4_1__mod__cparam*tmp1_304*dline_1__mod__cdata.z*dline_1__mod__cdata.z
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
diffus_eta3__mod__magnetic=diffus_eta3__mod__magnetic+AC_eta_hyper3__mod__magnetic*AC_pi4_1__mod__cparam*dxmin_pencil__mod__cdata*dxmin_pencil__mod__cdata*dxmin_pencil__mod__cdata*dxmin_pencil__mod__cdata
}
}
if (AC_lresi_hyper3_mesh__mod__magnetic) {
ju_304=1+AC_iaa__mod__cdata-1
tmp1_304 = der6x_ignore_spacing(Field(ju_304))
if (AC_ldynamical_diffusion__mod__cdata) {
fres__mod__magnetic.x = fres__mod__magnetic.x + AC_eta_hyper3_mesh__mod__magnetic * tmp1_304 * dline_1__mod__cdata.x
}
else {
fres__mod__magnetic.x = fres__mod__magnetic.x+AC_eta_hyper3_mesh__mod__magnetic*AC_pi5_1__mod__cparam/60.*tmp1_304*dline_1__mod__cdata.x
}
tmp1_304 = der6y_ignore_spacing(Field(ju_304))
if (AC_ldynamical_diffusion__mod__cdata) {
fres__mod__magnetic.x = fres__mod__magnetic.x + AC_eta_hyper3_mesh__mod__magnetic * tmp1_304 * dline_1__mod__cdata.y
}
else {
fres__mod__magnetic.x = fres__mod__magnetic.x+AC_eta_hyper3_mesh__mod__magnetic*AC_pi5_1__mod__cparam/60.*tmp1_304*dline_1__mod__cdata.y
}
tmp1_304 = der6z_ignore_spacing(Field(ju_304))
if (AC_ldynamical_diffusion__mod__cdata) {
fres__mod__magnetic.x = fres__mod__magnetic.x + AC_eta_hyper3_mesh__mod__magnetic * tmp1_304 * dline_1__mod__cdata.z
}
else {
fres__mod__magnetic.x = fres__mod__magnetic.x+AC_eta_hyper3_mesh__mod__magnetic*AC_pi5_1__mod__cparam/60.*tmp1_304*dline_1__mod__cdata.z
}
ju_304=2+AC_iaa__mod__cdata-1
tmp1_304 = der6x_ignore_spacing(Field(ju_304))
if (AC_ldynamical_diffusion__mod__cdata) {
fres__mod__magnetic.y = fres__mod__magnetic.y + AC_eta_hyper3_mesh__mod__magnetic * tmp1_304 * dline_1__mod__cdata.x
}
else {
fres__mod__magnetic.y = fres__mod__magnetic.y+AC_eta_hyper3_mesh__mod__magnetic*AC_pi5_1__mod__cparam/60.*tmp1_304*dline_1__mod__cdata.x
}
tmp1_304 = der6y_ignore_spacing(Field(ju_304))
if (AC_ldynamical_diffusion__mod__cdata) {
fres__mod__magnetic.y = fres__mod__magnetic.y + AC_eta_hyper3_mesh__mod__magnetic * tmp1_304 * dline_1__mod__cdata.y
}
else {
fres__mod__magnetic.y = fres__mod__magnetic.y+AC_eta_hyper3_mesh__mod__magnetic*AC_pi5_1__mod__cparam/60.*tmp1_304*dline_1__mod__cdata.y
}
tmp1_304 = der6z_ignore_spacing(Field(ju_304))
if (AC_ldynamical_diffusion__mod__cdata) {
fres__mod__magnetic.y = fres__mod__magnetic.y + AC_eta_hyper3_mesh__mod__magnetic * tmp1_304 * dline_1__mod__cdata.z
}
else {
fres__mod__magnetic.y = fres__mod__magnetic.y+AC_eta_hyper3_mesh__mod__magnetic*AC_pi5_1__mod__cparam/60.*tmp1_304*dline_1__mod__cdata.z
}
ju_304=3+AC_iaa__mod__cdata-1
tmp1_304 = der6x_ignore_spacing(Field(ju_304))
if (AC_ldynamical_diffusion__mod__cdata) {
fres__mod__magnetic.z = fres__mod__magnetic.z + AC_eta_hyper3_mesh__mod__magnetic * tmp1_304 * dline_1__mod__cdata.x
}
else {
fres__mod__magnetic.z = fres__mod__magnetic.z+AC_eta_hyper3_mesh__mod__magnetic*AC_pi5_1__mod__cparam/60.*tmp1_304*dline_1__mod__cdata.x
}
tmp1_304 = der6y_ignore_spacing(Field(ju_304))
if (AC_ldynamical_diffusion__mod__cdata) {
fres__mod__magnetic.z = fres__mod__magnetic.z + AC_eta_hyper3_mesh__mod__magnetic * tmp1_304 * dline_1__mod__cdata.y
}
else {
fres__mod__magnetic.z = fres__mod__magnetic.z+AC_eta_hyper3_mesh__mod__magnetic*AC_pi5_1__mod__cparam/60.*tmp1_304*dline_1__mod__cdata.y
}
tmp1_304 = der6z_ignore_spacing(Field(ju_304))
if (AC_ldynamical_diffusion__mod__cdata) {
fres__mod__magnetic.z = fres__mod__magnetic.z + AC_eta_hyper3_mesh__mod__magnetic * tmp1_304 * dline_1__mod__cdata.z
}
else {
fres__mod__magnetic.z = fres__mod__magnetic.z+AC_eta_hyper3_mesh__mod__magnetic*AC_pi5_1__mod__cparam/60.*tmp1_304*dline_1__mod__cdata.z
}
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
if (AC_ldynamical_diffusion__mod__cdata) {
diffus_eta3__mod__magnetic = diffus_eta3__mod__magnetic + AC_eta_hyper3_mesh__mod__magnetic
advec_hypermesh_aa_304 = 0.0
}
else {
advec_hypermesh_aa_304=AC_eta_hyper3_mesh__mod__magnetic*AC_pi5_1__mod__cparam*sqrt(dxyz_2__mod__cdata)
}
advec2_hypermesh__mod__cdata=advec2_hypermesh__mod__cdata+advec_hypermesh_aa_304*advec_hypermesh_aa_304
}
}
if (AC_lresi_hyper3_csmesh__mod__magnetic) {
ju_304=1+AC_iaa__mod__cdata-1
tmp1_304 = der6x_ignore_spacing(Field(ju_304))
if (AC_ldynamical_diffusion__mod__cdata) {
fres__mod__magnetic.x=fres__mod__magnetic.x+AC_eta_hyper3_mesh__mod__magnetic*sqrt(ac_transformed_pencil_cs2) * tmp1_304*dline_1__mod__cdata.x
}
else {
fres__mod__magnetic.x=fres__mod__magnetic.x+AC_eta_hyper3_mesh__mod__magnetic*sqrt(ac_transformed_pencil_cs2) * AC_pi5_1__mod__cparam/60.*tmp1_304*dline_1__mod__cdata.x
}
tmp1_304 = der6y_ignore_spacing(Field(ju_304))
if (AC_ldynamical_diffusion__mod__cdata) {
fres__mod__magnetic.x=fres__mod__magnetic.x+AC_eta_hyper3_mesh__mod__magnetic*sqrt(ac_transformed_pencil_cs2) * tmp1_304*dline_1__mod__cdata.y
}
else {
fres__mod__magnetic.x=fres__mod__magnetic.x+AC_eta_hyper3_mesh__mod__magnetic*sqrt(ac_transformed_pencil_cs2) * AC_pi5_1__mod__cparam/60.*tmp1_304*dline_1__mod__cdata.y
}
tmp1_304 = der6z_ignore_spacing(Field(ju_304))
if (AC_ldynamical_diffusion__mod__cdata) {
fres__mod__magnetic.x=fres__mod__magnetic.x+AC_eta_hyper3_mesh__mod__magnetic*sqrt(ac_transformed_pencil_cs2) * tmp1_304*dline_1__mod__cdata.z
}
else {
fres__mod__magnetic.x=fres__mod__magnetic.x+AC_eta_hyper3_mesh__mod__magnetic*sqrt(ac_transformed_pencil_cs2) * AC_pi5_1__mod__cparam/60.*tmp1_304*dline_1__mod__cdata.z
}
ju_304=2+AC_iaa__mod__cdata-1
tmp1_304 = der6x_ignore_spacing(Field(ju_304))
if (AC_ldynamical_diffusion__mod__cdata) {
fres__mod__magnetic.y=fres__mod__magnetic.y+AC_eta_hyper3_mesh__mod__magnetic*sqrt(ac_transformed_pencil_cs2) * tmp1_304*dline_1__mod__cdata.x
}
else {
fres__mod__magnetic.y=fres__mod__magnetic.y+AC_eta_hyper3_mesh__mod__magnetic*sqrt(ac_transformed_pencil_cs2) * AC_pi5_1__mod__cparam/60.*tmp1_304*dline_1__mod__cdata.x
}
tmp1_304 = der6y_ignore_spacing(Field(ju_304))
if (AC_ldynamical_diffusion__mod__cdata) {
fres__mod__magnetic.y=fres__mod__magnetic.y+AC_eta_hyper3_mesh__mod__magnetic*sqrt(ac_transformed_pencil_cs2) * tmp1_304*dline_1__mod__cdata.y
}
else {
fres__mod__magnetic.y=fres__mod__magnetic.y+AC_eta_hyper3_mesh__mod__magnetic*sqrt(ac_transformed_pencil_cs2) * AC_pi5_1__mod__cparam/60.*tmp1_304*dline_1__mod__cdata.y
}
tmp1_304 = der6z_ignore_spacing(Field(ju_304))
if (AC_ldynamical_diffusion__mod__cdata) {
fres__mod__magnetic.y=fres__mod__magnetic.y+AC_eta_hyper3_mesh__mod__magnetic*sqrt(ac_transformed_pencil_cs2) * tmp1_304*dline_1__mod__cdata.z
}
else {
fres__mod__magnetic.y=fres__mod__magnetic.y+AC_eta_hyper3_mesh__mod__magnetic*sqrt(ac_transformed_pencil_cs2) * AC_pi5_1__mod__cparam/60.*tmp1_304*dline_1__mod__cdata.z
}
ju_304=3+AC_iaa__mod__cdata-1
tmp1_304 = der6x_ignore_spacing(Field(ju_304))
if (AC_ldynamical_diffusion__mod__cdata) {
fres__mod__magnetic.z=fres__mod__magnetic.z+AC_eta_hyper3_mesh__mod__magnetic*sqrt(ac_transformed_pencil_cs2) * tmp1_304*dline_1__mod__cdata.x
}
else {
fres__mod__magnetic.z=fres__mod__magnetic.z+AC_eta_hyper3_mesh__mod__magnetic*sqrt(ac_transformed_pencil_cs2) * AC_pi5_1__mod__cparam/60.*tmp1_304*dline_1__mod__cdata.x
}
tmp1_304 = der6y_ignore_spacing(Field(ju_304))
if (AC_ldynamical_diffusion__mod__cdata) {
fres__mod__magnetic.z=fres__mod__magnetic.z+AC_eta_hyper3_mesh__mod__magnetic*sqrt(ac_transformed_pencil_cs2) * tmp1_304*dline_1__mod__cdata.y
}
else {
fres__mod__magnetic.z=fres__mod__magnetic.z+AC_eta_hyper3_mesh__mod__magnetic*sqrt(ac_transformed_pencil_cs2) * AC_pi5_1__mod__cparam/60.*tmp1_304*dline_1__mod__cdata.y
}
tmp1_304 = der6z_ignore_spacing(Field(ju_304))
if (AC_ldynamical_diffusion__mod__cdata) {
fres__mod__magnetic.z=fres__mod__magnetic.z+AC_eta_hyper3_mesh__mod__magnetic*sqrt(ac_transformed_pencil_cs2) * tmp1_304*dline_1__mod__cdata.z
}
else {
fres__mod__magnetic.z=fres__mod__magnetic.z+AC_eta_hyper3_mesh__mod__magnetic*sqrt(ac_transformed_pencil_cs2) * AC_pi5_1__mod__cparam/60.*tmp1_304*dline_1__mod__cdata.z
}
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
if (AC_ldynamical_diffusion__mod__cdata) {
diffus_eta3__mod__magnetic=diffus_eta3__mod__magnetic+AC_eta_hyper3_mesh__mod__magnetic*sqrt(ac_transformed_pencil_cs2)
advec_hypermesh_aa_304=0.0
}
else {
advec_hypermesh_aa_304=AC_eta_hyper3_mesh__mod__magnetic*AC_pi5_1__mod__cparam*sqrt(dxyz_2__mod__cdata*ac_transformed_pencil_cs2)
}
advec2_hypermesh__mod__cdata=advec2_hypermesh__mod__cdata+advec_hypermesh_aa_304*advec_hypermesh_aa_304
}
}
if (AC_lresi_hyper3_strict__mod__magnetic) {
fres__mod__magnetic=fres__mod__magnetic+AC_eta_hyper3__mod__magnetic*value(F_HYPREVEC)
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
diffus_eta3__mod__magnetic=diffus_eta3__mod__magnetic+AC_eta_hyper3__mod__magnetic
}
}
if (AC_lresi_hyper3_aniso__mod__magnetic) {
k1_278_304=AC_iaa__mod__cdata-1
tmp_278_304  = del6fj(Field(k1_278_304+1), AC_eta_aniso_hyper3__mod__magnetic)
tmp2_304.x=tmp_278_304
tmp_278_304  = del6fj(Field(k1_278_304+2), AC_eta_aniso_hyper3__mod__magnetic)
tmp2_304.y=tmp_278_304
tmp_278_304  = del6fj(Field(k1_278_304+3), AC_eta_aniso_hyper3__mod__magnetic)
tmp2_304.z=tmp_278_304
fres__mod__magnetic=fres__mod__magnetic+tmp2_304
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
diffus_eta3__mod__magnetic=diffus_eta3__mod__magnetic +  (AC_eta_aniso_hyper3__mod__magnetic.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x*dline_1__mod__cdata.x +  AC_eta_aniso_hyper3__mod__magnetic.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y*dline_1__mod__cdata.y +  AC_eta_aniso_hyper3__mod__magnetic.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z*dline_1__mod__cdata.z)/dxyz_6__mod__cdata
}
}
if (AC_lresi_shell__mod__magnetic) {
eta_r_287_304=0.
if (AC_eta_int__mod__magnetic > 0.) {
d_int_287_304 = AC_eta_int__mod__magnetic - AC_eta__mod__magnetic
}
else {
d_int_287_304 = 0.
}
if (AC_eta_ext__mod__magnetic > 0.) {
d_ext_287_304 = AC_eta_ext__mod__magnetic - AC_eta__mod__magnetic
}
else {
d_ext_287_304 = 0.
}
if (AC_lcylinder_in_a_box__mod__cdata || AC_lcylindrical_coords__mod__cdata) {
step_vector_return_value_279_287_304 = 0.5*(1+tanh((ac_transformed_pencil_rcyl_mn-AC_r_int__mod__cdata)/(AC_wresistivity__mod__magnetic+AC_tini__mod__cparam)))
prof_287_304=step_vector_return_value_279_287_304
eta_mn_304=d_int_287_304*(1-prof_287_304)
step_vector_return_value_280_287_304 = 0.5*(1+tanh((ac_transformed_pencil_rcyl_mn-AC_r_ext__mod__cdata)/(AC_wresistivity__mod__magnetic+AC_tini__mod__cparam)))
prof_287_304=step_vector_return_value_280_287_304
eta_mn_304=AC_eta__mod__magnetic+eta_mn_304+d_ext_287_304*prof_287_304
arg_281_287_304 = abs((ac_transformed_pencil_rcyl_mn-AC_r_int__mod__cdata)/(AC_wresistivity__mod__magnetic+AC_tini__mod__cparam))
if (abs(arg_281_287_304)>=8.)  {
der_step_return_value_281_287_304 = 2./AC_wresistivity__mod__magnetic*exp(-2.*abs(arg_281_287_304))
}
else {
der_step_return_value_281_287_304 = 0.5/(AC_wresistivity__mod__magnetic*cosh(arg_281_287_304)*cosh(arg_281_287_304))
}
prof_287_304=der_step_return_value_281_287_304
eta_r_287_304=-d_int_287_304*prof_287_304
arg_282_287_304 = abs((ac_transformed_pencil_rcyl_mn-AC_r_ext__mod__cdata)/(AC_wresistivity__mod__magnetic+AC_tini__mod__cparam))
if (abs(arg_282_287_304)>=8.)  {
der_step_return_value_282_287_304 = 2./AC_wresistivity__mod__magnetic*exp(-2.*abs(arg_282_287_304))
}
else {
der_step_return_value_282_287_304 = 0.5/(AC_wresistivity__mod__magnetic*cosh(arg_282_287_304)*cosh(arg_282_287_304))
}
prof_287_304=der_step_return_value_282_287_304
eta_r_287_304=eta_r_287_304+d_ext_287_304*prof_287_304
geta_304.x=ac_transformed_pencil_evr.x*eta_r_287_304
geta_304.y=ac_transformed_pencil_evr.y*eta_r_287_304
geta_304.z=ac_transformed_pencil_evr.z*eta_r_287_304
}
else if (AC_lsphere_in_a_box__mod__cdata || AC_lspherical_coords__mod__cdata) {
step_vector_return_value_283_287_304 = 0.5*(1+tanh((ac_transformed_pencil_r_mn-AC_r_int__mod__cdata)/(AC_wresistivity__mod__magnetic+AC_tini__mod__cparam)))
prof_287_304=step_vector_return_value_283_287_304
eta_mn_304=d_int_287_304*(1-prof_287_304)
step_vector_return_value_284_287_304 = 0.5*(1+tanh((ac_transformed_pencil_r_mn-AC_r_ext__mod__cdata)/(AC_wresistivity__mod__magnetic+AC_tini__mod__cparam)))
prof_287_304=step_vector_return_value_284_287_304
eta_mn_304=AC_eta__mod__magnetic+eta_mn_304+d_ext_287_304*prof_287_304
arg_285_287_304 = abs((ac_transformed_pencil_r_mn-AC_r_int__mod__cdata)/(AC_wresistivity__mod__magnetic+AC_tini__mod__cparam))
if (abs(arg_285_287_304)>=8.)  {
der_step_return_value_285_287_304 = 2./AC_wresistivity__mod__magnetic*exp(-2.*abs(arg_285_287_304))
}
else {
der_step_return_value_285_287_304 = 0.5/(AC_wresistivity__mod__magnetic*cosh(arg_285_287_304)*cosh(arg_285_287_304))
}
prof_287_304=der_step_return_value_285_287_304
eta_r_287_304=-d_int_287_304*prof_287_304
arg_286_287_304 = abs((ac_transformed_pencil_r_mn-AC_r_ext__mod__cdata)/(AC_wresistivity__mod__magnetic+AC_tini__mod__cparam))
if (abs(arg_286_287_304)>=8.)  {
der_step_return_value_286_287_304 = 2./AC_wresistivity__mod__magnetic*exp(-2.*abs(arg_286_287_304))
}
else {
der_step_return_value_286_287_304 = 0.5/(AC_wresistivity__mod__magnetic*cosh(arg_286_287_304)*cosh(arg_286_287_304))
}
prof_287_304=der_step_return_value_286_287_304
eta_r_287_304=eta_r_287_304+d_ext_287_304*prof_287_304
geta_304.x=ac_transformed_pencil_evr.x*eta_r_287_304
geta_304.y=ac_transformed_pencil_evr.y*eta_r_287_304
geta_304.z=ac_transformed_pencil_evr.z*eta_r_287_304
}
else {
}
fres__mod__magnetic.x=fres__mod__magnetic.x+eta_mn_304*ac_transformed_pencil_del2a.x+geta_304.x*ac_transformed_pencil_diva
fres__mod__magnetic.y=fres__mod__magnetic.y+eta_mn_304*ac_transformed_pencil_del2a.y+geta_304.y*ac_transformed_pencil_diva
fres__mod__magnetic.z=fres__mod__magnetic.z+eta_mn_304*ac_transformed_pencil_del2a.z+geta_304.z*ac_transformed_pencil_diva
eta_total__mod__magnetic=eta_total__mod__magnetic+eta_mn_304
}
if (AC_lresi_eta_shock__mod__magnetic) {
if (AC_lweyl_gauge__mod__magnetic) {
fres__mod__magnetic.x=fres__mod__magnetic.x-AC_eta_shock__mod__magnetic*ac_transformed_pencil_shock*AC_mu0__mod__cdata*ac_transformed_pencil_jj.x
fres__mod__magnetic.y=fres__mod__magnetic.y-AC_eta_shock__mod__magnetic*ac_transformed_pencil_shock*AC_mu0__mod__cdata*ac_transformed_pencil_jj.y
fres__mod__magnetic.z=fres__mod__magnetic.z-AC_eta_shock__mod__magnetic*ac_transformed_pencil_shock*AC_mu0__mod__cdata*ac_transformed_pencil_jj.z
}
else {
fres__mod__magnetic.x=fres__mod__magnetic.x+AC_eta_shock__mod__magnetic*(ac_transformed_pencil_shock*ac_transformed_pencil_del2a.x+ac_transformed_pencil_diva*ac_transformed_pencil_gshock.x)
fres__mod__magnetic.y=fres__mod__magnetic.y+AC_eta_shock__mod__magnetic*(ac_transformed_pencil_shock*ac_transformed_pencil_del2a.y+ac_transformed_pencil_diva*ac_transformed_pencil_gshock.y)
fres__mod__magnetic.z=fres__mod__magnetic.z+AC_eta_shock__mod__magnetic*(ac_transformed_pencil_shock*ac_transformed_pencil_del2a.z+ac_transformed_pencil_diva*ac_transformed_pencil_gshock.z)
}
eta_total__mod__magnetic=eta_total__mod__magnetic+AC_eta_shock__mod__magnetic*ac_transformed_pencil_shock
}
if (AC_lresi_eta_shock2__mod__magnetic) {
if (AC_lweyl_gauge__mod__magnetic) {
fres__mod__magnetic.x=fres__mod__magnetic.x-AC_eta_shock2__mod__magnetic*ac_transformed_pencil_shock*ac_transformed_pencil_shock*AC_mu0__mod__cdata*ac_transformed_pencil_jj.x
fres__mod__magnetic.y=fres__mod__magnetic.y-AC_eta_shock2__mod__magnetic*ac_transformed_pencil_shock*ac_transformed_pencil_shock*AC_mu0__mod__cdata*ac_transformed_pencil_jj.y
fres__mod__magnetic.z=fres__mod__magnetic.z-AC_eta_shock2__mod__magnetic*ac_transformed_pencil_shock*ac_transformed_pencil_shock*AC_mu0__mod__cdata*ac_transformed_pencil_jj.z
}
else {
fres__mod__magnetic.x=fres__mod__magnetic.x+AC_eta_shock2__mod__magnetic*(ac_transformed_pencil_shock*ac_transformed_pencil_shock*ac_transformed_pencil_del2a.x+2*ac_transformed_pencil_shock*ac_transformed_pencil_diva*ac_transformed_pencil_gshock.x)
fres__mod__magnetic.y=fres__mod__magnetic.y+AC_eta_shock2__mod__magnetic*(ac_transformed_pencil_shock*ac_transformed_pencil_shock*ac_transformed_pencil_del2a.y+2*ac_transformed_pencil_shock*ac_transformed_pencil_diva*ac_transformed_pencil_gshock.y)
fres__mod__magnetic.z=fres__mod__magnetic.z+AC_eta_shock2__mod__magnetic*(ac_transformed_pencil_shock*ac_transformed_pencil_shock*ac_transformed_pencil_del2a.z+2*ac_transformed_pencil_shock*ac_transformed_pencil_diva*ac_transformed_pencil_gshock.z)
}
eta_total__mod__magnetic=eta_total__mod__magnetic+AC_eta_shock2__mod__magnetic*ac_transformed_pencil_shock*ac_transformed_pencil_shock
}
if (AC_lresi_eta_shock_profz__mod__magnetic) {
step_vector_return_value_288_304 = 0.5*(1+tanh((ac_transformed_pencil_z_mn-AC_eta_zshock__mod__magnetic)/(AC_eta_width_shock__mod__magnetic+AC_tini__mod__cparam)))
peta_shock_304 = AC_eta_shock__mod__magnetic + AC_eta_shock_jump1__mod__magnetic*step_vector_return_value_288_304
gradeta_shock_304.x = 0.
gradeta_shock_304.y = 0.
arg_289_304 = abs((ac_transformed_pencil_z_mn-AC_eta_zshock__mod__magnetic)/(AC_eta_width_shock__mod__magnetic+AC_tini__mod__cparam))
if (abs(arg_289_304)>=8.)  {
der_step_return_value_289_304 = 2./AC_eta_width_shock__mod__magnetic*exp(-2.*abs(arg_289_304))
}
else {
der_step_return_value_289_304 = 0.5/(AC_eta_width_shock__mod__magnetic*cosh(arg_289_304)*cosh(arg_289_304))
}
gradeta_shock_304.z = AC_eta_shock_jump1__mod__magnetic*der_step_return_value_289_304
if (AC_lweyl_gauge__mod__magnetic) {
fres__mod__magnetic.x=fres__mod__magnetic.x-peta_shock_304*ac_transformed_pencil_shock*AC_mu0__mod__cdata*ac_transformed_pencil_jj.x
fres__mod__magnetic.y=fres__mod__magnetic.y-peta_shock_304*ac_transformed_pencil_shock*AC_mu0__mod__cdata*ac_transformed_pencil_jj.y
fres__mod__magnetic.z=fres__mod__magnetic.z-peta_shock_304*ac_transformed_pencil_shock*AC_mu0__mod__cdata*ac_transformed_pencil_jj.z
}
else {
fres__mod__magnetic.x=fres__mod__magnetic.x+  peta_shock_304*(ac_transformed_pencil_shock*ac_transformed_pencil_del2a.x+ac_transformed_pencil_diva*ac_transformed_pencil_gshock.x)+ac_transformed_pencil_diva*ac_transformed_pencil_shock*gradeta_shock_304.x
fres__mod__magnetic.y=fres__mod__magnetic.y+  peta_shock_304*(ac_transformed_pencil_shock*ac_transformed_pencil_del2a.y+ac_transformed_pencil_diva*ac_transformed_pencil_gshock.y)+ac_transformed_pencil_diva*ac_transformed_pencil_shock*gradeta_shock_304.y
fres__mod__magnetic.z=fres__mod__magnetic.z+  peta_shock_304*(ac_transformed_pencil_shock*ac_transformed_pencil_del2a.z+ac_transformed_pencil_diva*ac_transformed_pencil_gshock.z)+ac_transformed_pencil_diva*ac_transformed_pencil_shock*gradeta_shock_304.z
}
eta_total__mod__magnetic=eta_total__mod__magnetic+peta_shock_304*ac_transformed_pencil_shock
}
if (AC_lresi_eta_shock_profr__mod__magnetic) {
if (AC_lspherical_coords__mod__cdata || AC_lsphere_in_a_box__mod__cdata) {
tmp1_304=ac_transformed_pencil_r_mn
}
else {
tmp1_304=ac_transformed_pencil_rcyl_mn
}
step_vector_return_value_290_304 = 0.5*(1+tanh((tmp1_304-AC_eta_xshock__mod__magnetic)/(AC_eta_width_shock__mod__magnetic+AC_tini__mod__cparam)))
peta_shock_304 = AC_eta_shock__mod__magnetic + AC_eta_shock_jump1__mod__magnetic*step_vector_return_value_290_304
arg_291_304 = abs((tmp1_304-AC_eta_xshock__mod__magnetic)/(AC_eta_width_shock__mod__magnetic+AC_tini__mod__cparam))
if (abs(arg_291_304)>=8.)  {
der_step_return_value_291_304 = 2./AC_eta_width_shock__mod__magnetic*exp(-2.*abs(arg_291_304))
}
else {
der_step_return_value_291_304 = 0.5/(AC_eta_width_shock__mod__magnetic*cosh(arg_291_304)*cosh(arg_291_304))
}
gradeta_shock_304.x = AC_eta_shock_jump1__mod__magnetic*der_step_return_value_291_304
gradeta_shock_304.y = 0.
gradeta_shock_304.z = 0.
if (AC_lweyl_gauge__mod__magnetic) {
fres__mod__magnetic.x=fres__mod__magnetic.x-peta_shock_304*ac_transformed_pencil_shock*AC_mu0__mod__cdata*ac_transformed_pencil_jj.x
fres__mod__magnetic.y=fres__mod__magnetic.y-peta_shock_304*ac_transformed_pencil_shock*AC_mu0__mod__cdata*ac_transformed_pencil_jj.y
fres__mod__magnetic.z=fres__mod__magnetic.z-peta_shock_304*ac_transformed_pencil_shock*AC_mu0__mod__cdata*ac_transformed_pencil_jj.z
}
else {
fres__mod__magnetic.x=fres__mod__magnetic.x + peta_shock_304*(ac_transformed_pencil_shock*ac_transformed_pencil_del2a.x+ac_transformed_pencil_diva*ac_transformed_pencil_gshock.x)+  ac_transformed_pencil_diva*ac_transformed_pencil_shock*gradeta_shock_304.x
fres__mod__magnetic.y=fres__mod__magnetic.y + peta_shock_304*(ac_transformed_pencil_shock*ac_transformed_pencil_del2a.y+ac_transformed_pencil_diva*ac_transformed_pencil_gshock.y)+  ac_transformed_pencil_diva*ac_transformed_pencil_shock*gradeta_shock_304.y
fres__mod__magnetic.z=fres__mod__magnetic.z + peta_shock_304*(ac_transformed_pencil_shock*ac_transformed_pencil_del2a.z+ac_transformed_pencil_diva*ac_transformed_pencil_gshock.z)+  ac_transformed_pencil_diva*ac_transformed_pencil_shock*gradeta_shock_304.z
}
eta_total__mod__magnetic=eta_total__mod__magnetic+peta_shock_304*ac_transformed_pencil_shock
}
if (AC_lresi_eta_shock_perp__mod__magnetic) {
if (AC_lweyl_gauge__mod__magnetic) {
fres__mod__magnetic.x=fres__mod__magnetic.x-AC_eta_shock__mod__magnetic*ac_transformed_pencil_shock_perp*AC_mu0__mod__cdata*ac_transformed_pencil_jj.x
fres__mod__magnetic.y=fres__mod__magnetic.y-AC_eta_shock__mod__magnetic*ac_transformed_pencil_shock_perp*AC_mu0__mod__cdata*ac_transformed_pencil_jj.y
fres__mod__magnetic.z=fres__mod__magnetic.z-AC_eta_shock__mod__magnetic*ac_transformed_pencil_shock_perp*AC_mu0__mod__cdata*ac_transformed_pencil_jj.z
}
else {
fres__mod__magnetic.x=fres__mod__magnetic.x+ AC_eta_shock__mod__magnetic*(ac_transformed_pencil_shock_perp*ac_transformed_pencil_del2a.x+ac_transformed_pencil_diva*ac_transformed_pencil_gshock_perp.x)
fres__mod__magnetic.y=fres__mod__magnetic.y+ AC_eta_shock__mod__magnetic*(ac_transformed_pencil_shock_perp*ac_transformed_pencil_del2a.y+ac_transformed_pencil_diva*ac_transformed_pencil_gshock_perp.y)
fres__mod__magnetic.z=fres__mod__magnetic.z+ AC_eta_shock__mod__magnetic*(ac_transformed_pencil_shock_perp*ac_transformed_pencil_del2a.z+ac_transformed_pencil_diva*ac_transformed_pencil_gshock_perp.z)
}
eta_total__mod__magnetic=eta_total__mod__magnetic+AC_eta_shock__mod__magnetic*ac_transformed_pencil_shock_perp
}
if (AC_lresi_etava__mod__magnetic) {
if (AC_lweyl_gauge__mod__magnetic) {
fres__mod__magnetic = fres__mod__magnetic - ac_transformed_pencil_etava * ac_transformed_pencil_jj
}
eta_total__mod__magnetic = eta_total__mod__magnetic + ac_transformed_pencil_etava
}
if (AC_lresi_vaspeed__mod__magnetic) {
if (AC_lweyl_gauge__mod__magnetic) {
fres__mod__magnetic = fres__mod__magnetic - ac_transformed_pencil_etava * ac_transformed_pencil_jj
}
else {
fres__mod__magnetic.x = fres__mod__magnetic.x + AC_mu0__mod__cdata * ac_transformed_pencil_etava * ac_transformed_pencil_del2a.x + AC_eta_va__mod__magnetic/AC_varms__mod__magnetic * ac_transformed_pencil_diva * ac_transformed_pencil_gva.x
fres__mod__magnetic.y = fres__mod__magnetic.y + AC_mu0__mod__cdata * ac_transformed_pencil_etava * ac_transformed_pencil_del2a.y + AC_eta_va__mod__magnetic/AC_varms__mod__magnetic * ac_transformed_pencil_diva * ac_transformed_pencil_gva.y
fres__mod__magnetic.z = fres__mod__magnetic.z + AC_mu0__mod__cdata * ac_transformed_pencil_etava * ac_transformed_pencil_del2a.z + AC_eta_va__mod__magnetic/AC_varms__mod__magnetic * ac_transformed_pencil_diva * ac_transformed_pencil_gva.z
}
eta_total__mod__magnetic = eta_total__mod__magnetic + ac_transformed_pencil_etava
}
if (AC_lresi_etaj__mod__magnetic) {
fres__mod__magnetic = fres__mod__magnetic - ac_transformed_pencil_etaj * ac_transformed_pencil_jj
eta_total__mod__magnetic = eta_total__mod__magnetic + ac_transformed_pencil_etaj
}
if (AC_lresi_etaj2__mod__magnetic) {
fres__mod__magnetic = fres__mod__magnetic - ac_transformed_pencil_etaj2 * ac_transformed_pencil_jj
eta_total__mod__magnetic = eta_total__mod__magnetic + ac_transformed_pencil_etaj2
}
if (AC_lresi_etajrho__mod__magnetic) {
fres__mod__magnetic = fres__mod__magnetic - ac_transformed_pencil_etajrho * ac_transformed_pencil_jj
eta_total__mod__magnetic = eta_total__mod__magnetic + ac_transformed_pencil_etajrho
}
if (AC_lresi_smagorinsky__mod__magnetic) {
if (!AC_lweyl_gauge__mod__magnetic) {
if (AC_letasmag_as_aux__mod__magnetic) {
eta_smag__mod__magnetic=pow((AC_d_smag__mod__magnetic*AC_dxmax__mod__cdata),2.)*sqrt(ac_transformed_pencil_j2)
fres__mod__magnetic = eta_smag__mod__magnetic+AC_eta__mod__magnetic*ac_transformed_pencil_del2a
geta_304 = gradient(Field(AC_ietasmag__mod__cdata))
fres__mod__magnetic.x=fres__mod__magnetic.x+geta_304.x*ac_transformed_pencil_diva
fres__mod__magnetic.y=fres__mod__magnetic.y+geta_304.y*ac_transformed_pencil_diva
fres__mod__magnetic.z=fres__mod__magnetic.z+geta_304.z*ac_transformed_pencil_diva
}
else {
eta_smag__mod__magnetic=pow((AC_d_smag__mod__magnetic*AC_dxmax__mod__cdata),2.)*sqrt(ac_transformed_pencil_j2)
fres__mod__magnetic = eta_smag__mod__magnetic+AC_eta__mod__magnetic*ac_transformed_pencil_del2a
}
}
else {
eta_smag__mod__magnetic=pow((AC_d_smag__mod__magnetic*AC_dxmax__mod__cdata),2.)*sqrt(ac_transformed_pencil_j2)
fres__mod__magnetic.x=fres__mod__magnetic.x-eta_smag__mod__magnetic*AC_mu0__mod__cdata*ac_transformed_pencil_jj.x
fres__mod__magnetic.y=fres__mod__magnetic.y-eta_smag__mod__magnetic*AC_mu0__mod__cdata*ac_transformed_pencil_jj.y
fres__mod__magnetic.z=fres__mod__magnetic.z-eta_smag__mod__magnetic*AC_mu0__mod__cdata*ac_transformed_pencil_jj.z
}
}
if (AC_lresi_smagorinsky_nusmag__mod__magnetic) {
eta_smag__mod__magnetic=AC_pm_smag1__mod__magnetic*ac_transformed_pencil_nu_smag
fres__mod__magnetic = eta_smag__mod__magnetic+AC_eta__mod__magnetic*ac_transformed_pencil_del2a
geta_304 = gradient(Field(AC_inusmag__mod__cdata))
fres__mod__magnetic.x=fres__mod__magnetic.x+AC_pm_smag1__mod__magnetic*geta_304.x*ac_transformed_pencil_diva
fres__mod__magnetic.y=fres__mod__magnetic.y+AC_pm_smag1__mod__magnetic*geta_304.y*ac_transformed_pencil_diva
fres__mod__magnetic.z=fres__mod__magnetic.z+AC_pm_smag1__mod__magnetic*geta_304.z*ac_transformed_pencil_diva
}
if (AC_lresi_smagorinsky_cross__mod__magnetic) {
sign_jo_304 = 1. - (ac_transformed_pencil_jo < 0)*2.0
eta_smag__mod__magnetic=pow((AC_d_smag__mod__magnetic*AC_dxmax__mod__cdata),2.)*sign_jo_304*sqrt(ac_transformed_pencil_jo*sign_jo_304)
fres__mod__magnetic = eta_smag__mod__magnetic+AC_eta__mod__magnetic*ac_transformed_pencil_del2a
}
if (AC_lresi_smagorinsky__mod__magnetic  ||  AC_lresi_smagorinsky_nusmag__mod__magnetic  ||  AC_lresi_smagorinsky_cross__mod__magnetic)  {
eta_total__mod__magnetic = eta_total__mod__magnetic + eta_smag__mod__magnetic
}
if (AC_lresi_anomalous__mod__magnetic) {
vdrift_304=sqrt(sum(ac_transformed_pencil_jj*ac_transformed_pencil_jj))*ac_transformed_pencil_rho1
if (AC_lweyl_gauge__mod__magnetic) {
if (AC_eta_anom_thresh__mod__magnetic!=0) {
if (AC_eta_anom__mod__magnetic*vdrift_304 > AC_eta_anom_thresh__mod__magnetic*AC_vcrit_anom__mod__magnetic) {
fres__mod__magnetic.x=fres__mod__magnetic.x-AC_eta_anom_thresh__mod__magnetic*AC_mu0__mod__cdata*ac_transformed_pencil_jj.x
}
else {
fres__mod__magnetic.x=fres__mod__magnetic.x-AC_eta_anom__mod__magnetic*vdrift_304/AC_vcrit_anom__mod__magnetic*AC_mu0__mod__cdata*ac_transformed_pencil_jj.x
}
}
else {
if (vdrift_304>AC_vcrit_anom__mod__magnetic) {
fres__mod__magnetic.x=fres__mod__magnetic.x-AC_eta_anom__mod__magnetic*vdrift_304/AC_vcrit_anom__mod__magnetic*AC_mu0__mod__cdata*ac_transformed_pencil_jj.x
}
}
if (AC_eta_anom_thresh__mod__magnetic!=0) {
if (AC_eta_anom__mod__magnetic*vdrift_304 > AC_eta_anom_thresh__mod__magnetic*AC_vcrit_anom__mod__magnetic) {
fres__mod__magnetic.y=fres__mod__magnetic.y-AC_eta_anom_thresh__mod__magnetic*AC_mu0__mod__cdata*ac_transformed_pencil_jj.y
}
else {
fres__mod__magnetic.y=fres__mod__magnetic.y-AC_eta_anom__mod__magnetic*vdrift_304/AC_vcrit_anom__mod__magnetic*AC_mu0__mod__cdata*ac_transformed_pencil_jj.y
}
}
else {
if (vdrift_304>AC_vcrit_anom__mod__magnetic) {
fres__mod__magnetic.y=fres__mod__magnetic.y-AC_eta_anom__mod__magnetic*vdrift_304/AC_vcrit_anom__mod__magnetic*AC_mu0__mod__cdata*ac_transformed_pencil_jj.y
}
}
if (AC_eta_anom_thresh__mod__magnetic!=0) {
if (AC_eta_anom__mod__magnetic*vdrift_304 > AC_eta_anom_thresh__mod__magnetic*AC_vcrit_anom__mod__magnetic) {
fres__mod__magnetic.z=fres__mod__magnetic.z-AC_eta_anom_thresh__mod__magnetic*AC_mu0__mod__cdata*ac_transformed_pencil_jj.z
}
else {
fres__mod__magnetic.z=fres__mod__magnetic.z-AC_eta_anom__mod__magnetic*vdrift_304/AC_vcrit_anom__mod__magnetic*AC_mu0__mod__cdata*ac_transformed_pencil_jj.z
}
}
else {
if (vdrift_304>AC_vcrit_anom__mod__magnetic) {
fres__mod__magnetic.z=fres__mod__magnetic.z-AC_eta_anom__mod__magnetic*vdrift_304/AC_vcrit_anom__mod__magnetic*AC_mu0__mod__cdata*ac_transformed_pencil_jj.z
}
}
}
else {
}
if (AC_eta_anom_thresh__mod__magnetic!=0) {
if (AC_eta_anom__mod__magnetic*vdrift_304 > AC_eta_anom_thresh__mod__magnetic*AC_vcrit_anom__mod__magnetic) {
eta_total__mod__magnetic=eta_total__mod__magnetic+AC_eta_anom_thresh__mod__magnetic
}
else {
eta_total__mod__magnetic=eta_total__mod__magnetic+AC_eta_anom__mod__magnetic*vdrift_304/AC_vcrit_anom__mod__magnetic
}
}
else {
if (vdrift_304>AC_vcrit_anom__mod__magnetic) {
eta_total__mod__magnetic=eta_total__mod__magnetic+AC_eta_anom__mod__magnetic*vdrift_304/AC_vcrit_anom__mod__magnetic
}
}
}
if (AC_lresi_spitzer__mod__magnetic) {
if (AC_lweyl_gauge__mod__magnetic) {
fres__mod__magnetic.x=fres__mod__magnetic.x-AC_eta_spitzer__mod__magnetic*exp(-1.5*ac_transformed_pencil_lntt)*AC_mu0__mod__cdata*ac_transformed_pencil_jj.x
fres__mod__magnetic.y=fres__mod__magnetic.y-AC_eta_spitzer__mod__magnetic*exp(-1.5*ac_transformed_pencil_lntt)*AC_mu0__mod__cdata*ac_transformed_pencil_jj.y
fres__mod__magnetic.z=fres__mod__magnetic.z-AC_eta_spitzer__mod__magnetic*exp(-1.5*ac_transformed_pencil_lntt)*AC_mu0__mod__cdata*ac_transformed_pencil_jj.z
}
else {
fres__mod__magnetic.x=fres__mod__magnetic.x+AC_eta_spitzer__mod__magnetic*exp(-1.5*ac_transformed_pencil_lntt)*(ac_transformed_pencil_del2a.x-1.5*ac_transformed_pencil_diva*ac_transformed_pencil_glntt.x)
fres__mod__magnetic.y=fres__mod__magnetic.y+AC_eta_spitzer__mod__magnetic*exp(-1.5*ac_transformed_pencil_lntt)*(ac_transformed_pencil_del2a.y-1.5*ac_transformed_pencil_diva*ac_transformed_pencil_glntt.y)
fres__mod__magnetic.z=fres__mod__magnetic.z+AC_eta_spitzer__mod__magnetic*exp(-1.5*ac_transformed_pencil_lntt)*(ac_transformed_pencil_del2a.z-1.5*ac_transformed_pencil_diva*ac_transformed_pencil_glntt.z)
}
eta_total__mod__magnetic = eta_total__mod__magnetic + AC_eta_spitzer__mod__magnetic*exp(-1.5*ac_transformed_pencil_lntt)
}
if (AC_lresi_cspeed__mod__magnetic) {
if (AC_lweyl_gauge__mod__magnetic) {
fres__mod__magnetic.x=fres__mod__magnetic.x-AC_eta__mod__magnetic*exp(AC_eta_cspeed__mod__magnetic*ac_transformed_pencil_lntt)*AC_mu0__mod__cdata*ac_transformed_pencil_jj.x
fres__mod__magnetic.y=fres__mod__magnetic.y-AC_eta__mod__magnetic*exp(AC_eta_cspeed__mod__magnetic*ac_transformed_pencil_lntt)*AC_mu0__mod__cdata*ac_transformed_pencil_jj.y
fres__mod__magnetic.z=fres__mod__magnetic.z-AC_eta__mod__magnetic*exp(AC_eta_cspeed__mod__magnetic*ac_transformed_pencil_lntt)*AC_mu0__mod__cdata*ac_transformed_pencil_jj.z
}
else {
fres__mod__magnetic.x=fres__mod__magnetic.x+AC_eta__mod__magnetic*exp(AC_eta_cspeed__mod__magnetic*ac_transformed_pencil_lntt)*(ac_transformed_pencil_del2a.x+0.5*ac_transformed_pencil_diva*ac_transformed_pencil_glntt.x)
fres__mod__magnetic.y=fres__mod__magnetic.y+AC_eta__mod__magnetic*exp(AC_eta_cspeed__mod__magnetic*ac_transformed_pencil_lntt)*(ac_transformed_pencil_del2a.y+0.5*ac_transformed_pencil_diva*ac_transformed_pencil_glntt.y)
fres__mod__magnetic.z=fres__mod__magnetic.z+AC_eta__mod__magnetic*exp(AC_eta_cspeed__mod__magnetic*ac_transformed_pencil_lntt)*(ac_transformed_pencil_del2a.z+0.5*ac_transformed_pencil_diva*ac_transformed_pencil_glntt.z)
}
eta_total__mod__magnetic = eta_total__mod__magnetic + AC_eta__mod__magnetic*exp(AC_eta_cspeed__mod__magnetic*ac_transformed_pencil_lntt)
}
if (AC_lresi_eta_proptouz__mod__magnetic) {
if (AC_lweyl_gauge__mod__magnetic) {
fres__mod__magnetic.x=fres__mod__magnetic.x-AC_eta__mod__magnetic*AC_ampl_eta_uz__mod__magnetic*ac_transformed_pencil_uu.z*AC_mu0__mod__cdata*ac_transformed_pencil_jj.x
fres__mod__magnetic.y=fres__mod__magnetic.y-AC_eta__mod__magnetic*AC_ampl_eta_uz__mod__magnetic*ac_transformed_pencil_uu.z*AC_mu0__mod__cdata*ac_transformed_pencil_jj.y
fres__mod__magnetic.z=fres__mod__magnetic.z-AC_eta__mod__magnetic*AC_ampl_eta_uz__mod__magnetic*ac_transformed_pencil_uu.z*AC_mu0__mod__cdata*ac_transformed_pencil_jj.z
}
else {
fres__mod__magnetic.x=fres__mod__magnetic.x+AC_eta__mod__magnetic*AC_ampl_eta_uz__mod__magnetic*(ac_transformed_pencil_uu.z*ac_transformed_pencil_del2a.x+ac_transformed_pencil_uij[3-1][1-1]*ac_transformed_pencil_diva)
fres__mod__magnetic.y=fres__mod__magnetic.y+AC_eta__mod__magnetic*AC_ampl_eta_uz__mod__magnetic*(ac_transformed_pencil_uu.z*ac_transformed_pencil_del2a.y+ac_transformed_pencil_uij[3-1][2-1]*ac_transformed_pencil_diva)
fres__mod__magnetic.z=fres__mod__magnetic.z+AC_eta__mod__magnetic*AC_ampl_eta_uz__mod__magnetic*(ac_transformed_pencil_uu.z*ac_transformed_pencil_del2a.z+ac_transformed_pencil_uij[3-1][3-1]*ac_transformed_pencil_diva)
}
eta_total__mod__magnetic = eta_total__mod__magnetic + AC_eta__mod__magnetic*AC_ampl_eta_uz__mod__magnetic*ac_transformed_pencil_uu.z
}
if (AC_lresi_magfield__mod__magnetic) {
eta_bb_304=AC_eta__mod__magnetic/(1.+AC_etab__mod__magnetic*ac_transformed_pencil_bb.y*ac_transformed_pencil_bb.y)
if (AC_lweyl_gauge__mod__magnetic) {
fres__mod__magnetic.x=fres__mod__magnetic.x-AC_mu0__mod__cdata*eta_bb_304*ac_transformed_pencil_jj.x
fres__mod__magnetic.y=fres__mod__magnetic.y-AC_mu0__mod__cdata*eta_bb_304*ac_transformed_pencil_jj.y
fres__mod__magnetic.z=fres__mod__magnetic.z-AC_mu0__mod__cdata*eta_bb_304*ac_transformed_pencil_jj.z
}
eta_total__mod__magnetic = eta_total__mod__magnetic + eta_bb_304
}
if (AC_eta_aniso_bb__mod__magnetic!=0.0) {
if (ac_transformed_pencil_b2==0.) {
tmp1_304=0.
}
else {
tmp1_304=AC_eta_aniso_bb__mod__magnetic/ac_transformed_pencil_b2
}
if (AC_lquench_eta_aniso__mod__magnetic) {
tmp1_304=tmp1_304/(1.+AC_quench_aniso__mod__magnetic*AC_arms__mod__magnetic)
}
DF_AVEC=DF_AVEC-tmp1_304*ac_transformed_pencil_jb*ac_transformed_pencil_bb
eta_total__mod__magnetic = eta_total__mod__magnetic + AC_eta_aniso_bb__mod__magnetic
}
if (AC_lambipolar_diffusion__mod__magnetic) {
DF_AVEC=DF_AVEC+ac_transformed_pencil_nu_ni1*ac_transformed_pencil_jxbrxb
if (AC_lentropy__mod__cparam  &&  AC_lneutralion_heat__mod__magnetic) {
if (AC_pretend_lntt__mod__cdata) {
DF_SS = DF_SS + ac_transformed_pencil_cv1*ac_transformed_pencil_tt1*ac_transformed_pencil_nu_ni1*ac_transformed_pencil_jxbr2
}
else {
DF_SS = DF_SS + ac_transformed_pencil_tt1*ac_transformed_pencil_nu_ni1*ac_transformed_pencil_jxbr2
}
}
else if (AC_ltemperature__mod__cparam  &&  AC_lneutralion_heat__mod__magnetic) {
DF_LNTT = DF_LNTT + ac_transformed_pencil_cv1*ac_transformed_pencil_tt1*ac_transformed_pencil_nu_ni1*ac_transformed_pencil_jxbr2
}
eta_total__mod__magnetic = eta_total__mod__magnetic + ac_transformed_pencil_nu_ni1*ac_transformed_pencil_va2
}
if (AC_lmean_friction__mod__magnetic) {
}
else if (AC_llocal_friction__mod__magnetic) {
dadt_304 = dadt_304-AC_llambda_aa__mod__magnetic*ac_transformed_pencil_aa
}
if (AC_lmagnetic_slope_limited__mod__magnetic && AC_llast__mod__cdata) {
if (AC_lsld_bb__mod__magnetic) {
not_implemented("calc_slope_diff_flux")
not_implemented("calc_slope_diff_flux")
not_implemented("calc_slope_diff_flux")
tmp2_304.x= (-d_sld_flux_304[2-1][3-1] + d_sld_flux_304[3-1][2-1])*AC_fac_sld_magn__mod__magnetic
tmp2_304.y= (-d_sld_flux_304[3-1][1-1] + d_sld_flux_304[1-1][3-1])*AC_fac_sld_magn__mod__magnetic
tmp2_304.z= (-d_sld_flux_304[1-1][2-1] + d_sld_flux_304[2-1][1-1])*AC_fac_sld_magn__mod__magnetic
fres__mod__magnetic=fres__mod__magnetic + tmp2_304
}
else {
if (AC_lcylindrical_coords__mod__cdata  ||  AC_lspherical_coords__mod__cdata) {
not_implemented("calc_slope_diff_flux")
not_implemented("calc_slope_diff_flux")
not_implemented("calc_slope_diff_flux")
if (AC_lcylindrical_coords__mod__cdata) {
fres__mod__magnetic.x=fres__mod__magnetic.x+tmp2_304.x-(d_sld_flux_304[2-1][2-1])/AC_x__mod__cdata[vertexIdx.x]
fres__mod__magnetic.y=fres__mod__magnetic.y+tmp2_304.y+(d_sld_flux_304[2-1][1-1])/AC_x__mod__cdata[vertexIdx.x]
fres__mod__magnetic.z=fres__mod__magnetic.z+tmp2_304.z
}
else if(AC_lspherical_coords__mod__cdata) {
fres__mod__magnetic.x=fres__mod__magnetic.x+tmp2_304.x-(d_sld_flux_304[2-1][2-1]+d_sld_flux_304[3-1][3-1])/AC_x__mod__cdata[vertexIdx.x]
fres__mod__magnetic.y=fres__mod__magnetic.y+tmp2_304.y+(d_sld_flux_304[2-1][1-1]-d_sld_flux_304[3-1][3-1]*AC_cotth__mod__cdata[AC_m__mod__cdata-1])/AC_x__mod__cdata[vertexIdx.x]
fres__mod__magnetic.z=fres__mod__magnetic.z+tmp2_304.z+(d_sld_flux_304[3-1][1-1]+d_sld_flux_304[3-1][2-1]*AC_cotth__mod__cdata[AC_m__mod__cdata-1])/AC_x__mod__cdata[vertexIdx.x]
}
}
else {
not_implemented("calc_slope_diff_flux")
not_implemented("calc_slope_diff_flux")
not_implemented("calc_slope_diff_flux")
fres__mod__magnetic=fres__mod__magnetic+tmp2_304
}
}
if (AC_lohmic_heat__mod__magnetic) {
tmp1_304 = dot(tmp2_304,ac_transformed_pencil_jj)
if (AC_lentropy__mod__cparam) {
if (AC_pretend_lntt__mod__cdata) {
DF_SS = DF_SS + ac_transformed_pencil_cv1*max(0.0,tmp1_304)*ac_transformed_pencil_rho1*ac_transformed_pencil_tt1
}
else {
DF_SS = DF_SS + max(0.0,tmp1_304)*ac_transformed_pencil_rho1*ac_transformed_pencil_tt1
}
}
else if (AC_ltemperature__mod__cparam) {
if (AC_ltemperature_nolog__mod__cdata) {
DF_TT   = DF_TT + ac_transformed_pencil_cv1*max(0.0,tmp1_304)*ac_transformed_pencil_rho1
}
else {
DF_LNTT = DF_LNTT + ac_transformed_pencil_cv1*max(0.0,tmp1_304)*ac_transformed_pencil_rho1*ac_transformed_pencil_tt1
}
}
else if (AC_lthermal_energy__mod__cparam) {
DF_ETH = DF_ETH + max(0.0,tmp1_304)
}
}
}
if (AC_lno_ohmic_heat_bound_z__mod__magnetic && AC_lohmic_heat__mod__magnetic) {
if (false) {
}
else {
relshift_294_304=0.0
}
xi_294_304 = (AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_no_ohmic_heat_z0__mod__magnetic)/(AC_no_ohmic_heat_zwidth__mod__magnetic+AC_tini__mod__cparam) - relshift_294_304
xi_294_304 = max(xi_294_304,-1.0)
xi_294_304 = min(xi_294_304, 1.0)
cubic_step_pt_return_value_294_304 = 0.5 + xi_294_304*(0.75-xi_294_304*xi_294_304*0.25)
eta_heat_304=eta_total__mod__magnetic*cubic_step_pt_return_value_294_304
}
else {
eta_heat_304=eta_total__mod__magnetic
}
if (!AC_lkinematic__mod__magnetic && AC_lohmic_heat__mod__magnetic) {
if (AC_lentropy__mod__cparam) {
if (AC_pretend_lntt__mod__cdata) {
DF_SS = DF_SS + ac_transformed_pencil_cv1*eta_heat_304*AC_mu0__mod__cdata*ac_transformed_pencil_j2*ac_transformed_pencil_rho1*ac_transformed_pencil_tt1
}
else {
DF_SS = DF_SS + eta_heat_304*AC_mu0__mod__cdata*ac_transformed_pencil_j2*ac_transformed_pencil_rho1*ac_transformed_pencil_tt1
}
}
else if (AC_ltemperature__mod__cparam) {
if (AC_ltemperature_nolog__mod__cdata) {
DF_TT   = DF_TT + ac_transformed_pencil_cv1*eta_heat_304*AC_mu0__mod__cdata*ac_transformed_pencil_j2*ac_transformed_pencil_rho1
}
else {
DF_LNTT = DF_LNTT + ac_transformed_pencil_cv1*eta_heat_304*AC_mu0__mod__cdata*ac_transformed_pencil_j2*ac_transformed_pencil_rho1*ac_transformed_pencil_tt1
}
}
else if (AC_lthermal_energy__mod__cparam) {
DF_ETH = DF_ETH + eta_heat_304*AC_mu0__mod__cdata*ac_transformed_pencil_j2
}
}
if (AC_lfrozen_bb_bot__mod__magnetic.x && AC_lfirst_proc_z__mod__cdata && AC_n__mod__cdata==AC_n1__mod__cparam) {
fres__mod__magnetic.x=0.
}
if (AC_lfrozen_bb_top__mod__magnetic.x && AC_llast_proc_z__mod__cdata && AC_n__mod__cdata==AC_n2__mod__cparam) {
fres__mod__magnetic.x=0.
}
if (AC_lfrozen_bb_bot__mod__magnetic.y && AC_lfirst_proc_z__mod__cdata && AC_n__mod__cdata==AC_n1__mod__cparam) {
fres__mod__magnetic.y=0.
}
if (AC_lfrozen_bb_top__mod__magnetic.y && AC_llast_proc_z__mod__cdata && AC_n__mod__cdata==AC_n2__mod__cparam) {
fres__mod__magnetic.y=0.
}
if (AC_lfrozen_bb_bot__mod__magnetic.z && AC_lfirst_proc_z__mod__cdata && AC_n__mod__cdata==AC_n1__mod__cparam) {
fres__mod__magnetic.z=0.
}
if (AC_lfrozen_bb_top__mod__magnetic.z && AC_llast_proc_z__mod__cdata && AC_n__mod__cdata==AC_n2__mod__cparam) {
fres__mod__magnetic.z=0.
}
if (!AC_lupw_aa__mod__magnetic) {
if (AC_linduction__mod__magnetic) {
if (AC_ladvective_gauge__mod__magnetic) {
if (b_ext_304.x != 0.  ||  b_ext_304.y != 0.  ||  b_ext_304.z != 0.) {
ujiaj_304 = cross(ac_transformed_pencil_uu,b_ext_304)
}
else {
if (AC_lfargo_advection__mod__cdata) {
ajiuj_304.x = 0.
ajiuj_304.y = 0.
ajiuj_304.z = 0.
}
else {
ujiaj_304.x = 0.
ujiaj_304.y = 0.
ujiaj_304.z = 0.
}
}
if (AC_lfargo_advection__mod__cdata) {
ajiuj_304.x=ajiuj_304.x+ac_transformed_pencil_uu.x*ac_transformed_pencil_aij[1-1][1-1]
}
else {
ujiaj_304.x=ujiaj_304.x+ac_transformed_pencil_aa.x*ac_transformed_pencil_uij[1-1][1-1]
}
if (AC_lfargo_advection__mod__cdata) {
ajiuj_304.x=ajiuj_304.x+ac_transformed_pencil_uu.y*ac_transformed_pencil_aij[2-1][1-1]
}
else {
ujiaj_304.x=ujiaj_304.x+ac_transformed_pencil_aa.y*ac_transformed_pencil_uij[2-1][1-1]
}
if (AC_lfargo_advection__mod__cdata) {
ajiuj_304.x=ajiuj_304.x+ac_transformed_pencil_uu.z*ac_transformed_pencil_aij[3-1][1-1]
}
else {
ujiaj_304.x=ujiaj_304.x+ac_transformed_pencil_aa.z*ac_transformed_pencil_uij[3-1][1-1]
}
if (AC_lfargo_advection__mod__cdata) {
ajiuj_304.y=ajiuj_304.y+ac_transformed_pencil_uu.x*ac_transformed_pencil_aij[1-1][2-1]
}
else {
ujiaj_304.y=ujiaj_304.y+ac_transformed_pencil_aa.x*ac_transformed_pencil_uij[1-1][2-1]
}
if (AC_lfargo_advection__mod__cdata) {
ajiuj_304.y=ajiuj_304.y+ac_transformed_pencil_uu.y*ac_transformed_pencil_aij[2-1][2-1]
}
else {
ujiaj_304.y=ujiaj_304.y+ac_transformed_pencil_aa.y*ac_transformed_pencil_uij[2-1][2-1]
}
if (AC_lfargo_advection__mod__cdata) {
ajiuj_304.y=ajiuj_304.y+ac_transformed_pencil_uu.z*ac_transformed_pencil_aij[3-1][2-1]
}
else {
ujiaj_304.y=ujiaj_304.y+ac_transformed_pencil_aa.z*ac_transformed_pencil_uij[3-1][2-1]
}
if (AC_lfargo_advection__mod__cdata) {
ajiuj_304.z=ajiuj_304.z+ac_transformed_pencil_uu.x*ac_transformed_pencil_aij[1-1][3-1]
}
else {
ujiaj_304.z=ujiaj_304.z+ac_transformed_pencil_aa.x*ac_transformed_pencil_uij[1-1][3-1]
}
if (AC_lfargo_advection__mod__cdata) {
ajiuj_304.z=ajiuj_304.z+ac_transformed_pencil_uu.y*ac_transformed_pencil_aij[2-1][3-1]
}
else {
ujiaj_304.z=ujiaj_304.z+ac_transformed_pencil_aa.y*ac_transformed_pencil_uij[2-1][3-1]
}
if (AC_lfargo_advection__mod__cdata) {
ajiuj_304.z=ajiuj_304.z+ac_transformed_pencil_uu.z*ac_transformed_pencil_aij[3-1][3-1]
}
else {
ujiaj_304.z=ujiaj_304.z+ac_transformed_pencil_aa.z*ac_transformed_pencil_uij[3-1][3-1]
}
if (AC_lcylindrical_coords__mod__cdata) {
if (AC_lfargo_advection__mod__cdata) {
ajiuj_304.y = ajiuj_304.y + (ac_transformed_pencil_aa.x*ac_transformed_pencil_uu.y - ac_transformed_pencil_aa.y*ac_transformed_pencil_uu.x)*AC_rcyl_mn1__mod__cdata[vertexIdx.x-NGHOST_VAL]
}
else {
ujiaj_304.y = ujiaj_304.y + (ac_transformed_pencil_uu.x*ac_transformed_pencil_aa.y - ac_transformed_pencil_uu.y*ac_transformed_pencil_aa.x)*AC_rcyl_mn1__mod__cdata[vertexIdx.x-NGHOST_VAL]
}
}
else if (AC_lspherical_coords__mod__cdata) {
ujiaj_304.y = ujiaj_304.y + (ac_transformed_pencil_uu.x*ac_transformed_pencil_aa.y - ac_transformed_pencil_uu.y*ac_transformed_pencil_aa.x)*AC_r1_mn__mod__cdata[vertexIdx.x-NGHOST_VAL]
ujiaj_304.z = ujiaj_304.z + (ac_transformed_pencil_uu.x*ac_transformed_pencil_aa.z          -  ac_transformed_pencil_uu.z*ac_transformed_pencil_aa.x          +  ac_transformed_pencil_uu.y*ac_transformed_pencil_aa.z*AC_cotth__mod__cdata[AC_m__mod__cdata-1] -  ac_transformed_pencil_uu.z*ac_transformed_pencil_aa.z*AC_cotth__mod__cdata[AC_m__mod__cdata-1])*AC_r1_mn__mod__cdata[vertexIdx.x-NGHOST_VAL]
}
if (!AC_lfargo_advection__mod__cdata) {
dadt_304 = dadt_304-ac_transformed_pencil_uga-ujiaj_304+fres__mod__magnetic
}
else {
dadt_304 = dadt_304-ac_transformed_pencil_uuadvec_gaa+ajiuj_304+fres__mod__magnetic
}
}
else if (AC_ladvective_gauge2__mod__magnetic) {
if (AC_lua_as_aux__mod__magnetic) {
gua_304 = gradient(Field(AC_iua__mod__magnetic))
dadt_304 = dadt_304 + ac_transformed_pencil_uxb+fres__mod__magnetic-gua_304
}
else {
}
if(AC_limp_alpha__mod__magnetic) {
if (abs(AC_z__mod__cdata[AC_n__mod__cdata-1])<=AC_imp_halpha__mod__magnetic/2) {
dadt_304 = dadt_304+ ac_transformed_pencil_uxb+fres__mod__magnetic+AC_imp_alpha0__mod__magnetic*sin(AC_pi__mod__cparam*AC_z__mod__cdata[AC_n__mod__cdata-1]/AC_imp_halpha__mod__magnetic)*ac_transformed_pencil_bb
}
else {
dadt_304 = dadt_304+ ac_transformed_pencil_uxb+fres__mod__magnetic+sign(AC_imp_alpha0__mod__magnetic,AC_z__mod__cdata[AC_n__mod__cdata-1])*exp(-((2*AC_z__mod__cdata[AC_n__mod__cdata-1]-sign(AC_imp_halpha__mod__magnetic,AC_z__mod__cdata[AC_n__mod__cdata-1]))/AC_imp_halpha__mod__magnetic)*((2*AC_z__mod__cdata[AC_n__mod__cdata-1]-sign(AC_imp_halpha__mod__magnetic,AC_z__mod__cdata[AC_n__mod__cdata-1]))/AC_imp_halpha__mod__magnetic))*ac_transformed_pencil_bb
}
}
}
else {
dadt_304 = dadt_304+ ac_transformed_pencil_uxb+fres__mod__magnetic
}
if (AC_lnoinduction__mod__magnetic) {
dadt_304 = dadt_304 - ac_transformed_pencil_uxb
}
}
}
else {
if (b_ext_304.x != 0.  ||  b_ext_304.y != 0.  ||  b_ext_304.z != 0.) {
uxb_upw_304 = cross(ac_transformed_pencil_uu,b_ext_304)
}
else {
uxb_upw_304.x = 0.
uxb_upw_304.y = 0.
uxb_upw_304.z = 0.
}
if (AC_ladvective_gauge__mod__magnetic) {
ujiaj_304.x = 0.
ujiaj_304.y = 0.
ujiaj_304.z = 0.
ujiaj_304.x=ujiaj_304.x+ac_transformed_pencil_aa.x*ac_transformed_pencil_uij[1-1][1-1]
ujiaj_304.x=ujiaj_304.x+ac_transformed_pencil_aa.y*ac_transformed_pencil_uij[2-1][1-1]
ujiaj_304.x=ujiaj_304.x+ac_transformed_pencil_aa.z*ac_transformed_pencil_uij[3-1][1-1]
uxb_upw_304.x=uxb_upw_304.x-ac_transformed_pencil_uga.x-ujiaj_304.x
ujiaj_304.y=ujiaj_304.y+ac_transformed_pencil_aa.x*ac_transformed_pencil_uij[1-1][2-1]
ujiaj_304.y=ujiaj_304.y+ac_transformed_pencil_aa.y*ac_transformed_pencil_uij[2-1][2-1]
ujiaj_304.y=ujiaj_304.y+ac_transformed_pencil_aa.z*ac_transformed_pencil_uij[3-1][2-1]
uxb_upw_304.y=uxb_upw_304.y-ac_transformed_pencil_uga.y-ujiaj_304.y
ujiaj_304.z=ujiaj_304.z+ac_transformed_pencil_aa.x*ac_transformed_pencil_uij[1-1][3-1]
ujiaj_304.z=ujiaj_304.z+ac_transformed_pencil_aa.y*ac_transformed_pencil_uij[2-1][3-1]
ujiaj_304.z=ujiaj_304.z+ac_transformed_pencil_aa.z*ac_transformed_pencil_uij[3-1][3-1]
uxb_upw_304.z=uxb_upw_304.z-ac_transformed_pencil_uga.z-ujiaj_304.z
}
else {
if (1!=1) {
uxb_upw_304.x=uxb_upw_304.x+ac_transformed_pencil_uu.x*(ac_transformed_pencil_aij[1-1][1-1]-ac_transformed_pencil_aij[1-1][1-1])
}
if (2!=1) {
uxb_upw_304.x=uxb_upw_304.x+ac_transformed_pencil_uu.y*(ac_transformed_pencil_aij[2-1][1-1]-ac_transformed_pencil_aij[1-1][2-1])
}
if (3!=1) {
uxb_upw_304.x=uxb_upw_304.x+ac_transformed_pencil_uu.z*(ac_transformed_pencil_aij[3-1][1-1]-ac_transformed_pencil_aij[1-1][3-1])
}
msk_295_304=0
if (true) {
if ( 1>=1  &&  1 <=3 ) {
msk_295_304=1
}
}
del6f_upwind_295_304 = del6_masked(Field(AC_iaa__mod__cdata+1-1), msk_295_304)
if (msk_295_304>0) {
uxb_upw_304.x = uxb_upw_304.x+del6f_upwind_295_304
}
else {
uxb_upw_304.x = uxb_upw_304.x-del6f_upwind_295_304
}
if (1!=2) {
uxb_upw_304.y=uxb_upw_304.y+ac_transformed_pencil_uu.x*(ac_transformed_pencil_aij[1-1][2-1]-ac_transformed_pencil_aij[2-1][1-1])
}
if (2!=2) {
uxb_upw_304.y=uxb_upw_304.y+ac_transformed_pencil_uu.y*(ac_transformed_pencil_aij[2-1][2-1]-ac_transformed_pencil_aij[2-1][2-1])
}
if (3!=2) {
uxb_upw_304.y=uxb_upw_304.y+ac_transformed_pencil_uu.z*(ac_transformed_pencil_aij[3-1][2-1]-ac_transformed_pencil_aij[2-1][3-1])
}
msk_295_304=0
if (true) {
if ( 2>=1  &&  2 <=3 ) {
msk_295_304=2
}
}
del6f_upwind_295_304 = del6_masked(Field(AC_iaa__mod__cdata+2-1), msk_295_304)
if (msk_295_304>0) {
uxb_upw_304.y = uxb_upw_304.y+del6f_upwind_295_304
}
else {
uxb_upw_304.y = uxb_upw_304.y-del6f_upwind_295_304
}
if (1!=3) {
uxb_upw_304.z=uxb_upw_304.z+ac_transformed_pencil_uu.x*(ac_transformed_pencil_aij[1-1][3-1]-ac_transformed_pencil_aij[3-1][1-1])
}
if (2!=3) {
uxb_upw_304.z=uxb_upw_304.z+ac_transformed_pencil_uu.y*(ac_transformed_pencil_aij[2-1][3-1]-ac_transformed_pencil_aij[3-1][2-1])
}
if (3!=3) {
uxb_upw_304.z=uxb_upw_304.z+ac_transformed_pencil_uu.z*(ac_transformed_pencil_aij[3-1][3-1]-ac_transformed_pencil_aij[3-1][3-1])
}
msk_295_304=0
if (true) {
if ( 3>=1  &&  3 <=3 ) {
msk_295_304=3
}
}
del6f_upwind_295_304 = del6_masked(Field(AC_iaa__mod__cdata+3-1), msk_295_304)
if (msk_295_304>0) {
uxb_upw_304.z = uxb_upw_304.z+del6f_upwind_295_304
}
else {
uxb_upw_304.z = uxb_upw_304.z-del6f_upwind_295_304
}
}
if (AC_linduction__mod__magnetic) {
dadt_304= dadt_304 + uxb_upw_304 + fres__mod__magnetic
}
}
if (AC_hall_term__mod__magnetic!=0.0) {
if(AC_ihall_term_int__mod__magnetic == AC_ihall_term_int_const__mod__magnetic) {
hall_term__304=AC_hall_term__mod__magnetic
}
else if(AC_ihall_term_int__mod__magnetic == AC_ihall_term_int_t_dep__mod__magnetic) {
hall_term__304=AC_hall_term__mod__magnetic*pow(max(AC_t__mod__cdata,AC_hall_tdep_t0__mod__magnetic),AC_hall_tdep_exponent__mod__magnetic)
}
else if(AC_ihall_term_int__mod__magnetic == AC_ihall_term_int_z_dep__mod__magnetic) {
hall_term__304=AC_hall_term__mod__magnetic/pow((1.-(AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_xyz1__mod__cdata.z)/AC_hhall__mod__magnetic),AC_hall_zdep_exponent__mod__magnetic)
}
dadt_304=dadt_304-hall_term__304*ac_transformed_pencil_jxb
if (AC_lfirst__mod__cdata && AC_ldt__mod__cdata) {
advec_hall_304=sum(abs(ac_transformed_pencil_uu-hall_term__304*ac_transformed_pencil_jj)*dline_1__mod__cdata)
advec2__mod__cdata=advec2__mod__cdata+advec_hall_304*advec_hall_304
}
}
if (AC_battery_term__mod__magnetic!=0.0) {
dadt_304 = dadt_304-AC_battery_term__mod__magnetic*ac_transformed_pencil_fpres
}
if (AC_lambipolar_strong_coupling__mod__magnetic && AC_tauad__mod__magnetic!=0.0) {
dadt_304=dadt_304+AC_tauad__mod__magnetic*ac_transformed_pencil_jxbxb
eta_total__mod__magnetic = eta_total__mod__magnetic + AC_tauad__mod__magnetic*AC_mu01__mod__cdata*ac_transformed_pencil_b2
}
if (AC_lmagneto_friction__mod__magnetic && (!AC_lhydro__mod__cparam) && AC_numag__mod__magnetic!=0.0) {
tmp1_304=AC_mu01__mod__cdata/(AC_numag__mod__magnetic*(AC_b0_magfric__mod__magnetic/AC_unit_magnetic__mod__cdata*AC_unit_magnetic__mod__cdata+ac_transformed_pencil_b2))
dadt_304.x = dadt_304.x + ac_transformed_pencil_jxbxb.x*tmp1_304
dadt_304.y = dadt_304.y + ac_transformed_pencil_jxbxb.y*tmp1_304
dadt_304.z = dadt_304.z + ac_transformed_pencil_jxbxb.z*tmp1_304
if (! AC_linduction__mod__magnetic) {
dadt_304 = dadt_304 + fres__mod__magnetic
}
}
if (AC_height_eta__mod__magnetic!=0.0) {
if (AC_lhalox__mod__magnetic) {
tmp_304 = (AC_x__mod__cdata[AC_nx__mod__cparam-1]/AC_height_eta__mod__magnetic)*(AC_x__mod__cdata[AC_nx__mod__cparam-1]/AC_height_eta__mod__magnetic)
eta_out1_304 = AC_eta_out__mod__magnetic*(1.0-exp(-tmp_304*tmp_304*tmp_304*tmp_304*tmp_304*tmp_304/max(1.0-tmp_304,1.0e-5)))-AC_eta__mod__magnetic
}
else {
z_296_304 = abs((AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_height_eta__mod__magnetic)/AC_eta_zwidth__mod__magnetic)
t_296_304 = 1.0 / ( 1.0 + 0.5 * z_296_304 )
dumerfc_296_304 =  t_296_304 * exp(-z_296_304 * z_296_304 - 1.26551223 + t_296_304 *         ( 1.00002368 + t_296_304 * ( 0.37409196 + t_296_304 *            ( 0.09678418 + t_296_304 * (-0.18628806 + t_296_304 *            ( 0.27886807 + t_296_304 * (-1.13520398 + t_296_304 *            ( 1.48851587 + t_296_304 * (-0.82215223 + t_296_304 * 0.17087277 )))))))))
if ((AC_z__mod__cdata[AC_n__mod__cdata-1]-AC_height_eta__mod__magnetic)/AC_eta_zwidth__mod__magnetic<0.0) {
dumerfc_296_304 = 2.0 - dumerfc_296_304
}
erfunc_return_value_296_304 = 1.0 - dumerfc_296_304
eta_out1_304=(AC_eta_out__mod__magnetic-AC_eta__mod__magnetic)*0.5*(1.+erfunc_return_value_296_304)
}
dadt_304 = dadt_304-(eta_out1_304*AC_mu0__mod__cdata)*ac_transformed_pencil_jj
eta_total__mod__magnetic = eta_total__mod__magnetic + eta_out1_304*AC_mu0__mod__cdata
}
if (AC_ekman_friction_aa__mod__magnetic!=0) {
DF_AVEC=DF_AVEC-AC_ekman_friction_aa__mod__magnetic*ac_transformed_pencil_aa
}
if (AC_lforcing_cont_aa__mod__magnetic) {
dadt_304=dadt_304+ AC_ampl_fcont_aa__mod__magnetic*ac_transformed_pencil_fcont[AC_iforcing_cont_aa__mod__magnetic-1]
}
if (AC_z__mod__cdata[AC_n__mod__cdata-1]>AC_zgrav__mod__gravity) {
scl_298_304=1./AC_tau_aa_exterior__mod__magnetic
DF_AVEC=DF_AVEC-scl_298_304*value(F_AVEC)
}
if (AC_tau_relprof__mod__magnetic!=0.0) {
if (AC_la_relprof_global__mod__magnetic) {
dadt_304= dadt_304-(ac_transformed_pencil_aa-value(F_GLOBAL_EXT_AVEC))*AC_tau_relprof1__mod__magnetic
}
else {
dadt_304.x= dadt_304.x-(ac_transformed_pencil_aa.x-AC_a_relprof__mod__magnetic[vertexIdx.x-NGHOST_VAL][AC_m__mod__cdata-AC_m1__mod__cparam+1-1][AC_n__mod__cdata-AC_n1__mod__cparam+1-1][1-1])*AC_tau_relprof1__mod__magnetic
dadt_304.y= dadt_304.y-(ac_transformed_pencil_aa.y-AC_a_relprof__mod__magnetic[vertexIdx.x-NGHOST_VAL][AC_m__mod__cdata-AC_m1__mod__cparam+1-1][AC_n__mod__cdata-AC_n1__mod__cparam+1-1][2-1])*AC_tau_relprof1__mod__magnetic
dadt_304.z= dadt_304.z-(ac_transformed_pencil_aa.z-AC_a_relprof__mod__magnetic[vertexIdx.x-NGHOST_VAL][AC_m__mod__cdata-AC_m1__mod__cparam+1-1][AC_n__mod__cdata-AC_n1__mod__cparam+1-1][3-1])*AC_tau_relprof1__mod__magnetic
}
}
if(AC_borderaa_int__mod__magnetic.x == AC_borderaa_int_zero__mod__magnetic) {
f_target_302_304.x=0.
}
else if(AC_borderaa_int__mod__magnetic.x == AC_borderaa_int_initial_condition__mod__magnetic) {
ju_302_304=1+AC_iaa__mod__cdata-1
}
else if(AC_borderaa_int__mod__magnetic.x == AC_borderaa_int_initial_condition__mod__magnetic) {
}
if(AC_borderaa_int__mod__magnetic.y == AC_borderaa_int_zero__mod__magnetic) {
f_target_302_304.y=0.
}
else if(AC_borderaa_int__mod__magnetic.y == AC_borderaa_int_initial_condition__mod__magnetic) {
ju_302_304=2+AC_iaa__mod__cdata-1
}
else if(AC_borderaa_int__mod__magnetic.y == AC_borderaa_int_initial_condition__mod__magnetic) {
}
if(AC_borderaa_int__mod__magnetic.z == AC_borderaa_int_zero__mod__magnetic) {
f_target_302_304.z=0.
}
else if(AC_borderaa_int__mod__magnetic.z == AC_borderaa_int_initial_condition__mod__magnetic) {
ju_302_304=3+AC_iaa__mod__cdata-1
}
else if(AC_borderaa_int__mod__magnetic.z == AC_borderaa_int_initial_condition__mod__magnetic) {
}
if (AC_lee_as_aux__mod__magnetic) {
DF_EVEC=-dadt_304
}
if (AC_lbb_sph_as_aux__mod__magnetic && AC_lsphere_in_a_box__mod__cdata) {
DF_BB_SPHR = ac_transformed_pencil_bb.x*ac_transformed_pencil_evr.x+ac_transformed_pencil_bb.y*ac_transformed_pencil_evr.y+ac_transformed_pencil_bb.z*ac_transformed_pencil_evr.z
DF_BB_SPHT = ac_transformed_pencil_bb.x*ac_transformed_pencil_evth.x+ac_transformed_pencil_bb.y*ac_transformed_pencil_evth.y+ac_transformed_pencil_bb.z*ac_transformed_pencil_evth.z
DF_BB_SPHP = ac_transformed_pencil_bb.x*ac_transformed_pencil_phix+ac_transformed_pencil_bb.y*ac_transformed_pencil_phiy
}
DF_AVEC=DF_AVEC+dadt_304
}
if (AC_ietat__mod__cdata!=0) {
eta_total__mod__magnetic=eta_total__mod__magnetic+value(F_ETAT)
}
if (AC_lanelastic__mod__cparam) {
DF_RHSX = ac_transformed_pencil_rho*DF_UX
DF_RHSY = ac_transformed_pencil_rho*DF_UY
DF_RHSZ = ac_transformed_pencil_rho*DF_UZ
DF_UVEC = df_iuu_pencil + DF_UVEC
}
}
