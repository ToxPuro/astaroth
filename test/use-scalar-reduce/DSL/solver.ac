Field F
global output real F_GLOBAL_MAX
output real F_LOCAL_MAX
Kernel
empty_kernel()
{
}

Kernel reduce_field(Field f)
{
	reduce_max(f,F_GLOBAL_MAX)
	reduce_max(f,F_LOCAL_MAX)
}

Kernel set_field_to_max(Field f)
{
	write(f, F_GLOBAL_MAX)
}
BoundConds bcs
{
	periodic(BOUNDARY_XYZ)
}
ComputeSteps rhs_1(bcs)
{
	reduce_field(F)
}

ComputeSteps rhs_2(bcs)
{
	set_field_to_max(F)
}

ComputeSteps rhs(bcs)
{
	reduce_field(F)
	set_field_to_max(F)
}
