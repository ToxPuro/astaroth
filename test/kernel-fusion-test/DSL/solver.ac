hostdefine STENCIL_ORDER (0)
Field AX,AY,AZ



struct Profiles
{
	Profile<X> x;
	Profile<Y> y;
	Profile<Z> z;
} 
struct VectorProfiles
{
	Profiles x;
	Profiles y;
	Profiles z;
}


VectorProfiles AA_MEANS



Kernel reduce_aa_x()
{
    	reduce_sum(true, AX, AA_MEANS.x.x)
    	reduce_sum(true, AY, AA_MEANS.y.x)
    	reduce_sum(true, AZ, AA_MEANS.z.x)

}
Kernel reduce_aa_y()
{
    reduce_sum(true, AX, AA_MEANS.x.y)
    reduce_sum(true, AY, AA_MEANS.y.y)
    reduce_sum(true, AZ, AA_MEANS.z.y)
}
Kernel remove_aa_x()
{
	write(AX,AX-AA_MEANS.x.x)
	write(AY,AY-AA_MEANS.y.x)
	write(AZ,AZ-AA_MEANS.z.x)
}
Kernel remove_aa_y()
{
	write(AX,AX-AA_MEANS.x.y)
	write(AY,AY-AA_MEANS.y.y)
	write(AZ,AZ-AA_MEANS.z.y)
}
BoundConds bcs
{
	periodic(BOUNDARY_XYZ)
}

ComputeSteps rhs(bcs)
{
	reduce_aa_x()
	reduce_aa_y()
	remove_aa_x()
	remove_aa_y()
}
//#include "../../../build/acc-runtime/api/fused_kernels.h"
